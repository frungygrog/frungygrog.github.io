var zt=Object.defineProperty;var At=(t,d,u)=>d in t?zt(t,d,{enumerable:!0,configurable:!0,writable:!0,value:u}):t[d]=u;var pt=(t,d,u)=>At(t,typeof d!="symbol"?d+"":d,u);import{r as s,j as e,e as Ke,u as Xe,R as Z,q as Ft,T as Dt,L as H,U as Ye,V as Pt,W as Wt,B as Qe,X as $t,Y as Ot,Z as qt,_ as Ut,O as ht,K as Bt,A as jt,h as wt,P as Ht,Q as Vt,E as Yt,c as Ze,H as Qt,l as Nt,$ as ft,y as Jt,v as Gt,b as Kt,a as Xt,i as kt,g as St,k as Je,a0 as Zt,a1 as xt,o as es,x as ts,a2 as ss,a3 as as,a4 as ns,a5 as is,a6 as se}from"./vendor-react-DjZENDOm.js";import{y as rs}from"./vendor-CUqVEcin.js";import{u as $e,a as E,A as k,c as Ge,P as os,b as _e,d as ls,C as cs,T as ds,e as us}from"./mappi-routes-CGq90znU.js";import{H as ms}from"./editor-components-DLfFEG70.js";import{u as Oe,a as et,b as ps,c as hs,d as fs,e as xs,f as gs,g as bs,C as ys,M as vs,P as js,Q as ws,h as Ns,N as ks}from"./moddi-routes-CJP9h7G5.js";import{B as Ss,E as Cs}from"./editor-lib-3MZ0XSGo.js";import"./vendor-hls-B_fsdCYC.js";import"./beatmap-preview-B55-FkE2.js";import"./vendor-zip-CJUvx9qt.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))i(y);new MutationObserver(y=>{for(const m of y)if(m.type==="childList")for(const F of m.addedNodes)F.tagName==="LINK"&&F.rel==="modulepreload"&&i(F)}).observe(document,{childList:!0,subtree:!0});function u(y){const m={};return y.integrity&&(m.integrity=y.integrity),y.referrerPolicy&&(m.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?m.credentials="include":y.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function i(y){if(y.ep)return;y.ep=!0;const m=u(y);fetch(y.href,m)}})();const _s=new rs({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}});class Rs extends s.Component{constructor(u){super(u);pt(this,"handleRetry",()=>{const u=this.isChunkLoadingError(this.state.error);this.setState({hasError:!1,error:null}),u&&window.location.reload()});this.state={hasError:!1,error:null}}static getDerivedStateFromError(u){return{hasError:!0,error:u}}componentDidCatch(u,i){console.error("ErrorBoundary caught an error:",u,i)}isChunkLoadingError(u){if(!u)return!1;const i=u.message.toLowerCase();return i.includes("loading chunk")||i.includes("failed to load")||i.includes("chunk load failed")||i.includes("loading css chunk")||u.name==="ChunkLoadError"}render(){var u;if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const i=this.isChunkLoadingError(this.state.error),y=((u=this.state.error)==null?void 0:u.message)||"An unexpected error occurred";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"8px",color:"var(--muted)"},children:i?"Failed to load page. This might be a network issue.":y}),i&&e.jsx("p",{style:{marginBottom:"24px",fontSize:"14px",color:"var(--muted)",opacity:.8},children:"Try checking your internet connection or reloading the page."}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{className:"btn secondary",onClick:this.handleRetry,children:i?"Reload Page":"Try Again"}),!i&&e.jsx("button",{className:"btn secondary",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})}return this.props.children}}const ye=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function Es({i:t}){const d=t*1337,u=(T,z)=>{const O=Math.sin(d+T+z)*1e4,B=O-Math.floor(O);return Math.floor(B*(z-T+1)+T)},i=u(0,100),y=u(24,50),m=.7+u(0,100)/100*.3,F=y*m,Y=u(0,4e3),w=u(-10,10),L=u(-8,8),x=u(0,100),I=x<60?1:x<80?1.5:2,D=[{size:200*I,alpha:.06,dx:-22,dy:12,color:ye[u(0,ye.length-1)]},{size:150*I,alpha:.08,dx:-9,dy:7,color:ye[u(0,ye.length-1)]},{size:120*I,alpha:.1,dx:0,dy:0,color:ye[u(0,ye.length-1)]},{size:90*I,alpha:.12,dx:12,dy:-4,color:ye[u(0,ye.length-1)]},{size:64*I,alpha:.13,dx:20,dy:-7,color:ye[u(0,ye.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${i}vw`,animationDuration:`${F}s`,animationDelay:`${Y}ms`,"--tx":`${w}vw`,transform:`rotate(${L}deg)`},children:D.map((T,z)=>e.jsx("svg",{width:T.size,height:T.size,viewBox:"0 0 100 100",style:{left:`${50+T.dx}%`,bottom:`${T.dy}px`,transform:"translateX(-50%)","--alpha":T.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:T.color})},z))})}function Ct({paused:t=!1}){const d=s.useMemo(()=>new Array(20).fill(0).map((u,i)=>i),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:d.map(u=>e.jsx(Es,{i:u},u))})}function Ts(){const t=Ke(),d=Xe(),{lastSection:u,previousLocation:i,setPreviousLocation:y}=Oe(),m=Z.useRef(null),F=Z.useRef(!1),Y=Z.useRef(0),w=Z.useRef(0),L=Z.useRef(null),x=Z.useRef(null),I=Z.useRef(!1),D=300,T=2e3,z=Z.useRef(null),O=Z.useRef(null),B=Z.useRef(null),[N,W]=Z.useState(!1);Z.useEffect(()=>()=>{m.current&&clearTimeout(m.current),L.current&&clearTimeout(L.current),x.current&&clearTimeout(x.current)},[]),Z.useEffect(()=>{if(!N)return;const $=S=>{const Q=S.target;B.current&&!B.current.contains(Q)&&O.current&&!O.current.contains(Q)&&W(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[N]);const A=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",f=t.pathname==="/editor";t.pathname.startsWith("/mp/")||!A&&t.pathname.startsWith("/md/");const g=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!A&&!t.pathname.startsWith("/mp/")&&u==="moddi";if(A)return null;const j=()=>{d(i||(u==="moddi"?"/md/feed":"/mp/feed"))},h=()=>{W($=>!$)},q=()=>{var $;W(!1),($=z.current)==null||$.click()};if(f)return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:z,type:"file",accept:".osz,.zip",onChange:$=>{var Q;const S=(Q=$.target.files)==null?void 0:Q[0];S&&window.dispatchEvent(new CustomEvent("editor:file",{detail:S}))},style:{display:"none"}}),e.jsxs("nav",{className:"mobile-bottom-nav mobile-bottom-nav-editor",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx("button",{className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:j,"aria-label":"Back",title:"Go back",children:e.jsx(Ft,{size:20})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:O,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:h,"aria-label":"File",title:"File menu","aria-expanded":N,children:e.jsx(Dt,{size:20})}),N&&e.jsx("div",{ref:B,className:"menu-panel mobile-bottom-nav-menu",role:"menu",style:{position:"absolute",bottom:"calc(100% + 8px)",left:0,top:"auto",right:"auto",zIndex:1e3},children:e.jsx("button",{className:"menu-item",type:"button",onClick:q,style:{fontFamily:"Torus Pro, Torus, ui-sans-serif, system-ui, sans-serif"},children:"Open .osz"})})]})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:j,"aria-label":"Go back",title:"Go back to previous page",children:e.jsx("span",{className:"mobile-coin-flip-text",children:"ed!"})}),e.jsx("div",{className:"mobile-bottom-nav-right"})]})]});const ee=()=>{const $=Date.now();if(Y.current>0){const S=$-Y.current;if(S<D&&S>0){L.current&&(clearTimeout(L.current),L.current=null),x.current&&(clearTimeout(x.current),x.current=null),m.current&&(clearTimeout(m.current),m.current=null),w.current=$+T,Y.current=0,F.current=!1,y(t.pathname),d("/editor");return}}$<w.current&&Y.current===0||(L.current&&(clearTimeout(L.current),L.current=null),x.current&&(clearTimeout(x.current),x.current=null),Y.current=$,x.current=setTimeout(()=>{x.current!==null&&(d(g?"/mp/feed":"/md/feed"),x.current=null)},D),L.current=setTimeout(()=>{Y.current>0&&(Y.current=0,w.current=Date.now()+T),L.current=null},D))},le=()=>{F.current=!1,m.current=setTimeout(()=>{F.current=!0,d("/")},500)},ae=()=>{m.current&&(clearTimeout(m.current),m.current=null),F.current&&setTimeout(()=>{F.current=!1},100)},U=$=>{if(I.current){$.preventDefault(),$.stopPropagation(),I.current=!1;return}if(F.current){$.preventDefault(),$.stopPropagation();return}ee()},X=$=>{if(ae(),F.current){$.preventDefault(),I.current=!0;return}$.preventDefault(),ee(),I.current=!0,setTimeout(()=>{I.current=!1},D+100)};return e.jsxs("nav",{className:"mobile-bottom-nav",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx(H,{to:g?"/md/feed":"/mp/feed",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/feed"||t.pathname==="/md/feed"?"active":""}`,"aria-label":"Feed",children:e.jsx(Ye,{size:20})}),g?e.jsx(H,{to:"/md/queues",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/md/queues")?"active":""}`,"aria-label":"Queues",children:e.jsx(Pt,{size:20})}):e.jsx(H,{to:"/mp/discover",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/discover"?"active":""}`,"aria-label":"Discover",children:e.jsx(Wt,{size:20})})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:U,onTouchStart:le,onTouchEnd:X,onMouseDown:le,onMouseUp:ae,onMouseLeave:ae,"aria-label":g?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",title:g?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",children:e.jsx("span",{className:"mobile-coin-flip-text",children:g?"md!":"mp!"})}),e.jsxs("div",{className:"mobile-bottom-nav-right",children:[e.jsx(H,{to:"/profile",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/profile")?"active":""}`,"aria-label":"Profile",children:e.jsx(Qe,{size:20})}),e.jsx("button",{className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/settings"?"active":""}`,onClick:()=>d("/settings"),"aria-label":"Settings",children:e.jsx($t,{size:20})})]})]})}function Is(){const t=Ke(),d=Xe(),{notify:u}=$e(),{data:i,isLoading:y}=et(),{data:m}=ps(!!i),{data:F=[]}=hs(!!i),Y=fs(),w=xs(),L=gs(),x=bs(),[I,D]=s.useState(new Set),T=s.useRef(null),z=s.useRef(null),O=s.useRef(null),B=s.useRef(null),N=s.useRef(null),W=s.useRef(null),{menuOpen:A,mobileNavOpen:f,notifOpen:g,lastSection:j,setMenuOpen:h,setMobileNavOpen:q,setNotifOpen:ee,closeAllPanels:le,setLastSection:ae,setPreviousLocation:U}=Oe(),X=s.useRef(0),$=s.useRef(0),S=s.useRef(null),Q=500,ce=2e3;Z.useEffect(()=>()=>{S.current&&clearTimeout(S.current)},[]);const c=r=>{r.preventDefault();const v=Date.now();if(!(v<$.current)){if(S.current&&X.current>0){const P=v-X.current;if(P<Q&&P>0){clearTimeout(S.current),S.current=null,$.current=v+ce,X.current=0,U(t.pathname),d("/editor");return}}S.current&&(clearTimeout(S.current),S.current=null),X.current=v,S.current=setTimeout(()=>{$.current=Date.now()+ce,S.current=null,X.current=0,d(ne?"/mp/feed":"/md/feed")},Q)}},C=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",M=t.pathname==="/editor",V=t.pathname.startsWith("/mp/")||!C&&!t.pathname.startsWith("/md/")&&j==="mappi",ne=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!C&&!t.pathname.startsWith("/mp/")&&j==="moddi";t.pathname.startsWith("/md/queues/")&&t.pathname,Z.useEffect(()=>{t.pathname.startsWith("/mp/")?ae("mappi"):t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"&&ae("moddi")},[t.pathname,ae]);const[l,J]=Z.useState(0);Z.useEffect(()=>{const r=setInterval(()=>J(v=>v+1),1e3);return()=>clearInterval(r)},[]);const[_,de]=Z.useState(null);Z.useEffect(()=>{!i||!i.is_mod||(async()=>{try{const r=await E(k.admin.debugState,{requireAuth:!1}),v=Array.isArray(r==null?void 0:r.counts)?r.counts.find(P=>String(P.status)==="ready"):null;v&&de(Number(v.c)||0)}catch{}})()},[i]);const[Re,je]=Z.useState(!1),Te=r=>{if(!r)return null;try{const v=JSON.parse(r);if((v==null?void 0:v.type)==="queue_invite"&&(v!=null&&v.queue_id))return v}catch{}return null},Ee=async(r,v)=>{if(!I.has(r.id)){D(P=>new Set(P).add(r.id));try{await E(k.moddi.queueAccept(String(v)),{method:"POST"}),u("Invitation accepted!",{variant:"success"}),x.mutate(r.id),ee(!1),d(`/md/queues/${v}`)}catch(P){u((P==null?void 0:P.message)||"Failed to accept invitation",{variant:"error"})}finally{D(P=>{const ie=new Set(P);return ie.delete(r.id),ie})}}},Me=async(r,v)=>{if(!I.has(r.id)){D(P=>new Set(P).add(r.id));try{await E(k.moddi.queueDeny(String(v)),{method:"POST"}),u("Invitation declined",{variant:"success"}),x.mutate(r.id)}catch(P){u((P==null?void 0:P.message)||"Failed to decline invitation",{variant:"error"})}finally{D(P=>{const ie=new Set(P);return ie.delete(r.id),ie})}}},Le=async()=>{const r=F.filter(v=>v.id.startsWith("n:")||v.kind==="system"&&!v.read).map(v=>v.id);r.length>0&&L.mutate(r)},te=async r=>{if(ee(!1),L.mutate([r.id]),r.kind==="system"||r.id.startsWith("n:"))try{await E(k.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:[r.id]})})}catch{}},ze=async(r,v)=>{r.stopPropagation(),x.mutate(v)};return Z.useEffect(()=>{i&&!localStorage.getItem("welcomed")&&(u(`Welcome, ${i.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[i,u]),Z.useEffect(()=>{if(!g)return;const r=v=>{const P=v.target;z.current&&!z.current.contains(P)&&T.current&&!T.current.contains(P)&&ee(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[g,ee]),Z.useEffect(()=>{if(!A)return;const r=v=>{const P=v.target;B.current&&!B.current.contains(P)&&O.current&&!O.current.contains(P)&&h(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[A,h]),Z.useEffect(()=>{if(!f)return;const r=v=>{const P=v.target;W.current&&!W.current.contains(P)&&N.current&&!N.current.contains(P)&&q(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[f,q]),e.jsxs("div",{className:"app-shell","data-section":ne?"moddi":V?"mappi":j==="moddi"?"moddi":j==="mappi"?"mappi":void 0,children:[e.jsx(Ct,{paused:t.pathname==="/editor"}),e.jsxs("header",{className:"top-nav",children:[t.pathname!=="/editor"&&e.jsxs("div",{className:"mobile-nav",children:[e.jsx("button",{ref:N,className:"icon-link hamburger",onClick:()=>{f||le(),q(!f)},"aria-label":"Menu","aria-expanded":f,children:e.jsx(Ot,{size:18})}),f&&e.jsxs("div",{ref:W,className:"menu-panel",role:"menu",children:[C&&e.jsx(H,{to:t.pathname==="/"?"/about":"/",className:`menu-item ${t.pathname==="/about"?"active":""}`,onClick:()=>q(!1),children:t.pathname==="/"?"About":"Home"}),V&&e.jsxs(e.Fragment,{children:[e.jsx(H,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>q(!1),children:"Feed"}),e.jsx(H,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>q(!1),children:"Discover"})]}),ne&&e.jsxs(e.Fragment,{children:[e.jsx(H,{to:"/md/feed",className:`menu-item ${t.pathname==="/md/feed"?"active":""}`,onClick:()=>q(!1),children:"Feed"}),e.jsx(H,{to:"/md/queues",className:`menu-item ${t.pathname.startsWith("/md/queues")?"active":""}`,onClick:()=>q(!1),children:"Queues"})]}),!V&&!ne&&!C&&e.jsxs(e.Fragment,{children:[e.jsx(H,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>q(!1),children:"Feed"}),e.jsx(H,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>q(!1),children:"Discover"})]})]})]}),C?e.jsx(H,{to:"/",className:"title",children:ne?"osu!moddi.ng":V?"osu!mappi.ng":"mappi!"}):M?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(H,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(Ye,{size:18})}),e.jsx(H,{to:ne?"/md/feed":"/mp/feed",className:"title",children:ne?"osu!moddi.ng":"osu!mappi.ng"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(H,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(Ye,{size:18})}),e.jsxs("button",{onClick:c,className:"title coin-flip-title",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"inherit",font:"inherit"},title:"Switch section (double-click for editor)","aria-label":"Switch section (double-click for editor)",children:[e.jsx("span",{className:"coin-flip-front",children:ne?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:ne?"osu!mappi.ng":"osu!moddi.ng"})]})]}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),t.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(ms,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[C&&e.jsx(H,{to:t.pathname==="/"?"/about":"/",className:t.pathname==="/about"?"active":"",children:t.pathname==="/"?"About":"Home"}),V&&e.jsxs(e.Fragment,{children:[e.jsx(H,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(H,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(H,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]}),ne&&e.jsxs(e.Fragment,{children:[e.jsx(H,{to:"/md/feed",className:t.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx(H,{to:"/md/queues",className:t.pathname.startsWith("/md/queues")?"active":"",children:"Queues"})]}),!V&&!ne&&!C&&e.jsxs(e.Fragment,{children:[e.jsx(H,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(H,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(H,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]})]}),e.jsx("div",{style:{marginLeft:"auto"}}),e.jsx("a",{className:"icon-link",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)","aria-label":"Join Discord",style:{marginRight:3,transform:"translateY(2px)"},children:e.jsx(qt,{size:18})}),i?e.jsxs("div",{className:"user-menu",children:[e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:3},children:[e.jsx("button",{ref:T,className:"icon-link",onClick:()=>{g||le(),ee(!g)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(Ut,{size:18})}),Y>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),g&&e.jsxs("div",{ref:z,className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(H,{to:"/md/notifications",onClick:()=>ee(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:r=>r.currentTarget.style.opacity="1",onMouseLeave:r=>r.currentTarget.style.opacity="0.7",children:"View all"}),F.filter(r=>!(r.kind==="system"&&r.id.startsWith("b:")&&(r.expiresAt||0)<=Date.now())).length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:Le,children:e.jsx(ht,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[F.filter(r=>!(r.kind==="system"&&r.id.startsWith("b:")&&(r.expiresAt||0)<=Date.now())).length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),F.filter(r=>!(r.kind==="system"&&r.id.startsWith("b:")&&(r.expiresAt||0)<=Date.now())).map(r=>{const v=Te(r.text),P=r.id.startsWith("b:"),ie=v?"queue-invite":r.kind==="star"?"star":r.kind==="likes5"?"likes":r.kind==="comment"?"comment":r.kind==="inspiration"?"inspiration":r.kind==="reaction"?"reaction":P?"global":"system",ue=r.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${ie}`,role:"button",onClick:()=>!v&&te(r),children:[e.jsxs("div",{className:`notif-icon ${ue?"deletable":""}`,"aria-hidden":"true",onClick:ue&&!v?pe=>ze(pe,r.id):void 0,title:ue&&!v?"Remove":void 0,role:ue&&!v?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:v?e.jsx(Bt,{}):ie==="star"?e.jsx(jt,{}):ie==="likes"?e.jsx(wt,{}):ie==="comment"?e.jsx(Qe,{}):ie==="inspiration"?e.jsx(Qe,{}):ie==="reaction"?e.jsx(Ht,{}):ie==="global"?e.jsx(Vt,{}):null}),ue&&!v?e.jsx("span",{className:"swap-trash",children:e.jsx(Yt,{})}):null]}),e.jsx("div",{className:"notif-body",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Queue Invitation"}),e.jsxs("div",{className:"notif-desc",children:[v.inviter_username," invited you to join queue: ",v.queue_name]}),I.has(r.id)?e.jsx("div",{className:"muted",style:{fontSize:11,marginTop:6},children:"Processing..."}):e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:pe=>{pe.stopPropagation(),Ee(r,v.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(ht,{size:12,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:pe=>{pe.stopPropagation(),Me(r,v.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(Ze,{size:12,style:{marginRight:4}}),"Decline"]})]})]}):r.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:P?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:r.text||""}),P&&r.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(r.expiresAt).toLocaleString()]}):null]}):r.kind==="comment"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Comment"}),e.jsx("div",{className:"notif-desc",children:r.text||"Someone commented on your post"})]}):r.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:r.text||"Someone is inspired by you!"})]}):r.kind==="reaction"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Reaction"}),e.jsx("div",{className:"notif-desc",children:r.text||"Someone raised their hand on your post!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:r.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:r.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},r.id)})]})]})]}),m!=null&&m.blocked?e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(Qt,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:(()=>{const r=Math.max(0,Math.floor((((m==null?void 0:m.reset_at)??0)*1e3-Date.now())/1e3)),v=Math.floor(r/3600),P=Math.floor(r%3600/60),ie=r%60,ue=pe=>String(pe).padStart(2,"0");return v>0?`${v}:${ue(P)}:${ue(ie)}`:`${P}:${ue(ie)}`})()})]}):null,e.jsxs("button",{ref:O,className:"icon-link",onClick:()=>{A||le(),h(!A)},title:i.username,"aria-label":"User menu","aria-expanded":A,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[i.avatar_url&&e.jsx("img",{src:i.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:i.username}),e.jsx(Nt,{size:14,style:{opacity:.8}})]}),A&&e.jsxs("div",{ref:B,className:"menu-panel",role:"menu",children:[e.jsx(H,{to:"/profile",className:"menu-item",onClick:()=>h(!1),children:"Profile"}),i!=null&&i.is_admin||i!=null&&i.is_mod?e.jsx(H,{to:"/moderation",className:"menu-item",onClick:()=>h(!1),children:"Moderation"}):null,e.jsx("button",{className:"menu-item",type:"button",onClick:()=>w.mutate(),children:"Log out"})]})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{window.location.href=Ge+k.auth.login},disabled:y,children:y?"Checkingâ€¦":"Login with osu!"})]})]}),e.jsx("main",{className:`page ${t.pathname==="/editor"||t.pathname==="/mp/discover"?"fullscreen":""}`,children:t.pathname==="/about"||t.pathname==="/moderation"||t.pathname==="/settings"?e.jsx("div",{className:"card",children:e.jsx(ft,{})}):e.jsx(ft,{})}),t.pathname!=="/editor"&&e.jsx(e.Fragment,{children:i&&i.is_mod&&_!==null&&e.jsx("div",{className:"site-badge","aria-hidden":!1,children:e.jsxs("div",{className:"label",children:[_," videos ready"]})})}),e.jsx(Ts,{})]})}function Ms(){return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes shimmer {
          0% { background-position: -1000px 0; }
          100% { background-position: 1000px 0; }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
        
        .landing-container {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 80px 24px 24px;
          overflow-y: auto;
          z-index: 1;
        }
        
        .landing-hero {
          text-align: center;
          max-width: 900px;
          width: 100%;
          animation: fadeInUp 0.8s ease-out;
        }
        
        .landing-title {
          font-size: clamp(48px, 8vw, 96px);
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 24px;
          background: linear-gradient(135deg, #7dd3fc 0%, #a78bfa 50%, #34d399 100%);
          background-size: 200% 200%;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          animation: shimmer 3s ease-in-out infinite, fadeInUp 0.8s ease-out 0.2s both;
          letter-spacing: -0.02em;
        }
        
        .landing-subtitle {
          font-size: clamp(18px, 2.5vw, 28px);
          color: var(--muted);
          margin: 0 0 64px;
          font-weight: 400;
          animation: fadeInUp 0.8s ease-out 0.4s both;
          opacity: 0.9;
        }
        
        .landing-actions {
          display: flex;
          gap: 24px;
          justify-content: center;
          flex-wrap: wrap;
          animation: fadeInUp 0.8s ease-out 0.6s both;
        }
        
        .landing-btn {
          padding: 20px 32px;
          font-size: 20px;
          font-weight: 700;
          text-decoration: none;
          border-radius: 10px;
          transition: background 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          min-width: 180px;
          border: 1px solid transparent;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          text-rendering: optimizeLegibility;
          font-smooth: always;
        }
        
        .landing-btn-primary {
          background: #ffffff;
          color: #0b0d10;
          border: 1px solid rgba(0, 0, 0, 0.15);
        }
        
        .landing-btn-primary:hover {
          background: linear-gradient(90deg, rgba(255,255,255,1), rgba(248,249,255,0.98));
          border-color: rgba(0, 0, 0, 0.18);
          box-shadow: 0 1px 0 rgba(255,255,255,0.25) inset, 0 0 0 1px rgba(255,255,255,0.02) inset;
        }
        
        .landing-btn-secondary {
          background: #1f2430;
          color: var(--text);
          border: 1px solid rgba(255, 255, 255, 0.12);
        }
        
        .landing-btn-secondary:hover {
          background: linear-gradient(90deg, rgba(125,211,252,0.14), rgba(167,139,250,0.16));
          border-color: rgba(255, 255, 255, 0.18);
        }
        
        .landing-glow {
          position: absolute;
          width: 600px;
          height: 600px;
          border-radius: 50%;
          background: radial-gradient(circle, rgba(125, 211, 252, 0.15) 0%, transparent 70%);
          pointer-events: none;
          animation: pulse 4s ease-in-out infinite;
          z-index: -1;
        }
        
        .landing-glow-1 {
          top: 10%;
          left: 10%;
          animation-delay: 0s;
        }
        
        .landing-glow-2 {
          bottom: 10%;
          right: 10%;
          background: radial-gradient(circle, rgba(167, 139, 250, 0.15) 0%, transparent 70%);
          animation-delay: 2s;
        }
        
        @media (max-width: 768px) {
          .landing-container {
            padding: 60px 16px 16px;
          }
          
          .landing-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .landing-btn {
            width: 100%;
            min-width: unset;
            padding: 18px 24px;
            font-size: 18px;
          }
        }
      `}),e.jsxs("div",{className:"landing-container",children:[e.jsx("div",{className:"landing-glow landing-glow-1"}),e.jsx("div",{className:"landing-glow landing-glow-2"}),e.jsxs("div",{className:"landing-hero",children:[e.jsx("h1",{className:"landing-title",children:"mappi!"}),e.jsx("p",{className:"landing-subtitle",children:"Navigate to.."}),e.jsxs("div",{className:"landing-actions",children:[e.jsx(H,{to:"/mp/discover",className:"landing-btn landing-btn-secondary",children:"mappi.ng"}),e.jsx(H,{to:"/md/feed",className:"landing-btn landing-btn-secondary",children:"moddi.ng"})]})]})]})]})}function Ls(){const{data:t}=et(),{modeFilters:d}=Oe(),u=Object.entries(d).filter(([y,m])=>m).map(([y])=>y),i=u.length?u.join(","):"standard";return Jt({queryKey:["mappi","feed",i],queryFn:async({pageParam:y=0})=>{const m=new URLSearchParams({limit:"20",offset:String(y),modes:i}),F=`${k.feed.recent}?${m.toString()}`;return await E(F)},enabled:!!t,initialPageParam:0,getNextPageParam:(y,m)=>{var w;const F=m.reduce((L,x)=>{var I;return L+(((I=x.items)==null?void 0:I.length)||0)},0);return(((w=y.items)==null?void 0:w.length)||0)===20?F:void 0}})}function Ie(){const t=Ke(),d=Gt(),{data:u}=et(),{modeFilters:i}=Oe(),{data:y,fetchNextPage:m,hasNextPage:F,isFetching:Y,isFetchingNextPage:w,refetch:L}=Ls(),x=s.useMemo(()=>(y==null?void 0:y.pages.flatMap(N=>N.items||[]))||[],[y]),I=s.useMemo(()=>{const N=Object.entries(i).filter(([A,f])=>f).map(([A])=>A.toLowerCase()),W=new Set(N.length?N:["standard"]);return x.filter(A=>{const f=String(A.mode||"standard").toLowerCase();return W.has(f)})},[x,i]);s.useEffect(()=>{t.pathname==="/mp/feed"&&L()},[t.pathname,L]),s.useEffect(()=>{const N=()=>{L()};return window.addEventListener("filterchange",N),()=>window.removeEventListener("filterchange",N)},[L]);const D=N=>{d.setQueryData(["mappi","feed"],W=>W&&{...W,pages:W.pages.map(A=>({...A,items:A.items.map(f=>f.id===N.id?N:f)}))})},T=N=>{d.setQueryData(["mappi","feed"],W=>W&&{...W,pages:W.pages.map(A=>({...A,items:A.items.filter(f=>f.id!==N)}))})},z=()=>{L()},O=Y&&!w,B=F??!1;return e.jsxs("div",{className:"feed-container",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"title",style:{marginBottom:8},children:"Feed"}),e.jsx("div",{className:"muted",style:{fontSize:12,marginBottom:12},children:"Clips auto-delete after 60 days. Starred posts are preserved."}),e.jsx(ys,{section:"mappi",onUpload:z})]}),e.jsx("div",{style:{marginTop:12,borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:e.jsxs("div",{className:"col",style:{gap:0},children:[I.length===0&&!O&&e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No videos match the selected filter."}),I.map(N=>e.jsx(os,{post:N,section:"mappi",onUpdate:D,onDelete:T,me:u},N.id)),I.length>0&&B&&e.jsx("div",{style:{padding:"16px",textAlign:"center",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsx("button",{className:"btn secondary",onClick:()=>m(),disabled:w,children:w?"Loading...":"Load more"})})]})})]})}const fe={};function zs(){try{const t=localStorage.getItem("feed_seen_ids");if(t){const d=JSON.parse(t);Array.isArray(d)&&(fe.seenIds=d.filter(u=>typeof u=="number"))}}catch{}return fe}function gt(t){Object.assign(fe,t);try{const d=Array.from(new Set(fe.seenIds||[])).slice(-200);localStorage.setItem("feed_seen_ids",JSON.stringify(d))}catch{}}function bt(){var dt,ut,mt;const{notify:t}=$e(),[d,u]=s.useState(fe.history||[]),[i,y]=s.useState(fe.index??-1),[m,F]=s.useState(fe.queue||[]),[Y,w]=s.useState(!1),[L,x]=s.useState(!1),[I,D]=s.useState(fe.eligibleCount??null),[T,z]=s.useState(fe.viewedCount??0),[O,B]=s.useState(!1),[N,W]=s.useState(!0),[A,f]=s.useState(!1),[g,j]=s.useState(!1),[h,q]=s.useState(!1),[ee,le]=s.useState(!1),[ae,U]=s.useState(!1),[X,$]=s.useState([]),[S,Q]=s.useState(""),[ce,c]=s.useState(null),[C,M]=s.useState(!1),[V,ne]=s.useState(null),[l,J]=s.useState(!1),_=s.useRef(new Set(fe.seenIds||[])),de=s.useRef(new Set),Re=s.useRef(!1),je=s.useRef(fe.lastShownVideoId??null),Te=s.useRef(!1),Ee=s.useRef(0),Me=s.useRef(0),Le=s.useRef(0),te=s.useRef(null),ze=s.useRef(null),r=s.useRef(null),v=s.useRef(null),P=s.useRef(null),ie=s.useRef(null),ue=s.useRef(null),pe=s.useRef(null),Ae=s.useRef(0),tt=s.useRef(0),Fe=s.useRef(null),De=s.useRef(null),[Pe,_t]=s.useState(0),n=s.useMemo(()=>i>=0?d[i]:null,[d,i]);s.useEffect(()=>{zs()},[]),s.useEffect(()=>{gt({history:d,index:i,queue:m,seenIds:Array.from(_.current),eligibleCount:I??void 0,viewedCount:T,lastShownVideoId:je.current??void 0})},[d,i,m,I,T]);const we=s.useCallback(()=>{try{const a=localStorage.getItem("filter_modes"),o=(a?String(a):"standard").toLowerCase().split(",").map(R=>R.trim()).filter(Boolean),p=["standard","taiko","mania","catch"],b=Array.from(new Set(o.filter(R=>p.includes(R))));return b.length?b:["standard"]}catch{return["standard"]}},[]),st=s.useCallback(()=>{const a=new Set;return je.current!==null&&a.add(je.current),Array.from(_.current).slice(-200).forEach(p=>a.add(p)),m.forEach(p=>a.add(p.id)),Array.from(a)},[m]),qe=s.useCallback(async(a=3)=>{var b,R,G,ge;if(Re.current)return[];const o=Date.now();if(o<Ee.current){const oe=Math.ceil((Ee.current-o)/1e3);return t(`Rate limited. Please wait ${oe}s.`,{durationMs:3e3,variant:"warn"}),[]}const p=o-Le.current;if(p<2e3){const oe=2e3-p;await new Promise(Ce=>setTimeout(Ce,oe))}Re.current=!0,Le.current=Date.now();try{const oe=st(),Ce=we().join(","),be=[],Ne=new Set(m.map(me=>me.id));let ke=[...oe];const He=Math.min(a,3);for(let me=0;me<He;me++){if(me>0){const K=Date.now()-Me.current,re=1e3;K<re&&await new Promise(he=>setTimeout(he,re-K))}try{Me.current=Date.now();const K=await E(k.feed.next+_e({exclude:ke.join(","),modes:Ce}),{requireAuth:!1}),re=K&&("id"in K?K:K.video)||null;if(!re)break;if(_.current.has(re.id)||Ne.has(re.id)||re.id===je.current){ke.push(re.id);continue}be.push(re),ke.push(re.id),Ne.add(re.id)}catch(K){if((b=K==null?void 0:K.message)!=null&&b.includes("401")||(R=K==null?void 0:K.message)!=null&&R.includes("Unauthorized")){B(!0);break}else if((G=K==null?void 0:K.message)!=null&&G.includes("429")||(ge=K==null?void 0:K.message)!=null&&ge.includes("rate limit")){Ee.current=Date.now()+5e3,t("Rate limited. Please wait a moment.",{durationMs:5e3,variant:"warn"});break}}}if(be.length>0&&F(me=>{const K=new Set(me.map(he=>he.id)),re=be.filter(he=>!K.has(he.id));return[...me,...re]}),be.length===0&&m.length===0)try{const me=we().join(","),K=await E(k.feed.progress(me),{requireAuth:!1});D(Number(K.eligible||0)),z(Number(K.viewed||0)),x(Number(K.caught_up||0)===1)}catch{}return be}catch{return[]}finally{Re.current=!1}},[st,we,m,t]),xe=s.useCallback(async()=>{if(!Y){w(!0);try{m.length<=2&&qe(3).catch(()=>{});let a;if(m.length>0)a=m[0],F(o=>o.filter(p=>p.id!==a.id));else{const o=await qe(3);o.length>0&&(a=o[0],o.length>1&&F(p=>{const b=new Set(p.map(G=>G.id)),R=o.slice(1).filter(G=>!b.has(G.id));return[...p,...R]}))}if(a)je.current=a.id,_.current.add(a.id),gt({seenIds:Array.from(_.current)}),u(o=>{const p=[...o.slice(0,i+1),a];return y(p.length-1),p}),de.current.has(a.id)||(de.current.add(a.id),E(k.videos.view(a.id),{method:"POST"}).then(o=>{o&&u(p=>{const b=[...p],R=b.findIndex(G=>G.id===a.id);return R!==-1&&(b[R]={...b[R],views_count:o.views_count??b[R].views_count??0,viewed_by_me:!0}),b})}).catch(()=>{}));else try{const o=we().join(","),p=await E(k.feed.progress(o),{requireAuth:!1});D(Number(p.eligible||0)),z(Number(p.viewed||0)),x(Number(p.eligible||0)>0&&Number(p.viewed||0)>=Number(p.eligible||0))}catch{}}finally{w(!1)}}},[Y,m,qe,i,we]),Rt=s.useCallback(()=>{te.current&&!te.current.paused&&te.current.pause(),f(!0),U(!1)},[]),Ue=s.useCallback(()=>{i>0&&(y(i-1),f(!1))},[i]),Be=s.useCallback(()=>{const a=Date.now();if(!(a-tt.current<300)){if(tt.current=a,N||(Te.current=!0,W(!1)),i<d.length-1){const o=d[i+1];console.log("[Discover] Navigating to next video in history:",{currentIndex:i,nextIndex:i+1,currentVideoId:n==null?void 0:n.id,nextVideoId:o==null?void 0:o.id,nextVideoStreamUID:o==null?void 0:o.stream_uid}),o&&(je.current=o.id),y(i+1),f(!1);return}if(!L){if(Date.now()<Ee.current){const o=Math.ceil((Ee.current-Date.now())/1e3);t(`Rate limited. Please wait ${o}s.`,{durationMs:3e3,variant:"warn"});return}console.log("[Discover] Fetching next video (queue empty)"),xe()}}},[i,d,N,L,xe,t,n]);s.useEffect(()=>{const a=ze.current;if(!a)return;const o=R=>{if(O||Math.abs(R.deltaY)<Math.abs(R.deltaX))return;R.preventDefault(),R.stopPropagation();const G=Date.now();if(!(G<Ae.current)){if(Ae.current=G+1e3,!n){R.deltaY>0&&!Y&&xe();return}R.deltaY>0?Be():Ue()}},p=R=>{Fe.current=R.touches[0].clientY,De.current=Date.now()},b=R=>{if(O||Fe.current===null||De.current===null)return;const G=R.changedTouches[0].clientY,ge=Date.now(),oe=Fe.current-G,Ce=ge-De.current;if(Fe.current=null,De.current=null,Math.abs(oe)<50||Ce>300)return;const be=Date.now();if(!(be<Ae.current)){if(Ae.current=be+1e3,!n){oe>0&&!Y&&xe();return}oe>0?Be():Ue()}};return a.addEventListener("wheel",o,{passive:!1,capture:!0}),a.addEventListener("touchstart",p,{passive:!0}),a.addEventListener("touchend",b,{passive:!0}),window.addEventListener("wheel",o,{passive:!1,capture:!0}),()=>{a.removeEventListener("wheel",o,{capture:!0}),a.removeEventListener("touchstart",p),a.removeEventListener("touchend",b),window.removeEventListener("wheel",o,{capture:!0})}},[Be,Ue,n,Y,xe,O]);const Et=s.useCallback(async()=>{var a,o;if(!(!n||l)){J(!0);try{const p=n.liked_by_me?"DELETE":"POST",b=await E(k.videos.like(n.id),{method:p});u(R=>{const G=[...R],ge=G.findIndex(oe=>oe.id===n.id);return ge!==-1&&(G[ge]={...G[ge],liked_by_me:!n.liked_by_me,likes_count:b.likes_count}),G})}catch(p){((a=p==null?void 0:p.message)!=null&&a.includes("429")||(o=p==null?void 0:p.message)!=null&&o.includes("rate limit"))&&t("Please slow down a bit.",{durationMs:5e3,variant:"warn"})}finally{J(!1)}}},[n,l,t]),at=s.useCallback(async a=>{if(n)try{await E(k.videos.flag(n.id),{method:"POST",body:JSON.stringify({reason:a})}),t("Thanks for your report.",{variant:"info"})}catch{t("Report failed",{variant:"error"})}finally{q(!1)}},[n,t]),Tt=s.useCallback(async()=>{if(!n)return;const a=!n.is_starred,o=a?"star":"unstar";try{await E(k.admin.videosAction(n.id,o),{method:"POST"}),u(p=>{const b=[...p],R=b.findIndex(G=>G.id===n.id);return R!==-1&&(b[R]={...b[R],is_starred:a}),b}),le(!1),t(a?"Post starred":"Star removed",{variant:"success"})}catch{t("Action failed",{variant:"error"})}},[n,t]),nt=s.useCallback(async()=>{if(!(!n||!confirm("Permanently delete this video?")))try{await E(k.videos.delete(n.id),{method:"DELETE"}),t("Deleted",{variant:"warn"}),q(!1),u(a=>{const o=a.filter((p,b)=>b!==i);return o.length===0?(y(-1),setTimeout(xe,0)):y(p=>Math.max(0,Math.min(p,o.length-1))),o})}catch{alert("Delete failed")}},[n,i,xe,t]),We=s.useCallback(async()=>{if(n!=null&&n.id)try{const a=await E(k.videos.comments(n.id),{requireAuth:!1});$(a.items||[])}catch{}},[n==null?void 0:n.id]);s.useEffect(()=>{g&&(n!=null&&n.id)&&We()},[g,n==null?void 0:n.id,We]);const it=s.useCallback(async a=>{if(a.preventDefault(),!(!S.trim()||!(n!=null&&n.id))){M(!0);try{await E(k.videos.comments(n.id),{method:"POST",body:JSON.stringify({text:S.trim(),parent_id:ce||void 0})}),Q(""),c(null),We(),u(o=>{const p=[...o],b=p.findIndex(R=>R.id===n.id);return b!==-1&&(p[b]={...p[b],comments_count:(p[b].comments_count||0)+1}),p}),t("Comment posted!",{variant:"success"})}catch(o){t((o==null?void 0:o.message)||"Failed to post comment",{variant:"error"})}finally{M(!1)}}},[S,n,ce,We,t]),It=s.useCallback(a=>{$(o=>o.filter(p=>p.id!==a)),u(o=>{const p=[...o],b=p.findIndex(R=>R.id===(n==null?void 0:n.id));return b!==-1&&(p[b]={...p[b],comments_count:Math.max(0,(p[b].comments_count||0)-1)}),p})},[n==null?void 0:n.id]),{topLevelComments:rt,repliesMap:ot}=s.useMemo(()=>{const a=X.filter(p=>!p.parent_id),o=new Map;return X.filter(p=>p.parent_id).forEach(p=>{const b=p.parent_id;o.has(b)||o.set(b,[]),o.get(b).push(p)}),{topLevelComments:a,repliesMap:o}},[X]),Mt=s.useCallback(()=>{if(!te.current)return;const a=!N;W(a),te.current.muted=a,a||(Te.current=!0),!a&&te.current.paused&&te.current.play().catch(()=>{})},[N]),Lt=s.useCallback(a=>{te.current=a,a&&(a.muted=N)},[N]);s.useEffect(()=>{f(!1),j(!1),Te.current?W(!1):W(!0)},[n==null?void 0:n.id,n==null?void 0:n.stream_uid,i,d.length]),s.useEffect(()=>{te.current&&(te.current.muted=N)},[N]),s.useEffect(()=>{if(!n)return;const a=!Te.current;W(a);const o=setTimeout(()=>{te.current&&(te.current.muted=a)},100);return()=>clearTimeout(o)},[n==null?void 0:n.id]),s.useEffect(()=>{n&&(je.current=n.id)},[n==null?void 0:n.id]),s.useEffect(()=>{A&&te.current&&!te.current.paused&&te.current.pause()},[A]),s.useEffect(()=>{d.length===0&&xe()},[]),s.useEffect(()=>{(async()=>{try{const a=we().join(","),o=await E(k.feed.progress(a),{requireAuth:!1}),p=Number(o.eligible||0),b=Number(o.viewed||0);D(p),z(b),x(p>0&&b>=p)}catch{}})()},[we]),s.useEffect(()=>{const a=()=>{u([]),F([]),_.current.clear(),je.current=null,y(-1),x(!1),(async()=>{try{const o=we().join(","),p=await E(k.feed.progress(o),{requireAuth:!1}),b=Number(p.eligible||0),R=Number(p.viewed||0);D(b),z(R),x(!1)}catch{}xe()})()};return window.addEventListener("filterchange",a),()=>window.removeEventListener("filterchange",a)},[we,xe]),s.useEffect(()=>{(async()=>{try{const a=await E(k.auth.me,{requireAuth:!1});ne(a)}catch{}})()},[]);const[Se,lt]=s.useState(()=>typeof window<"u"?window.matchMedia("(max-width: 480px)").matches:!1);s.useEffect(()=>{const a=()=>{const b=document.querySelector(".top-nav");b&&_t(b.offsetHeight),lt(window.matchMedia("(max-width: 480px)").matches)};a();const o=window.matchMedia("(max-width: 480px)"),p=()=>lt(o.matches);return o.addEventListener("change",p),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a),o.removeEventListener("change",p)}},[]),s.useEffect(()=>{var p;if(!r.current||!v.current||!n||!te.current)return;const a=()=>{var Ce;const b=(Ce=v.current)==null?void 0:Ce.querySelector("div"),R=te.current;if(!b||!R||!r.current)return;const G=r.current,ge=window.matchMedia("(max-width: 480px)").matches;let oe;if(n.width&&n.height?oe=n.width/n.height:R.videoWidth>0&&R.videoHeight>0?oe=R.videoWidth/R.videoHeight:oe=16/9,ge){const Ne=G.offsetWidth,ke=Ne/oe;b.style.width=`${Ne}px`,b.style.height=`${ke}px`,b.style.maxWidth="100%",b.style.maxHeight="100%"}else{const Ne=G.offsetWidth-32,ke=G.offsetHeight-32,He=16/9,me=Ne/He;let re=Math.min(ke,me),he=re*oe;he>Ne&&(he=Ne,re=he/oe),re>ke&&(re=ke,he=re*oe),b.style.width=`${he}px`,b.style.height=`${re}px`,b.style.maxWidth="100%",b.style.maxHeight="100%"}},o=()=>{requestAnimationFrame(a)};if(te.current.readyState>=1)a();else{const b=()=>{var R;a(),(R=te.current)==null||R.removeEventListener("loadedmetadata",b)};(p=te.current)==null||p.addEventListener("loadedmetadata",b)}return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[n==null?void 0:n.id,n==null?void 0:n.width,n==null?void 0:n.height]),s.useEffect(()=>{if(!h)return;const a=o=>{P.current&&!P.current.contains(o.target)&&q(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[h]),s.useEffect(()=>{if(!ee)return;const a=o=>{ie.current&&!ie.current.contains(o.target)&&le(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[ee]),s.useEffect(()=>{if(!ae)return;const a=o=>{ue.current&&!ue.current.contains(o.target)&&pe.current&&!pe.current.contains(o.target)&&U(!1)};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[ae]);const ct=!!(V!=null&&V.is_admin||V!=null&&V.is_mod);return e.jsxs(e.Fragment,{children:[e.jsx(Ct,{paused:Se}),e.jsx("style",{children:`
        .video-area .discover-player-wrapper {
          position: relative !important;
          width: 100% !important;
          height: 100% !important;
          max-width: 100% !important;
          max-height: 100% !important;
          min-height: 100% !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          box-sizing: border-box !important;
        }
        .video-area .discover-player-wrapper > div {
          position: relative !important;
          /* Dimensions will be set by JavaScript to ensure proper fit */
          box-sizing: border-box !important;
          /* Center the video within container */
          flex-shrink: 1 !important;
          min-width: 0 !important;
          min-height: 0 !important;
          align-self: center !important;
        }
        .video-area .discover-player-wrapper > div[style] {
          /* JavaScript will set width and height, but ensure max constraints */
          max-width: 100% !important;
          max-height: 100% !important;
          box-sizing: border-box !important;
          flex-shrink: 1 !important;
          min-width: 0 !important;
          min-height: 0 !important;
        }
        /* Ensure wrapper constrains width to prevent overflow */
        .video-area .discover-player-wrapper {
          max-width: 100% !important;
          width: 100% !important;
          overflow: hidden !important;
          /* Use flexbox to center and constrain */
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }
        .video-area .discover-player-wrapper video {
          /* Ensure video content is fully visible - no cropping */
          width: 100% !important;
          height: 100% !important;
          object-fit: contain !important;
          max-width: 100% !important;
          max-height: 100% !important;
        }
        /* Mobile-specific: ensure videos take full width */
        @media (max-width: 480px) {
          .video-area .discover-player-wrapper > div {
            min-width: 100% !important;
            max-width: 100% !important;
          }
          .video-area .discover-player-wrapper > div[style] {
            min-width: 100% !important;
            max-width: 100% !important;
          }
        }
      `}),e.jsxs("div",{ref:ze,className:"player-wrap",style:{height:"100dvh",width:"100vw",position:"fixed",top:Se?"calc(0px - env(safe-area-inset-top, 0px))":0,left:0,right:0,bottom:0,overflow:"hidden",background:"transparent",zIndex:1,margin:0,padding:0,boxSizing:"border-box"},children:[L&&e.jsx("div",{className:"chip info",style:{position:"absolute",top:Pe+20,left:"50%",transform:"translateX(-50%)",zIndex:10,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(10px)"},children:"You're all caught up. Check 'Feed' to watch videos you've seen already."}),e.jsx("div",{ref:r,className:"video-area discover-video-container",style:{position:"absolute",top:Se?0:Pe,left:0,right:0,bottom:Se?"-10px":0,maxHeight:Se?"calc(100dvh + env(safe-area-inset-top, 0px) + 2px)":`calc(100dvh - ${Pe}px)`,height:Se?"calc(100dvh + env(safe-area-inset-top, 0px) + 2px)":`calc(100dvh - ${Pe}px)`,display:"flex",alignItems:"center",justifyContent:"center",background:"#000",transition:Se?"none":"bottom 0.3s ease-out, max-height 0.3s ease-out, height 0.3s ease-out",overflow:"hidden",boxSizing:"border-box",padding:Se?"0":"16px",maxWidth:"100vw",width:"100%"},children:O?e.jsxs("div",{className:"col",style:{alignItems:"center",zIndex:10},children:[e.jsx("div",{className:"muted",style:{marginBottom:8},children:"Please log in to view videos."}),e.jsx("button",{className:"btn",onClick:()=>window.location.href=Ge+k.auth.login,children:"Login with osu!"})]}):n?e.jsx("div",{style:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",overflow:"hidden"},children:e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:10,pointerEvents:"none"}}),e.jsxs("div",{onClick:Mt,style:{position:"relative",width:"100%",height:"100%",cursor:"pointer",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",maxWidth:"100%",maxHeight:"100%"},children:[e.jsx("div",{ref:v,className:"discover-player-wrapper",children:e.jsx(ls,{streamUID:n.stream_uid,playbackUrl:n.playback_url,aspectRatio:n.width&&n.height?n.width/n.height:null,preferNative:!0,autoplay:!0,loop:!0,muted:N,controls:!1,onVideoRef:Lt})}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0,0,0,0.6)",backdropFilter:"blur(10px)",borderRadius:"50%",width:56,height:56,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",transition:"opacity 0.3s ease",opacity:N?1:0,zIndex:2},children:N?e.jsx(Kt,{size:28,color:"#fff"}):e.jsx(Xt,{size:28,color:"#fff"})})]})]})}):L?null:e.jsxs("div",{className:"muted",style:{zIndex:10,textAlign:"center",padding:"20px",maxWidth:"400px",pointerEvents:"none"},children:[e.jsx("div",{style:{marginBottom:12,fontSize:14,fontWeight:500},children:"How to navigate"}),e.jsxs("div",{style:{fontSize:12,lineHeight:1.6},children:[e.jsx("div",{children:"â€¢ Scroll up/down or swipe to change videos"}),e.jsx("div",{children:"â€¢ Click video to toggle mute/unmute"}),e.jsx("div",{children:"â€¢ Hold to pause temporarily"})]})]})}),n&&!A&&e.jsxs("div",{style:{position:"absolute",right:16,top:"50%",display:"flex",flexDirection:"column",gap:20,alignItems:"center",zIndex:15,pointerEvents:"auto",transform:"translateY(-50%) scale(1)",transformOrigin:"center right"},onClick:a=>a.stopPropagation(),children:[e.jsx(H,{to:`/profile/${(dt=n.uploader)==null?void 0:dt.id}`,style:{width:48,height:48,borderRadius:"50%",border:"2px solid rgba(255,255,255,0.3)",overflow:"hidden",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},children:(ut=n.uploader)!=null&&ut.avatar_url?e.jsx("img",{src:n.uploader.avatar_url,width:48,height:48,style:{borderRadius:"50%",objectFit:"cover",display:"block"},alt:n.uploader.username}):e.jsx("div",{style:{width:48,height:48,background:"rgba(255,255,255,0.1)"}})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("button",{onClick:Et,disabled:l,"aria-label":n.liked_by_me?"Unlike":"Like",title:n.liked_by_me?"Unlike":"Like",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:n.liked_by_me?"#f87171":"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:n.liked_by_me?e.jsx(wt,{size:28}):e.jsx(kt,{size:28})}),e.jsx("span",{style:{color:"#fff",fontSize:12,fontWeight:600,textShadow:"0 1px 3px rgba(0,0,0,0.8)"},children:n.likes_count??0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("button",{onClick:()=>j(!0),"aria-label":"Comments",title:"Comments",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(St,{size:28})}),e.jsx("span",{style:{color:"#fff",fontSize:12,fontWeight:600,textShadow:"0 1px 3px rgba(0,0,0,0.8)"},children:n.comments_count??0})]}),n.beatmap_url&&e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:pe,onClick:()=>U(a=>!a),title:"Beatmap options","aria-label":"Beatmap options",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(Je,{size:24})}),ae&&e.jsxs("div",{ref:ue,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:160,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsxs("a",{className:"menu-item",href:n.beatmap_url,target:"_blank",rel:"noreferrer",onClick:()=>U(!1),children:[e.jsx(Je,{size:16,style:{marginRight:8}}),"osu.ppy.sh"]}),n.beatmapset_id&&e.jsx("button",{className:"menu-item",onClick:Rt,children:"Preview"})]})]}),ct?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{onClick:()=>le(a=>!a),title:"Manage","aria-label":"Manage",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(xt,{size:24})}),ee&&e.jsxs("div",{ref:ie,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:180,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsx("button",{className:"menu-item",onClick:Tt,children:n.is_starred?"Unstar post":"Star post"}),e.jsx("button",{className:"menu-item",onClick:nt,children:"Delete video"})]})]}):e.jsx("button",{onClick:()=>q(a=>!a),title:"Report","aria-label":"Report",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(Zt,{size:24})}),h&&e.jsxs("div",{ref:P,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:160,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsx("div",{className:"muted",style:{fontSize:12,padding:"4px 8px"},children:"Report asâ€¦"}),e.jsx("button",{className:"menu-item",onClick:()=>at("unrelated"),children:"Unrelated"}),e.jsx("button",{className:"menu-item",onClick:()=>at("explicit"),children:"Explicit"}),ct&&e.jsx("button",{className:"menu-item",onClick:nt,children:"Delete video"})]})]}),n&&!A&&e.jsxs("div",{style:{position:"absolute",left:16,bottom:80,right:80,zIndex:15,pointerEvents:"none",display:"flex",flexDirection:"column",gap:12,transformOrigin:"bottom left"},onClick:a=>a.stopPropagation(),children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,pointerEvents:"auto"},children:e.jsx(H,{to:`/profile/${(mt=n.uploader)==null?void 0:mt.id}`,style:{textDecoration:"none",color:"#fff",fontWeight:600,fontSize:"clamp(14px, 16px, 18px)",display:"flex",alignItems:"center",gap:8,textShadow:"0 1px 3px rgba(0,0,0,0.8)",transition:"font-size 0.3s ease-out"},children:(()=>{var b,R,G;const a=(b=n.uploader)==null?void 0:b.is_admin,o=(R=n.uploader)==null?void 0:R.is_mod,p=a?"#fff3bf":o?"#d7fbe8":"#fff";return e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:p},children:["@",(G=n.uploader)==null?void 0:G.username]}),n.is_starred&&e.jsx(jt,{size:16,color:"#f59e0b",title:"Starred"}),(a||o)&&e.jsx(xt,{size:14,color:p,title:a?"admin":"mod"})]})})()})}),(n.description??"").trim()&&e.jsx("div",{style:{color:"#fff",fontSize:"clamp(12px, 14px, 16px)",lineHeight:1.5,textShadow:"0 1px 3px rgba(0,0,0,0.8)",maxWidth:"85%",wordBreak:"break-word",pointerEvents:"auto",transition:"font-size 0.3s ease-out"},children:n.description}),n.beatmap_title&&e.jsxs("div",{style:{color:"rgba(255,255,255,0.9)",fontSize:"clamp(11px, 13px, 15px)",textShadow:"0 1px 3px rgba(0,0,0,0.8)",pointerEvents:"auto",transition:"font-size 0.3s ease-out"},children:[n.beatmap_artist," â€“ ",n.beatmap_title," ",n.beatmap_mapper?`(by ${n.beatmap_mapper})`:""," ",n.beatmap_version?`[${n.beatmap_version}]`:""]})]}),g&&n&&e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `}),e.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:"50%",background:"var(--panel)",borderTop:"1px solid rgba(255,255,255,0.08)",borderTopLeftRadius:20,borderTopRightRadius:20,display:"flex",flexDirection:"column",zIndex:20,boxShadow:"0 -4px 20px rgba(0,0,0,0.3)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:["Comments (",n.comments_count??0,")"]}),e.jsx("button",{onClick:()=>j(!1),style:{background:"transparent",border:"none",color:"var(--text)",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"Close comments",children:e.jsx(Ze,{size:24})})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"8px 0"},children:rt.length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No comments yet. Be the first to comment!"}):e.jsx("div",{className:"col",style:{gap:0},children:rt.map(a=>e.jsx(cs,{comment:a,replies:ot.get(a.id)||[],me:V,section:"mappi",onReply:o=>c(o),onDelete:It,replyingTo:ce,replyText:S,onReplyTextChange:Q,onReplySubmit:it,posting:C,onCancelReply:()=>{c(null),Q("")},repliesMap:ot},a.id))})}),V&&!ce&&e.jsx("div",{style:{padding:"12px 20px",borderTop:"1px solid rgba(255,255,255,0.06)",background:"var(--panel-dark)"},children:e.jsxs("form",{onSubmit:it,style:{display:"flex",alignItems:"flex-end",gap:8},children:[e.jsx("textarea",{placeholder:"Write a comment...",value:S,onChange:a=>Q(a.target.value),rows:1,style:{flex:1,background:"#0b0d10",border:"1px solid rgba(255,255,255,0.12)",borderRadius:6,padding:"8px 12px",color:"var(--text)",fontFamily:"inherit",fontSize:13,resize:"none",minHeight:"36px",maxHeight:"120px",overflowY:"auto"},onInput:a=>{const o=a.target;o.style.height="auto",o.style.height=`${Math.min(o.scrollHeight,120)}px`}}),e.jsx("button",{type:"submit",className:"btn compact",disabled:C||!S.trim(),style:{padding:"8px 16px",fontSize:13,flexShrink:0},children:C?"...":"Post"})]})})]})]}),A&&(n==null?void 0:n.beatmapset_id)&&e.jsx(Ss,{open:A,onClose:()=>f(!1),downloadUrl:`${Ge}${k.osu.downloadBeatmapset(n.beatmapset_id)}`,beatmapId:n.beatmap_id??void 0,beatmapVersion:n.beatmap_version??void 0})]})]})}function yt(t){if(!t)return"standard";const d=String(t).toLowerCase().trim();return d==="osu"||d==="0"||d==="standard"?"standard":d==="taiko"||d==="1"?"taiko":d==="catch"||d==="fruits"||d==="2"?"catch":d==="mania"||d==="3"?"mania":"standard"}const As=({open:t,onClose:d,videoId:u,initialDescription:i,initialBeatmapUrl:y,onSave:m})=>{const[F,Y]=s.useState(i||""),[w,L]=s.useState(y||""),[x,I]=s.useState(null),[D,T]=s.useState(null),[z,O]=s.useState(""),[B,N]=s.useState(!1),W=s.useRef(0);s.useEffect(()=>{t&&(Y(i||""),L(y||""),I(null),T(null),O(""))},[t,i,y]),s.useEffect(()=>{if(!t)return;W.current&&window.clearTimeout(W.current);const f=(w||"").trim();if(!f){O(""),I(null),T(null);return}if(!/^https?:\/\/osu\.ppy\.sh\/(beatmapsets|beatmaps)\//i.test(f)){O(""),I(null),T(null);return}return W.current=window.setTimeout(async()=>{var j;try{let h;try{h=new URL(f)}catch{O("Invalid URL format");return}const q=h.hash.match(/#osu\/(\d+)/),ee=q?q[1]:null;h.hash="";const ae={url:h.toString()};ee&&(ae.beatmap_id=ee);const U=await E(k.osu.resolveBeatmap+_e(ae),{requireAuth:!1}),X=Array.isArray(U==null?void 0:U.diffs)?U.diffs:[];if(!X.length&&!U.setId){O("No difficulties found"),I(null),T(null);return}if(I({setId:Number(U.setId)||0,beatmapId:U.beatmapId??null,title:String(U.title||""),artist:String(U.artist||""),mapper:String(U.mapper||""),diffs:X}),X.length>0){const $=Number.isFinite(Number(U.beatmapId))?Number(U.beatmapId):Number((j=X[0])==null?void 0:j.id),S=X.find(ce=>Number(ce.id)===$)||X[0],Q=yt(S==null?void 0:S.mode);T({beatmapId:Number(S==null?void 0:S.id)||null,version:String((S==null?void 0:S.version)||""),mode:Q})}O("")}catch(h){O(`Failed to resolve: ${(h==null?void 0:h.message)||"Unknown error"}`),I(null),T(null)}},400),()=>{W.current&&window.clearTimeout(W.current)}},[w,t]);const A=async()=>{if(!B){N(!0);try{await E(k.videos.update(u),{method:"PATCH",body:JSON.stringify({description:F.slice(0,100),beatmap_url:w.trim()||void 0})});const f=!!w.trim();if(x||!f)try{await E(k.videos.update(u)+"/beatmap",{method:"PATCH",body:JSON.stringify({beatmapset_id:f&&x&&x.setId>0?x.setId:null,beatmap_id:f&&(D!=null&&D.beatmapId)?D.beatmapId:null,beatmap_version:f&&(D!=null&&D.version)?D.version:null,beatmap_title:f&&(x!=null&&x.title)?x.title:null,beatmap_artist:f&&(x!=null&&x.artist)?x.artist:null,beatmap_mapper:f&&(x!=null&&x.mapper)?x.mapper:null,beatmap_url:f?w.trim():null})})}catch(j){console.warn("Failed to update beatmap metadata:",j)}m(F,w.trim()||null),d()}catch(f){alert((f==null?void 0:f.message)||"Failed to update post")}finally{N(!1)}}};return t?e.jsxs("div",{className:"overlay",role:"dialog","aria-modal":"true",onClick:f=>f.target===f.currentTarget&&d(),children:[e.jsx("div",{className:"overlay-backdrop",onClick:d}),e.jsxs("div",{className:"overlay-card",style:{maxWidth:"600px",width:"calc(100vw - 24px)"},children:[e.jsx("button",{className:"overlay-close",onClick:d,"aria-label":"Close",children:e.jsx(Ze,{size:18})}),e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",children:"Edit Post"}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Description (max 100 chars)"}),e.jsx("textarea",{maxLength:100,placeholder:"Description (max 100 chars)",value:F,onChange:f=>Y(f.target.value),style:{height:64,resize:"vertical",background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"}})]}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Beatmap URL (optional)"}),x?e.jsx("div",{className:"col",style:{gap:8},children:e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{className:"chip-btn",style:{cursor:"default"},children:[e.jsxs("strong",{style:{marginRight:6},children:[x.artist," â€“ ",x.title]}),e.jsxs("span",{className:"muted",children:["by ",x.mapper]})]}),e.jsx("select",{value:(D==null?void 0:D.beatmapId)??x.beatmapId??void 0,onChange:f=>{const g=Number(f.target.value),j=(x==null?void 0:x.diffs.find(h=>Number(h.id)===g))||null;if(j){const h=yt(j.mode);T({beatmapId:g,version:j.version,mode:h})}},style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"},children:x.diffs.map(f=>e.jsxs("option",{value:f.id,children:[f.version," (",f.mode,")"]},f.id))}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>{I(null),T(null),L("")},children:"Clear"})]})}):e.jsx("input",{type:"url",placeholder:"Beatmap URL (optional) e.g. https://osu.ppy.sh/beatmapsets/...",value:w,onChange:f=>L(f.target.value),style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"}}),z&&e.jsx("div",{className:"muted",style:{color:"var(--danger)",fontSize:12},children:z})]}),e.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn secondary",onClick:d,disabled:B,children:"Cancel"}),e.jsx("button",{className:"btn",onClick:A,disabled:B,children:B?"Saving...":"Save"})]})]})]})]}):null};function vt(){const t=es(),d=Xe(),{notify:u}=$e(),[i,y]=s.useState(null),[m,F]=s.useState(null),[Y,w]=s.useState(""),[L,x]=s.useState([]),[I,D]=s.useState([]),[T,z]=s.useState([]),[O,B]=s.useState(""),[N,W]=s.useState(null),[A,f]=s.useState([]),[g,j]=s.useState(null),[h,q]=s.useState(""),[ee,le]=s.useState([]),[ae,U]=s.useState(null),[X,$]=s.useState(!1),S=s.useMemo(()=>{const c=t.id?Number(t.id):null;return c?i?i.id===c:!1:!0},[t.id,i]);function Q(c){const C=c.stream_uid||String(c.id),M=t.id?`/profile/${t.id}`:"/profile";d(`/mp/feed/${C}`,{state:{returnTo:M}})}s.useEffect(()=>{(async()=>{try{const c=await E(k.auth.me,{requireAuth:!1});y(c),c&&Array.isArray(c.inspirations)&&f(c.inspirations)}catch(c){w((c==null?void 0:c.message)||"Not logged in")}})()},[]),s.useEffect(()=>{(async()=>{try{const c=t.id?Number(t.id):null;if(c){const C=await E(k.users.get(c),{requireAuth:!1});F(C),B(C.about||""),Array.isArray(C.inspirations)&&f(C.inspirations);const M=await E(k.users.videos(c)+_e({limit:"60"}),{requireAuth:!1});z(M.items||[]);const V=await E(k.users.likes(c)+_e({limit:"60"}),{requireAuth:!1});D(V.items||[])}else{if(!i)return;F(i),B(i.about||""),Array.isArray(i.inspirations)&&f(i.inspirations);const C=await E(k.users.myVideos+_e({limit:"50"}),{requireAuth:!1});x(C.items||[]);const M=await E(k.users.likes(i.id)+_e({limit:"60"}),{requireAuth:!1});D(M.items||[])}}catch{}})()},[t.id,i]),s.useEffect(()=>{$(!1)},[m==null?void 0:m.id]);async function ce(c){try{const M=(await E(k.auth.me,{method:"PATCH",body:JSON.stringify({inspirations:c})})).user||m;F(M),Array.isArray(M==null?void 0:M.inspirations)&&f(M.inspirations),t.id||y(M)}catch{}}return s.useEffect(()=>{let c;return g!==null&&h.trim().length>=2?c=setTimeout(async()=>{try{const C=await E(k.osu.usersSearch(h),{requireAuth:!1});le(Array.isArray(C.items)?C.items:[])}catch{}},250):le([]),()=>{c&&clearTimeout(c)}},[h,g]),e.jsxs("div",{className:"feed-container",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"row wrap",style:{alignItems:"center"},children:m?e.jsxs(e.Fragment,{children:[m.avatar_url&&e.jsx("img",{src:m.avatar_url,width:48,height:48,style:{borderRadius:"50%"}}),e.jsxs("div",{className:"col",children:[e.jsxs("div",{className:"title",style:{display:"flex",alignItems:"center",gap:8},children:[m.username,m.osu_user_id&&e.jsx("a",{href:`https://osu.ppy.sh/users/${m.osu_user_id}`,target:"_blank",rel:"noreferrer",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:"var(--text)",opacity:.7,cursor:"pointer",padding:0,textDecoration:"none",transition:"opacity 0.2s ease"},onMouseEnter:c=>c.currentTarget.style.opacity="1",onMouseLeave:c=>c.currentTarget.style.opacity="0.7",title:"View osu! profile","aria-label":"View osu! profile",children:e.jsx(Je,{size:16})})]}),e.jsxs("div",{className:"muted",children:["ID: ",m.id]})]}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[!S&&A.length>0&&e.jsx("span",{className:"muted",style:{fontSize:12},children:"inspired by:"}),A.map((c,C)=>S?e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>U(c.id),onMouseLeave:()=>U(null),children:[e.jsx("button",{className:"insp-avatar",onClick:()=>{if(!confirm("Remove this inspiration?"))return;const M=A.filter((V,ne)=>ne!==C);f(M),ce(M)},children:e.jsx("img",{src:c.avatar_url,alt:c.username})}),ae===c.id&&e.jsxs("div",{className:"insp-tooltip",children:[c.username," â€” click to remove"]})]},c.id):e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>U(c.id),onMouseLeave:()=>U(null),children:[e.jsx("a",{href:`https://osu.ppy.sh/users/${c.id}`,target:"_blank",rel:"noreferrer",className:"insp-avatar link",children:e.jsx("img",{src:c.avatar_url,alt:c.username})}),ae===c.id&&e.jsx("div",{className:"insp-tooltip",children:c.username})]},c.id)),S&&A.length<3&&new Array(3-A.length).fill(0).map((c,C)=>e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>U(-C-1),onMouseLeave:()=>U(null),children:[e.jsx("button",{className:"insp-add",onClick:()=>{j(C),q(""),le([])},children:"+"}),ae===-C-1&&e.jsx("div",{className:"insp-tooltip",children:"Add inspiration"}),g===C&&e.jsxs("div",{className:"insp-pop",role:"dialog","aria-label":"Search osu! users",children:[e.jsx("input",{autoFocus:!0,placeholder:"Search username",value:h,onChange:M=>q(M.target.value)}),e.jsxs("div",{className:"insp-results",children:[ee.length===0&&h.trim().length>=2&&e.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:"No results"}),ee.map(M=>e.jsxs("button",{className:"insp-result",onClick:()=>{if(i&&Number(i.osu_user_id)===Number(M.id)){u("Kinda based, but no.",{variant:"warn"}),j(null);return}if(A.some(ne=>ne.id===M.id)){j(null);return}const V=[...A,{id:M.id,username:M.username,avatar_url:M.avatar_url}].slice(0,3);f(V),j(null),ce(V)},children:[e.jsx("img",{src:M.avatar_url,alt:"avatar"}),e.jsx("span",{children:M.username})]},M.id))]}),e.jsx("button",{className:"insp-close",onClick:()=>j(null),children:"Close"})]})]},`slot-${C}`))]}),S&&e.jsx("div",{className:"muted",style:{fontSize:12},children:"Who inspires you?"})]})]}):e.jsx("div",{className:"muted",children:Y||"Loadingâ€¦"})}),e.jsxs("div",{className:"col",style:{marginTop:12,gap:4},children:[e.jsx("div",{className:"title",children:"About"}),S?e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("textarea",{value:O,onChange:c=>B(c.target.value),rows:3,maxLength:1e3,placeholder:"Write something about yourself (max 1000 chars)"}),e.jsx("div",{className:"row",style:{justifyContent:"flex-end"},children:e.jsx("button",{className:"btn compact",onClick:async()=>{try{const c=await E(k.auth.me,{method:"PATCH",body:JSON.stringify({about:O})});F(c.user||m),y(c.user||i)}catch{}},children:"Save"})})]}):(()=>{const c=((m==null?void 0:m.about)||"").trim()||"No bio.",C=c.length>200,M=C&&!X?c.slice(0,200)+"...":c;return e.jsxs("div",{className:"col",style:{gap:4},children:[e.jsx("div",{className:"muted",style:{whiteSpace:"pre-wrap"},children:M}),C&&e.jsx("button",{onClick:()=>$(!X),style:{display:"flex",alignItems:"center",gap:4,background:"transparent",border:"none",color:"var(--muted)",cursor:"pointer",padding:0,fontSize:14,fontFamily:"inherit",marginTop:4},children:X?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show less"}),e.jsx(ts,{size:14})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show more"}),e.jsx(Nt,{size:14})]})})]})})()]})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Profile sections",children:[e.jsx("button",{role:"tab","aria-selected":!0,className:"profile-tab active","data-tab":"uploads",onClick:c=>{const C=c.currentTarget.closest(".profile-tabs-unified");C.querySelectorAll(".profile-tab").forEach(V=>{V.classList.remove("active"),V.setAttribute("aria-selected","false")}),c.currentTarget.classList.add("active"),c.currentTarget.setAttribute("aria-selected","true"),C.querySelector(".profile-tabs-content").setAttribute("data-active","uploads")},children:"Uploads"}),e.jsx("button",{role:"tab","aria-selected":!1,className:"profile-tab","data-tab":"likes",onClick:c=>{const C=c.currentTarget.closest(".profile-tabs-unified");C.querySelectorAll(".profile-tab").forEach(V=>{V.classList.remove("active"),V.setAttribute("aria-selected","false")}),c.currentTarget.classList.add("active"),c.currentTarget.setAttribute("aria-selected","true"),C.querySelector(".profile-tabs-content").setAttribute("data-active","likes")},children:"Likes"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":"uploads",children:[e.jsx("div",{className:"panel uploads",hidden:!1,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[(S?L:T).length===0&&e.jsx("div",{className:"profile-empty-state",children:"No uploads yet."}),(S?L:T).map(c=>(S&&m?(m.id,m.username,m.avatar_url,m.is_admin,m.is_mod):c.uploader,e.jsxs("button",{className:"recent-cell",onClick:()=>Q({...c}),children:[c.poster_url?e.jsx("img",{className:"recent-thumb",src:c.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsx("div",{className:"cell-footer",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(kt,{size:12}),e.jsx("span",{children:c.likes_count??0})]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(St,{size:12}),e.jsx("span",{children:c.comments_count??0})]})]})})]},c.id)))]})})}),e.jsx("div",{className:"panel likes",hidden:!0,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[I.length===0&&e.jsx("div",{className:"profile-empty-state",children:"No likes yet."}),I.map(c=>{var C,M;return e.jsxs("button",{className:"recent-cell",onClick:()=>Q(c),children:[c.poster_url?e.jsx("img",{className:"recent-thumb",src:c.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsxs("div",{className:"cell-footer",children:[((C=c.uploader)==null?void 0:C.avatar_url)&&e.jsx("img",{className:"cell-avatar",src:c.uploader.avatar_url,alt:"avatar"}),e.jsx("span",{className:"cell-name",children:(M=c.uploader)==null?void 0:M.username})]})]},c.id)})]})})})]})]}),N&&e.jsx(As,{open:!!N,onClose:()=>W(null),videoId:N.id,initialDescription:N.description,initialBeatmapUrl:N.beatmap_url,onSave:(c,C)=>{x(L.map(M=>M.id===N.id?{...M,description:c||null,beatmap_url:C}:M)),W(null)}}),e.jsx("style",{children:`
        .insp-avatar { width: 32px; height: 32px; border-radius: 9999px; padding: 0; border: none; overflow: hidden; cursor: pointer; background: rgba(255,255,255,0.06); display: inline-flex; align-items: center; justify-content: center; }
        .insp-avatar.link { background: transparent; border: 1px solid rgba(255,255,255,0.08); }
        .insp-avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .insp-add { width: 32px; height: 32px; border-radius: 9999px; border: 1px dashed rgba(255,255,255,0.25); background: transparent; color: #e5e7eb; font-weight: 700; cursor: pointer; }
        .insp-add:hover { border-color: rgba(255,255,255,0.5); }
        .insp-tooltip {
          position: absolute;
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
          background: rgba(18, 20, 24, 0.95);
          color: var(--text, #e5e7eb);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 14px;
          white-space: nowrap;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
          z-index: 10000;
          pointer-events: none;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
        }
        .insp-tooltip::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          width: 0;
          height: 0;
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-bottom: 5px solid rgba(18, 20, 24, 0.95);
        }
        .insp-pop { position: absolute; right: 0; top: 40px; width: 260px; background: var(--panel); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; box-shadow: 0 12px 30px rgba(0,0,0,0.4); padding: 8px; z-index: 10; }
        .insp-pop input { width: 100%; padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.08); background: var(--panel-dark); color: #fff; outline: none; box-sizing: border-box; display: block; }
        .insp-results { margin-top: 6px; max-height: 220px; overflow: auto; display: grid; gap: 4px; }
        .insp-result { display: grid; grid-template-columns: 24px 1fr; gap: 8px; align-items: center; padding: 6px 8px; border-radius: 8px; border: 1px solid transparent; background: transparent; color: #e5e7eb; cursor: pointer; text-align: left; }
        .insp-result:hover { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.08); }
        .insp-result img { width: 24px; height: 24px; border-radius: 9999px; object-fit: cover; }
        .insp-close { margin-top: 6px; width: 100%; padding: 6px 8px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.04); color: #e5e7eb; cursor: pointer; }
      `})]})}function Fs(){var c,C,M,V,ne;const[t,d]=s.useState(null),[u,i]=s.useState([]),[y,m]=s.useState(""),[F,Y]=s.useState([]),[w,L]=s.useState(null),[x,I]=s.useState([]),[D,T]=s.useState("all"),[z,O]=s.useState("approvals"),[B,N]=s.useState(null),[W,A]=s.useState(""),[f,g]=s.useState(!1),{notify:j}=$e(),[h,q]=s.useState(null),[ee,le]=s.useState(!1);s.useEffect(()=>{(async()=>{try{const l=await E(k.auth.me,{requireAuth:!1});if(d(l),l!=null&&l.is_admin)try{const J=await E(k.admin.settingsModeration,{requireAuth:!1});N(!!J.require_approval)}catch{}}catch{}try{const l=await E(k.admin.videosPending+_e({limit:"50"}),{requireAuth:!1});i(l.items||[])}catch{}})()},[]);async function ae(){le(!0);try{const l=await E(k.admin.analytics,{requireAuth:!1});q(l)}finally{le(!1)}}async function U(){try{const l=await E(k.admin.usersSearch(y),{requireAuth:!1});Y(l.items||[])}catch{}}async function X(l){L(l),I([]);try{const J=await E(k.admin.userVideos(l.id)+_e({limit:"50"}),{requireAuth:!1});I(J.items||[])}catch{}}async function $(l,J){try{const _=await E(k.admin.user(l.id),{method:"PATCH",body:JSON.stringify({is_mod:J})}),de=(_==null?void 0:_.user)||{...l,is_mod:J};j(J?"Granted moderation":"Revoked moderation",{variant:J?"success":"warn"}),L(de),Y(F.map(Re=>Re.id===l.id?de:Re))}catch{alert("Failed to update")}}const S=!!(t!=null&&t.is_admin||t!=null&&t.is_mod),Q=!!(t!=null&&t.is_admin),ce=B===null?null:!B;return e.jsxs("div",{className:"col",style:{width:"100%"},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:10},children:[e.jsx("div",{className:"title",children:"Moderation"}),Q&&ce!==null&&e.jsxs("div",{className:"row",style:{alignItems:"center",gap:6},children:[e.jsx("span",{className:"muted",style:{fontSize:12},children:"Auto-approve"}),e.jsx("button",{className:`btn ${ce?"":"secondary"}`,style:{padding:"6px 10px"},onClick:async()=>{if(B===null)return;const l=!B;try{await E(k.admin.settingsModeration,{method:"POST",body:JSON.stringify({require_approval:l})}),N(l),j(l?"Auto-approve disabled":"Auto-approve enabled",{variant:l?"warn":"success"})}catch{alert("Failed to update setting")}},children:ce?"On":"Off"})]})]}),S&&e.jsxs("div",{className:"tabs",role:"tablist","aria-label":"Moderation tabs",children:[e.jsx("button",{role:"tab","aria-selected":z==="approvals",className:`tab ${z==="approvals"?"active":""}`,onClick:()=>O("approvals"),children:"Approvals"}),(Q||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":z==="manage",className:`tab ${z==="manage"?"active":""}`,onClick:()=>O("manage"),children:"Manage"}),(Q||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":z==="analytics",className:`tab ${z==="analytics"?"active":""}`,onClick:()=>{O("analytics"),h||ae()},children:"Analytics"}),(Q||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":z==="message",className:`tab ${z==="message"?"active":""}`,onClick:()=>O("message"),children:"Message"})]})]}),e.jsx("hr",{className:"subtle-divider"}),!S&&e.jsx("div",{className:"muted",children:"You do not have access."}),z==="approvals"&&S&&(()=>{const l=u.filter(_=>!_.flagged_only),J=u.filter(_=>!!_.flagged_only);return e.jsxs("div",{className:"row wrap",style:{marginTop:12,gap:16,alignItems:"flex-start"},children:[e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Pending approvals"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[l.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",children:[l.length===0&&e.jsx("div",{className:"muted",children:"Nothing pending."}),l.map(_=>e.jsxs("div",{className:"row wrap",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[_.poster_url?e.jsx("img",{src:_.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:_.description||"",children:_.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:["uploader: ",_.username,_.needs_review?e.jsx("span",{style:{marginLeft:6,color:"#f59e0b"},children:"(needs review)"}):e.jsx("span",{style:{marginLeft:6,color:"#60a5fa"},children:"(pending)"}),typeof _.flags_count=="number"&&_.flags_count>0?e.jsxs("span",{className:"muted",style:{marginLeft:6},children:["â€¢ ",_.flags_count," reports"]}):null]})]})]}),e.jsxs("div",{className:"row wrap",children:[e.jsx("button",{className:"btn secondary",onClick:async()=>{try{await E(k.admin.videosReject(_.id),{method:"POST"}),i(u.filter(de=>de.id!==_.id)),j("Rejected",{variant:"warn"})}catch{}},children:"Reject"}),e.jsx("button",{className:"btn",style:{marginLeft:8},onClick:async()=>{try{await E(k.admin.videosApprove(_.id),{method:"POST"}),i(u.filter(de=>de.id!==_.id)),j("Approved",{variant:"success"})}catch{}},children:"Approve"}),e.jsx("button",{className:"btn secondary",style:{marginLeft:8},onClick:async()=>{if(confirm("Permanently delete this video?"))try{await E(k.videos.delete(_.id),{method:"DELETE"}),i(u.filter(de=>de.id!==_.id)),j("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]},_.id))]})]}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Flagged (FYI)"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[J.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",children:[J.length===0&&e.jsx("div",{className:"muted",children:"No flagged items."}),J.map(_=>e.jsxs("div",{className:"row wrap",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[_.poster_url?e.jsx("img",{src:_.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:_.description||"",children:_.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:["uploader: ",_.username,e.jsx("span",{style:{marginLeft:6,color:"#9ca3af"},children:"(flagged)"}),typeof _.flags_count=="number"&&_.flags_count>0?e.jsxs("span",{className:"muted",style:{marginLeft:6},children:["â€¢ ",_.flags_count," reports"]}):null]})]})]}),e.jsx("div",{className:"row wrap",children:e.jsx("button",{className:"btn secondary",onClick:async()=>{if(confirm("Permanently delete this video?"))try{await E(k.videos.delete(_.id),{method:"DELETE"}),i(u.filter(de=>de.id!==_.id)),j("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})})]},_.id))]}),e.jsx("div",{className:"muted",style:{fontSize:12,marginTop:6},children:"Flagged items donâ€™t require approval; use Delete only if necessary."})]})]})})(),z==="manage"&&(Q||(t==null?void 0:t.is_mod))&&e.jsx("div",{className:"col",style:{marginTop:16},children:e.jsxs("div",{className:"mod-manage-grid",children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"User management"}),e.jsxs("div",{className:"row wrap",style:{gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:y,onChange:l=>m(l.target.value),onKeyDown:l=>{l.key==="Enter"&&U()}}),e.jsx("button",{className:"btn",onClick:U,style:{padding:"6px 10px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:8},children:e.jsx("div",{className:"col",style:{gap:6},children:F.map(l=>e.jsxs("button",{className:"btn secondary",onClick:()=>X(l),style:{justifyContent:"flex-start"},children:[l.avatar_url&&e.jsx("img",{src:l.avatar_url,width:18,height:18,style:{borderRadius:"50%",marginRight:8}}),e.jsx("span",{className:"one-line",style:{marginRight:8},children:l.username}),e.jsxs("span",{className:"muted",children:["(id ",l.id,", osu ",l.osu_user_id,")"]}),l.is_admin?e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"admin"}):l.is_mod?e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"mod"}):l.is_blacklisted?e.jsx("span",{style:{marginLeft:"auto",color:"#f87171"},children:"blacklisted"}):null]},l.id))})})]}),e.jsx("div",{className:"v-divider","aria-hidden":"true"}),e.jsx("div",{className:"col",style:{minWidth:0},children:w?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row wrap",style:{alignItems:"center"},children:[w.avatar_url&&e.jsx("img",{src:w.avatar_url,width:28,height:28,style:{borderRadius:"50%",marginRight:8}}),e.jsx("div",{className:"title",style:{marginRight:8,fontSize:18},children:w.username}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["id ",w.id," â€¢ osu ",w.osu_user_id]}),e.jsx("div",{style:{marginLeft:"auto"}}),Q?w.is_admin?e.jsx("span",{}):w.is_mod?e.jsx("button",{className:"btn secondary",style:{padding:"6px 10px"},onClick:()=>$(w,!1),children:"Revoke moderation"}):e.jsx("button",{className:"btn",style:{padding:"6px 10px"},onClick:()=>$(w,!0),children:"Grant moderation"}):null,!w.is_admin&&(w.is_blacklisted?e.jsx("button",{className:"btn",style:{marginLeft:8,padding:"6px 10px"},onClick:async()=>{try{await E(k.admin.user(w.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!1})}),L({...w,is_blacklisted:!1}),j("User unblacklisted",{variant:"success"})}catch{alert("Failed")}},children:"Unblacklist"}):e.jsx("button",{className:"btn secondary",style:{marginLeft:8,padding:"6px 10px"},onClick:async()=>{try{await E(k.admin.user(w.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!0})}),L({...w,is_blacklisted:!0}),j("User blacklisted",{variant:"warn"})}catch{alert("Failed")}},children:"Blacklist"}))]}),w.is_admin?e.jsx("div",{className:"caption",style:{marginTop:4},children:"Admins always retain access"}):null,e.jsxs("div",{className:"col",style:{marginTop:12},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Uploads"}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("span",{className:"muted",style:{fontSize:12},children:"Show"}),e.jsx("button",{className:`btn ${D==="all"?"":"secondary"}`,onClick:()=>T("all"),children:"All"}),e.jsx("button",{className:`btn ${D==="review"?"":"secondary"}`,onClick:()=>T("review"),children:"Needs review"})]})]}),e.jsxs("div",{className:"scroll-panel sm",style:{marginTop:8},children:[x.length===0&&e.jsx("div",{className:"muted",children:"No uploads."}),x.filter(l=>{if(D==="all")return!0;const J=(B?!l.approved_at:!1)&&l.status==="ready",_=!!l.needs_review;return J||_}).map(l=>e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[l.poster_url?e.jsx("img",{src:l.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:l.description||"",children:l.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:[l.status.toUpperCase()," â€¢ ",new Date(l.created_at*1e3).toLocaleString(),l.needs_review?e.jsx("span",{style:{marginLeft:6,color:"#f59e0b"},children:"(purgatory)"}):null,B&&!l.approved_at&&l.status==="ready"?e.jsx("span",{style:{marginLeft:6,color:"#60a5fa"},children:"(pending)"}):null]})]})]}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("span",{className:"muted",children:l.likes_count??0}),e.jsx("span",{style:{color:"var(--accent)"},children:"â˜…"}),(Q||(t==null?void 0:t.is_mod))&&(!!l.needs_review||B&&!l.approved_at&&l.status==="ready")&&e.jsx("button",{className:"btn",onClick:async()=>{try{await E(k.admin.videosApprove(l.id),{method:"POST"}),I(x.map(J=>J.id===l.id?{...J,approved_at:Math.floor(Date.now()/1e3),needs_review:0}:J)),j("Approved",{variant:"success"})}catch{alert("Approve failed")}},children:"Approve"}),(Q||(t==null?void 0:t.is_mod))&&e.jsx("button",{className:"btn secondary",style:{marginLeft:8},onClick:async()=>{if(confirm("Permanently delete this video?"))try{await E(k.videos.delete(l.id),{method:"DELETE"}),I(x.filter(J=>J.id!==l.id)),j("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]},l.id))]})]})]}):e.jsx("div",{className:"muted",children:"Select a user to view details and uploads."})})]})}),!1,z==="message"&&(Q||(t==null?void 0:t.is_mod))&&e.jsx("div",{className:"col",style:{marginTop:16},children:e.jsxs("div",{className:"mod-manage-grid",children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"Send a system message"}),e.jsxs("div",{className:"row wrap",style:{gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:y,onChange:l=>m(l.target.value),onKeyDown:l=>{l.key==="Enter"&&U()}}),e.jsx("button",{className:"btn",onClick:U,style:{padding:"6px 10px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:8},children:e.jsx("div",{className:"col",style:{gap:6},children:F.map(l=>e.jsxs("button",{className:"btn secondary",onClick:()=>L(l),style:{justifyContent:"flex-start"},children:[l.avatar_url&&e.jsx("img",{src:l.avatar_url,width:18,height:18,style:{borderRadius:"50%",marginRight:8}}),e.jsx("span",{className:"one-line",style:{marginRight:8},children:l.username}),e.jsxs("span",{className:"muted",children:["(id ",l.id,", osu ",l.osu_user_id,")"]}),(w==null?void 0:w.id)===l.id&&e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"selected"})]},l.id))})})]}),e.jsx("div",{className:"v-divider","aria-hidden":"true"}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"Compose"}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:f,onChange:l=>g(l.currentTarget.checked)}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Send to all users (global)"})]}),e.jsx("textarea",{placeholder:"Message (shown in notifications)",style:{height:120,resize:"vertical"},value:W,onChange:l=>A(l.target.value)}),e.jsx("div",{className:"row wrap",style:{justifyContent:"flex-end",gap:8},children:e.jsx("button",{className:"btn",onClick:()=>{const l=(W||"").trim();if(!l){alert("Enter a message");return}(async()=>{try{const J={text:l,global:f};!f&&(w!=null&&w.id)&&(J.user_id=w.id),await E(k.admin.notificationsSystem,{method:"POST",body:JSON.stringify(J)}),A(""),j("Message sent",{variant:"success"})}catch{alert("Failed to send")}})()},children:"Send"})}),e.jsx("div",{className:"caption",style:{marginTop:6},children:'System messages persist for 24 hours and show an "Expires at" timestamp.'})]})]})}),z==="analytics"&&(Q||(t==null?void 0:t.is_mod))&&e.jsxs("div",{className:"col",style:{marginTop:16,gap:12},children:[e.jsx("div",{className:"title",children:"Analytics"}),ee&&e.jsx("div",{className:"muted",children:"Loadingâ€¦"}),!ee&&!h&&e.jsx("div",{className:"muted",children:"No data."}),h&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",style:{flexWrap:"wrap",gap:10},children:[e.jsx(ve,{label:"Users",value:h.totals.users_total}),e.jsx(ve,{label:"Admins",value:h.totals.users_admin}),e.jsx(ve,{label:"Mods",value:h.totals.users_mod}),e.jsx(ve,{label:"Blacklisted",value:h.totals.users_blacklisted}),e.jsx(ve,{label:"Videos",value:h.totals.videos_total}),e.jsx(ve,{label:"Ready",value:h.totals.videos_ready}),e.jsx(ve,{label:"Pending",value:h.totals.pending_count}),e.jsx(ve,{label:"Purgatory",value:h.totals.purgatory_count}),e.jsx(ve,{label:"Likes",value:h.totals.likes_total}),e.jsx(ve,{label:"Flags",value:h.totals.flags_total})]}),e.jsxs("div",{className:"row",style:{flexWrap:"wrap",gap:20,marginTop:8},children:[e.jsx(Ve,{title:"New users (30d)",series:h.series.users,color:"#60a5fa"}),e.jsx(Ve,{title:"New videos (30d)",series:h.series.videos,color:"#34d399"}),((C=(c=h.stream)==null?void 0:c.graphql)==null?void 0:C.minutes_viewed)&&h.stream.graphql.minutes_viewed.length>0&&e.jsx(Ve,{title:"Minutes viewed (30d)",series:h.stream.graphql.minutes_viewed,color:"#f59e0b"})]}),e.jsxs("div",{className:"col",style:{gap:6,marginTop:8},children:[e.jsx("div",{className:"title",children:"Feed & Stream"}),e.jsxs("div",{className:"muted",children:["Feed: ",h.feed.count," items in rotation",h.feed.cursor?` â€¢ cursor ${h.feed.cursor}`:""]}),e.jsxs("div",{className:"muted",children:["Approx. ready seconds: ",h.stream.approximate.total_duration_sec," â€¢ ready videos: ",h.stream.approximate.videos_ready]}),h.stream.api&&e.jsxs("div",{className:"muted",style:{fontSize:12},children:["Stream API: ",h.stream.api.ok?"ok":"unavailable",(V=(M=h.stream.api)==null?void 0:M.result_info)!=null&&V.count?` â€¢ count ${h.stream.api.result_info.count}`:"",(ne=h.stream.api)!=null&&ne.sample_status?` â€¢ sample status ${String(h.stream.api.sample_status)}`:""]})]})]})]})]})}function ve({label:t,value:d}){return e.jsxs("div",{className:"col",style:{padding:"8px 10px",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,minWidth:120},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:t}),e.jsx("div",{className:"title",children:d})]})}function Ve({title:t,series:d,color:u}){const L=d.map(g=>g.count),x=Math.max(1,...L),I=s.useMemo(()=>{const g=x,j=Math.pow(10,Math.floor(Math.log10(g))),h=g/j;return(h<=1?1:h<=2?2:h<=5?5:10)*j},[x]),D=350,T=124,z=s.useMemo(()=>d.map((g,j)=>{const h=42+j/Math.max(1,d.length-1)*D,q=8+(1-g.count/(I||1))*T;return[h,q]}),[d,I,D,T]),O=s.useMemo(()=>z.map((g,j)=>j===0?`M ${g[0]} ${g[1]}`:`L ${g[0]} ${g[1]}`).join(" "),[z]),B=[0,.25,.5,.75,1],N=s.useMemo(()=>{if(d.length===0)return[];const g=[0,.25,.5,.75,1].map(j=>Math.min(d.length-1,Math.round(j*(d.length-1))));return Array.from(new Set(g))},[d]),W=g=>{if(!g||g.length<10)return g||"";const j=g.slice(5,7).replace(/^0/,""),h=g.slice(8,10).replace(/^0/,"");return`${j}/${h}`};function A(g){const j=Number.isInteger(g);return g>=1e6?`${(g/1e6).toFixed(1).replace(/\.0$/,"")}M`:g>=1e3?`${(g/1e3).toFixed(1).replace(/\.0$/,"")}k`:j?String(g):g<10?g.toFixed(1):g.toFixed(1).replace(/\.0$/,"")}const f=d.length?d[d.length-1].count:0;return e.jsxs("div",{className:"col",style:{border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:10},children:[e.jsxs("div",{className:"row",style:{alignItems:"baseline",justifyContent:"space-between",marginBottom:6},children:[e.jsx("div",{className:"muted",children:t}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["latest: ",A(f)]})]}),e.jsxs("svg",{width:400,height:160,role:"img","aria-label":t,children:[e.jsx("rect",{x:0,y:0,width:400,height:160,fill:"#0f1217",rx:8}),B.map((g,j)=>{const h=8+(1-g)*T,q=g*I;return e.jsxs("g",{children:[e.jsx("line",{x1:42,y1:h,x2:392,y2:h,stroke:"rgba(255,255,255,0.08)",strokeWidth:1}),e.jsx("text",{x:36,y:h+4,textAnchor:"end",fontSize:10,fill:"rgba(255,255,255,0.6)",children:A(q)})]},j)}),e.jsx("line",{x1:42,y1:8,x2:42,y2:8+T,stroke:"rgba(255,255,255,0.25)",strokeWidth:1}),e.jsx("line",{x1:42,y1:8+T,x2:42+D,y2:8+T,stroke:"rgba(255,255,255,0.25)",strokeWidth:1}),N.map((g,j)=>{var q;const h=42+g/Math.max(1,d.length-1)*D;return e.jsxs("g",{children:[e.jsx("line",{x1:h,y1:8,x2:h,y2:8+T,stroke:"rgba(255,255,255,0.08)",strokeWidth:1}),e.jsx("text",{x:h,y:8+T+12,textAnchor:"middle",fontSize:10,fill:"rgba(255,255,255,0.6)",children:W((q=d[g])==null?void 0:q.day)})]},j)}),e.jsx("path",{d:O,fill:"none",stroke:u,strokeWidth:2}),z.length>0&&e.jsx("circle",{cx:z[z.length-1][0],cy:z[z.length-1][1],r:3,fill:u})]})]})}function Ds(){return e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsxs("div",{className:"title",style:{fontSize:"2em"},children:["mappi! ",e.jsx("span",{style:{fontSize:"0.4em",fontWeight:"normal"},children:"by Catawba."})]}),e.jsx("div",{className:"muted",children:"Hi, I get writers block/lose motivation very very easily. I want this site to counterract that."}),e.jsx("div",{className:"muted",children:"Basically, when you are struggling to come up with ideas; you'd hop on this site, watch a few videos, see something that impresses you, then hopefully you can get back to mapping with a lil' bit of inspiration."}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"How it works:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Log in with your osu! account."}),e.jsx("li",{children:"Upload a clip (100MB max). Allow for it to upload/process."}),e.jsx("li",{children:"Uploaded clips enter the random feed. New uploads and liked videos surface more often."}),e.jsx("li",{children:"Moderators can review reports and pending items for safety."})]})]}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"Guidelines:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"You can post two clips every 24 hours before getting rate-limited."}),e.jsx("li",{children:"Keep clips 4:3 or 16:9 for best fit. Ultrawide will letterbox."}),e.jsx("li",{children:"Add a short description and (optional) beatmap link."}),e.jsx("li",{children:"Don't post unrelated content."}),e.jsx("li",{children:"Report posts accordingly and within reason."})]})]})]})}function Ps(){return e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",style:{fontSize:"2em"},children:"Settings"}),e.jsx("div",{className:"section-panel",children:e.jsx("div",{className:"muted",children:"Settings page coming soon..."})})]})}const Ws=()=>e.jsx(Cs,{}),$s=()=>e.jsx(is,{children:e.jsxs(se,{element:e.jsx(Is,{}),children:[e.jsx(se,{path:"/",element:e.jsx(Ms,{})}),e.jsx(se,{path:"/mp/discover",element:e.jsx(bt,{})}),e.jsx(se,{path:"/mp/feed",element:e.jsx(Ie,{})}),e.jsx(se,{path:"/mp/feed/:uid",element:e.jsx(us,{})}),e.jsx(se,{path:"/md/feed",element:e.jsx(vs,{})}),e.jsx(se,{path:"/md/feed/:uid",element:e.jsx(js,{})}),e.jsx(se,{path:"/md/queues",element:e.jsx(ws,{})}),e.jsx(se,{path:"/md/queues/:id",element:e.jsx(Ns,{})}),e.jsx(se,{path:"/md/notifications",element:e.jsx(ks,{})}),e.jsx(se,{path:"/profile",element:e.jsx(vt,{})}),e.jsx(se,{path:"/profile/:id",element:e.jsx(vt,{})}),e.jsx(se,{path:"/moderation",element:e.jsx(Fs,{})}),e.jsx(se,{path:"/about",element:e.jsx(Ds,{})}),e.jsx(se,{path:"/settings",element:e.jsx(Ps,{})}),e.jsx(se,{path:"/editor",element:e.jsx(Ws,{})}),e.jsx(se,{path:"/feed",element:e.jsx(bt,{})}),e.jsx(se,{path:"/upload",element:e.jsx(Ie,{})}),e.jsx(se,{path:"/posts",element:e.jsx(Ie,{})}),e.jsx(se,{path:"/recents",element:e.jsx(Ie,{})}),e.jsx(se,{path:"/recent",element:e.jsx(Ie,{})})]})}),Os=()=>e.jsx(ns,{children:e.jsx($s,{})});ss(document.getElementById("root")).render(e.jsx(Rs,{children:e.jsx(as,{client:_s,children:e.jsx(ds,{children:e.jsx(Os,{})})})}));
