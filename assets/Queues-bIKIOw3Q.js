import{j as e,L as j,W as v,q as f,u as C,e as N,f as w,r as i,T as S,w as z}from"./vendor-react-_vsaDC62.js";import{c as y,A as h,a as _,u as k}from"./index-BVzlARBt.js";import"./vendor-DBgzFpze.js";import"./editor-components-CKFEosPJ.js";function q({queue:s}){return e.jsx(j,{to:`/md/queues/${s.id}`,style:{textDecoration:"none",color:"inherit",display:"block"},children:e.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid rgba(255,255,255,0.06)",background:"rgba(255,255,255,0.01)",transition:"background-color 0.15s ease",cursor:"pointer"},onMouseEnter:a=>a.currentTarget.style.background="rgba(255,255,255,0.02)",onMouseLeave:a=>a.currentTarget.style.background="rgba(255,255,255,0.01)",children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:12,marginBottom:8},children:[s.is_group?e.jsx(v,{size:18}):e.jsx(f,{size:18}),e.jsx("strong",{style:{fontSize:16},children:s.name}),s.is_member&&e.jsx("span",{className:"chip",style:{fontSize:11,padding:"2px 8px"},children:"Member"})]}),s.description&&e.jsx("div",{className:"muted",style:{fontSize:14,marginBottom:8},children:s.description}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,fontSize:12},children:[s.owner_avatar_url&&e.jsx("img",{src:s.owner_avatar_url,width:20,height:20,style:{borderRadius:"50%"}}),e.jsxs("span",{className:"muted",children:["by ",s.owner_username]}),e.jsx("span",{className:"muted",children:"â€¢"}),e.jsx("span",{className:"muted",children:new Date(s.created_at*1e3).toLocaleDateString()})]})]})})}function Q(){return C({queryKey:["moddi","queues"],queryFn:async()=>{const s=await y(h.moddi.queues);return Array.isArray(s.items)?s.items:[]}})}function F(){const s=N();return w({mutationFn:async a=>{var r;return await y(h.moddi.queues,{method:"POST",body:JSON.stringify({name:a.name.trim(),description:((r=a.description)==null?void 0:r.trim())||null,is_group:a.is_group??!1})})},onSuccess:()=>{s.invalidateQueries({queryKey:["moddi","queues"]})}})}function A(){const{data:s=[],isLoading:a}=Q(),{data:r}=_(),o=F(),{notify:n}=k(),[d,l]=i.useState(!1),[u,p]=i.useState(""),[g,x]=i.useState(""),c=i.useMemo(()=>r?s.some(t=>t.owner_id===r.id):!1,[r,s]),b=async t=>{if(t.preventDefault(),c){n("You can only create one queue. You can join other queues as a member.",{variant:"error"});return}if(!u.trim()){n("Queue name is required",{variant:"error"});return}o.mutate({name:u.trim(),description:g.trim()||null,is_group:!1},{onSuccess:()=>{n("Queue created!",{variant:"success"}),l(!1),p(""),x("")},onError:m=>{n((m==null?void 0:m.message)||"Failed to create queue",{variant:"error"})}})};return e.jsxs("div",{style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsx("div",{style:{background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,marginBottom:0},children:c?e.jsx("div",{style:{padding:"12px"},children:e.jsx("div",{className:"muted",style:{fontSize:14,lineHeight:1.5},children:"You already own a queue. You can join other queues as a member, but you can only create one queue."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",cursor:"pointer",padding:"8px 12px",minHeight:36},onClick:()=>l(!d),children:[e.jsx("span",{style:{fontWeight:600,fontSize:16,lineHeight:1},children:"Create a queue!"}),d?e.jsx(S,{size:16}):e.jsx(z,{size:16})]}),d&&e.jsx("form",{onSubmit:b,style:{padding:"12px",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("input",{type:"text",placeholder:"Queue name",value:u,onChange:t=>p(t.target.value),maxLength:100,required:!0,style:{background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"inherit",fontSize:14}}),e.jsx("textarea",{placeholder:"Description (optional)",value:g,onChange:t=>x(t.target.value),maxLength:500,rows:3,style:{background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"inherit",fontSize:14,resize:"vertical"}}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:t=>{t.stopPropagation(),l(!1)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:o.isPending||c,onClick:t=>t.stopPropagation(),children:o.isPending?"Creating...":"Create"})]})]})})]})}),e.jsx("div",{style:{marginTop:12,borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:e.jsx("div",{className:"col",style:{gap:0},children:a?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"Loading..."}):s.length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No queues yet. Create one to get started!"}):s.map(t=>e.jsx(q,{queue:t},t.id))})})]})}export{A as default};
