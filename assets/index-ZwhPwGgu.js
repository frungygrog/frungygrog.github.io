const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Discover-DEB31-Wg.js","assets/vendor-react-CcFPULbg.js","assets/vendor-JPAzRx9E.js","assets/mappi-routes-rmgwAihC.js","assets/vendor-hls-B_fsdCYC.js","assets/editor-AMIBF98P.js","assets/vendor-zip-B-J1xrE3.js","assets/beatmap-preview-ChKgcSai.js","assets/editor-CG1yLUbS.css","assets/moddi-routes-Tvao75h_.js","assets/editor-components-COwEyuAl.js","assets/editor-components-Bzmrvihl.css"])))=>i.map(i=>d[i]);
var et=Object.defineProperty;var tt=(t,i,s)=>i in t?et(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s;var Ae=(t,i,s)=>tt(t,typeof i!="symbol"?i+"":i,s);import{r as w,j as e,e as ie,u as le,R as x,q as Se,d as Ne,V as st,W as _e,X as at,L as $,Y as it,H as nt,Z as rt,P as Fe,_ as ot,$ as lt,Q as ve,M as ct,A as dt,h as ut,D as Le,S as mt,T as pt,J as ht,c as De,G as ft,l as We,a0 as gt,z as xt,a1 as Pe,B as vt,v as bt,o as yt,k as jt,x as Nt,i as wt,g as kt,a2 as St,a3 as Tt,a4 as Ct,a5 as Et,a6 as K}from"./vendor-react-CcFPULbg.js";import{y as At}from"./vendor-JPAzRx9E.js";import{u as ce,a as F,A as I,O as fe,c as be,i as te,d as ke,P as _t,b as oe,e as Lt,T as Pt,f as Mt}from"./mappi-routes-rmgwAihC.js";import{u as se,a as qe,b as re,c as $e,d as zt,e as It,f as Rt,g as Be,h as Ft,i as Dt,F as Wt,C as qt,M as $t,D as Bt,j as Ut,P as Ht,Q as Ot,k as Qt,l as Jt,N as Gt}from"./moddi-routes-Tvao75h_.js";import{b as Yt,a as Kt,i as Vt,c as Xt,H as Zt}from"./editor-components-COwEyuAl.js";import{s as es,E as ts}from"./editor-AMIBF98P.js";import"./vendor-hls-B_fsdCYC.js";import"./beatmap-preview-ChKgcSai.js";import"./vendor-zip-B-J1xrE3.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();const ss="modulepreload",as=function(t){return"/"+t},Me={},is=function(i,s,r){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),v=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=Promise.allSettled(s.map(m=>{if(m=as(m),m in Me)return;Me[m]=!0;const j=m.endsWith(".css"),d=j?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${d}`))return;const f=document.createElement("link");if(f.rel=j?"stylesheet":ss,j||(f.as="script"),f.crossOrigin="",f.href=m,v&&f.setAttribute("nonce",v),document.head.appendChild(f),j)return new Promise((E,C)=>{f.addEventListener("load",E),f.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${m}`)))})}))}function n(u){const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=u,window.dispatchEvent(v),!v.defaultPrevented)throw u}return o.then(u=>{for(const v of u||[])v.status==="rejected"&&n(v.reason);return i().catch(n)})},ns=new At({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}});class rs extends w.Component{constructor(s){super(s);Ae(this,"handleRetry",()=>{const s=this.isChunkLoadingError(this.state.error);this.setState({hasError:!1,error:null}),s&&window.location.reload()});this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,r){console.error("ErrorBoundary caught an error:",s,r)}isChunkLoadingError(s){if(!s)return!1;const r=s.message.toLowerCase();return r.includes("loading chunk")||r.includes("failed to load")||r.includes("chunk load failed")||r.includes("loading css chunk")||s.name==="ChunkLoadError"}render(){var s;if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const r=this.isChunkLoadingError(this.state.error),o=((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"8px",color:"var(--muted)"},children:r?"Failed to load page. This might be a network issue.":o}),r&&e.jsx("p",{style:{marginBottom:"24px",fontSize:"14px",color:"var(--muted)",opacity:.8},children:"Try checking your internet connection or reloading the page."}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{className:"btn secondary",onClick:this.handleRetry,children:r?"Reload Page":"Try Again"}),!r&&e.jsx("button",{className:"btn secondary",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})}return this.props.children}}const Z=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function os({i:t}){const i=t*1337,s=(C,y)=>{const p=Math.sin(i+C+y)*1e4,b=p-Math.floor(p);return Math.floor(b*(y-C+1)+C)},r=s(0,100),o=s(24,50),n=.7+s(0,100)/100*.3,u=o*n,v=s(0,4e3),m=s(-10,10),j=s(-8,8),d=s(0,100),f=d<60?1:d<80?1.5:2,E=[{size:200*f,alpha:.06,dx:-22,dy:12,color:Z[s(0,Z.length-1)]},{size:150*f,alpha:.08,dx:-9,dy:7,color:Z[s(0,Z.length-1)]},{size:120*f,alpha:.1,dx:0,dy:0,color:Z[s(0,Z.length-1)]},{size:90*f,alpha:.12,dx:12,dy:-4,color:Z[s(0,Z.length-1)]},{size:64*f,alpha:.13,dx:20,dy:-7,color:Z[s(0,Z.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${r}vw`,animationDuration:`${u}s`,animationDelay:`${v}ms`,"--tx":`${m}vw`,transform:`rotate(${j}deg)`},children:E.map((C,y)=>e.jsx("svg",{width:C.size,height:C.size,viewBox:"0 0 100 100",style:{left:`${50+C.dx}%`,bottom:`${C.dy}px`,transform:"translateX(-50%)","--alpha":C.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:C.color})},y))})}function ls({paused:t=!1}){const i=w.useMemo(()=>new Array(20).fill(0).map((s,r)=>r),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:i.map(s=>e.jsx(os,{i:s},s))})}function cs(){const t=ie(),i=le(),{lastSection:s,previousLocation:r,setPreviousLocation:o}=se(),n=x.useRef(null),u=x.useRef(!1),v=x.useRef(0),m=x.useRef(0),j=x.useRef(null),d=x.useRef(null),f=x.useRef(!1),E=300,C=2e3,y=x.useRef(null),p=x.useRef(null),b=x.useRef(null),[c,S]=x.useState(!1),[_,N]=x.useState(12),q=x.useRef(null),M=x.useRef(null),[l,R]=x.useState(!1),[Q,T]=x.useState(12),[L,A]=x.useState([]),[W,V]=x.useState(""),D=x.useRef(null),G=x.useRef(null),[Y,h]=x.useState(!1),[z,P]=x.useState(12),[O,ne]=x.useState(null),de=x.useCallback(()=>{if(!p.current)return;const g=p.current.getBoundingClientRect(),U=window.innerWidth||document.documentElement.clientWidth||320,H=160;let B=g.left;B+H+8>U&&(B=Math.max(8,U-H-8)),B=Math.max(8,B),N(B)},[]),ue=x.useCallback(()=>{if(!q.current)return;const g=q.current.getBoundingClientRect(),U=window.innerWidth||document.documentElement.clientWidth||320,H=220;let B=g.left;B+H+8>U&&(B=Math.max(8,U-H-8)),B=Math.max(8,B),T(B)},[]),me=x.useCallback(()=>{if(!D.current)return;const g=D.current.getBoundingClientRect(),U=window.innerWidth||document.documentElement.clientWidth||320,H=280;let B=g.left;B+H+8>U&&(B=Math.max(8,U-H-8)),B=Math.max(8,B),P(B)},[]);x.useEffect(()=>()=>{n.current&&clearTimeout(n.current),j.current&&clearTimeout(j.current),d.current&&clearTimeout(d.current)},[]),x.useEffect(()=>{if(!c)return;const g=U=>{const H=U.target;b.current&&!b.current.contains(H)&&p.current&&!p.current.contains(H)&&S(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[c]),x.useEffect(()=>{if(!l)return;const g=U=>{const H=U.target;M.current&&!M.current.contains(H)&&q.current&&!q.current.contains(H)&&R(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[l]),x.useEffect(()=>{if(!Y)return;const g=U=>{const H=U.target;G.current&&!G.current.contains(H)&&D.current&&!D.current.contains(H)&&h(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[Y]),x.useEffect(()=>{if(!c)return;de();const g=()=>de();return window.addEventListener("resize",g),window.addEventListener("orientationchange",g),()=>{window.removeEventListener("resize",g),window.removeEventListener("orientationchange",g)}},[c,de]),x.useEffect(()=>{if(!l)return;ue();const g=()=>ue();return window.addEventListener("resize",g),window.addEventListener("orientationchange",g),()=>{window.removeEventListener("resize",g),window.removeEventListener("orientationchange",g)}},[l,ue]),x.useEffect(()=>{if(!Y)return;me();const g=()=>me();return window.addEventListener("resize",g),window.addEventListener("orientationchange",g),()=>{window.removeEventListener("resize",g),window.removeEventListener("orientationchange",g)}},[Y,me]);const pe=t.pathname==="/"||t.pathname==="/about",he=t.pathname==="/editor";t.pathname.startsWith("/mp/")||!pe&&t.pathname.startsWith("/md/");const ae=t.pathname.startsWith("/md/")||!pe&&!t.pathname.startsWith("/mp/")&&s==="moddi";x.useEffect(()=>{if(!he)return;const g=H=>{const B=H.detail||{},Ze=Array.isArray(B.items)?B.items:[];A(Ze),V(String(B.selected||""))},U=H=>{const B=H.detail||{};ne({title:String(B.title||""),artist:String(B.artist||""),mapper:String(B.mapper||""),version:String(B.version||""),beatmapId:Number(B.beatmapId)||null})};return window.addEventListener("editor:difficulty:list",g),window.addEventListener("editor:info",U),()=>{window.removeEventListener("editor:difficulty:list",g),window.removeEventListener("editor:info",U)}},[he]);const a=qe(),{data:k}=re(),X=x.useRef(null),J=x.useRef(!1),ge=g=>{J.current=!1,(k!=null&&k.is_mod||k!=null&&k.is_admin)&&(g.preventDefault(),g.stopPropagation(),X.current=setTimeout(()=>{J.current=!0,i("/moderation")},500))},ye=()=>{X.current&&(clearTimeout(X.current),X.current=null),J.current&&setTimeout(()=>{J.current=!1},100)},He=g=>{if(J.current){g.preventDefault(),g.stopPropagation();return}i("/settings")},Oe=g=>{if(ye(),J.current){g.preventDefault();return}i("/settings")};if(x.useEffect(()=>()=>{X.current&&clearTimeout(X.current)},[]),pe)return null;const Te=()=>{i(r||(s==="moddi"?"/md/feed":"/mp/feed"))},Qe=()=>{S(g=>!g)},Je=()=>{var g;S(!1),(g=y.current)==null||g.click()},Ge=()=>{R(g=>!g)},Ye=g=>{R(!1),V(g),window.dispatchEvent(new CustomEvent("editor:difficulty:select",{detail:{path:g}}))},Ke=()=>{h(g=>!g)};if(he)return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:y,type:"file",accept:".osz,.zip",onChange:g=>{var H;const U=(H=g.target.files)==null?void 0:H[0];U&&window.dispatchEvent(new CustomEvent("editor:file",{detail:U}))},style:{display:"none"}}),e.jsxs("nav",{className:"mobile-bottom-nav mobile-bottom-nav-editor",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx("button",{className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:Te,"aria-label":"Back",title:"Go back",children:e.jsx(Se,{size:20})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:p,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:Qe,"aria-label":"File",title:"File menu","aria-expanded":c,children:e.jsx(st,{size:20})}),c&&Ne.createPortal(e.jsx("div",{ref:b,className:"menu-panel mobile-bottom-nav-menu",role:"menu",style:{"--mobile-menu-left":`${_}px`},children:e.jsx("button",{className:"menu-item",type:"button",onClick:Je,style:{fontFamily:"Torus Pro, Torus, ui-sans-serif, system-ui, sans-serif"},children:"Open .osz"})}),document.body)]})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:Te,"aria-label":"Go back",title:"Go back to previous page",children:e.jsx("span",{className:"mobile-coin-flip-text",children:"ed!"})}),e.jsxs("div",{className:"mobile-bottom-nav-right",children:[L.length>0&&e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:q,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:Ge,"aria-label":"Select Difficulty",title:"Select Difficulty","aria-expanded":l,children:e.jsx(_e,{size:20})}),l&&Ne.createPortal(e.jsx("div",{ref:M,className:"settings-panel mobile-bottom-nav-menu",role:"menu",style:{"--mobile-menu-left":`${Q}px`,minWidth:220},children:L.map(g=>{const U=g.mode==="taiko"?Yt:g.mode==="mania"?Kt:g.mode==="catch"?Vt:Xt;return e.jsxs("button",{className:`mode-option ${W===g.path?"selected":""}`,type:"button",onClick:()=>Ye(g.path),children:[e.jsx("img",{className:"mode-icon",src:U,width:24,height:24,alt:""}),e.jsx("span",{children:g.version||"(Untitled)"})]},g.path)})}),document.body)]}),O&&e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:D,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:Ke,"aria-label":"Map Info",title:"Map Info","aria-expanded":Y,children:e.jsx(at,{size:20})}),Y&&Ne.createPortal(e.jsx("div",{ref:G,className:"menu-panel mobile-bottom-nav-menu",role:"dialog",style:{"--mobile-menu-left":`${z}px`,minWidth:280,maxWidth:"min(380px, calc(100vw - 24px))"},children:e.jsxs("div",{style:{padding:"4px 0"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"var(--text)",marginBottom:8},children:[O.artist||"Artist"," – ",O.title||"Title"]}),e.jsxs("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:["Mapped by: ",O.mapper||"Unknown"]}),O.version&&e.jsxs("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:["Difficulty: ",O.version]}),O.beatmapId&&e.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginTop:8},children:e.jsx("a",{href:`https://osu.ppy.sh/beatmaps/${O.beatmapId}`,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary)",textDecoration:"none"},children:"View on osu.ppy.sh →"})})]})}),document.body)]})]})]})]});const Ce=()=>{const g=Date.now();if(v.current>0){const U=g-v.current;if(U<E&&U>0){j.current&&(clearTimeout(j.current),j.current=null),d.current&&(clearTimeout(d.current),d.current=null),n.current&&(clearTimeout(n.current),n.current=null),m.current=g+C,v.current=0,u.current=!1,o(t.pathname),i("/editor");return}}g<m.current&&v.current===0||(j.current&&(clearTimeout(j.current),j.current=null),d.current&&(clearTimeout(d.current),d.current=null),v.current=g,d.current=setTimeout(()=>{d.current!==null&&(i(ae?"/mp/feed":"/md/feed"),d.current=null)},E),j.current=setTimeout(()=>{v.current>0&&(v.current=0,m.current=Date.now()+C),j.current=null},E))},Ee=()=>{u.current=!1,n.current=setTimeout(()=>{u.current=!0,i("/")},500)},je=()=>{n.current&&(clearTimeout(n.current),n.current=null),u.current&&setTimeout(()=>{u.current=!1},100)},Ve=g=>{if(f.current){g.preventDefault(),g.stopPropagation(),f.current=!1;return}if(u.current){g.preventDefault(),g.stopPropagation();return}Ce()},Xe=g=>{if(je(),u.current){g.preventDefault(),f.current=!0;return}g.preventDefault(),Ce(),f.current=!0,setTimeout(()=>{f.current=!1},E+100)};return e.jsxs("nav",{className:"mobile-bottom-nav",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx($,{to:ae?"/md/feed":"/mp/feed",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/feed"||t.pathname==="/md/feed"?"active":""}`,"aria-label":"Feed",children:e.jsx(_e,{size:20})}),ae?e.jsxs(e.Fragment,{children:[e.jsx($,{to:"/md/queues",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/md/queues")?"active":""}`,"aria-label":"Queues",children:e.jsx(it,{size:20})}),e.jsx($,{to:"/md/me/submissions",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/md/me/submissions"?"active":""}`,"aria-label":"My Submissions",children:e.jsx(nt,{size:20})})]}):e.jsx($,{to:"/mp/discover",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/discover"?"active":""}`,"aria-label":"Discover",children:e.jsx(rt,{size:20})})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:Ve,onTouchStart:Ee,onTouchEnd:Xe,onMouseDown:Ee,onMouseUp:je,onMouseLeave:je,"aria-label":ae?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",title:ae?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",children:e.jsx("span",{className:"mobile-coin-flip-text",children:ae?"md!":"mp!"})}),e.jsxs("div",{className:"mobile-bottom-nav-right",children:[e.jsxs($,{to:"/notifications",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/notifications"?"active":""}`,"aria-label":"Notifications",style:{position:"relative",overflow:"visible"},children:[e.jsx(Fe,{size:20}),a>0&&e.jsx("div",{style:{position:"absolute",top:4,right:4,width:10,height:10,background:"#f87171",borderRadius:9999,zIndex:10,pointerEvents:"none",border:"2px solid var(--panel)",boxSizing:"border-box"}})]}),e.jsx("button",{className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/settings"?"active":""}`,onClick:He,onTouchStart:ge,onTouchEnd:Oe,onMouseDown:ge,onMouseUp:ye,onMouseLeave:ye,"aria-label":k!=null&&k.is_mod||k!=null&&k.is_admin?"Settings (long press for moderation)":"Settings",title:k!=null&&k.is_mod||k!=null&&k.is_admin?"Settings (long press for moderation)":"Settings",children:e.jsx(ot,{size:20})})]})]})}function ze({isModdi:t,onClick:i}){return e.jsxs("button",{onClick:i,className:"title coin-flip-title",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"inherit"},title:"Switch section (double-click for editor)","aria-label":"Switch section (double-click for editor)",children:[e.jsx("span",{className:"coin-flip-front",children:t?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:t?"osu!mappi.ng":"osu!moddi.ng"})]})}function ds({isNeutralPage:t,isEditor:i,isModdi:s,isMappi:r,onCoinFlipClick:o}){const u=ie().pathname==="/";return t&&!u?e.jsx($,{to:"/",className:"title",children:s?"osu!moddi.ng":r?"osu!mappi.ng":"mappi!"}):u?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:4},children:e.jsx(ze,{isModdi:s,onClick:o})}):i?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx($,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(lt,{size:18})}),e.jsx($,{to:s?"/md/feed":"/mp/feed",className:"title",children:"osu!editi.ng"})]}):e.jsx("div",{style:{display:"flex",alignItems:"center",gap:4},children:e.jsx(ze,{isModdi:s,onClick:o})})}function us({isNeutralPage:t,isMappi:i,isModdi:s}){const r=ie();return e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[t&&r.pathname!=="/"&&e.jsx($,{to:r.pathname==="/about"?"/":"/about",className:r.pathname==="/about"?"active":"",children:r.pathname==="/about"?"Home":"About"}),i&&e.jsxs(e.Fragment,{children:[e.jsx($,{to:"/mp/feed",className:r.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx($,{to:"/mp/discover",className:r.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx($,{to:"/editor",className:r.pathname==="/editor"?"active":"",children:"Editor"})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx($,{to:"/md/feed",className:r.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx($,{className:r.pathname.startsWith("/md/queues")?"active":"",children:"Queues"}),e.jsx($,{to:"/md/me/submissions",className:r.pathname==="/md/me/submissions"?"active":"",children:"Submissions"})]}),!i&&!s&&!t&&e.jsxs(e.Fragment,{children:[e.jsx($,{to:"/mp/feed",className:r.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx($,{to:"/mp/discover",className:r.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx($,{to:"/editor",className:r.pathname==="/editor"?"active":"",children:"Editor"})]})]})}function ms(t,i,s,r){const o=le(),{notify:n}=ce(),[u,v]=w.useState(new Set);return{parseQueueInvite:y=>{if(!y)return null;try{const p=JSON.parse(y);if((p==null?void 0:p.type)==="queue_invite"&&(p!=null&&p.queue_id))return p}catch{}return null},handleAcceptInvite:async(y,p)=>{if(!u.has(y.id)){v(b=>new Set(b).add(y.id));try{await F(I.moddi.queueAccept(String(p)),{method:"POST"}),n("Invitation accepted!",{variant:"success"}),s.mutate(y.id),r(!1),o(`/md/queues/${p}`)}catch(b){n((b==null?void 0:b.message)||"Failed to accept invitation",{variant:"error"})}finally{v(b=>{const c=new Set(b);return c.delete(y.id),c})}}},handleDenyInvite:async(y,p)=>{if(!u.has(y.id)){v(b=>new Set(b).add(y.id));try{await F(I.moddi.queueDeny(String(p)),{method:"POST"}),n("Invitation declined",{variant:"success"}),s.mutate(y.id)}catch(b){n((b==null?void 0:b.message)||"Failed to decline invitation",{variant:"error"})}finally{v(b=>{const c=new Set(b);return c.delete(y.id),c})}}},handleMarkAllRead:async()=>{const y=t.filter(p=>p.id.startsWith("n:")||p.kind==="system"&&!p.read).map(p=>p.id);y.length>0&&i.mutate(y)},handleNotificationClick:async y=>{r(!1),i.mutate([y.id]);const p=typeof y.targetPath=="string"&&y.targetPath.trim().length>0?y.targetPath:null;if(p&&o(p),y.kind==="system"||y.id.startsWith("n:"))try{await F(I.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:[y.id]})})}catch{}},handleDeleteNotification:async(y,p)=>{y.stopPropagation(),s.mutate(p)},processing:u}}function ps({notifications:t,unreadCount:i,notifOpen:s,setNotifOpen:r,markReadMutation:o,deleteNotificationMutation:n,closeAllPanels:u}){const v=w.useRef(null),m=w.useRef(null),{parseQueueInvite:j,handleAcceptInvite:d,handleDenyInvite:f,handleMarkAllRead:E,handleNotificationClick:C,handleDeleteNotification:y,processing:p}=ms(t,o,n,r);$e(v,m,s,()=>r(!1));const b=t.filter(c=>!(c.kind==="system"&&c.id.startsWith("b:")&&(c.expiresAt||0)<=Date.now()));return e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:3},children:[e.jsx("button",{ref:v,className:"icon-link",onClick:()=>{s||u(),r(!s)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(Fe,{size:18})}),i>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),s&&e.jsxs("div",{ref:m,className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx($,{to:"/notifications",onClick:()=>r(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:c=>c.currentTarget.style.opacity="1",onMouseLeave:c=>c.currentTarget.style.opacity="0.7",children:"View all"}),b.length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:E,children:e.jsx(ve,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[b.length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),b.map(c=>{const S=j(c.text),_=c.id.startsWith("b:"),N=S?"queue-invite":c.kind==="star"?"star":c.kind==="likes5"?"likes":c.kind==="comment"?"comment":c.kind==="inspiration"?"inspiration":c.kind==="reaction"?"reaction":_?"global":"system",q=c.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${N}`,role:"button",onClick:()=>!S&&C(c),children:[e.jsxs("div",{className:`notif-icon ${q?"deletable":""}`,"aria-hidden":"true",onClick:q&&!S?M=>y(M,c.id):void 0,title:q&&!S?"Remove":void 0,role:q&&!S?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:S?e.jsx(ct,{}):N==="star"?e.jsx(dt,{}):N==="likes"?e.jsx(ut,{}):N==="comment"?e.jsx(Le,{}):N==="inspiration"?e.jsx(Le,{}):N==="reaction"?e.jsx(mt,{}):N==="global"?e.jsx(pt,{}):null}),q&&!S?e.jsx("span",{className:"swap-trash",children:e.jsx(ht,{})}):null]}),e.jsx("div",{className:"notif-body",children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Queue Invitation"}),e.jsxs("div",{className:"notif-desc",children:[S.inviter_username," invited you to join queue: ",S.queue_name]}),p.has(c.id)?e.jsx("div",{className:"muted",style:{fontSize:11,marginTop:6},children:"Processing..."}):e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:M=>{M.stopPropagation(),d(c,S.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(ve,{size:12,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:M=>{M.stopPropagation(),f(c,S.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(De,{size:12,style:{marginRight:4}}),"Decline"]})]})]}):c.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:_?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:e.jsx(fe,{text:c.text||""})}),_&&c.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(c.expiresAt).toLocaleString()]}):null]}):c.kind==="comment"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Comment"}),e.jsx("div",{className:"notif-desc",children:e.jsx(fe,{text:c.text||"Someone commented on your post"})})]}):c.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:e.jsx(fe,{text:c.text||"Someone is inspired by you!"})})]}):c.kind==="reaction"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Reaction"}),e.jsx("div",{className:"notif-desc",children:e.jsx(fe,{text:c.text||"Someone raised their hand on your post!"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:c.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:c.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},c.id)})]})]})]})}function hs({quota:t,nowTick:i}){if(!(t!=null&&t.blocked))return null;const s=Math.max(0,Math.floor((((t==null?void 0:t.reset_at)??0)*1e3-Date.now())/1e3)),r=Math.floor(s/3600),o=Math.floor(s%3600/60),n=s%60,u=m=>String(m).padStart(2,"0"),v=r>0?`${r}:${u(o)}:${u(n)}`:`${o}:${u(n)}`;return e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(ft,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:v})]})}function fs({me:t,menuOpen:i,setMenuOpen:s,onLogout:r,closeAllPanels:o}){const n=w.useRef(null),u=w.useRef(null);return $e(n,u,i,()=>s(!1)),e.jsxs(e.Fragment,{children:[e.jsxs("button",{ref:n,className:"icon-link",onClick:()=>{i||o(),s(!i)},title:t.username,"aria-label":"User menu","aria-expanded":i,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[t.avatar_url&&e.jsx("img",{src:t.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:t.username}),e.jsx(We,{size:14,style:{opacity:.8}})]}),i&&e.jsxs("div",{ref:u,className:"menu-panel",role:"menu",children:[e.jsx($,{to:"/profile",className:"menu-item",onClick:()=>s(!1),children:"Profile"}),e.jsx($,{to:"/settings",className:"menu-item",onClick:()=>s(!1),children:"Settings"}),((t==null?void 0:t.is_admin)||(t==null?void 0:t.is_mod))&&e.jsx($,{to:"/moderation",className:"menu-item",onClick:()=>s(!1),children:"Moderation"}),e.jsx("button",{className:"menu-item",type:"button",onClick:r,children:"Log out"})]})]})}function gs({isNeutralPage:t,isEditor:i,isMappi:s,isModdi:r,onCoinFlipClick:o}){const n=ie(),u=le(),{data:v,isLoading:m}=re(),{data:j}=zt(!!v),{data:d=[]}=It(!!v),f=qe(),E=Rt(),C=Be(),y=Ft(),{menuOpen:p,notifOpen:b,setMenuOpen:c,setNotifOpen:S,closeAllPanels:_,previousLocation:N,lastSection:q}=se(),M=n.pathname==="/settings",l=n.pathname==="/moderation",R=n.pathname==="/profile"||n.pathname.startsWith("/profile/"),Q=M||l||R,T=()=>{u(N||(q==="moddi"?"/md/feed":q==="mappi"?"/mp/feed":"/"))},[L,A]=x.useState(0);return x.useEffect(()=>{const W=setInterval(()=>A(V=>V+1),1e3);return()=>clearInterval(W)},[]),e.jsxs("header",{className:"top-nav",children:[Q&&e.jsx("button",{onClick:T,className:"icon-link",title:"Go back","aria-label":"Go back",style:{width:"auto",height:"auto",padding:"4px",marginRight:4},children:e.jsx(Se,{size:18})}),e.jsx(ds,{isNeutralPage:t,isEditor:i,isModdi:r,isMappi:s,onCoinFlipClick:o}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),n.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(Zt,{})}):e.jsxs(e.Fragment,{children:[e.jsx(us,{isNeutralPage:t,isMappi:s,isModdi:r}),e.jsx("div",{style:{marginLeft:"auto"}}),e.jsx("a",{className:"icon-link",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)","aria-label":"Join Discord",style:{marginRight:3,transform:"translateY(2px)"},children:e.jsx(gt,{size:18})}),v?e.jsxs("div",{className:"user-menu",children:[e.jsx(ps,{notifications:d,unreadCount:f,notifOpen:b,setNotifOpen:S,markReadMutation:C,deleteNotificationMutation:y,closeAllPanels:_}),e.jsx(hs,{quota:j,nowTick:L}),e.jsx(fs,{me:v,menuOpen:p,setMenuOpen:c,onLogout:()=>E.mutate(),closeAllPanels:_})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{window.location.href=be+I.auth.login},disabled:m,children:m?"Checking…":"Login with osu!"})]})]})}function xs({title:t,onRefresh:i}){const{data:s}=re(),r=ie(),o=le(),{lastSection:n}=se(),[u,v]=x.useState(!0),[m,j]=x.useState(0),[d,f]=x.useState(!1),E=x.useRef(!1),C=x.useRef(0),[y,p]=x.useState(!1),b=x.useRef(null),{data:c=[]}=Dt(),S=Be(),{notify:_}=ce();x.useEffect(()=>{const l=document.querySelector(".page");if(!l)return;let R=l.scrollTop,Q=!1;const T=()=>{Q||(Q=!0,requestAnimationFrame(()=>{const L=l.scrollTop,A=L-R;L<=12||A<-12?v(!0):A>12&&v(!1),R=L,Q=!1}))};return l.addEventListener("scroll",T,{passive:!0}),()=>l.removeEventListener("scroll",T)},[]),x.useEffect(()=>{const l=document.querySelector(".page");if(!l)return;const R=120,Q=70,T=V=>{var D;d||(l.scrollTop<=0?(E.current=!0,C.current=((D=V.touches[0])==null?void 0:D.clientY)??0):E.current=!1)},L=V=>{var Y;if(!E.current||d)return;const D=((Y=V.touches[0])==null?void 0:Y.clientY)??0,G=Math.max(0,D-C.current);if(G>0){const h=Math.min(R,G*.5);j(h)}},A=async()=>{try{if(f(!0),i)await i();else{window.location.reload();return}}finally{setTimeout(()=>{f(!1),j(0)},400)}},W=()=>{!E.current||d||(m>=Q?A():j(0),E.current=!1)};return l.addEventListener("touchstart",T,{passive:!0}),l.addEventListener("touchmove",L,{passive:!0}),l.addEventListener("touchend",W),l.addEventListener("touchcancel",W),()=>{l.removeEventListener("touchstart",T),l.removeEventListener("touchmove",L),l.removeEventListener("touchend",W),l.removeEventListener("touchcancel",W)}},[m,d,i]);const{showBack:N,onBack:q}=x.useMemo(()=>{const l=r.pathname;if(/^\/mp\/feed\/.+/.test(l))return{showBack:!0,onBack:()=>o("/mp/feed")};if(/^\/md\/feed\/.+/.test(l))return{showBack:!0,onBack:()=>o("/md/feed")};if(/^\/md\/queues\/.+/.test(l))return{showBack:!0,onBack:()=>o("/md/queues")};if(l==="/profile"||l.startsWith("/profile/")){const R=n==="moddi"?"/md/feed":"/mp/feed";return{showBack:!0,onBack:()=>{window.history.length>2?o(-1):o(R)}}}return{showBack:!1,onBack:()=>{}}},[r.pathname,o,n]),M=r.pathname==="/notifications";return e.jsxs("div",{className:`mobile-page-header ${u?"":"collapsed"}`,children:[e.jsxs("div",{className:`mobile-page-header-inner ${u?"show":"hide"}`,children:[e.jsx("div",{className:"mobile-page-header-left",children:N?e.jsx("button",{className:"icon-link",onClick:q,"aria-label":"Back",title:"Back",style:{padding:4},children:e.jsx(Se,{size:18})}):e.jsx($,{to:"/profile",className:"icon-link","aria-label":"Profile",children:s!=null&&s.avatar_url?e.jsx("img",{src:s.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}):e.jsx("span",{style:{display:"inline-block",width:22,height:22,borderRadius:"50%",background:"var(--hover-overlay-strong)"}})})}),t?e.jsx("div",{className:"mobile-page-header-title",children:t}):null,e.jsx("div",{className:"mobile-page-header-right",children:M?e.jsx("button",{className:"icon-link","aria-label":"Mark all read",title:"Mark all read",style:{padding:4},onClick:()=>{const l=c.filter(R=>!R.read&&(R.id.startsWith("n:")||R.kind==="system"&&!R.id.startsWith("b:"))).map(R=>R.id);l.length!==0&&S.mutate(l,{onSuccess:()=>{_("All notifications marked as read",{variant:"success"})}})},children:e.jsx(ve,{size:18})}):(()=>{const l=r.pathname;let R=null;return l==="/mp/feed"?R="mappi-feed":l==="/md/feed"?R="moddi-feed":l==="/md/queues"?R="moddi-queues":l.startsWith("/md/queues/")&&(R="moddi-queue-detail"),R?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:b,className:"icon-link","aria-haspopup":"dialog","aria-expanded":y,onClick:()=>p(Q=>!Q),"aria-label":"Filters",title:"Filters",style:{padding:4},children:e.jsx(xt,{size:18})}),y&&e.jsx("div",{style:{position:"absolute",right:0,top:32},children:e.jsx(Wt,{context:R,onClose:()=>p(!1)})})]}):null})()})]}),e.jsx("div",{className:"mobile-ptr-indicator","aria-hidden":"true",style:{opacity:d||m>4?1:0,transform:`translate(-50%, calc(-100% + ${Math.min(m,70)}px))`},children:e.jsx("div",{className:`mobile-ptr-spinner ${d?"spin":m>60?"ready":""}`})})]})}function vs({readyCount:t}){return t===null?null:e.jsx("div",{className:"site-badge","aria-hidden":!1,children:e.jsxs("div",{className:"label",children:[t," videos ready"]})})}function bs(){const t=ie(),{lastSection:i}=se(),s=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/notifications"||t.pathname==="/settings"||t.pathname==="/moderation"||t.pathname==="/profile"||t.pathname.startsWith("/profile/"),r=t.pathname==="/editor",o=t.pathname.startsWith("/mp/")||s&&(i==="mappi"||t.pathname==="/"&&!i)||!s&&!t.pathname.startsWith("/md/")&&i==="mappi",n=t.pathname.startsWith("/md/")||s&&i==="moddi"||!s&&!t.pathname.startsWith("/mp/")&&i==="moddi",u=t.pathname.startsWith("/md/queues/")&&t.pathname!=="/md/queues";return{isNeutralPage:s,isEditor:r,isMappi:o,isModdi:n,isQueueDetail:u}}function ys(t){const i=le(),s=ie(),{setPreviousLocation:r}=se(),o=w.useRef(0),n=w.useRef(0),u=w.useRef(null),v=500,m=2e3;return w.useEffect(()=>()=>{u.current&&clearTimeout(u.current)},[]),d=>{d.preventDefault();const f=Date.now();if(!(f<n.current)){if(u.current&&o.current>0){const E=f-o.current;if(E<v&&E>0){clearTimeout(u.current),u.current=null,n.current=f+m,o.current=0,r(s.pathname),i("/editor");return}}u.current&&(clearTimeout(u.current),u.current=null),o.current=f,u.current=setTimeout(()=>{n.current=Date.now()+m,u.current=null,o.current=0,i(t?"/mp/feed":"/md/feed")},v)}}}function js(){const t=ie(),{notify:i}=ce(),{data:s}=re(),{lastSection:r,setLastSection:o,setPreviousLocation:n}=se(),{isNeutralPage:u,isEditor:v,isMappi:m,isModdi:j}=bs(),d=ys(j);x.useEffect(()=>{t.pathname==="/settings"||t.pathname==="/moderation"||t.pathname==="/profile"||t.pathname.startsWith("/profile/")||n(t.pathname)},[t.pathname,n]),x.useEffect(()=>{t.pathname==="/notifications"||t.pathname==="/settings"||t.pathname==="/moderation"||t.pathname==="/profile"||t.pathname.startsWith("/profile/")||(t.pathname.startsWith("/mp/")?o("mappi"):t.pathname.startsWith("/md/")&&o("moddi"))},[t.pathname,o]);const[f,E]=x.useState(null);x.useEffect(()=>{!s||!s.is_mod||(async()=>{try{const p=await F(I.admin.debugState,{requireAuth:!1}),b=Array.isArray(p==null?void 0:p.counts)?p.counts.find(c=>String(c.status)==="ready"):null;b&&E(Number(b.c)||0)}catch{}})()},[s]),x.useEffect(()=>{s&&!localStorage.getItem("welcomed")&&(i(`Welcome, ${s.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[s,i]),x.useEffect(()=>{if(typeof window>"u"||!te()||t.pathname==="/editor")return;const b=document.querySelector(".page");b&&(b.scrollTop=0)},[t.pathname]);const{showMobileHeader:C,headerTitle:y}=x.useMemo(()=>{const p=t.pathname;if(p==="/"||p==="/about"||p==="/editor"||p==="/mp/discover"||p==="/mobile")return{showMobileHeader:!1,headerTitle:""};const b=p.split("/").filter(Boolean),c=b[0]||"",S=b[1]||"";if(c==="mp"){if(S==="discover")return{showMobileHeader:!0,headerTitle:"Discover"};if(S==="feed")return{showMobileHeader:!0,headerTitle:b.length>2?"Post":"Feed"}}if(c==="md"){if(S==="feed")return{showMobileHeader:!0,headerTitle:b.length>2?"Post":"Feed"};if(S==="queues")return{showMobileHeader:!0,headerTitle:b.length>2?"Queue":"Queues"}}return p==="/notifications"?{showMobileHeader:!0,headerTitle:"Notifications"}:c==="profile"?{showMobileHeader:!0,headerTitle:"Profile"}:p==="/settings"?{showMobileHeader:!0,headerTitle:"Settings"}:p==="/moderation"?{showMobileHeader:!0,headerTitle:"Moderation"}:{showMobileHeader:!0,headerTitle:""}},[t.pathname]);return e.jsxs("div",{className:"app-shell","data-section":j?"moddi":m?"mappi":r==="moddi"?"moddi":r==="mappi"?"mappi":void 0,children:[e.jsx(ls,{paused:t.pathname==="/editor"}),e.jsx(gs,{isNeutralPage:u,isEditor:v,isMappi:m,isModdi:j,onCoinFlipClick:d}),e.jsxs("main",{className:`page ${t.pathname==="/editor"||t.pathname==="/mp/discover"?"fullscreen":""}`,children:[C&&e.jsx(xs,{title:y}),t.pathname==="/about"?e.jsx("div",{className:"card",children:e.jsx(Pe,{})}):e.jsx(Pe,{})]}),t.pathname!=="/editor"&&e.jsx(e.Fragment,{children:e.jsx(vs,{readyCount:f})}),t.pathname!=="/mobile"&&e.jsx(cs,{})]})}const Ns="theme";function ws(){try{const t=localStorage.getItem(Ns);if(t==="light"||t==="dark")return t}catch{}return null}function Ue(t){if(!(typeof document>"u")){document.documentElement.setAttribute("data-theme",t);try{const i=document.querySelector('meta[name="theme-color"]');i&&(i.content=t==="light"?"#ffffff":"#1a1a1a")}catch{}}}function ks(t="dark"){const i=ws()||t;Ue(i)}function Ss(){const{data:t,isLoading:i}=re(),s=!!t,r=le(),{lastSection:o}=se(),[n,u]=x.useState(!1);return x.useEffect(()=>{if(typeof window>"u")return;const v=localStorage.getItem("hide_mobile_install_prompt")==="1",m=te()&&!ke()&&!v;u(m)},[]),x.useEffect(()=>{ke()&&r(o==="moddi"?"/md/feed":"/mp/feed",{replace:!0})},[o,r]),e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes shimmer {
          0% { background-position: -1000px 0; }
          100% { background-position: 1000px 0; }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
        
        .landing-container {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 80px 24px 24px;
          overflow-y: auto;
          z-index: 1;
        }
        
        .landing-hero {
          text-align: center;
          max-width: 900px;
          width: 100%;
          animation: fadeInUp 0.8s ease-out;
        }
        
        .landing-title {
          font-size: clamp(48px, 8vw, 96px);
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 24px;
          background: linear-gradient(135deg, #7dd3fc 0%, #a78bfa 50%, #34d399 100%);
          background-size: 200% 200%;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          animation: shimmer 3s ease-in-out infinite, fadeInUp 0.8s ease-out 0.2s both;
          letter-spacing: -0.02em;
        }
        
        .landing-subtitle {
          font-size: clamp(18px, 2.5vw, 28px);
          color: var(--muted);
          margin: 0 0 64px;
          font-weight: 400;
          animation: fadeInUp 0.8s ease-out 0.4s both;
          opacity: 0.9;
        }
        
        .landing-actions {
          display: flex;
          gap: 24px;
          justify-content: center;
          flex-wrap: wrap;
          animation: fadeInUp 0.8s ease-out 0.6s both;
        }
        
        .landing-btn {
          padding: 20px 32px;
          font-size: 20px;
          font-weight: 700;
          text-decoration: none;
          border-radius: 10px;
          transition: background 0.2s ease, border-color 0.2s ease;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          min-width: 180px;
          border: 1px solid transparent;
          cursor: pointer;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          text-rendering: optimizeLegibility;
          font-smooth: always;
        }
        
        .landing-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
        
        .landing-btn-primary {
          background: #ffffff;
          color: #0b0d10;
          border: 1px solid rgba(0, 0, 0, 0.15);
        }
        
        .landing-btn-primary:hover {
          background: linear-gradient(90deg, rgba(255,255,255,1), rgba(248,249,255,0.98));
          border-color: rgba(0, 0, 0, 0.18);
        }
        
        .landing-btn-secondary {
          background: var(--panel);
          color: var(--text);
          border: 1px solid var(--border);
        }
        
        .landing-btn-secondary:hover {
          background: linear-gradient(90deg, rgba(125,211,252,0.14), rgba(167,139,250,0.16));
          border-color: var(--border-strong);
        }
        
        .landing-glow {
          position: absolute;
          width: 600px;
          height: 600px;
          border-radius: 50%;
          background: radial-gradient(circle, rgba(125, 211, 252, 0.15) 0%, transparent 70%);
          pointer-events: none;
          animation: pulse 4s ease-in-out infinite;
          z-index: -1;
        }
        
        .landing-glow-1 {
          top: 10%;
          left: 10%;
          animation-delay: 0s;
        }
        
        .landing-glow-2 {
          bottom: 10%;
          right: 10%;
          background: radial-gradient(circle, rgba(167, 139, 250, 0.15) 0%, transparent 70%);
          animation-delay: 2s;
        }
        
        .landing-subtitle-desktop {
          display: block;
        }
        
        .landing-subtitle-mobile {
          display: none;
        }
        
        .landing-actions-desktop {
          display: flex;
        }
        
        .landing-actions-mobile {
          display: none;
        }
        
        @media (max-width: 768px) {
          .landing-container {
            padding: 60px 16px 16px;
          }
          
          .landing-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .landing-btn {
            width: 100%;
            min-width: unset;
            padding: 18px 24px;
            font-size: 18px;
          }
          
          .landing-subtitle-desktop {
            display: none;
          }
          
          .landing-subtitle-mobile {
            display: block;
          }
          
          .landing-actions-desktop {
            display: none;
          }
          
          .landing-actions-mobile {
            display: flex;
          }
        }
      `}),e.jsxs("div",{className:"landing-container",children:[e.jsx("div",{className:"landing-glow landing-glow-1"}),e.jsx("div",{className:"landing-glow landing-glow-2"}),e.jsxs("div",{className:"landing-hero",children:[e.jsx("h1",{className:"landing-title",children:"mappi!"}),e.jsx("p",{className:"landing-subtitle landing-subtitle-desktop",children:"Navigate to.."}),!s&&e.jsx("p",{className:"landing-subtitle landing-subtitle-mobile",children:"You have to be logged in to use the site."}),s&&e.jsx("p",{className:"landing-subtitle landing-subtitle-mobile",children:"Navigate to.."}),e.jsxs("div",{className:"landing-actions landing-actions-desktop",children:[e.jsx($,{to:"/mp/feed",className:"landing-btn landing-btn-secondary",children:"mappi.ng"}),e.jsx($,{to:"/md/feed",className:"landing-btn landing-btn-secondary",children:"moddi.ng"})]}),!s&&e.jsx("div",{className:"landing-actions landing-actions-mobile",children:e.jsx("button",{className:"landing-btn landing-btn-primary",onClick:()=>{window.location.href=be+I.auth.login},disabled:i,children:i?"Checking…":"Login with osu!"})}),s&&e.jsxs("div",{className:"landing-actions landing-actions-mobile",children:[e.jsx($,{to:"/mp/feed",className:"landing-btn landing-btn-secondary",children:"mappi.ng"}),e.jsx($,{to:"/md/feed",className:"landing-btn landing-btn-secondary",children:"moddi.ng"})]})]})]}),n&&e.jsxs("div",{className:"mobile-install-prompt",role:"dialog","aria-live":"polite",style:{position:"fixed",left:12,right:12,bottom:12,zIndex:50,display:"flex",alignItems:"center",gap:12,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:10,padding:"10px 12px"},children:[e.jsx("div",{style:{fontSize:14,lineHeight:1.3},children:"Install osumapp.ing to your home screen"}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[e.jsx("button",{className:"btn secondary",onClick:()=>{u(!1);try{localStorage.setItem("hide_mobile_install_prompt","1")}catch{}},"aria-label":"Dismiss",title:"Dismiss",children:"Dismiss"}),e.jsx($,{to:"/mobile",className:"btn","aria-label":"How to install",children:"Install"})]})]})]})}function Ts(){const{data:t}=re(),{modeFilters:i}=se(),s=Object.entries(i).filter(([o,n])=>n).map(([o])=>o),r=s.length?s.join(","):"standard";return vt({queryKey:["mappi","feed",r],queryFn:async({pageParam:o=0})=>{const n=new URLSearchParams({limit:"20",offset:String(o),modes:r}),u=`${I.feed.recent}?${n.toString()}`;return await F(u)},enabled:!!t,initialPageParam:0,getNextPageParam:(o,n)=>{var m;const u=n.reduce((j,d)=>{var f;return j+(((f=d.items)==null?void 0:f.length)||0)},0);return(((m=o.items)==null?void 0:m.length)||0)===20?u:void 0}})}function Cs(){const t=ie(),i=bt(),{data:s}=re(),{modeFilters:r}=se(),{data:o,fetchNextPage:n,hasNextPage:u,isFetching:v,isFetchingNextPage:m,refetch:j}=Ts(),d=w.useMemo(()=>(o==null?void 0:o.pages.flatMap(c=>c.items||[]))||[],[o]),f=w.useMemo(()=>{const c=Object.entries(r).filter(([_,N])=>N).map(([_])=>_.toLowerCase()),S=new Set(c.length?c:["standard"]);return d.filter(_=>{const N=String(_.mode||"standard").toLowerCase();return S.has(N)})},[d,r]);w.useEffect(()=>{t.pathname==="/mp/feed"&&j()},[t.pathname,j]),w.useEffect(()=>{const c=()=>{j()};return window.addEventListener("filterchange",c),()=>window.removeEventListener("filterchange",c)},[j]);const E=c=>{i.setQueryData(["mappi","feed"],S=>S&&{...S,pages:S.pages.map(_=>({..._,items:_.items.map(N=>N.id===c.id?c:N)}))})},C=c=>{i.setQueryData(["mappi","feed"],S=>S&&{...S,pages:S.pages.map(_=>({..._,items:_.items.filter(N=>N.id!==c)}))})},y=()=>{j()},p=v&&!m,b=u??!1;return e.jsxs("div",{className:"feed-container mappi-feed",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"title",style:{marginBottom:8},children:"Feed"}),e.jsx("div",{className:"muted",style:{fontSize:12,marginBottom:12},children:"Clips auto-delete after 60 days. Starred posts are preserved."}),e.jsx(qt,{section:"mappi",onUpload:y})]}),e.jsx($t,{section:"mappi",onUpload:y}),e.jsx(Bt,{context:"mappi-feed"}),e.jsx("div",{className:"feed-list-wrapper",style:{borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)",paddingBottom:"100px"},children:e.jsxs("div",{className:"col",style:{gap:0},children:[f.length===0&&!p&&e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No videos match the selected filter."}),f.map(c=>e.jsx(_t,{post:c,section:"mappi",onUpdate:E,onDelete:C,me:s},c.id)),f.length>0&&b&&e.jsx("div",{style:{padding:"16px",textAlign:"center",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsx("button",{className:"btn secondary",onClick:()=>n(),disabled:m,children:m?"Loading...":"Load more"})})]})})]})}function Ie(t){if(!t)return"standard";const i=String(t).toLowerCase().trim();return i==="osu"||i==="0"||i==="standard"?"standard":i==="taiko"||i==="1"?"taiko":i==="catch"||i==="fruits"||i==="2"?"catch":i==="mania"||i==="3"?"mania":"standard"}const Es=({open:t,onClose:i,videoId:s,initialDescription:r,initialBeatmapUrl:o,onSave:n})=>{const[u,v]=w.useState(r||""),[m,j]=w.useState(o||""),[d,f]=w.useState(null),[E,C]=w.useState(null),[y,p]=w.useState(""),[b,c]=w.useState(!1),S=w.useRef(0);w.useEffect(()=>{t&&(v(r||""),j(o||""),f(null),C(null),p(""))},[t,r,o]),w.useEffect(()=>{if(!t)return;S.current&&window.clearTimeout(S.current);const N=(m||"").trim();if(!N){p(""),f(null),C(null);return}if(!/^https?:\/\/osu\.ppy\.sh\/(beatmapsets|beatmaps)\//i.test(N)){p(""),f(null),C(null);return}return S.current=window.setTimeout(async()=>{var M;try{let l;try{l=new URL(N)}catch{p("Invalid URL format");return}const R=l.hash.match(/#osu\/(\d+)/),Q=R?R[1]:null;l.hash="";const L={url:l.toString()};Q&&(L.beatmap_id=Q);const A=await F(I.osu.resolveBeatmap+oe(L),{requireAuth:!1}),W=Array.isArray(A==null?void 0:A.diffs)?A.diffs:[];if(!W.length&&!A.setId){p("No difficulties found"),f(null),C(null);return}if(f({setId:Number(A.setId)||0,beatmapId:A.beatmapId??null,title:String(A.title||""),artist:String(A.artist||""),mapper:String(A.mapper||""),diffs:W}),W.length>0){const V=Number.isFinite(Number(A.beatmapId))?Number(A.beatmapId):Number((M=W[0])==null?void 0:M.id),D=W.find(Y=>Number(Y.id)===V)||W[0],G=Ie(D==null?void 0:D.mode);C({beatmapId:Number(D==null?void 0:D.id)||null,version:String((D==null?void 0:D.version)||""),mode:G})}p("")}catch(l){p(`Failed to resolve: ${(l==null?void 0:l.message)||"Unknown error"}`),f(null),C(null)}},400),()=>{S.current&&window.clearTimeout(S.current)}},[m,t]);const _=async()=>{if(!b){c(!0);try{await F(I.videos.update(s),{method:"PATCH",body:JSON.stringify({description:u.slice(0,100),beatmap_url:m.trim()||void 0})});const N=!!m.trim();if(d||!N)try{await F(I.videos.update(s)+"/beatmap",{method:"PATCH",body:JSON.stringify({beatmapset_id:N&&d&&d.setId>0?d.setId:null,beatmap_id:N&&(E!=null&&E.beatmapId)?E.beatmapId:null,beatmap_version:N&&(E!=null&&E.version)?E.version:null,beatmap_title:N&&(d!=null&&d.title)?d.title:null,beatmap_artist:N&&(d!=null&&d.artist)?d.artist:null,beatmap_mapper:N&&(d!=null&&d.mapper)?d.mapper:null,beatmap_url:N?m.trim():null})})}catch(M){console.warn("Failed to update beatmap metadata:",M)}n(u,m.trim()||null),i()}catch(N){alert((N==null?void 0:N.message)||"Failed to update post")}finally{c(!1)}}};return t?e.jsxs("div",{className:"overlay",role:"dialog","aria-modal":"true",onClick:N=>N.target===N.currentTarget&&i(),children:[e.jsx("div",{className:"overlay-backdrop",onClick:i}),e.jsxs("div",{className:"overlay-card",style:{maxWidth:"600px",width:"calc(100vw - 24px)"},children:[e.jsx("button",{className:"overlay-close",onClick:i,"aria-label":"Close",children:e.jsx(De,{size:18})}),e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",children:"Edit Post"}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Description (max 100 chars)"}),e.jsx("textarea",{maxLength:100,placeholder:"Description (max 100 chars)",value:u,onChange:N=>v(N.target.value),style:{height:64,resize:"vertical",background:"var(--panel-dark)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:8,padding:"8px 10px"}})]}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Beatmap URL (optional)"}),d?e.jsx("div",{className:"col",style:{gap:8},children:e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{className:"chip-btn",style:{cursor:"default"},children:[e.jsxs("strong",{style:{marginRight:6},children:[d.artist," – ",d.title]}),e.jsxs("span",{className:"muted",children:["by ",d.mapper]})]}),e.jsx("select",{value:(E==null?void 0:E.beatmapId)??d.beatmapId??void 0,onChange:N=>{const q=Number(N.target.value),M=(d==null?void 0:d.diffs.find(l=>Number(l.id)===q))||null;if(M){const l=Ie(M.mode);C({beatmapId:q,version:M.version,mode:l})}},style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:8,padding:"8px 10px"},children:d.diffs.map(N=>e.jsxs("option",{value:N.id,children:[N.version," (",N.mode,")"]},N.id))}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>{f(null),C(null),j("")},children:"Clear"})]})}):e.jsx("input",{type:"url",placeholder:"Beatmap URL (optional) e.g. https://osu.ppy.sh/beatmapsets/...",value:m,onChange:N=>j(N.target.value),style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:8,padding:"8px 10px"}}),y&&e.jsx("div",{className:"muted",style:{color:"var(--danger)",fontSize:12},children:y})]}),e.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn secondary",onClick:i,disabled:b,children:"Cancel"}),e.jsx("button",{className:"btn",onClick:_,disabled:b,children:b?"Saving...":"Save"})]})]})]})]}):null};function Re(){const t=yt(),i=le(),{notify:s}=ce(),[r,o]=w.useState(null),[n,u]=w.useState(null),[v,m]=w.useState(""),[j,d]=w.useState([]),[f,E]=w.useState([]),[C,y]=w.useState([]),[p,b]=w.useState(""),[c,S]=w.useState(null),[_,N]=w.useState([]),[q,M]=w.useState(null),[l,R]=w.useState(""),[Q,T]=w.useState([]),[L,A]=w.useState(null),[W,V]=w.useState(!1),D=w.useMemo(()=>{const h=t.id?Number(t.id):null;return h?r?r.id===h:!1:!0},[t.id,r]);function G(h){const z=h.stream_uid||String(h.id),P=t.id?`/profile/${t.id}`:"/profile";i(`/mp/feed/${z}`,{state:{returnTo:P}})}w.useEffect(()=>{(async()=>{try{const h=await F(I.auth.me,{requireAuth:!1});o(h),h&&Array.isArray(h.inspirations)&&N(h.inspirations)}catch(h){m((h==null?void 0:h.message)||"Not logged in")}})()},[]),w.useEffect(()=>{(async()=>{try{const h=t.id?Number(t.id):null;if(h){const z=await F(I.users.get(h),{requireAuth:!1});u(z),b(z.about||""),Array.isArray(z.inspirations)&&N(z.inspirations);const P=await F(I.users.videos(h)+oe({limit:"60"}),{requireAuth:!1});y(P.items||[]);const O=await F(I.users.likes(h)+oe({limit:"60"}),{requireAuth:!1});E(O.items||[])}else{if(!r)return;u(r),b(r.about||""),Array.isArray(r.inspirations)&&N(r.inspirations);const z=await F(I.users.myVideos+oe({limit:"50"}),{requireAuth:!1});d(z.items||[]);const P=await F(I.users.likes(r.id)+oe({limit:"60"}),{requireAuth:!1});E(P.items||[])}}catch{}})()},[t.id,r]),w.useEffect(()=>{V(!1)},[n==null?void 0:n.id]);async function Y(h){try{const P=(await F(I.auth.me,{method:"PATCH",body:JSON.stringify({inspirations:h})})).user||n;u(P),Array.isArray(P==null?void 0:P.inspirations)&&N(P.inspirations),t.id||o(P)}catch{}}return w.useEffect(()=>{let h;return q!==null&&l.trim().length>=2?h=setTimeout(async()=>{try{const z=await F(I.osu.usersSearch(l),{requireAuth:!1});T(Array.isArray(z.items)?z.items:[])}catch{}},250):T([]),()=>{h&&clearTimeout(h)}},[l,q]),e.jsxs("div",{className:"feed-container profile-page",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"row wrap",style:{alignItems:"center"},children:n?e.jsxs(e.Fragment,{children:[n.avatar_url&&e.jsx("img",{src:n.avatar_url,width:48,height:48,style:{borderRadius:"50%"}}),e.jsxs("div",{className:"col",children:[e.jsxs("div",{className:"title",style:{display:"flex",alignItems:"center",gap:8},children:[n.username,n.osu_user_id&&e.jsx("a",{href:`https://osu.ppy.sh/users/${n.osu_user_id}`,target:"_blank",rel:"noreferrer",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:"var(--text)",opacity:.7,cursor:"pointer",padding:0,textDecoration:"none",transition:"opacity 0.2s ease"},onMouseEnter:h=>h.currentTarget.style.opacity="1",onMouseLeave:h=>h.currentTarget.style.opacity="0.7",title:"View osu! profile","aria-label":"View osu! profile",children:e.jsx(jt,{size:16})})]}),e.jsxs("div",{className:"muted",children:["ID: ",n.id]})]}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[!D&&_.length>0&&e.jsx("span",{className:"muted",style:{fontSize:12},children:"inspired by:"}),_.map((h,z)=>D?e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>A(h.id),onMouseLeave:()=>A(null),children:[e.jsx("button",{className:"insp-avatar",onClick:()=>{if(!confirm("Remove this inspiration?"))return;const P=_.filter((O,ne)=>ne!==z);N(P),Y(P)},children:e.jsx("img",{src:h.avatar_url,alt:h.username})}),L===h.id&&e.jsxs("div",{className:"insp-tooltip",children:[h.username," — click to remove"]})]},h.id):e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>A(h.id),onMouseLeave:()=>A(null),children:[e.jsx("a",{href:`https://osu.ppy.sh/users/${h.id}`,target:"_blank",rel:"noreferrer",className:"insp-avatar link",children:e.jsx("img",{src:h.avatar_url,alt:h.username})}),L===h.id&&e.jsx("div",{className:"insp-tooltip",children:h.username})]},h.id)),D&&_.length<3&&new Array(3-_.length).fill(0).map((h,z)=>e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>A(-z-1),onMouseLeave:()=>A(null),children:[e.jsx("button",{className:"insp-add",onClick:()=>{M(z),R(""),T([])},children:"+"}),L===-z-1&&e.jsx("div",{className:"insp-tooltip",children:"Add inspiration"}),q===z&&e.jsxs("div",{className:"insp-pop",role:"dialog","aria-label":"Search osu! users",children:[e.jsx("input",{autoFocus:!0,placeholder:"Search username",value:l,onChange:P=>R(P.target.value)}),e.jsxs("div",{className:"insp-results",children:[Q.length===0&&l.trim().length>=2&&e.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:"No results"}),Q.map(P=>e.jsxs("button",{className:"insp-result",onClick:()=>{if(r&&Number(r.osu_user_id)===Number(P.id)){s("Kinda based, but no.",{variant:"warn"}),M(null);return}if(_.some(ne=>ne.id===P.id)){M(null);return}const O=[..._,{id:P.id,username:P.username,avatar_url:P.avatar_url}].slice(0,3);N(O),M(null),Y(O)},children:[e.jsx("img",{src:P.avatar_url,alt:"avatar"}),e.jsx("span",{children:P.username})]},P.id))]}),e.jsx("button",{className:"insp-close",onClick:()=>M(null),children:"Close"})]})]},`slot-${z}`))]}),D&&e.jsx("div",{className:"muted",style:{fontSize:12},children:"Who inspires you?"})]})]}):e.jsx("div",{className:"muted",children:v||"Loading…"})}),e.jsxs("div",{className:"col",style:{marginTop:12,gap:4},children:[e.jsx("div",{className:"title",children:"About"}),D?e.jsx("div",{className:"col",style:{gap:6},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx("textarea",{value:p,onChange:h=>b(h.target.value),rows:3,maxLength:1e3,placeholder:"Write something about yourself (max 1000 chars)",style:{paddingRight:36}}),e.jsx("button",{className:"icon-link",onClick:async()=>{try{const h=await F(I.auth.me,{method:"PATCH",body:JSON.stringify({about:p})});u(h.user||n),o(h.user||r)}catch{}},"aria-label":"Save about",title:"Save",style:{position:"absolute",right:8,bottom:8,padding:4,color:"rgba(255,255,255,0.55)"},children:e.jsx(ve,{size:16})})]})}):(()=>{const h=((n==null?void 0:n.about)||"").trim()||"No bio.",z=h.length>200,P=z&&!W?h.slice(0,200)+"...":h;return e.jsxs("div",{className:"col",style:{gap:4},children:[e.jsx("div",{className:"muted",style:{whiteSpace:"pre-wrap"},children:P}),z&&e.jsx("button",{onClick:()=>V(!W),style:{display:"flex",alignItems:"center",gap:4,background:"transparent",border:"none",color:"var(--muted)",cursor:"pointer",padding:0,fontSize:14,fontFamily:"inherit",marginTop:4},children:W?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show less"}),e.jsx(Nt,{size:14})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show more"}),e.jsx(We,{size:14})]})})]})})()]})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Profile sections",children:[e.jsx("button",{role:"tab","aria-selected":!0,className:"profile-tab active","data-tab":"uploads",onClick:h=>{const z=h.currentTarget.closest(".profile-tabs-unified");z.querySelectorAll(".profile-tab").forEach(O=>{O.classList.remove("active"),O.setAttribute("aria-selected","false")}),h.currentTarget.classList.add("active"),h.currentTarget.setAttribute("aria-selected","true"),z.querySelector(".profile-tabs-content").setAttribute("data-active","uploads")},children:"Uploads"}),e.jsx("button",{role:"tab","aria-selected":!1,className:"profile-tab","data-tab":"likes",onClick:h=>{const z=h.currentTarget.closest(".profile-tabs-unified");z.querySelectorAll(".profile-tab").forEach(O=>{O.classList.remove("active"),O.setAttribute("aria-selected","false")}),h.currentTarget.classList.add("active"),h.currentTarget.setAttribute("aria-selected","true"),z.querySelector(".profile-tabs-content").setAttribute("data-active","likes")},children:"Likes"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":"uploads",children:[e.jsx("div",{className:"panel uploads",hidden:!1,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[(D?j:C).length===0&&e.jsx("div",{className:"profile-empty-state",children:"No uploads yet."}),(D?j:C).map(h=>(D&&n?(n.id,n.username,n.avatar_url,n.is_admin,n.is_mod):h.uploader,e.jsxs("button",{className:"recent-cell",onClick:()=>G({...h}),children:[h.poster_url?e.jsx("img",{className:"recent-thumb",src:h.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsx("div",{className:"cell-footer",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(wt,{size:12}),e.jsx("span",{children:h.likes_count??0})]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(kt,{size:12}),e.jsx("span",{children:h.comments_count??0})]})]})})]},h.id)))]})})}),e.jsx("div",{className:"panel likes",hidden:!0,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[f.length===0&&e.jsx("div",{className:"profile-empty-state",children:"No likes yet."}),f.map(h=>{var z,P;return e.jsxs("button",{className:"recent-cell",onClick:()=>G(h),children:[h.poster_url?e.jsx("img",{className:"recent-thumb",src:h.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsxs("div",{className:"cell-footer",children:[((z=h.uploader)==null?void 0:z.avatar_url)&&e.jsx("img",{className:"cell-avatar",src:h.uploader.avatar_url,alt:"avatar"}),e.jsx("span",{className:"cell-name",children:(P=h.uploader)==null?void 0:P.username})]})]},h.id)})]})})})]})]}),c&&e.jsx(Es,{open:!!c,onClose:()=>S(null),videoId:c.id,initialDescription:c.description,initialBeatmapUrl:c.beatmap_url,onSave:(h,z)=>{d(j.map(P=>P.id===c.id?{...P,description:h||null,beatmap_url:z}:P)),S(null)}}),e.jsx("style",{children:`
        .insp-avatar { width: 32px; height: 32px; border-radius: 9999px; padding: 0; border: none; overflow: hidden; cursor: pointer; background: var(--hover-overlay); display: inline-flex; align-items: center; justify-content: center; }
        .insp-avatar.link { background: transparent; border: 1px solid var(--divider); }
        .insp-avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .insp-add { width: 32px; height: 32px; border-radius: 9999px; border: 1px dashed var(--divider); background: transparent; color: var(--text); font-weight: 700; cursor: pointer; }
        .insp-add:hover { border-color: var(--border-strong); }
        .insp-tooltip {
          position: absolute;
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
          background: rgba(18, 20, 24, 0.95);
          color: var(--text, #e5e7eb);
          border: 1px solid var(--divider);
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 14px;
          white-space: nowrap;
          z-index: 10000;
          pointer-events: none;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
        }
        .insp-tooltip::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          width: 0;
          height: 0;
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-bottom: 5px solid rgba(18, 20, 24, 0.95);
        }
        .insp-pop { position: absolute; right: 0; top: 40px; width: 260px; background: var(--panel); border: 1px solid var(--divider); border-radius: 10px; padding: 8px; z-index: 10; }
        .insp-pop input { width: 100%; padding: 8px 10px; border-radius: 8px; border: 1px solid var(--divider); background: var(--panel-dark); color: var(--text); outline: none; box-sizing: border-box; display: block; }
        .insp-results { margin-top: 6px; max-height: 220px; overflow: auto; display: grid; gap: 4px; }
        .insp-result { display: grid; grid-template-columns: 24px 1fr; gap: 8px; align-items: center; padding: 6px 8px; border-radius: 8px; border: 1px solid transparent; background: transparent; color: var(--text); cursor: pointer; text-align: left; }
        .insp-result:hover { background: var(--hover-overlay); border-color: var(--divider); }
        .insp-result img { width: 24px; height: 24px; border-radius: 9999px; object-fit: cover; }
        .insp-close { margin-top: 6px; width: 100%; padding: 6px 8px; border-radius: 8px; border: 1px solid var(--divider); background: var(--hover-overlay); color: var(--text); cursor: pointer; }
      `})]})}function As(){var z,P,O,ne,de,ue,me,pe,he,ae;const[t,i]=w.useState(null),[s,r]=w.useState([]),[o,n]=w.useState(""),[u,v]=w.useState([]),[m,j]=w.useState(null),[d,f]=w.useState([]),[E,C]=w.useState("all"),[y,p]=w.useState("approvals"),[b,c]=w.useState(null),[S,_]=w.useState(""),[N,q]=w.useState(!1),{notify:M}=ce(),[l,R]=w.useState(null),[Q,T]=w.useState(!1);w.useEffect(()=>{(async()=>{try{const a=await F(I.auth.me,{requireAuth:!1});if(i(a),a!=null&&a.is_admin)try{const k=await F(I.admin.settingsModeration,{requireAuth:!1});c(!!k.require_approval)}catch{}}catch{}try{const a=await F(I.admin.videosPending+oe({limit:"50"}),{requireAuth:!1});r(a.items||[])}catch{}})()},[]);async function L(){T(!0);try{const a=await F(I.admin.analytics,{requireAuth:!1});R(a)}finally{T(!1)}}async function A(){try{const a=await F(I.admin.usersSearch(o),{requireAuth:!1});v(a.items||[])}catch{}}async function W(a){j(a),f([]);try{const k=await F(I.admin.userVideos(a.id)+oe({limit:"50"}),{requireAuth:!1});f(k.items||[])}catch{}}async function V(a,k){try{const X=await F(I.admin.userUpdate(a.id),{method:"PATCH",body:JSON.stringify({is_mod:k})}),J=(X==null?void 0:X.user)||{...a,is_mod:k};M(k?"Granted moderation":"Revoked moderation",{variant:k?"success":"warn"}),j(J),v(u.map(ge=>ge.id===a.id?J:ge))}catch{alert("Failed to update")}}const D=!!(t!=null&&t.is_admin||t!=null&&t.is_mod),G=!!(t!=null&&t.is_admin);if(!D)return e.jsx("div",{className:"muted",style:{padding:20},children:"You do not have access."});const Y=s.filter(a=>!a.flagged_only),h=s.filter(a=>!!a.flagged_only);return e.jsxs("div",{className:"moderation-container",children:[e.jsxs("div",{className:"moderation-header",children:[e.jsx("div",{className:"moderation-title",children:"Moderation"}),e.jsx("div",{className:"moderation-description",children:"Review approvals, manage users, and monitor moderation metrics from one place."})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Moderation tabs",style:{display:"flex",flexWrap:te()?"nowrap":"wrap",gap:te()?"2px":"4px",overflowX:te()?"auto":void 0},children:[e.jsx("button",{role:"tab","aria-selected":y==="approvals",className:`profile-tab ${y==="approvals"?"active":""}`,"data-tab":"approvals",onClick:a=>{const k=a.currentTarget.closest(".profile-tabs-unified");k.querySelectorAll(".profile-tab").forEach(J=>{J.classList.remove("active"),J.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),k.querySelector(".profile-tabs-content").setAttribute("data-active","approvals"),p("approvals")},children:"Approvals"}),(G||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="manage",className:`profile-tab ${y==="manage"?"active":""}`,"data-tab":"manage",onClick:a=>{const k=a.currentTarget.closest(".profile-tabs-unified");k.querySelectorAll(".profile-tab").forEach(J=>{J.classList.remove("active"),J.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),k.querySelector(".profile-tabs-content").setAttribute("data-active","manage"),p("manage")},children:"Manage"}),(G||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="analytics",className:`profile-tab ${y==="analytics"?"active":""}`,"data-tab":"analytics",onClick:a=>{const k=a.currentTarget.closest(".profile-tabs-unified");k.querySelectorAll(".profile-tab").forEach(J=>{J.classList.remove("active"),J.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),k.querySelector(".profile-tabs-content").setAttribute("data-active","analytics"),p("analytics"),l||L()},children:"Analytics"}),(G||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="message",className:`profile-tab ${y==="message"?"active":""}`,"data-tab":"message",onClick:a=>{const k=a.currentTarget.closest(".profile-tabs-unified");k.querySelectorAll(".profile-tab").forEach(J=>{J.classList.remove("active"),J.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),k.querySelector(".profile-tabs-content").setAttribute("data-active","message"),p("message")},children:"Message"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":y,children:[e.jsx("div",{className:"panel approvals",hidden:y!=="approvals",children:e.jsxs("div",{className:"moderation-grid",style:{paddingTop:16},children:[e.jsxs("div",{className:"moderation-column",children:[e.jsxs("div",{className:"moderation-column-header",children:[e.jsx("div",{className:"moderation-column-title",children:"Pending approvals"}),e.jsx("div",{className:"moderation-column-count",children:Y.length})]}),Y.length===0&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"Nothing pending."}),Y.map(a=>e.jsxs("div",{className:"moderation-video-card",children:[e.jsxs("div",{className:"mod-card-content",children:[a.poster_url?e.jsx("img",{src:a.poster_url,className:"mod-card-poster",alt:""}):e.jsx("div",{className:"mod-card-poster"}),e.jsxs("div",{className:"mod-card-info",children:[e.jsx("div",{className:"mod-card-desc",title:a.description||"",children:e.jsx(fe,{text:a.description||"No description."})}),e.jsxs("div",{className:"mod-card-meta",children:[e.jsx("span",{children:a.username}),a.needs_review?e.jsx("span",{style:{color:"#f59e0b"},children:"(needs review)"}):e.jsx("span",{style:{color:"#60a5fa"},children:"(pending)"}),typeof a.flags_count=="number"&&a.flags_count>0?e.jsxs("span",{className:"muted",children:["• ",a.flags_count," reports"]}):null]})]})]}),e.jsxs("div",{className:"mod-card-actions",children:[e.jsx("button",{className:"btn secondary compact",onClick:async()=>{try{await F(I.admin.videosReject(a.id),{method:"POST"}),r(s.filter(k=>k.id!==a.id)),M("Rejected",{variant:"warn"})}catch{}},children:"Reject"}),e.jsx("button",{className:"btn primary compact",onClick:async()=>{try{await F(I.admin.videosApprove(a.id),{method:"POST"}),r(s.filter(k=>k.id!==a.id)),M("Approved",{variant:"success"})}catch{}},children:"Approve"}),e.jsx("button",{className:"btn secondary compact",onClick:async()=>{if(confirm("Permanently delete this video?"))try{await F(I.videos.delete(a.id),{method:"DELETE"}),r(s.filter(k=>k.id!==a.id)),M("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]},a.id))]}),e.jsxs("div",{className:"moderation-column",children:[e.jsxs("div",{className:"moderation-column-header",children:[e.jsx("div",{className:"moderation-column-title",children:"Flagged (FYI)"}),e.jsx("div",{className:"moderation-column-count",children:h.length})]}),h.length===0&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"No flagged items."}),h.map(a=>e.jsxs("div",{className:"moderation-video-card flagged",children:[e.jsxs("div",{className:"mod-card-content",children:[a.poster_url?e.jsx("img",{src:a.poster_url,className:"mod-card-poster",alt:""}):e.jsx("div",{className:"mod-card-poster"}),e.jsxs("div",{className:"mod-card-info",children:[e.jsx("div",{className:"mod-card-desc",title:a.description||"",children:e.jsx(fe,{text:a.description||"No description."})}),e.jsxs("div",{className:"mod-card-meta",children:[e.jsx("span",{children:a.username}),e.jsx("span",{style:{color:"#9ca3af"},children:"(flagged)"}),typeof a.flags_count=="number"&&a.flags_count>0?e.jsxs("span",{className:"muted",children:["• ",a.flags_count," reports"]}):null]})]})]}),e.jsx("div",{className:"mod-card-actions",children:e.jsx("button",{className:"btn secondary compact",style:{width:"100%"},onClick:async()=>{if(confirm("Permanently delete this video?"))try{await F(I.videos.delete(a.id),{method:"DELETE"}),r(s.filter(k=>k.id!==a.id)),M("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})})]},a.id)),h.length>0&&e.jsx("div",{className:"muted",style:{fontSize:12,marginTop:8,padding:"0 4px"},children:"Flagged items don't require approval; use Delete only if necessary."})]})]})}),e.jsx("div",{className:"panel manage",hidden:y!=="manage",children:e.jsxs("div",{className:"col",style:{gap:24,paddingTop:16},children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{fontSize:"18px",marginBottom:8},children:"User management"}),e.jsxs("div",{className:"row",style:{gap:8},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:o,onChange:a=>n(a.target.value),onKeyDown:a=>{a.key==="Enter"&&A()},className:"moderation-input"}),e.jsx("button",{className:"btn secondary",onClick:A,style:{minHeight:"44px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:12,maxHeight:"40vh"},children:e.jsx("div",{className:"col",style:{gap:8},children:u.map(a=>e.jsxs("button",{className:`moderation-user-result ${(m==null?void 0:m.id)===a.id?"selected":""}`,onClick:()=>W(a),children:[a.avatar_url&&e.jsx("img",{src:a.avatar_url,width:32,height:32,style:{borderRadius:"50%",flexShrink:0}}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0,gap:2,alignItems:"flex-start"},children:[e.jsx("span",{style:{fontWeight:500},children:a.username}),e.jsxs("span",{className:"muted",style:{fontSize:12},children:["id ",a.id," • osu ",a.osu_user_id]})]}),a.is_admin?e.jsx("span",{className:"chip info",children:"admin"}):a.is_mod?e.jsx("span",{className:"chip success",children:"mod"}):a.is_blacklisted?e.jsx("span",{className:"chip error",children:"blacklisted"}):null]},a.id))})})]}),m?e.jsxs("div",{className:"col",style:{minWidth:0,borderTop:"1px solid var(--divider)",paddingTop:24,gap:24},children:[e.jsxs("div",{className:"row",style:{alignItems:"flex-start",gap:16,flexWrap:"wrap"},children:[m.avatar_url&&e.jsx("img",{src:m.avatar_url,width:64,height:64,style:{borderRadius:"50%",flexShrink:0,border:"2px solid var(--border)"}}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0,gap:8},children:[e.jsxs("div",{children:[e.jsx("div",{className:"title",style:{fontSize:"24px"},children:m.username}),e.jsxs("div",{className:"muted",style:{fontSize:13},children:["id ",m.id," • osu ",m.osu_user_id]})]}),e.jsxs("div",{className:"row wrap",style:{gap:8},children:[G&&!m.is_admin&&(m.is_mod?e.jsx("button",{className:"btn secondary compact",onClick:()=>V(m,!1),children:"Revoke moderation"}):e.jsx("button",{className:"btn secondary compact",onClick:()=>V(m,!0),children:"Grant moderation"})),!m.is_admin&&(m.is_blacklisted?e.jsx("button",{className:"btn secondary compact",onClick:async()=>{try{await F(I.admin.userUpdate(m.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!1})}),j({...m,is_blacklisted:!1}),M("User unblacklisted",{variant:"success"})}catch{alert("Failed")}},children:"Unblacklist"}):e.jsx("button",{className:"btn secondary compact",onClick:async()=>{try{await F(I.admin.userUpdate(m.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!0})}),j({...m,is_blacklisted:!0}),M("User blacklisted",{variant:"warn"})}catch{alert("Failed")}},children:"Blacklist"}))]})]})]}),e.jsxs("div",{className:"col",style:{gap:16},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",flexWrap:"wrap",gap:8},children:[e.jsx("div",{className:"title",style:{fontSize:"18px"},children:"Uploads"}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("button",{className:`btn compact ${E==="all"?"primary":"secondary"}`,onClick:()=>C("all"),children:"All"}),e.jsx("button",{className:`btn compact ${E==="review"?"primary":"secondary"}`,onClick:()=>C("review"),children:"Review"})]})]}),e.jsxs("div",{className:"scroll-panel sm",style:{maxHeight:"50vh"},children:[d.length===0&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"No uploads."}),e.jsx("div",{className:"col",style:{gap:12},children:d.filter(a=>{if(E==="all")return!0;const k=(b?!a.approved_at:!1)&&a.status==="ready",X=!!a.needs_review;return k||X}).map(a=>e.jsxs("div",{className:"moderation-video-card",children:[e.jsxs("div",{className:"mod-card-content",children:[a.poster_url?e.jsx("img",{src:a.poster_url,className:"mod-card-poster",alt:""}):e.jsx("div",{className:"mod-card-poster"}),e.jsxs("div",{className:"mod-card-info",children:[e.jsx("div",{className:"mod-card-desc",title:a.description||"",children:a.description||"No description."}),e.jsxs("div",{className:"mod-card-meta",children:[e.jsx("span",{children:a.status.toUpperCase()}),e.jsxs("span",{className:"muted",children:["• ",new Date(a.created_at*1e3).toLocaleDateString()]}),a.needs_review?e.jsx("span",{style:{color:"#f59e0b"},children:"(purgatory)"}):null,b&&!a.approved_at&&a.status==="ready"?e.jsx("span",{style:{color:"#60a5fa"},children:"(pending)"}):null]}),e.jsxs("div",{className:"row",style:{gap:4,marginTop:4},children:[e.jsx("span",{style:{color:"var(--accent)",fontSize:14},children:"★"}),e.jsx("span",{className:"muted",style:{fontSize:13},children:a.likes_count??0})]})]})]}),e.jsxs("div",{className:"mod-card-actions",children:[(G||(t==null?void 0:t.is_mod))&&(!!a.needs_review||b&&!a.approved_at&&a.status==="ready")&&e.jsx("button",{className:"btn primary compact",onClick:async()=>{try{await F(I.admin.videosApprove(a.id),{method:"POST"}),f(d.map(k=>k.id===a.id?{...k,approved_at:Math.floor(Date.now()/1e3),needs_review:0}:k)),M("Approved",{variant:"success"})}catch{alert("Approve failed")}},children:"Approve"}),(G||(t==null?void 0:t.is_mod))&&e.jsx("button",{className:"btn secondary compact",onClick:async()=>{if(confirm("Permanently delete this video?"))try{await F(I.videos.delete(a.id),{method:"DELETE"}),f(d.filter(k=>k.id!==a.id)),M("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]},a.id))})]})]})]}):e.jsx("div",{className:"muted",style:{padding:"20px",textAlign:"center",border:"1px dashed var(--border)",borderRadius:"12px"},children:"Select a user to view details and uploads."})]})}),e.jsx("div",{className:"panel message",hidden:y!=="message",children:e.jsxs("div",{className:"col",style:{gap:24,paddingTop:16},children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{fontSize:"18px",marginBottom:8},children:"Send a system message"}),e.jsxs("div",{className:"row",style:{gap:8},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:o,onChange:a=>n(a.target.value),onKeyDown:a=>{a.key==="Enter"&&A()},className:"moderation-input"}),e.jsx("button",{className:"btn secondary",onClick:A,style:{minHeight:"44px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:12,maxHeight:"30vh"},children:e.jsx("div",{className:"col",style:{gap:8},children:u.map(a=>e.jsxs("button",{className:`moderation-user-result ${(m==null?void 0:m.id)===a.id?"selected":""}`,onClick:()=>j(a),children:[a.avatar_url&&e.jsx("img",{src:a.avatar_url,width:32,height:32,style:{borderRadius:"50%",flexShrink:0}}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0,gap:2,alignItems:"flex-start"},children:[e.jsx("span",{style:{fontWeight:500},children:a.username}),e.jsxs("span",{className:"muted",style:{fontSize:12},children:["id ",a.id," • osu ",a.osu_user_id]})]}),(m==null?void 0:m.id)===a.id&&e.jsx("span",{className:"chip info",children:"selected"})]},a.id))})})]}),e.jsxs("div",{className:"col",style:{minWidth:0,borderTop:"1px solid var(--divider)",paddingTop:24,gap:16},children:[e.jsx("div",{className:"title",style:{fontSize:"18px"},children:"Compose"}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:12,padding:"8px 0"},children:[e.jsx("input",{type:"checkbox",checked:N,onChange:a=>q(a.currentTarget.checked),style:{width:20,height:20,cursor:"pointer",minWidth:20,minHeight:20}}),e.jsx("span",{className:"muted",style:{fontSize:14},children:"Send to all users (global)"})]}),e.jsx("textarea",{placeholder:"Message (shown in notifications)",className:"moderation-input",style:{height:120,resize:"vertical",fontFamily:"inherit"},value:S,onChange:a=>_(a.target.value)}),e.jsx("button",{className:"btn primary",style:{width:"100%",minHeight:"44px"},onClick:()=>{const a=(S||"").trim();if(!a){alert("Enter a message");return}(async()=>{try{const k={text:a,global:N};!N&&(m!=null&&m.id)&&(k.user_id=m.id),await F(I.admin.notificationsSystem,{method:"POST",body:JSON.stringify(k)}),_(""),M("Message sent",{variant:"success"})}catch{alert("Failed to send")}})()},children:"Send"}),e.jsx("div",{className:"caption",style:{marginTop:4,fontSize:12,lineHeight:1.4},children:'System messages persist for 24 hours and show an "Expires at" timestamp.'})]})]})}),e.jsx("div",{className:"panel analytics",hidden:y!=="analytics",children:e.jsxs("div",{className:"col",style:{gap:24,paddingTop:16},children:[e.jsx("div",{className:"title",style:{fontSize:"18px"},children:"Analytics"}),Q&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"Loading…"}),!Q&&!l&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"No data."}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"moderation-stats-grid",children:[e.jsx(ee,{label:"Users",value:l.totals.users_total}),e.jsx(ee,{label:"Admins",value:l.totals.users_admin}),e.jsx(ee,{label:"Mods",value:l.totals.users_mod}),e.jsx(ee,{label:"Blacklisted",value:l.totals.users_blacklisted}),e.jsx(ee,{label:"Videos",value:l.totals.videos_total}),e.jsx(ee,{label:"Ready",value:l.totals.videos_ready}),e.jsx(ee,{label:"Pending",value:l.totals.pending_count}),e.jsx(ee,{label:"Purgatory",value:l.totals.purgatory_count}),e.jsx(ee,{label:"Likes",value:l.totals.likes_total}),e.jsx(ee,{label:"Flags",value:l.totals.flags_total})]}),e.jsxs("div",{className:"col",style:{gap:20,marginTop:8},children:[e.jsx(we,{title:"New users (30d)",series:l.series.users,color:"#60a5fa"}),e.jsx(we,{title:"New videos (30d)",series:l.series.videos,color:"#34d399"}),(P=(z=l.stream)==null?void 0:z.graphql)!=null&&P.minutes_viewed?e.jsx(we,{title:"Minutes viewed (30d)",series:l.stream.graphql.minutes_viewed,color:"#f59e0b"}):e.jsxs("div",{className:"moderation-chart-card",children:[e.jsxs("div",{className:"row",style:{alignItems:"baseline",justifyContent:"space-between",marginBottom:12,flexWrap:"wrap",gap:4},children:[e.jsx("div",{className:"muted",style:{fontSize:te()?13:14},children:"Minutes viewed (30d)"}),e.jsx("div",{className:"muted",style:{fontSize:te()?11:12},children:"Data unavailable"})]}),e.jsxs("div",{className:"col",style:{padding:"24px",gap:12},children:[e.jsx("div",{className:"muted",style:{textAlign:"center",fontSize:14},children:"Minutes viewed data is not currently available."}),((ne=(O=l.stream)==null?void 0:O.graphql)==null?void 0:ne.errors)&&Array.isArray(l.stream.graphql.errors)&&l.stream.graphql.errors.length>0&&e.jsxs("div",{className:"col",style:{gap:8,padding:"12px",background:"var(--panel-dark)",borderRadius:8,border:"1px solid var(--border)"},children:[e.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:600,color:"var(--danger)"},children:"Error details:"}),l.stream.graphql.errors.map((a,k)=>e.jsx("div",{className:"muted",style:{fontSize:11,lineHeight:1.5,fontFamily:"monospace"},children:typeof a=="string"?a:(a==null?void 0:a.message)||JSON.stringify(a)},k)),((ue=(de=l.stream)==null?void 0:de.graphql)==null?void 0:ue.raw)&&e.jsxs("div",{className:"col",style:{gap:4,marginTop:8,paddingTop:8,borderTop:"1px solid var(--border)"},children:[e.jsx("div",{className:"muted",style:{fontSize:11,fontWeight:600},children:"Debug info:"}),l.stream.graphql.raw.account_keys&&l.stream.graphql.raw.account_keys.length>0&&e.jsxs("div",{className:"muted",style:{fontSize:10,fontFamily:"monospace"},children:["Available account fields: ",l.stream.graphql.raw.account_keys.join(", ")]}),l.stream.graphql.raw.response_sample&&e.jsxs("details",{style:{fontSize:10},children:[e.jsx("summary",{className:"muted",style:{cursor:"pointer",marginTop:4},children:"Response sample"}),e.jsx("pre",{style:{fontSize:9,overflow:"auto",maxHeight:"200px",marginTop:4,padding:8,background:"rgba(0,0,0,0.2)",borderRadius:4},children:l.stream.graphql.raw.response_sample})]})]})]}),!((me=l.stream)!=null&&me.graphql)&&e.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",padding:"8px",background:"var(--panel-dark)",borderRadius:8},children:"GraphQL API not configured. Set CF_GRAPHQL_API_TOKEN secret."})]})]})]}),e.jsxs("div",{className:"col",style:{gap:8,marginTop:8},children:[e.jsx("div",{className:"title",style:{fontSize:"18px"},children:"Feed & Stream"}),e.jsxs("div",{className:"muted",style:{fontSize:14,lineHeight:1.5},children:["Feed: ",l.feed.count," items in rotation",l.feed.cursor?` • cursor ${l.feed.cursor}`:""]}),e.jsxs("div",{className:"muted",style:{fontSize:14,lineHeight:1.5},children:["Approx. ready seconds: ",l.stream.approximate.total_duration_sec," • ready videos: ",l.stream.approximate.videos_ready]}),l.stream.api&&e.jsxs("div",{className:"muted",style:{fontSize:12,lineHeight:1.5},children:["Stream API: ",l.stream.api.ok?"ok":"unavailable",(he=(pe=l.stream.api)==null?void 0:pe.result_info)!=null&&he.count?` • count ${l.stream.api.result_info.count}`:"",(ae=l.stream.api)!=null&&ae.sample_status?` • sample status ${String(l.stream.api.sample_status)}`:""]})]})]})]})})]})]})]})}function ee({label:t,value:i}){return e.jsxs("div",{className:"moderation-stat-card",children:[e.jsx("div",{className:"mod-stat-label",children:t}),e.jsx("div",{className:"mod-stat-value",children:i})]})}function we({title:t,series:i,color:s}){const[r,o]=w.useState(()=>te()),n=x.useRef(null),[u,v]=w.useState(400);w.useEffect(()=>{const T=()=>{if(o(te()),n.current){const A=n.current.offsetWidth-48;v(Math.max(300,A))}};T();let L=null;return n.current&&typeof ResizeObserver<"u"&&(L=new ResizeObserver(T),L.observe(n.current)),window.addEventListener("resize",T),()=>{window.removeEventListener("resize",T),L&&n.current&&L.unobserve(n.current)}},[]);const m=r?Math.min(400,Math.max(300,window.innerWidth-48)):Math.max(400,Math.min(1e3,u)),j=160,d=8,f=8,E=28,C=r?36:42,y=i.map(T=>T.count),p=Math.max(1,...y),b=w.useMemo(()=>{const T=p,L=Math.pow(10,Math.floor(Math.log10(T))),A=T/L;return(A<=1?1:A<=2?2:A<=5?5:10)*L},[p]),c=m-C-f,S=j-d-E,_=w.useMemo(()=>i.map((T,L)=>{const A=C+L/Math.max(1,i.length-1)*c,W=d+(1-T.count/(b||1))*S;return[A,W]}),[i,b,c,S]),N=w.useMemo(()=>_.map((T,L)=>L===0?`M ${T[0]} ${T[1]}`:`L ${T[0]} ${T[1]}`).join(" "),[_]),q=[0,.25,.5,.75,1],M=w.useMemo(()=>{if(i.length===0)return[];const T=[0,.25,.5,.75,1].map(L=>Math.min(i.length-1,Math.round(L*(i.length-1))));return Array.from(new Set(T))},[i]),l=T=>{if(!T||T.length<10)return T||"";const L=T.slice(5,7).replace(/^0/,""),A=T.slice(8,10).replace(/^0/,"");return`${L}/${A}`};function R(T){const L=Number.isInteger(T);return T>=1e6?`${(T/1e6).toFixed(1).replace(/\.0$/,"")}M`:T>=1e3?`${(T/1e3).toFixed(1).replace(/\.0$/,"")}k`:L?String(T):T<10?T.toFixed(1):T.toFixed(1).replace(/\.0$/,"")}const Q=i.length?i[i.length-1].count:0;return e.jsxs("div",{className:"moderation-chart-card",ref:n,children:[e.jsxs("div",{className:"row",style:{alignItems:"baseline",justifyContent:"space-between",marginBottom:12,flexWrap:"wrap",gap:4},children:[e.jsx("div",{className:"muted",style:{fontSize:r?13:14},children:t}),e.jsxs("div",{className:"muted",style:{fontSize:r?11:12},children:["latest: ",R(Q)]})]}),e.jsx("div",{style:{width:"100%"},children:e.jsxs("svg",{width:m,height:j,role:"img","aria-label":t,style:{display:"block",width:`${m}px`,height:`${j}px`,maxWidth:"100%"},children:[e.jsx("rect",{x:0,y:0,width:m,height:j,rx:12,style:{fill:"var(--panel-dark)"}}),q.map((T,L)=>{const A=d+(1-T)*S,W=T*b;return e.jsxs("g",{children:[e.jsx("line",{x1:C,y1:A,x2:m-f,y2:A,strokeWidth:1,style:{stroke:"var(--divider)"}}),e.jsx("text",{x:C-6,y:A+4,textAnchor:"end",fontSize:10,style:{fill:"var(--muted)"},children:R(W)})]},L)}),e.jsx("line",{x1:C,y1:d,x2:C,y2:d+S,strokeWidth:1,style:{stroke:"var(--border-strong)"}}),e.jsx("line",{x1:C,y1:d+S,x2:C+c,y2:d+S,strokeWidth:1,style:{stroke:"var(--border-strong)"}}),M.map((T,L)=>{var W;const A=C+T/Math.max(1,i.length-1)*c;return e.jsxs("g",{children:[e.jsx("line",{x1:A,y1:d,x2:A,y2:d+S,strokeWidth:1,style:{stroke:"var(--divider)"}}),e.jsx("text",{x:A,y:d+S+12,textAnchor:"middle",fontSize:10,style:{fill:"var(--muted)"},children:l((W=i[T])==null?void 0:W.day)})]},L)}),e.jsx("path",{d:N,fill:"none",stroke:s,strokeWidth:2}),_.length>0&&e.jsx("circle",{cx:_[_.length-1][0],cy:_[_.length-1][1],r:3,fill:s})]})})]})}function _s(){return e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsxs("div",{className:"title",style:{fontSize:"2em"},children:["mappi! ",e.jsx("span",{style:{fontSize:"0.4em",fontWeight:"normal"},children:"by Catawba."})]}),e.jsx("div",{className:"muted",children:"Hi, I get writers block/lose motivation very very easily. I want this site to counterract that."}),e.jsx("div",{className:"muted",children:"Basically, when you are struggling to come up with ideas; you'd hop on this site, watch a few videos, see something that impresses you, then hopefully you can get back to mapping with a lil' bit of inspiration."}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"How it works:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Log in with your osu! account."}),e.jsx("li",{children:"Upload a clip (100MB max). Allow for it to upload/process."}),e.jsx("li",{children:"Uploaded clips enter the random feed. New uploads and liked videos surface more often."}),e.jsx("li",{children:"Moderators can review reports and pending items for safety."})]})]}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"Guidelines:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"You can post two clips every 24 hours before getting rate-limited."}),e.jsx("li",{children:"Keep clips 4:3 or 16:9 for best fit. Ultrawide will letterbox."}),e.jsx("li",{children:"Add a short description and (optional) beatmap link."}),e.jsx("li",{children:"Don't post unrelated content."}),e.jsx("li",{children:"Report posts accordingly and within reason."})]})]})]})}function Ls(t){const i="=".repeat((4-t.length%4)%4),s=(t+i).replace(/-/g,"+").replace(/_/g,"/"),r=atob(s),o=new Uint8Array(r.length);for(let n=0;n<r.length;n++)o[n]=r.charCodeAt(n);return o}async function xe(){return!("serviceWorker"in navigator)||!("PushManager"in window)?null:(await navigator.serviceWorker.ready).pushManager.getSubscription()}async function Ps(){try{const t=await fetch(`${be}/api/push/public_key`,{credentials:"include"});if(!t.ok)return null;const i=await t.json().catch(()=>null);return i&&typeof i.publicKey=="string"?i.publicKey:null}catch{return null}}async function Ms(t){if(!("Notification"in window)||!("serviceWorker"in navigator)||!("PushManager"in window)||await Notification.requestPermission()!=="granted")return!1;const s=await navigator.serviceWorker.ready;let r=await s.pushManager.getSubscription();r||(r=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ls(t)}));try{await F(I.user.pushSubscribe,{method:"POST",body:JSON.stringify({...r.toJSON(),ua:navigator.userAgent})})}catch{}return!0}async function zs(){const t=await xe();if(!t)return!0;try{await F(I.user.pushUnsubscribe,{method:"POST",body:JSON.stringify({endpoint:t.endpoint})})}catch{}try{await t.unsubscribe()}catch{}return!0}function Is(){const{theme:t,setTheme:i}=se(),{data:s}=re(),{notify:r}=ce(),[o,n]=x.useState("general"),[u,v]=x.useState(!1),[m,j]=x.useState(!1),[d,f]=x.useState(!1),[E,C]=x.useState(typeof Notification<"u"?Notification.permission:"default"),y=p=>{i(p),Ue(p)};return x.useEffect(()=>{v(typeof window<"u"&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window),j(ke()),xe().then(p=>f(!!p)).catch(()=>f(!1)),typeof Notification<"u"&&C(Notification.permission)},[]),e.jsxs("div",{className:"settings-container",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("div",{className:"settings-title",children:"Settings"}),e.jsx("div",{className:"settings-description",children:"Personalize appearance and app behavior."})]}),e.jsxs("div",{className:"profile-tabs-unified",role:"region","aria-label":"Settings",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Settings tabs",children:[e.jsx("button",{role:"tab","aria-selected":o==="general",className:`profile-tab ${o==="general"?"active":""}`,"data-tab":"general",onClick:p=>{const b=p.currentTarget.closest(".profile-tabs-unified"),c=b==null?void 0:b.querySelector(".profile-tabs-content");c==null||c.setAttribute("data-active","general"),n("general")},children:"General"}),e.jsx("button",{role:"tab","aria-selected":o==="notifications",className:`profile-tab ${o==="notifications"?"active":""}`,"data-tab":"notifications",onClick:p=>{const b=p.currentTarget.closest(".profile-tabs-unified"),c=b==null?void 0:b.querySelector(".profile-tabs-content");c==null||c.setAttribute("data-active","notifications"),n("notifications")},children:"Notifications"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":o,children:[e.jsx("div",{className:"panel general",hidden:o!=="general",children:e.jsxs("div",{className:"settings-card",children:[e.jsxs("div",{className:"settings-section-header",children:[e.jsx("h3",{className:"settings-section-title",children:"Appearance"}),e.jsx("span",{className:"settings-section-desc",children:"Customize how the app looks on this device."})]}),e.jsxs("div",{className:"settings-row",children:[e.jsxs("div",{className:"settings-info",children:[e.jsx("span",{className:"settings-label",children:"Theme"}),e.jsx("span",{className:"settings-sublabel",children:"Select your preferred color scheme"})]}),e.jsx("div",{className:"settings-action",children:e.jsxs("div",{className:"theme-toggle-group",role:"group","aria-label":"Theme selection",children:[e.jsx("button",{type:"button",className:`theme-toggle-btn ${t==="dark"?"active":""}`,"aria-pressed":t==="dark",onClick:()=>y("dark"),children:"Dark"}),e.jsx("button",{type:"button",className:`theme-toggle-btn ${t==="light"?"active":""}`,"aria-pressed":t==="light",onClick:()=>y("light"),children:"Light"})]})})]})]})}),e.jsx("div",{className:"panel notifications",hidden:o!=="notifications",children:e.jsxs("div",{className:"col",style:{gap:24},children:[e.jsxs("div",{className:"settings-card",children:[e.jsxs("div",{className:"settings-section-header",children:[e.jsx("h3",{className:"settings-section-title",children:"Push Notifications"}),e.jsx("span",{className:"settings-section-desc",children:"Manage push alerts for this device."})]}),!u&&e.jsx("div",{className:"settings-hint",children:"Push notifications are not supported on this device."}),u&&e.jsxs("div",{className:"settings-row",children:[e.jsxs("div",{className:"settings-info",children:[e.jsx("span",{className:"settings-label",children:"Push Alerts"}),e.jsx("span",{className:"settings-sublabel",children:E==="granted"&&d?"Enabled on this device":"Disabled on this device"}),!m&&e.jsx("div",{className:"settings-hint",style:{marginTop:4},children:"On iOS, install the app to your Home Screen to enable push."})]}),e.jsx("div",{className:"settings-action",children:E!=="granted"||!d?e.jsx("button",{className:"btn primary compact",onClick:async()=>{const p=await Ps();if(!p)return;await Ms(p),C(typeof Notification<"u"?Notification.permission:"default");const b=await xe();f(!!b)},title:m?void 0:"On iOS, install as PWA to enable",children:"Enable"}):e.jsx("button",{className:"btn secondary compact",onClick:async()=>{await zs();const p=await xe();f(!!p),C(typeof Notification<"u"?Notification.permission:"default")},children:"Disable"})})]})]}),e.jsxs("div",{className:"settings-card",children:[e.jsxs("div",{className:"settings-section-header",children:[e.jsx("h3",{className:"settings-section-title",children:"Preferences"}),e.jsx("span",{className:"settings-section-desc",children:"Choose which activities trigger notifications."})]}),e.jsx(Rs,{})]})]})})]})]})]})}function Rs(){const{notify:t}=ce(),[i,s]=x.useState(!0),[r,o]=x.useState(!1),[n,u]=x.useState({star:!0,likes5:!0,comment:!0,inspiration:!0,reaction:!0,system:!0,invites:!0});x.useEffect(()=>{(async()=>{s(!0);try{const d=await F(I.user.notifPrefs,{requireAuth:!0});d&&d.prefs&&u(f=>({...f,...d.prefs}))}finally{s(!1)}})()},[]);async function v(d){o(!0);try{await F(I.user.notifPrefs,{method:"POST",body:JSON.stringify(d)}),t("Preferences saved",{variant:"success"})}catch(f){t((f==null?void 0:f.message)||"Failed to save",{variant:"error"})}finally{o(!1)}}function m(d){const f={...n,[d]:!n[d]};u(f),v(f)}const j=({k:d,label:f,desc:E})=>e.jsxs("div",{className:"settings-row",children:[e.jsxs("div",{className:"settings-info",children:[e.jsx("span",{className:"settings-label",children:f}),E&&e.jsx("span",{className:"settings-sublabel",children:E})]}),e.jsx("div",{className:"settings-action",children:e.jsxs("label",{className:"settings-toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:n[d],onChange:()=>m(d),"aria-label":`Toggle ${f}`}),e.jsx("span",{className:"settings-toggle-slider"})]})})]});return i?e.jsx("div",{className:"settings-hint",children:"Loading preferences…"}):e.jsxs(e.Fragment,{children:[e.jsx(j,{k:"star",label:"Stars",desc:"When someone stars your map"}),e.jsx(j,{k:"likes5",label:"Likes milestone",desc:"When you reach 5+ likes"}),e.jsx(j,{k:"comment",label:"Comments",desc:"When someone comments on your post"}),e.jsx(j,{k:"inspiration",label:"Inspirations",desc:"When someone is inspired by you"}),e.jsx(j,{k:"reaction",label:"Reactions",desc:"When someone reacts to your comment"}),e.jsx(j,{k:"invites",label:"Queue invitations",desc:"When you are invited to a queue"}),e.jsx(j,{k:"system",label:"System messages",desc:"Important announcements"}),r&&e.jsx("div",{className:"settings-hint",style:{marginTop:8},children:"Saving…"})]})}const Fs=()=>(w.useEffect(()=>()=>{es.clearAll()},[]),e.jsx(ts,{}));function Ds(){const[t,i]=x.useState({mobile:!1,standalone:!1,platform:""}),[s,r]=x.useState("ios");return x.useEffect(()=>{const o=typeof navigator<"u"&&navigator.userAgent||"",n=/iPad|iPhone|iPod/i.test(o)||/(Macintosh).*Mobile/.test(o),u=/Android/i.test(o),v=n?"ios":u?"android":"other";i({mobile:te(),standalone:!1,platform:v}),r(v==="android"?"android":"ios")},[]),e.jsx("div",{className:"feed-container",style:{width:"100%",maxWidth:600,margin:"0 auto",padding:"0 16px"},children:e.jsxs("div",{className:"feed-header",style:{paddingTop:12,paddingBottom:0},children:[e.jsxs("div",{className:"moderation-header",children:[e.jsx("div",{className:"moderation-title",children:"Install osumapp.ing"}),e.jsx("div",{className:"muted moderation-description",children:"Add this app to your home screen for a faster, fullscreen experience."})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Install tabs",style:{display:"flex",gap:4},children:[e.jsx("button",{role:"tab","aria-selected":s==="ios",className:`profile-tab ${s==="ios"?"active":""}`,"data-tab":"ios",onClick:o=>{const n=o.currentTarget.closest(".profile-tabs-unified");n.querySelectorAll(".profile-tab").forEach(v=>{v.classList.remove("active"),v.setAttribute("aria-selected","false")}),o.currentTarget.classList.add("active"),o.currentTarget.setAttribute("aria-selected","true"),n.querySelector(".profile-tabs-content").setAttribute("data-active","ios"),r("ios")},children:"iOS"}),e.jsx("button",{role:"tab","aria-selected":s==="android",className:`profile-tab ${s==="android"?"active":""}`,"data-tab":"android",onClick:o=>{const n=o.currentTarget.closest(".profile-tabs-unified");n.querySelectorAll(".profile-tab").forEach(v=>{v.classList.remove("active"),v.setAttribute("aria-selected","false")}),o.currentTarget.classList.add("active"),o.currentTarget.setAttribute("aria-selected","true"),n.querySelector(".profile-tabs-content").setAttribute("data-active","android"),r("android")},children:"Android"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":s,children:[e.jsx("div",{className:"panel",hidden:s!=="ios",children:e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"iOS (Safari)"}),e.jsxs("ol",{style:{paddingLeft:18,margin:0,lineHeight:1.7},children:[e.jsx("li",{children:"Open this site in Safari."}),e.jsx("li",{children:"Tap the Share button."}),e.jsx("li",{children:"Select “Add to Home Screen”."}),e.jsx("li",{children:"Tap “Add” to confirm."})]})]})}),e.jsx("div",{className:"panel",hidden:s!=="android",children:e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Android (Chrome)"}),e.jsxs("ol",{style:{paddingLeft:18,margin:0,lineHeight:1.7},children:[e.jsx("li",{children:"Open the browser menu (⋮) in Chrome."}),e.jsx("li",{children:"Choose “Install app” or “Add to Home screen”."}),e.jsx("li",{children:"Confirm to add it."})]})]})})]})]})]})})}const Ws=x.lazy(()=>is(()=>import("./Discover-DEB31-Wg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));ks("dark");Lt();"serviceWorker"in navigator&&window.addEventListener("load",()=>{const t=encodeURIComponent(be);navigator.serviceWorker.register(`/sw.js?api=${t}`).then(i=>{console.log("Service Worker registered successfully:",i.scope)}).catch(i=>{console.error("Service Worker registration failed:",i)})});const qs=()=>e.jsx(Et,{children:e.jsxs(K,{element:e.jsx(js,{}),children:[e.jsx(K,{path:"/",element:e.jsx(Ss,{})}),e.jsx(K,{path:"/mp/discover",element:e.jsx(w.Suspense,{fallback:e.jsx("div",{style:{padding:"48px",textAlign:"center"},children:"Loading..."}),children:e.jsx(Ws,{})})}),e.jsx(K,{path:"/mp/feed",element:e.jsx(Cs,{})}),e.jsx(K,{path:"/mp/feed/:uid",element:e.jsx(Mt,{})}),e.jsx(K,{path:"/md/feed",element:e.jsx(Ut,{})}),e.jsx(K,{path:"/md/feed/:uid",element:e.jsx(Ht,{})}),e.jsx(K,{path:"/md/queues",element:e.jsx(Ot,{})}),e.jsx(K,{path:"/md/queues/:id",element:e.jsx(Qt,{})}),e.jsx(K,{path:"/md/me/submissions",element:e.jsx(Jt,{})}),e.jsx(K,{path:"/notifications",element:e.jsx(Gt,{})}),e.jsx(K,{path:"/profile",element:e.jsx(Re,{})}),e.jsx(K,{path:"/profile/:id",element:e.jsx(Re,{})}),e.jsx(K,{path:"/moderation",element:e.jsx(As,{})}),e.jsx(K,{path:"/about",element:e.jsx(_s,{})}),e.jsx(K,{path:"/settings",element:e.jsx(Is,{})}),e.jsx(K,{path:"/mobile",element:e.jsx(Ds,{})}),e.jsx(K,{path:"/editor",element:e.jsx(Fs,{})})]})}),$s=()=>e.jsx(Ct,{children:e.jsx(qs,{})});St(document.getElementById("root")).render(e.jsx(rs,{children:e.jsx(Tt,{client:ns,children:e.jsx(Pt,{children:e.jsx($s,{})})})}));export{ls as B,is as _};
