import{r as o,j as e,d as jt,u as he,e as be,f as Se,g as st,R as G,c as fe,h as ve,i as de,k as $e,l as Ue,m as He,n as ue,o as we,p as Me,q as wt,s as St,t as at,v as kt,w as je,x as ze,y as Nt,L as Ie,z as nt,A as Tt,M as _t,B as Ye,C as Je,D as Xe,E as Ge,G as ge,H as Ke,I as Ve,J as Ct,K as qt,N as zt}from"./vendor-react-BUPocPCH.js";import{B as Ft}from"./editor-MZP5zgVH.js";function rt(){if(typeof window>"u")return!1;try{const t=navigator.userAgentData;if(t&&typeof t.mobile=="boolean"&&t.mobile||window.matchMedia&&(window.matchMedia("(pointer: coarse)").matches||window.matchMedia("(hover: none)").matches))return!0;const s=navigator.userAgent||"";if(/Android|iPhone|iPad|iPod|Mobile|Silk|Kindle|Opera Mini|IEMobile|WPDesktop/i.test(s))return!0}catch{}return!1}function as(){var c;if(typeof window>"u"||typeof document>"u")return()=>{};const t=()=>{const i=rt();document.documentElement.classList.toggle("is-mobile",i),document.documentElement.setAttribute("data-mobile",i?"true":"false")};t();const s=["(pointer: coarse)","(hover: none)","(orientation: landscape)","(orientation: portrait)"],a=[];try{for(const i of s)if(window.matchMedia){const p=window.matchMedia(i);(c=p.addEventListener)==null||c.call(p,"change",t),a.push(p)}}catch{}return window.addEventListener("resize",t),()=>{try{a.forEach(i=>{var p;return(p=i.removeEventListener)==null?void 0:p.call(i,"change",t)}),window.removeEventListener("resize",t)}catch{}}}function ns(){if(typeof window>"u")return!1;try{const t=navigator.standalone===!0,s=window.matchMedia&&window.matchMedia("(display-mode: standalone)"),a=!!(s&&s.matches),c=window.matchMedia&&window.matchMedia("(display-mode: minimal-ui)"),i=window.matchMedia&&window.matchMedia("(display-mode: fullscreen)");return t||a||!!(c&&c.matches)||!!(i&&i.matches)}catch{return!1}}const it=o.createContext(null);function rs({children:t}){const[s,a]=o.useState([]),c=o.useRef(1),i=o.useRef(new Map),p=l=>{const b=i.current.get(l);b&&(clearTimeout(b),i.current.delete(l))},m=(l,b)=>{p(l);const S=window.setTimeout(()=>x(l),b);i.current.set(l,S)},x=o.useCallback(l=>{p(l),a(b=>b.filter(S=>S.id!==l))},[]),v=o.useCallback((l,b)=>{const S=typeof b=="number"?b:(b==null?void 0:b.durationMs)??5e3,q=typeof b=="number"?"info":(b==null?void 0:b.variant)??"info",_=rt();let w=null;return a(_?B=>{const R=B[0];if(R&&R.message===l&&R.variant===q){const y={...R,count:R.count+1,duration:S};return w=y.id,[y]}B.forEach(y=>p(y.id));const W=c.current++,N={id:W,message:l,duration:S,variant:q,count:1};return w=W,[N]}:B=>{const R=B.findIndex(y=>y.message===l&&y.variant===q);if(R!==-1){const y=[...B],T={...y[R],count:y[R].count+1};return y[R]=T,w=T.id,y}const W=c.current++,N={id:W,message:l,duration:S,variant:q,count:1};return w=W,[...B,N]}),w!=null&&m(w,S),w??-1},[]),k=o.useMemo(()=>({notify:v,close:x}),[v,x]);return e.jsxs(it.Provider,{value:k,children:[t,e.jsx("div",{className:"toasts",children:s.map(l=>e.jsxs("div",{className:`toast ${l.variant}`,children:[e.jsxs("div",{className:"toast-text",children:[l.message,l.count>1&&e.jsxs("span",{style:{marginLeft:6,opacity:.8},children:["×",l.count]})]}),e.jsx("button",{className:"toast-close",onClick:()=>x(l.id),"aria-label":"Close",children:"×"})]},l.id))})]})}function me(){const t=o.useContext(it);if(!t)throw new Error("useToasts must be used within ToastProvider");return t}const Mt=()=>{try{const t=localStorage.getItem("filter_modes")||"standard",s=new Set(t.toLowerCase().split(",").map(a=>a.trim()).filter(Boolean));return{standard:!0,taiko:!0,mania:!0,catch:!0}}catch{return{standard:!0,taiko:!0,mania:!0,catch:!0}}},It=()=>{try{const t=localStorage.getItem("filter_moddi_tags")||"untagged,help,showcase,request",s=new Set(t.toLowerCase().split(",").map(a=>a.trim()).filter(Boolean));return{untagged:s.has("untagged")||s.size===0,help:s.has("help")||s.size===0,showcase:s.has("showcase")||s.size===0,request:s.has("request")||s.size===0}}catch{return{untagged:!0,help:!0,showcase:!0,request:!0}}},Rt=()=>{try{const t=localStorage.getItem("filter_queue_status")||"unchecked,accepted,denied,finished",s=new Set(t.toLowerCase().split(",").map(a=>a.trim()).filter(Boolean));return{unchecked:s.has("unchecked")||s.size===0,accepted:s.has("accepted")||s.size===0,denied:s.has("denied")||s.size===0,finished:s.has("finished")||s.size===0,archived:s.has("archived")}}catch{return{unchecked:!0,accepted:!0,denied:!0,finished:!0,archived:!1}}},Et=()=>{try{const t=localStorage.getItem("filter_queue_open")||"open",s=new Set(t.toLowerCase().split(",").map(a=>a.trim()).filter(Boolean));return{open:s.has("open")||s.size===0,closed:s.has("closed")}}catch{return{open:!0,closed:!1}}},Lt=()=>{try{const t=localStorage.getItem("filter_queue_type")||"modder,nominator",s=new Set(t.toLowerCase().split(",").map(a=>a.trim()).filter(Boolean));return{modder:s.has("modder")||s.size===0,nominator:s.has("nominator")||s.size===0}}catch{return{modder:!0,nominator:!0}}},At=()=>{try{const t=localStorage.getItem("last_section");return t==="mappi"||t==="moddi"?t:null}catch{return null}},Pt=()=>{try{return localStorage.getItem("theme")==="light"?"light":"dark"}catch{return"dark"}},ke=jt(t=>({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1,modeFilters:Mt(),tagFilters:It(),queueStatusFilters:Rt(),queueOpenFilters:Et(),queueTypeFilters:Lt(),lastSection:At(),previousLocation:null,theme:Pt(),setMenuOpen:s=>t({menuOpen:s}),setMobileNavOpen:s=>t({mobileNavOpen:s}),setNotifOpen:s=>t({notifOpen:s}),closeAllPanels:()=>t({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1}),setModeFilters:s=>{t({modeFilters:s});try{const c=Object.entries(s).filter(([p,m])=>m).map(([p])=>p),i=c.length?c:["standard"];localStorage.setItem("filter_modes",i.join(","))}catch{}},setTagFilters:s=>{t({tagFilters:s});try{const c=Object.entries(s).filter(([p,m])=>m).map(([p])=>p),i=c.length?c:["untagged","help","showcase","request"];localStorage.setItem("filter_moddi_tags",i.join(","))}catch{}},setQueueStatusFilters:s=>{t({queueStatusFilters:s});try{const c=Object.entries(s).filter(([p,m])=>m).map(([p])=>p),i=c.length?c:["unchecked","accepted","denied","finished"];localStorage.setItem("filter_queue_status",i.join(","))}catch{}},setQueueOpenFilters:s=>{t({queueOpenFilters:s});try{const c=Object.entries(s).filter(([p,m])=>m).map(([p])=>p),i=c.length?c:["open"];localStorage.setItem("filter_queue_open",i.join(","))}catch{}},setQueueTypeFilters:s=>{t({queueTypeFilters:s});try{const c=Object.entries(s).filter(([p,m])=>m).map(([p])=>p),i=c.length?c:["modder","nominator"];localStorage.setItem("filter_queue_type",i.join(","))}catch{}},setLastSection:s=>{t({lastSection:s});try{s?localStorage.setItem("last_section",s):localStorage.removeItem("last_section")}catch{}},setPreviousLocation:s=>{t({previousLocation:s})},setTheme:s=>{t({theme:s});try{localStorage.setItem("theme",s)}catch{}}})),ot="https://api.osumappi.ng";function lt(){var t;try{return((t=document.cookie.split("; ").map(s=>s.split("=")).find(([s])=>s==="csrf"))==null?void 0:t[1])||""}catch{return""}}async function M(t,s={}){const{requireAuth:a=!0,skipCsrf:c=!1,...i}=s,p={...i.headers};if(i.body&&!p["Content-Type"]&&(p["Content-Type"]="application/json"),a&&!c){const x=lt();x&&(p["X-CSRF-Token"]=x)}const m=await fetch(`${ot}${t}`,{...i,credentials:"include",headers:p});if(!m.ok){const x=await m.json().catch(()=>({error:`HTTP ${m.status}`}));throw new Error(x.error||`HTTP ${m.status}: ${m.statusText}`)}return m.json()}function Bt(t){const s=new URLSearchParams;for(const[c,i]of Object.entries(t))i!=null&&s.append(c,String(i));const a=s.toString();return a?`?${a}`:""}const I={auth:{login:"/api/auth/login",logout:"/api/auth/logout",me:"/api/me"},user:{quota:"/api/me/upload_quota",notifications:"/api/me/notifications",markNotificationsRead:"/api/me/notifications/mark_read",deleteNotification:t=>`/api/me/notifications/${encodeURIComponent(t)}`,pushSubscribe:"/api/me/push/subscribe",pushUnsubscribe:"/api/me/push/unsubscribe",pushList:"/api/me/push/subscriptions",pushTest:"/api/me/push/test",notifPrefs:"/api/me/notification_prefs"},feed:{next:"/api/feed/next",batch:"/api/feed/batch",progress:t=>`/api/feed/progress${t?`?modes=${encodeURIComponent(t)}`:""}`,recent:"/api/videos/recent"},videos:{like:t=>`/api/videos/${t}/like`,view:t=>`/api/videos/${t}/view`,update:t=>`/api/videos/${t}`,delete:t=>`/api/videos/${t}`,flag:t=>`/api/videos/${t}/flag`,comments:t=>`/api/videos/${t}/comments`,get:t=>`/api/videos/${t}`},uploads:{new:"/api/uploads/new"},moddi:{mySubmissions:"/api/moddi/me/submissions",posts:"/api/moddiposts",post:t=>`/api/moddiposts/${t}`,postReact:t=>`/api/moddiposts/${t}/react`,postComments:t=>`/api/moddiposts/${t}/comments`,queues:"/api/moddi/queues",queue:t=>`/api/moddi/queues/${t}`,queueSubmit:t=>`/api/moddi/queues/${t}/submit`,queueAccept:t=>`/api/moddi/queues/${t}/accept`,queueDeny:t=>`/api/moddi/queues/${t}/deny`,queueInvite:t=>`/api/moddi/queues/${t}/invite`,queueMember:(t,s)=>`/api/moddi/queues/${t}/members/${s}`,queueSubmission:(t,s)=>`/api/moddi/queues/${t}/submissions/${s}`,queueSubmissionDelete:(t,s)=>`/api/moddi/queues/${t}/submissions/${s}`,queueBlockUser:t=>`/api/moddi/queues/${t}/block`,queueUnblockUser:(t,s)=>`/api/moddi/queues/${t}/block/${s}`,queueBlockedUsers:t=>`/api/moddi/queues/${t}/blocked`,queueSubmissionAcknowledge:(t,s)=>`/api/moddi/queues/${t}/submissions/${s}/acknowledge`,queueSubmissionUnacknowledge:(t,s)=>`/api/moddi/queues/${t}/submissions/${s}/acknowledge`,usersSearch:t=>`/api/moddi/users/search?q=${encodeURIComponent(t)}`},osu:{resolveBeatmap:"/api/osu/beatmap/resolve",downloadBeatmapset:t=>`/api/osu/beatmapsets/${t}/download?noVideo=1`,usersSearch:t=>`/api/osu/users/search?q=${encodeURIComponent(t)}`},users:{get:t=>`/api/users/${t}`,videos:t=>`/api/users/${t}/videos`,likes:t=>`/api/users/${t}/likes`,myVideos:"/api/me/videos"},admin:{clearViews:"/api/admin/me/clear_views",debugState:"/api/debug/state",settingsModeration:"/api/admin/settings/moderation",videosPending:"/api/admin/videos/pending",videosApprove:t=>`/api/admin/videos/${t}/approve`,videosReject:t=>`/api/admin/videos/${t}/reject`,videosAction:(t,s)=>`/api/admin/videos/${t}/${s}`,analytics:"/api/admin/analytics",usersSearch:t=>`/api/admin/users/search?q=${encodeURIComponent(t)}`,userVideos:t=>`/api/admin/users/${t}/videos`,userUpdate:t=>`/api/admin/users/${t}`,notificationsSystem:"/api/admin/notifications/system",notificationsTest:"/api/admin/notifications/test"}};function Ot(t=!0){return he({queryKey:["notifications"],queryFn:async()=>{try{const s=await M(I.user.notifications);return Array.isArray(s.items)?s.items:[]}catch{return[]}},enabled:t,refetchInterval:45*1e3})}function Dt(){return he({queryKey:["notifications","detailed"],queryFn:async()=>{try{const t=await M("/api/me/notifications/detailed");return Array.isArray(t.items)?t.items:[]}catch{return[]}},refetchInterval:30*1e3})}function is(){const{data:t=[]}=Ot();return t.filter(s=>s.kind==="system"&&s.id.startsWith("b:")&&(s.expiresAt||0)<=Date.now()?!1:!s.read).length}function Wt(){const t=be();return Se({mutationFn:async s=>{await M(I.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:s})})},onSuccess:()=>{t.setQueryData(["notifications"],s=>(s==null?void 0:s.map(a=>({...a,read:!0})))||[])}})}function Qt(){const t=be();return Se({mutationFn:async s=>{const a=lt();await M(I.user.deleteNotification(s),{method:"DELETE",headers:{"X-CSRF-Token":a}})},onSuccess:(s,a)=>{t.setQueryData(["notifications"],c=>(c==null?void 0:c.filter(i=>i.id!==a))||[]),t.setQueryData(["notifications","detailed"],c=>(c==null?void 0:c.filter(i=>i.id!==a))||[])}})}function Re(){return he({queryKey:["user","me"],queryFn:async()=>{try{return await M(I.auth.me)}catch{return null}},staleTime:5*60*1e3})}function os(t=!0){return he({queryKey:["user","quota"],queryFn:async()=>{try{return await M(I.user.quota)}catch{return null}},enabled:t,refetchInterval:30*1e3})}function ls(){const t=be();return Se({mutationFn:async()=>{await M(I.auth.logout,{method:"POST"})},onSuccess:()=>{t.setQueryData(["user","me"],null),t.clear(),window.location.href="/"}})}function $t(t,s,a,c){o.useEffect(()=>{if(!a)return;const i=p=>{const m=p.target;s.current&&!s.current.contains(m)&&t.current&&!t.current.contains(m)&&c()};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[a,c,t,s])}const Ze=/(\d{2}:\d{2}:\d{3})(?:\s+\(([\d,]+)\))?/g;function et(t,s){return s?`osu://edit/${t}-(${s})`:`osu://edit/${t}`}function Ee({text:t,className:s,style:a}){Ze.lastIndex=0;const c=[];let i=0,p;for(;(p=Ze.exec(t))!==null;){p.index>i&&c.push(t.substring(i,p.index));const m=p[1],x=p[2],v=p[0];c.push(e.jsx("a",{href:et(m,x),onClick:k=>{k.preventDefault(),window.location.href=et(m,x)},style:{color:"var(--primary)",textDecoration:"none",cursor:"pointer"},onMouseEnter:k=>{k.currentTarget.style.textDecoration="underline"},onMouseLeave:k=>{k.currentTarget.style.textDecoration="none"},title:"Open in osu! editor",children:v},p.index)),i=p.index+p[0].length}return i<t.length&&c.push(t.substring(i)),c.length===0?e.jsx("span",{className:s,style:a,children:t}):e.jsx("span",{className:s,style:a,children:c})}const Ut=({context:t,onClose:s,style:a})=>{const c=st(),i=G.useMemo(()=>{if(t)return t;const T=c.pathname;return T==="/feed"||T==="/mp/feed"?"mappi-feed":T==="/md/feed"?"moddi-feed":T==="/queues"||T==="/md/queues"?"moddi-queues":T.startsWith("/queues/")||T.startsWith("/md/queues/")?"moddi-queue-detail":"mappi-feed"},[t,c.pathname]),{modeFilters:p,setModeFilters:m,tagFilters:x,setTagFilters:v,queueOpenFilters:k,setQueueOpenFilters:l,queueStatusFilters:b,setQueueStatusFilters:S,queueTypeFilters:q,setQueueTypeFilters:_}=ke(),w=T=>{const C={...x,[T]:!x[T]};!C.untagged&&!C.help&&(C.help=!0),v(C);try{window.dispatchEvent(new Event("moddifilterchange"))}catch{}},B=T=>{const C={...k,[T]:!k[T]};!C.open&&!C.closed&&(C.open=!0),l(C)},R=T=>{const C={...b,[T]:!b[T]};["unchecked","accepted","denied","finished"].some(P=>C[P])||(C.unchecked=!0),S(C)},W=T=>{const C={...q,[T]:!q[T]};!C.modder&&!C.nominator&&(C.modder=!0),_(C)},N=({title:T,children:C})=>e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("div",{style:{fontSize:12,textTransform:"uppercase",letterSpacing:.5,opacity:.8,marginBottom:6},children:T}),e.jsx("div",{className:"row",style:{gap:8,flexWrap:"wrap"},children:C})]}),y=({active:T,onClick:C,label:Z})=>e.jsx("button",{type:"button",onClick:C,className:"chip","aria-pressed":T,style:{padding:"6px 10px",borderRadius:999,border:"1px solid",borderColor:T?"rgba(125,211,252,0.6)":"var(--border)",background:T?"rgba(125,211,252,0.18)":"transparent",color:"var(--text)",fontSize:13,lineHeight:1},children:Z});return e.jsxs("div",{role:"dialog","aria-label":"Filters",style:{zIndex:1e4,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:10,padding:12,width:260,boxShadow:"0 10px 30px rgba(0,0,0,0.45)",...a},children:[e.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("div",{style:{fontWeight:600},children:"Filters"}),s&&e.jsx("button",{className:"icon-link",onClick:s,"aria-label":"Close filters",title:"Close",style:{padding:4},children:e.jsx(fe,{size:16})})]}),i==="moddi-feed"&&e.jsxs(N,{title:"Tags",children:[e.jsx(y,{active:x.untagged,onClick:()=>w("untagged"),label:"Untagged"}),e.jsx(y,{active:x.help,onClick:()=>w("help"),label:"Help"})]}),i==="moddi-queues"&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{title:"Status",children:[e.jsx(y,{active:k.open,onClick:()=>B("open"),label:"Open"}),e.jsx(y,{active:k.closed,onClick:()=>B("closed"),label:"Closed"})]}),e.jsxs(N,{title:"Type",children:[e.jsx(y,{active:q.modder,onClick:()=>W("modder"),label:"Modder"}),e.jsx(y,{active:q.nominator,onClick:()=>W("nominator"),label:"Nominator"})]})]}),i==="moddi-queue-detail"&&e.jsxs(N,{title:"Submissions",children:[e.jsx(y,{active:b.unchecked,onClick:()=>R("unchecked"),label:"Pending"}),e.jsx(y,{active:b.accepted,onClick:()=>R("accepted"),label:"Accepted"}),e.jsx(y,{active:b.denied,onClick:()=>R("denied"),label:"Denied"}),e.jsx(y,{active:b.finished,onClick:()=>R("finished"),label:"Finished"})]})]})};function Ht({beatmapMeta:t,beatmapVersion:s}){const a=o.useRef(null),c=o.useRef(null),[i,p]=o.useState(!1),[m,x]=o.useState(!1),[v,k]=o.useState(0);o.useEffect(()=>{if(a.current&&c.current){const S=a.current.offsetWidth,q=c.current.scrollWidth;k(q),x(q>S)}},[t,s]);const l=t?e.jsxs(e.Fragment,{children:[t.artist," – ",t.title,t.mapper?` (by ${t.mapper})`:"",s?` [${s}]`:""]}):s?`[${s}]`:"Beatmap",b=v>0?Math.max(3,v/50):3;return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @keyframes beatmap-marquee {
          0% { transform: translateX(0); }
          100% { transform: translateX(calc(-100% - 1em)); }
        }
      `}),e.jsxs("div",{ref:a,className:"muted one-line",style:{fontSize:13,fontWeight:600,color:"var(--text)",flex:"1 1 auto",minWidth:0,overflow:"hidden",whiteSpace:"nowrap",position:"relative",cursor:m?"pointer":"default"},onMouseEnter:()=>m&&p(!0),onMouseLeave:()=>p(!1),children:[e.jsx("span",{ref:c,style:{display:"inline-block",animation:i&&m?`beatmap-marquee ${b}s linear infinite`:"none"},children:l}),i&&m&&e.jsx("span",{style:{display:"inline-block",paddingLeft:"1em"},children:l})]})]})}function Fe({submission:t,canManage:s,onUpdate:a,onDelete:c,isGroup:i=!1,allowSelfActions:p=!1}){const[m,x]=o.useState(!1),[v,k]=o.useState(!1),[l,b]=o.useState(null),[S,q]=o.useState(t.beatmapset_id),[_,w]=o.useState(t.beatmap_id),[B,R]=o.useState(!1),[W,N]=o.useState(!1),[y,T]=o.useState(null),[C,Z]=o.useState(!1),[P,re]=o.useState(t.acknowledgments||[]),[J,te]=o.useState(t.acknowledged_by_me||!1),O=o.useRef(null),d=o.useRef(null),j=o.useRef(null),h=o.useRef(null),L=o.useRef(null),{notify:K}=me();o.useEffect(()=>{re(t.acknowledgments||[]),te(t.acknowledged_by_me||!1)},[t.acknowledgments,t.acknowledged_by_me]),o.useEffect(()=>{if(t.beatmap_url)try{const r=new URL(t.beatmap_url),f=r.pathname.match(/\/beatmapsets\/(\d+)/);if(f&&!t.beatmapset_id){const E=Number(f[1]);isNaN(E)||q(E)}const F=r.hash.match(/#osu\/(\d+)/);if(F&&!t.beatmap_id){const E=Number(F[1]);isNaN(E)||w(E)}}catch(r){console.error("[QueueSubmission] Error parsing beatmap URL:",t.beatmap_url,r)}},[t.beatmap_url,t.beatmapset_id,t.beatmap_id,t.id]),o.useEffect(()=>{console.log("[QueueSubmission] Submission data:",{id:t.id,beatmap_url:t.beatmap_url,beatmapset_id:t.beatmapset_id,beatmap_id:t.beatmap_id,extracted_beatmapset_id:S,extracted_beatmap_id:_,beatmap_version:t.beatmap_version})},[t.id,S,_]),o.useEffect(()=>{if(!t.beatmap_url||l&&S)return;let r=!1;return(async()=>{try{console.log("[QueueSubmission] Fetching beatmap metadata...",{beatmap_url:t.beatmap_url,existing_beatmapset_id:t.beatmapset_id,existing_beatmap_id:t.beatmap_id});let f;try{f=new URL(t.beatmap_url)}catch(Q){console.error("[QueueSubmission] Invalid beatmap URL:",t.beatmap_url,Q);return}const F=f.hash.match(/#osu\/(\d+)/),E=F?F[1]:null;f.hash="";const U={url:f.toString()};if(E?U.beatmap_id=E:t.beatmap_id&&(U.beatmap_id=String(t.beatmap_id)),console.log("[QueueSubmission] Resolving beatmap with params:",U),!r){const Q=await M(I.osu.resolveBeatmap+Bt(U),{requireAuth:!1});console.log("[QueueSubmission] Beatmap resolve response:",Q),Q.setId&&!S&&(console.log("[QueueSubmission] Setting beatmapset_id from API:",Q.setId),q(Number(Q.setId))),(Q.title||Q.artist)&&b({title:Q.title||null,artist:Q.artist||null,mapper:Q.mapper||null})}}catch(f){console.error("[QueueSubmission] Error fetching beatmap metadata:",f)}})(),()=>{r=!0}},[t.beatmap_url,t.beatmap_id,t.beatmapset_id,l,S]),o.useEffect(()=>{if(!B){T(null),L.current&&(window.removeEventListener("resize",L.current),window.removeEventListener("scroll",L.current,!0),L.current=null);return}let r=null;const f=()=>{let F=null;const E=h.current;if(E){const Y=E.querySelector(".queue-submission-beatmap-btn-desktop button"),U=E.querySelector(".queue-submission-beatmap-btn-desktop-actions button"),Q=E.querySelector(".queue-submission-beatmap-btn-mobile button");Y&&window.getComputedStyle(Y.parentElement).display!=="none"?F=Y:U&&window.getComputedStyle(U.parentElement).display!=="none"?F=U:Q&&window.getComputedStyle(Q.parentElement).display!=="none"&&(F=Q)}if(!F&&j.current&&(F=j.current),F){const Y=F.getBoundingClientRect();T({top:Y.bottom+8,right:window.innerWidth-Y.right})}else T(null)};return L.current=f,r=requestAnimationFrame(()=>{f(),window.addEventListener("resize",f),window.addEventListener("scroll",f,!0)}),()=>{r!==null&&cancelAnimationFrame(r),L.current&&(window.removeEventListener("resize",L.current),window.removeEventListener("scroll",L.current,!0),L.current=null)}},[B]),o.useEffect(()=>{if(!v)return;const r=f=>{const F=f.target;O.current&&!O.current.contains(F)&&!F.closest("[data-status-dropdown]")&&k(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[v]),o.useEffect(()=>{if(!B)return;const r=f=>{const F=f.target;if(d.current&&d.current.contains(F))return;const E=h.current;if(E){if(j.current&&j.current.contains(F))return;const Y=E.querySelector(".queue-submission-beatmap-btn-desktop button"),U=E.querySelector(".queue-submission-beatmap-btn-desktop-actions button"),Q=E.querySelector(".queue-submission-beatmap-btn-mobile button");if(Y&&Y.contains(F)||U&&U.contains(F)||Q&&Q.contains(F))return}R(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[B]);const pe=async r=>{if(!m){x(!0);try{await M(I.moddi.queueSubmission(String(t.queue_id),t.id),{method:"PATCH",body:JSON.stringify({status:r})});const f={...t,status:r,updated_at:Math.floor(Date.now()/1e3)};a&&a(f),K("Status updated",{variant:"success"})}catch{K("Failed to update status",{variant:"error"})}finally{x(!1),k(!1)}}},ie=async()=>{if(!m){x(!0);try{const r=!!t.is_archived;await M(I.moddi.queueSubmission(String(t.queue_id),t.id),{method:"PATCH",body:JSON.stringify({is_archived:!r})});const f={...t,is_archived:r?0:1,updated_at:Math.floor(Date.now()/1e3)};a&&a(f),K(r?"Unarchived":"Archived",{variant:"success"})}catch{K("Failed to update archive status",{variant:"error"})}finally{x(!1)}}},$=async()=>{if(confirm("Are you sure you want to delete this submission? This action cannot be undone.")&&!m){x(!0);try{await M(I.moddi.queueSubmissionDelete(String(t.queue_id),t.id),{method:"DELETE"}),K("Submission deleted",{variant:"success"}),c&&c(t.id)}catch{K("Failed to delete submission",{variant:"error"})}finally{x(!1)}}},ae=async()=>{if(!C){Z(!0);try{if(J){if(await M(I.moddi.queueSubmissionUnacknowledge(String(t.queue_id),t.id),{method:"DELETE"}),te(!1),K("Unacknowledged",{variant:"info"}),a){const r={...t,acknowledged_by_me:!1};a(r)}}else if(await M(I.moddi.queueSubmissionAcknowledge(String(t.queue_id),t.id),{method:"POST"}),te(!0),K("Acknowledged",{variant:"success"}),a){const r={...t,acknowledged_by_me:!0};a(r)}}catch{K("Failed to update acknowledgment",{variant:"error"})}finally{Z(!1)}}},z={unchecked:"#f59e0b",accepted:"#10b981",denied:"#ef4444",finished:"#6366f1"},ee={unchecked:"Pending",accepted:"Accepted",denied:"Denied",finished:"Finished"},V=S||t.beatmapset_id,ne=V?`https://assets.ppy.sh/beatmaps/${V}/covers/card.jpg`:null;o.useEffect(()=>{ne?console.log("[QueueSubmission] Background image URL:",ne,"for beatmapset_id:",V):console.log("[QueueSubmission] No background image URL - beatmapset_id:",V,"submission.beatmapset_id:",t.beatmapset_id)},[ne,V,t.beatmapset_id]);const H=!!t.is_archived,se=s||p?e.jsxs("div",{className:"queue-submission-actions",style:{display:"flex",alignItems:"center",gap:8},children:[t.beatmap_url&&e.jsx("div",{className:"queue-submission-beatmap-btn-desktop-actions",children:e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),R(f=>!f)},title:"Beatmap options","aria-label":"Beatmap options",style:{display:"inline-flex",alignItems:"center",gap:6,padding:"6px 12px",background:"var(--hover-overlay)",border:"1px solid var(--border)",borderRadius:6,color:"var(--text)",fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:r=>{r.currentTarget.style.background="rgba(255,255,255,0.1)",r.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},onMouseLeave:r=>{r.currentTarget.style.background="rgba(255,255,255,0.05)",r.currentTarget.style.borderColor="rgba(255,255,255,0.1)"},children:[e.jsx(ve,{size:14}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Beatmap"}),e.jsx(de,{size:12,style:{marginLeft:4,opacity:.7}})]})}),t.beatmap_url&&e.jsx("div",{className:"queue-submission-beatmap-btn-mobile",style:{display:"none"},children:e.jsxs("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),R(f=>!f)},title:"Beatmap options","aria-label":"Beatmap options",style:{display:"inline-flex",alignItems:"center",gap:6,padding:"6px 12px",background:"var(--hover-overlay)",border:"1px solid var(--border)",borderRadius:6,color:"var(--text)",fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:r=>{r.currentTarget.style.background="rgba(255,255,255,0.1)",r.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},onMouseLeave:r=>{r.currentTarget.style.background="rgba(255,255,255,0.05)",r.currentTarget.style.borderColor="rgba(255,255,255,0.1)"},children:[e.jsx(ve,{size:14}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Beatmap"}),e.jsx(de,{size:12,style:{marginLeft:4,opacity:.7}})]})}),P&&P.length>0&&e.jsxs("div",{className:"queue-submission-acks",style:{display:"flex",alignItems:"center",marginRight:4},children:[P.slice(0,5).map((r,f)=>r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:r.username,title:r.username,width:24,height:24,style:{borderRadius:"50%",border:"2px solid var(--panel)",marginLeft:f>0?-8:0,zIndex:P.length-f,position:"relative",cursor:"pointer"}},r.user_id):e.jsx("div",{title:r.username,style:{width:24,height:24,borderRadius:"50%",border:"2px solid var(--panel)",marginLeft:f>0?-8:0,zIndex:P.length-f,position:"relative",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,color:"var(--text)",cursor:"pointer"},children:r.username.charAt(0).toUpperCase()},r.user_id)),P.length>5&&e.jsxs("div",{style:{width:24,height:24,borderRadius:"50%",border:"2px solid var(--panel)",marginLeft:-8,background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,color:"var(--text)",zIndex:0,position:"relative"},title:`+${P.length-5} more`,children:["+",P.length-5]})]}),s&&e.jsx("button",{className:"icon-link",onClick:ae,disabled:C||m,title:J?"Unacknowledge":"Acknowledge",style:{color:J?"#10b981":"var(--muted)",width:"auto",height:"auto",padding:"6px",borderRadius:6,transition:"all 0.2s ease",background:J?"rgba(16, 185, 129, 0.1)":"transparent"},onMouseEnter:r=>{!C&&!m&&(r.currentTarget.style.background=J?"rgba(16, 185, 129, 0.2)":"rgba(255,255,255,0.05)")},onMouseLeave:r=>{r.currentTarget.style.background=J?"rgba(16, 185, 129, 0.1)":"transparent"},children:e.jsx($e,{size:16})}),e.jsx("button",{className:"icon-link",onClick:ie,disabled:m,title:H?"Unarchive":"Archive",style:{color:H?"#6366f1":"var(--muted)",width:"auto",height:"auto",padding:"6px",borderRadius:6,transition:"all 0.2s ease",background:H?"rgba(99, 102, 241, 0.1)":"transparent"},onMouseEnter:r=>{m||(r.currentTarget.style.background=H?"rgba(99, 102, 241, 0.2)":"rgba(255,255,255,0.05)")},onMouseLeave:r=>{r.currentTarget.style.background=H?"rgba(99, 102, 241, 0.1)":"transparent"},children:H?e.jsx(Ue,{size:16}):e.jsx(He,{size:16})}),e.jsx("button",{className:"icon-link",onClick:$,disabled:m,title:"Delete submission",style:{color:"var(--danger)",width:"auto",height:"auto",padding:"6px",borderRadius:6,transition:"all 0.2s ease",background:"transparent"},onMouseEnter:r=>{m||(r.currentTarget.style.background="rgba(239, 68, 68, 0.1)")},onMouseLeave:r=>{r.currentTarget.style.background="transparent"},children:e.jsx(ue,{size:16})}),s&&e.jsxs("div",{className:"queue-submission-status-btn-wrapper",style:{position:"relative"},children:[e.jsxs("button",{ref:O,onClick:()=>k(!v),disabled:m,style:{display:"inline-flex",alignItems:"center",gap:6,padding:"8px 14px",borderRadius:8,fontSize:13,fontWeight:600,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",background:z[t.status]+"15",border:`1.5px solid ${z[t.status]}50`,color:z[t.status],whiteSpace:"nowrap",cursor:m?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:m?.6:1},onMouseEnter:r=>{m||(r.currentTarget.style.background=z[t.status]+"25",r.currentTarget.style.borderColor=z[t.status]+"70",r.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:r=>{r.currentTarget.style.background=z[t.status]+"15",r.currentTarget.style.borderColor=z[t.status]+"50",r.currentTarget.style.transform="translateY(0)"},children:[e.jsx("span",{children:ee[t.status]}),e.jsx(de,{size:14,style:{marginLeft:2,transition:"transform 0.2s ease",transform:v?"rotate(180deg)":"rotate(0deg)"}})]}),v&&we.createPortal(e.jsx("div",{"data-status-dropdown":!0,style:{position:"fixed",background:"var(--panel)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:10,padding:6,zIndex:1e4,minWidth:140,boxShadow:"0 8px 24px rgba(0,0,0,0.4)",...(()=>{const r=document.querySelector(".queue-submission-status-btn-desktop button"),f=document.querySelector(".queue-submission-actions .queue-submission-status-btn-wrapper button"),F=document.querySelector(".queue-submission-status-btn-mobile button");let E=null;if(r&&window.getComputedStyle(r.parentElement).display!=="none"?E=r:F&&window.getComputedStyle(F.parentElement).display!=="none"?E=F:f&&window.getComputedStyle(f.parentElement).display!=="none"?E=f:O.current&&(E=O.current),E){const Y=E.getBoundingClientRect();return{top:Y.bottom+6,right:window.innerWidth-Y.right}}return{top:0,right:0}})()},onClick:r=>r.stopPropagation(),children:["unchecked","accepted","denied","finished"].map(r=>e.jsx("button",{onClick:()=>pe(r),style:{display:"block",width:"100%",padding:"8px 12px",borderRadius:6,fontSize:13,fontWeight:r===t.status?600:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",textAlign:"left",background:r===t.status?z[r]+"15":"transparent",color:r===t.status?z[r]:"var(--text)",border:"none",cursor:"pointer",transition:"all 0.15s ease",marginBottom:2},onMouseEnter:f=>{r!==t.status&&(f.currentTarget.style.background="rgba(255,255,255,0.05)")},onMouseLeave:f=>{r!==t.status&&(f.currentTarget.style.background="transparent")},children:ee[r]},r))}),document.body)]})]}):null;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:h,className:"queue-submission-card",style:{position:"relative",borderRadius:16,overflow:"hidden",border:"1px solid var(--border-subtle)",background:"var(--panel-dark)",opacity:H?.6:1},children:[ne&&e.jsxs(e.Fragment,{children:[e.jsx("img",{src:ne,alt:"",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",opacity:.25,zIndex:0,pointerEvents:"none",filter:"blur(2px) saturate(0.6)"},onError:r=>{r.currentTarget.style.display="none"}}),e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(to bottom, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.8) 100%)",backdropFilter:"blur(4px)",zIndex:0}})]}),e.jsxs("div",{className:"queue-submission-inner",children:[e.jsxs("div",{className:"row queue-submission-header",style:{alignItems:"center",justifyContent:"space-between",gap:12},children:[e.jsx("div",{className:"queue-submission-main",style:{flex:1,minWidth:0},children:e.jsxs("div",{className:"queue-submission-meta-row",children:[t.avatar_url&&e.jsx("img",{src:t.avatar_url,width:24,height:24,style:{borderRadius:"50%"},alt:t.username}),e.jsx("span",{style:{fontSize:13},children:t.username}),e.jsx("span",{className:"muted",style:{fontSize:12},children:new Date(t.created_at*1e3).toLocaleDateString()})]})}),t.beatmap_url&&e.jsx("div",{className:"queue-submission-beatmap-btn queue-submission-beatmap-btn-desktop",children:e.jsxs("button",{ref:j,className:"chip-btn link",onClick:r=>{r.preventDefault(),r.stopPropagation(),R(f=>!f)},title:"Beatmap options","aria-label":"Beatmap options",style:{display:"inline-flex",alignItems:"center",gap:6,padding:"6px 12px",background:"var(--hover-overlay)",border:"1px solid var(--border)",borderRadius:6,color:"var(--text)",fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:r=>{r.currentTarget.style.background="rgba(255,255,255,0.1)",r.currentTarget.style.borderColor="rgba(255,255,255,0.2)"},onMouseLeave:r=>{r.currentTarget.style.background="rgba(255,255,255,0.05)",r.currentTarget.style.borderColor="rgba(255,255,255,0.1)"},children:[e.jsx(ve,{size:14}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Beatmap"}),e.jsx(de,{size:12,style:{marginLeft:4,opacity:.7}})]})}),s&&e.jsxs("div",{className:"queue-submission-actions-desktop",style:{display:"flex",alignItems:"center",gap:8},children:[P&&P.length>0&&e.jsxs("div",{className:"queue-submission-acks",style:{display:"flex",alignItems:"center",marginRight:4},children:[P.slice(0,5).map((r,f)=>r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:r.username,title:r.username,width:24,height:24,style:{borderRadius:"50%",border:"2px solid var(--panel)",marginLeft:f>0?-8:0,zIndex:P.length-f,position:"relative",cursor:"pointer"}},r.user_id):e.jsx("div",{title:r.username,style:{width:24,height:24,borderRadius:"50%",border:"2px solid var(--panel)",marginLeft:f>0?-8:0,zIndex:P.length-f,position:"relative",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,color:"var(--text)",cursor:"pointer"},children:r.username.charAt(0).toUpperCase()},r.user_id)),P.length>5&&e.jsxs("div",{style:{width:24,height:24,borderRadius:"50%",border:"2px solid var(--panel)",marginLeft:-8,background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:600,color:"var(--text)",zIndex:0,position:"relative"},title:`+${P.length-5} more`,children:["+",P.length-5]})]}),e.jsx("button",{className:"icon-link",onClick:ae,disabled:C||m,title:J?"Unacknowledge":"Acknowledge",style:{color:J?"#10b981":"var(--muted)",width:"auto",height:"auto",padding:"6px",borderRadius:6,transition:"all 0.2s ease",background:J?"rgba(16, 185, 129, 0.1)":"transparent"},onMouseEnter:r=>{!C&&!m&&(r.currentTarget.style.background=J?"rgba(16, 185, 129, 0.2)":"rgba(255,255,255,0.05)")},onMouseLeave:r=>{r.currentTarget.style.background=J?"rgba(16, 185, 129, 0.1)":"transparent"},children:e.jsx($e,{size:16})}),e.jsx("button",{className:"icon-link",onClick:ie,disabled:m,title:H?"Unarchive":"Archive",style:{color:H?"#6366f1":"var(--muted)",width:"auto",height:"auto",padding:"6px",borderRadius:6,transition:"all 0.2s ease",background:H?"rgba(99, 102, 241, 0.1)":"transparent"},onMouseEnter:r=>{m||(r.currentTarget.style.background=H?"rgba(99, 102, 241, 0.2)":"rgba(255,255,255,0.05)")},onMouseLeave:r=>{r.currentTarget.style.background=H?"rgba(99, 102, 241, 0.1)":"transparent"},children:H?e.jsx(Ue,{size:16}):e.jsx(He,{size:16})}),e.jsx("button",{className:"icon-link",onClick:$,disabled:m,title:"Delete submission",style:{color:"var(--danger)",width:"auto",height:"auto",padding:"6px",borderRadius:6,transition:"all 0.2s ease",background:"transparent"},onMouseEnter:r=>{m||(r.currentTarget.style.background="rgba(239, 68, 68, 0.1)")},onMouseLeave:r=>{r.currentTarget.style.background="transparent"},children:e.jsx(ue,{size:16})}),e.jsx("div",{className:"queue-submission-status-btn-wrapper queue-submission-status-btn-desktop",style:{position:"relative"},children:e.jsxs("button",{ref:O,onClick:()=>k(!v),disabled:m,style:{display:"inline-flex",alignItems:"center",gap:6,padding:"8px 14px",borderRadius:8,fontSize:13,fontWeight:600,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",background:z[t.status]+"15",border:`1.5px solid ${z[t.status]}50`,color:z[t.status],whiteSpace:"nowrap",cursor:m?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:m?.6:1},onMouseEnter:r=>{m||(r.currentTarget.style.background=z[t.status]+"25",r.currentTarget.style.borderColor=z[t.status]+"70",r.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:r=>{r.currentTarget.style.background=z[t.status]+"15",r.currentTarget.style.borderColor=z[t.status]+"50",r.currentTarget.style.transform="translateY(0)"},children:[e.jsx("span",{children:ee[t.status]}),e.jsx(de,{size:14,style:{marginLeft:2,transition:"transform 0.2s ease",transform:v?"rotate(180deg)":"rotate(0deg)"}})]})})]}),s&&e.jsx("div",{className:"queue-submission-status-btn-mobile",style:{display:"none",position:"relative"},children:e.jsxs("button",{onClick:()=>k(!v),disabled:m,style:{display:"inline-flex",alignItems:"center",gap:6,padding:"8px 14px",borderRadius:8,fontSize:13,fontWeight:600,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",background:z[t.status]+"15",border:`1.5px solid ${z[t.status]}50`,color:z[t.status],whiteSpace:"nowrap",cursor:m?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:m?.6:1},onMouseEnter:r=>{m||(r.currentTarget.style.background=z[t.status]+"25",r.currentTarget.style.borderColor=z[t.status]+"70",r.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:r=>{r.currentTarget.style.background=z[t.status]+"15",r.currentTarget.style.borderColor=z[t.status]+"50",r.currentTarget.style.transform="translateY(0)"},children:[e.jsx("span",{children:ee[t.status]}),e.jsx(de,{size:14,style:{marginLeft:2,transition:"transform 0.2s ease",transform:v?"rotate(180deg)":"rotate(0deg)"}})]})}),!s&&e.jsx("span",{className:"queue-submission-status-badge-header",style:{display:"inline-flex",alignItems:"center",padding:"8px 14px",borderRadius:8,fontSize:13,fontWeight:600,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",background:z[t.status]+"15",border:`1.5px solid ${z[t.status]}50`,color:z[t.status],whiteSpace:"nowrap"},children:ee[t.status]})]}),t.beatmap_url&&e.jsx("div",{className:"queue-submission-title-row",children:e.jsx(Ht,{beatmapMeta:l,beatmapVersion:t.beatmap_version})}),t.message&&e.jsx("div",{className:"queue-submission-message",children:e.jsx(Ee,{text:t.message})}),se]})]}),B&&y&&t.beatmap_url&&we.createPortal(e.jsxs("div",{ref:d,style:{position:"fixed",top:y.top,right:y.right,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:1e4,minWidth:160,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},onClick:r=>r.stopPropagation(),children:[e.jsxs("a",{className:"menu-item",href:t.beatmap_url,target:"_blank",rel:"noreferrer",onClick:()=>R(!1),children:[e.jsx(ve,{size:16,style:{marginRight:8}}),"osu.ppy.sh"]}),V&&e.jsx("button",{className:"menu-item",onClick:()=>{N(!0),R(!1)},children:"Preview"})]}),document.body),W&&V&&e.jsx(Ft,{open:W,onClose:()=>N(!1),downloadUrl:`${ot}${I.osu.downloadBeatmapset(V)}`,beatmapId:_??t.beatmap_id??void 0,beatmapVersion:t.beatmap_version??void 0})]})}function Le(){return he({queryKey:["moddi","queues"],queryFn:async()=>{const t=await M(I.moddi.queues);return Array.isArray(t.items)?t.items:[]}})}function dt(){const t=be();return Se({mutationFn:async s=>{var a;return await M(I.moddi.queues,{method:"POST",body:JSON.stringify({name:s.name.trim(),description:((a=s.description)==null?void 0:a.trim())||null,is_group:s.is_group??!1,type:s.type||"modder"})})},onSuccess:()=>{t.invalidateQueries({queryKey:["moddi","queues"]})}})}function Ae({open:t,onClose:s,children:a}){const c=o.useRef(null),i=o.useRef(null),p=o.useRef(!1),m=l=>{var b;i.current=((b=l.touches[0])==null?void 0:b.clientY)??null,p.current=!1},x=l=>{var _,w;if(i.current==null)return;const b=((_=l.touches[0])==null?void 0:_.clientY)??null;if(b==null)return;const S=b-i.current;(((w=c.current)==null?void 0:w.scrollTop)??0)<=0&&S>60?p.current=!0:p.current=!1},v=()=>{p.current&&s(),i.current=null,p.current=!1};if(!t)return null;const k=e.jsx("div",{className:"mobile-upload-overlay",onClick:s,children:e.jsx("div",{ref:c,className:"mobile-upload-sheet",onClick:l=>l.stopPropagation(),onTouchStart:m,onTouchMove:x,onTouchEnd:v,children:a})});return we.createPortal(k,document.body)}function Yt({queueId:t,onSubmitted:s}){const[a,c]=G.useState(!1),[i,p]=G.useState(t),[m,x]=G.useState(""),[v,k]=G.useState(""),[l,b]=G.useState(!1),{notify:S}=me(),{data:q=[]}=Le();G.useEffect(()=>{p(t)},[t]);const _=async()=>{if(!i){S("Please select a queue",{variant:"error"});return}if(!m.trim()){S("Beatmap URL is required",{variant:"error"});return}b(!0);try{await M(I.moddi.queueSubmit(i),{method:"POST",body:JSON.stringify({beatmap_url:m.trim(),message:v.trim()||null})}),S("Submission created!",{variant:"success"}),x(""),k(""),c(!1),s==null||s()}catch(w){S((w==null?void 0:w.message)||"Failed to create submission",{variant:"error"})}finally{b(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"mobile-fab","aria-label":"Submit to queue",title:"Submit to queue",onClick:()=>c(!0),children:e.jsx(Me,{size:22})}),e.jsx(Ae,{open:a,onClose:()=>c(!1),children:e.jsxs("div",{className:"col",style:{gap:12},children:[!t&&e.jsxs("div",{className:"row",style:{alignItems:"center"},children:[e.jsx("span",{className:"muted",style:{fontSize:12,minWidth:80},children:"Queue:"}),e.jsxs("select",{value:i??"",onChange:w=>p(w.target.value||void 0),style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:6,padding:"6px 10px",fontSize:13},children:[e.jsx("option",{value:"",disabled:!0,children:"Select queue"}),q.map(w=>e.jsx("option",{value:String(w.id),children:w.name},w.id))]})]}),e.jsx("input",{type:"url",placeholder:"Beatmap URL e.g. https://osu.ppy.sh/beatmapsets/...",value:m,onChange:w=>x(w.target.value),required:!0,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),e.jsx("input",{type:"text",placeholder:"Message (optional, max 100 chars)",value:v,onChange:w=>k(w.target.value.slice(0,100)),maxLength:100,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),v.length>0&&e.jsxs("div",{className:"muted",style:{fontSize:12,textAlign:"right",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:[v.length,"/100"]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn",disabled:l,onClick:_,children:l?"Submitting...":"Submit"})]})]})})]})}function Jt(){const[t,s]=G.useState(!1);return G.useEffect(()=>{var i;const a=window.matchMedia("(max-width: 768px)"),c=()=>s(a.matches);return c(),(i=a.addEventListener)==null||i.call(a,"change",c),()=>{var p;return(p=a.removeEventListener)==null?void 0:p.call(a,"change",c)}},[]),t}const Xt=({context:t})=>{const s=Jt(),[a,c]=G.useState(!1),i=G.useRef(null),p=12,m=18,l=84+56+12;return G.useEffect(()=>{const b=S=>{if(!a)return;const q=S.target;if(i.current&&i.current.contains(q))return;const _=document.getElementById("desktop-filters-panel");_&&_.contains(q)||c(!1)};return document.addEventListener("mousedown",b),()=>document.removeEventListener("mousedown",b)},[a]),s?null:e.jsxs(e.Fragment,{children:[e.jsx("button",{ref:i,className:"desktop-fab",onClick:()=>c(b=>!b),"aria-haspopup":"dialog","aria-expanded":a,title:"Filters","aria-label":"Filters",children:e.jsx(wt,{size:22})}),a&&e.jsx("div",{id:"desktop-filters-panel",style:{position:"fixed",right:m,bottom:l,zIndex:1e4},children:e.jsx(Ut,{context:t,onClose:()=>c(!1),style:{maxHeight:`calc(100vh - ${l+p}px)`,maxWidth:`calc(100vw - ${m+p}px)`,overflow:"auto"}})})]})},tt=({content:t})=>e.jsx("div",{style:{fontSize:13,lineHeight:1.6,color:"var(--text)"},children:e.jsx(_t,{components:{p:({children:s})=>e.jsx("p",{style:{margin:"0 0 8px 0"},children:s}),ul:({children:s})=>e.jsx("ul",{style:{margin:"0 0 8px 0",paddingLeft:20},children:s}),ol:({children:s})=>e.jsx("ol",{style:{margin:"0 0 8px 0",paddingLeft:20},children:s}),li:({children:s})=>e.jsx("li",{style:{margin:"0 0 4px 0"},children:s}),strong:({children:s})=>e.jsx("strong",{style:{fontWeight:600},children:s}),em:({children:s})=>e.jsx("em",{children:s}),code:({children:s})=>e.jsx("code",{style:{background:"rgba(255,255,255,0.1)",padding:"2px 4px",borderRadius:4,fontSize:12},children:s}),h1:({children:s})=>e.jsx("h1",{style:{fontSize:18,fontWeight:700,margin:"0 0 8px 0"},children:s}),h2:({children:s})=>e.jsx("h2",{style:{fontSize:16,fontWeight:700,margin:"0 0 8px 0"},children:s}),h3:({children:s})=>e.jsx("h3",{style:{fontSize:14,fontWeight:600,margin:"0 0 8px 0"},children:s})},children:t})});function ds(){const{id:t}=St(),s=at(),[a,c]=o.useState(null),[i,p]=o.useState([]),[m,x]=o.useState([]),[v,k]=o.useState(!0),[l,b]=o.useState(null),[S,q]=o.useState(!1),[_,w]=o.useState(!1),[B,R]=o.useState(""),[W,N]=o.useState(""),[y,T]=o.useState(null),[C,Z]=o.useState(!1),[P,re]=o.useState(""),[J,te]=o.useState(""),[O,d]=o.useState(""),[j,h]=o.useState("modder"),[L,K]=o.useState(!1),[pe,ie]=o.useState(!1),[$,ae]=o.useState("general"),[z,ee]=o.useState(!1),[V,ne]=o.useState(!1),[H,se]=o.useState(null),[r,f]=o.useState(""),[F,E]=o.useState([]),[Y,U]=o.useState(!1),Q=o.useRef(null),Ne=o.useRef(null),Te=o.useRef(null),[_e,ct]=o.useState([]),[Pe,Be]=o.useState(!1),[Ce,Oe]=o.useState(null),{notify:D}=me(),{queueStatusFilters:ye}=ke(),oe=async()=>{var n,g;if(t){k(!0);try{const u=await M(I.moddi.queue(t),{requireAuth:!1});c(u.queue||null),p(u.members||[]),x(u.submissions||[])}catch(u){(n=u==null?void 0:u.message)!=null&&n.includes("403")||(g=u==null?void 0:u.message)!=null&&g.includes("Forbidden")?(D("You do not have access to this queue",{variant:"error"}),s("/queues")):D("Failed to load queue",{variant:"error"})}finally{k(!1)}}};o.useEffect(()=>{oe(),M(I.auth.me,{requireAuth:!1}).then(n=>b(n)).catch(()=>{})},[t]);const le=l&&a&&(a.owner_id===l.id||i.some(n=>n.user_id===l.id&&n.joined_at)||l.is_mod||l.is_admin);l&&i.some(n=>n.user_id===l.id&&n.joined_at);const De=l&&a&&(a.owner_id===l.id||i.some(n=>n.user_id===l.id&&n.joined_at)),ut=async n=>{if(n.preventDefault(),!a||a.is_open===0){D("Queue is closed for submissions",{variant:"error"});return}if(!B.trim()){D("Beatmap URL is required",{variant:"error"});return}w(!0);try{await M(I.moddi.queueSubmit(t),{method:"POST",body:JSON.stringify({beatmap_url:B.trim(),message:W.trim()||null})}),D("Submission created!",{variant:"success"}),q(!1),R(""),N(""),oe()}catch(g){D((g==null?void 0:g.message)||"Failed to create submission",{variant:"error"})}finally{w(!1)}},We=n=>{x(g=>g.map(u=>u.id===n.id?n:u)),n.acknowledged_by_me!==void 0&&oe()},mt=()=>{a&&(re(a.name),te(a.description||""),d(a.rules||""),h(a.type||"modder"),Z(!0),ae("general"))},ce=()=>{Z(!1),re(""),te(""),d(""),h("modder")},pt=async()=>{if(!(!a||!De)){ie(!0);try{const n=a.is_open!==1;await M(I.moddi.queue(t),{method:"PATCH",body:JSON.stringify({is_open:n})}),D(`Queue ${n?"opened":"closed"}`,{variant:"success"}),oe()}catch(n){D((n==null?void 0:n.message)||"Failed to update status",{variant:"error"})}finally{ie(!1)}}},gt=async n=>{if(n.preventDefault(),!a||!P.trim()){D("Queue name is required",{variant:"error"});return}ee(!0);try{const g=i.filter(A=>A.user_id!==a.owner_id&&A.role!=="owner").length>0,u={name:P.trim(),description:J.trim()||null,rules:O.trim()||null,is_group:g};(l!=null&&l.is_mod||l!=null&&l.is_admin)&&(u.type=j),await M(I.moddi.queue(t),{method:"PATCH",body:JSON.stringify(u)}),D("Queue updated!",{variant:"success"}),ce(),oe()}catch(g){D((g==null?void 0:g.message)||"Failed to update queue",{variant:"error"})}finally{ee(!1)}};o.useEffect(()=>{if(!r.trim()){E([]),U(!1);return}const n=setTimeout(async()=>{try{const u=(await M(I.moddi.usersSearch(r),{requireAuth:!1})).items||[];E(u),U(u.length>0)}catch(g){console.error("Search failed:",g),E([]),U(!1)}},300);return()=>clearTimeout(n)},[r]);const ft=async n=>{if(!V){ne(!0);try{await M(I.moddi.queueInvite(t),{method:"POST",body:JSON.stringify({user_id:n})}),D("Invite sent!",{variant:"success"}),f(""),E([]),U(!1),oe()}catch(g){D((g==null?void 0:g.message)||"Failed to invite member",{variant:"error"})}finally{ne(!1)}}},qe=async()=>{if(!(!t||!le))try{const n=await M(I.moddi.queueBlockedUsers(t));ct(n.blocked||[])}catch(n){console.error("Failed to load blocked users:",n)}},ht=async n=>{if(!(!t||Pe)&&confirm("Block this user from submitting to this queue?")){Be(!0);try{await M(I.moddi.queueBlockUser(t),{method:"POST",body:JSON.stringify({user_id:n})}),D("User blocked",{variant:"success"}),qe(),f(""),E([]),U(!1)}catch(g){D((g==null?void 0:g.message)||"Failed to block user",{variant:"error"})}finally{Be(!1)}}},Qe=async n=>{if(!(!t||Ce===n)){Oe(n);try{await M(I.moddi.queueUnblockUser(t,n),{method:"DELETE"}),D("User unblocked",{variant:"success"}),qe()}catch(g){D((g==null?void 0:g.message)||"Failed to unblock user",{variant:"error"})}finally{Oe(null)}}};o.useEffect(()=>{$==="members"&&le&&t&&qe()},[$,le,t]);const bt=async()=>{if(a&&confirm(`Are you sure you want to delete "${a.name}"? This action cannot be undone.`)){K(!0);try{await M(I.moddi.queue(t),{method:"DELETE"}),D("Queue deleted",{variant:"success"}),s("/queues")}catch(n){D((n==null?void 0:n.message)||"Failed to delete queue",{variant:"error"})}finally{K(!1)}}},yt=async n=>{if(!l||!a||l.id!==a.owner_id){D("Only the queue owner can remove members",{variant:"error"});return}if(confirm("Remove this member from the queue?")){se(n);try{await M(I.moddi.queueMember(t,n),{method:"DELETE"}),D("Member removed",{variant:"success"});const u=i.filter(A=>A.user_id!==n).some(A=>A.user_id!==(a==null?void 0:a.owner_id)&&A.role!=="owner");if(a&&a.is_group===1&&!u)try{await M(I.moddi.queue(t),{method:"PATCH",body:JSON.stringify({is_group:!1})})}catch{console.warn("Failed to convert queue back to individual after removing last member")}oe()}catch(g){D((g==null?void 0:g.message)||"Failed to remove member",{variant:"error"})}finally{se(null)}}},xt=async()=>{if(l&&confirm("Leave this queue? You will need to be invited again to rejoin.")){se(l.id);try{await M(I.moddi.queueMember(t,l.id),{method:"DELETE"}),D("Left queue",{variant:"success"});const g=i.filter(u=>u.user_id!==l.id).some(u=>u.user_id!==(a==null?void 0:a.owner_id)&&u.role!=="owner");if(a&&a.is_group===1&&!g)try{await M(I.moddi.queue(t),{method:"PATCH",body:JSON.stringify({is_group:!1})})}catch{console.warn("Failed to convert queue back to individual after leaving")}s("/queues")}catch(n){D((n==null?void 0:n.message)||"Failed to leave queue",{variant:"error"})}finally{se(null)}}},vt=async n=>{if(confirm("Cancel this invitation?")){se(n);try{await M(I.moddi.queueMember(t,n),{method:"DELETE"}),D("Invitation canceled",{variant:"success"}),oe()}catch(g){D((g==null?void 0:g.message)||"Failed to cancel invitation",{variant:"error"})}finally{se(null)}}};return o.useEffect(()=>{if(!C)return;const n=g=>{const u=g.target;u.closest(".manage-overlay")||u.closest(".manage-overlay-backdrop")||!u.closest(".manage-popup")&&Te.current&&!Te.current.contains(u)&&ce()};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[C]),o.useEffect(()=>{if(!Y)return;const n=g=>{const u=g.target;Q.current&&!Q.current.contains(u)&&Ne.current&&!Ne.current.contains(u)&&U(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[Y]),v?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"Loading..."}):a?e.jsxs("div",{style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[t&&e.jsx(Yt,{queueId:t,onSubmitted:()=>oe()}),e.jsx(Xt,{context:"moddi-queue-detail"}),e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:16,paddingTop:16},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:12,flex:1,minWidth:0},children:[e.jsx("button",{className:"icon-link hide-on-mobile",onClick:()=>s("/queues"),style:{width:"auto",height:"auto",padding:"4px",background:"transparent"},title:"Back","aria-label":"Back",children:e.jsx(kt,{size:20})}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:10,flex:1,minWidth:0},children:[e.jsx("div",{className:"title",style:{flex:1,minWidth:0},children:a.name}),De&&e.jsxs("button",{onClick:pt,disabled:pe,className:`queue-status-badge ${a.is_open===1?"status-open":"status-closed"}`,title:a.is_open===1?"Close queue":"Open queue","aria-label":a.is_open===1?"Close queue":"Open queue",children:[a.is_open===1?e.jsx(je,{size:14}):e.jsx(ze,{size:14}),e.jsx("span",{children:a.is_open===1?"Open":"Closed"})]})]})]}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8},children:[le&&e.jsx("button",{ref:Te,className:"icon-link",onClick:mt,style:{width:"auto",height:"auto",padding:"4px"},title:"Manage Queue","aria-label":"Manage Queue",children:e.jsx(Nt,{size:18})}),i.length>0&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:6},children:i.filter(n=>n.joined_at!==null).sort((n,g)=>{const u=n.role==="owner"||n.user_id===(a==null?void 0:a.owner_id),A=g.role==="owner"||g.user_id===(a==null?void 0:a.owner_id);return u&&!A?-1:!u&&A?1:(g.joined_at||0)-(n.joined_at||0)}).map(n=>e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>T(n.user_id),onMouseLeave:()=>T(null),children:[e.jsx(Ie,{to:`/profile/${n.user_id}`,className:"queue-member-avatar",title:n.username,children:n.avatar_url?e.jsx("img",{src:n.avatar_url,alt:n.username}):e.jsx("div",{style:{width:"100%",height:"100%",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,color:"var(--muted)"},children:n.username.charAt(0).toUpperCase()})}),y===n.user_id&&e.jsxs("div",{className:"queue-member-tooltip",children:[n.username," ",n.role!=="member"?`(${n.role})`:""]})]},n.user_id))})]})]}),a.description&&e.jsx("div",{className:"muted",style:{marginBottom:16,fontSize:14,padding:"0 4px"},children:e.jsx(Ee,{text:a.description})}),a.rules&&e.jsxs("div",{style:{marginBottom:16,padding:12,background:"var(--panel-dark)",border:"1px solid var(--divider)",borderRadius:10},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Rules"}),e.jsx(tt,{content:a.rules})]}),a.is_open===0&&e.jsx("div",{style:{marginBottom:12,padding:10,background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:10,textAlign:"center",fontSize:14,color:"#f59e0b"},children:"This queue is currently closed for submissions"}),e.jsxs("div",{className:"queue-submit-desktop-only",style:{background:"var(--panel)",border:"1px solid var(--divider)",borderRadius:10,marginBottom:12,opacity:a.is_open===0?.6:1},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",cursor:a.is_open===1?"pointer":"not-allowed",padding:"8px 12px",minHeight:36},onClick:()=>a.is_open===1&&q(!S),children:[e.jsxs("span",{style:{fontWeight:600,fontSize:16,lineHeight:1},children:["Submit a beatmap ",a.is_open===0&&"(Closed)"]}),a.is_open===1&&(S?e.jsx(fe,{size:16}):e.jsx(Me,{size:16}))]}),S&&e.jsx("form",{onSubmit:ut,style:{padding:"12px",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("input",{type:"url",placeholder:"Beatmap URL e.g. https://osu.ppy.sh/beatmapsets/...",value:B,onChange:n=>R(n.target.value),required:!0,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),e.jsx("input",{type:"text",placeholder:"Message (optional, max 100 chars)",value:W,onChange:n=>N(n.target.value.slice(0,100)),maxLength:100,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),W.length>0&&e.jsxs("div",{className:"muted",style:{fontSize:12,textAlign:"right",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:[W.length,"/100"]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:n=>{n.stopPropagation(),q(!1)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:_,onClick:n=>n.stopPropagation(),children:_?"Submitting...":"Submit"})]})]})})]}),e.jsxs("div",{className:"profile-tabs-unified",style:{marginTop:24},children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Submission sections",children:[e.jsx("button",{role:"tab","aria-selected":!0,className:"profile-tab active","data-tab":"active",onClick:n=>{const g=n.currentTarget.closest(".profile-tabs-unified");g.querySelectorAll(".profile-tab").forEach(A=>{A.classList.remove("active"),A.setAttribute("aria-selected","false")}),n.currentTarget.classList.add("active"),n.currentTarget.setAttribute("aria-selected","true"),g.querySelector(".profile-tabs-content").setAttribute("data-active","active")},children:"Active"}),e.jsx("button",{role:"tab","aria-selected":!1,className:"profile-tab","data-tab":"archived",onClick:n=>{const g=n.currentTarget.closest(".profile-tabs-unified");g.querySelectorAll(".profile-tab").forEach(A=>{A.classList.remove("active"),A.setAttribute("aria-selected","false")}),n.currentTarget.classList.add("active"),n.currentTarget.setAttribute("aria-selected","true"),g.querySelector(".profile-tabs-content").setAttribute("data-active","archived")},children:"Archived"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":"active",children:[e.jsx("div",{className:"panel active",children:e.jsx("div",{className:"col",style:{gap:0},children:m.filter(n=>!!!n.is_archived&&ye[n.status]).length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No active submissions."}):m.filter(n=>!!!n.is_archived&&ye[n.status]).map(n=>e.jsx(Fe,{submission:n,canManage:!!le,isGroup:(a==null?void 0:a.is_group)===1,onUpdate:We,onDelete:g=>{x(u=>u.filter(A=>A.id!==g))}},n.id))})}),e.jsx("div",{className:"panel archived",children:e.jsx("div",{className:"col",style:{gap:0},children:m.filter(n=>!!n.is_archived&&ye[n.status]).length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No archived submissions."}):m.filter(n=>!!n.is_archived&&ye[n.status]).map(n=>e.jsx(Fe,{submission:n,canManage:!!le,isGroup:(a==null?void 0:a.is_group)===1,onUpdate:We,onDelete:g=>{x(u=>u.filter(A=>A.id!==g))}},n.id))})})]})]}),C&&we.createPortal(e.jsxs("div",{className:"overlay manage-overlay",children:[e.jsx("div",{className:"overlay-backdrop manage-overlay-backdrop",onClick:ce}),e.jsxs("div",{className:"overlay-card",style:{maxWidth:500},children:[e.jsx("button",{className:"overlay-close",onClick:ce,"aria-label":"Close",children:e.jsx(fe,{size:18})}),e.jsxs("div",{className:"settings-header",style:{padding:"20px 16px 12px"},children:[e.jsx("div",{className:"settings-title",children:"Manage Queue"}),e.jsx("div",{className:"settings-description",children:"Configure queue settings, rules, and members."})]}),e.jsxs("div",{className:"profile-tabs-unified",role:"region","aria-label":"Manage Queue",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Manage Queue tabs",children:[e.jsx("button",{role:"tab","aria-selected":$==="general",className:`profile-tab ${$==="general"?"active":""}`,"data-tab":"general",onClick:n=>{const g=n.currentTarget.closest(".profile-tabs-unified"),u=g==null?void 0:g.querySelector(".profile-tabs-content");u==null||u.setAttribute("data-active","general"),ae("general")},children:"General"}),e.jsx("button",{role:"tab","aria-selected":$==="rules",className:`profile-tab ${$==="rules"?"active":""}`,"data-tab":"rules",onClick:n=>{const g=n.currentTarget.closest(".profile-tabs-unified"),u=g==null?void 0:g.querySelector(".profile-tabs-content");u==null||u.setAttribute("data-active","rules"),ae("rules")},children:"Rules"}),e.jsx("button",{role:"tab","aria-selected":$==="members",className:`profile-tab ${$==="members"?"active":""}`,"data-tab":"members",onClick:n=>{const g=n.currentTarget.closest(".profile-tabs-unified"),u=g==null?void 0:g.querySelector(".profile-tabs-content");u==null||u.setAttribute("data-active","members"),ae("members")},children:"Members"})]}),e.jsx("div",{className:"profile-tabs-content","data-active":$,children:e.jsxs("form",{onSubmit:gt,className:"col",style:{gap:0},children:[e.jsx("div",{className:"panel general",hidden:$!=="general",children:e.jsxs("div",{className:"col",style:{gap:10,padding:"16px"},children:[e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Queue Name"}),e.jsx("input",{type:"text",value:P,onChange:n=>re(n.target.value),required:!0,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}})]}),e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Description (optional)"}),e.jsx("textarea",{placeholder:"Description",value:J,onChange:n=>te(n.target.value),rows:3,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14,resize:"vertical"}})]}),((l==null?void 0:l.is_mod)||(l==null?void 0:l.is_admin))&&e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsxs("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:["Queue Type ",a.owner_id!==(l==null?void 0:l.id)&&e.jsx("span",{style:{fontSize:12,color:"var(--muted)",fontWeight:400},children:"(Mod/Admin only)"})]}),e.jsxs("select",{value:j,onChange:n=>h(n.target.value),style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14},children:[e.jsx("option",{value:"modder",children:"Modder"}),e.jsx("option",{value:"nominator",children:"Nominator"})]})]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"space-between",alignItems:"center",marginTop:8},children:[e.jsxs("button",{type:"button",className:"btn secondary",onClick:bt,disabled:L||z,style:{background:"rgba(248, 113, 113, 0.1)",borderColor:"rgba(248, 113, 113, 0.3)",color:"var(--danger)",fontSize:13,padding:"8px 12px"},children:[e.jsx(ue,{size:14,style:{marginRight:6}}),L?"Deleting...":"Delete Queue"]}),e.jsxs("div",{className:"row",style:{gap:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:ce,disabled:z||L,style:{fontSize:13,padding:"8px 16px"},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:z||L,style:{fontSize:13,padding:"8px 16px"},children:z?"Updating...":"Save Changes"})]})]})]})}),e.jsx("div",{className:"panel rules",hidden:$!=="rules",children:e.jsxs("div",{className:"col",style:{gap:10,padding:"16px"},children:[e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Rules (optional, markdown supported)"}),e.jsx("textarea",{placeholder:"Rules in markdown format...",value:O,onChange:n=>d(n.target.value),rows:8,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:13,resize:"vertical"}}),O&&e.jsxs("div",{style:{padding:10,background:"var(--panel-dark)",border:"1px solid var(--divider)",borderRadius:8,fontSize:12},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:6,opacity:.8,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Preview:"}),e.jsx(tt,{content:O})]})]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end",marginTop:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:ce,disabled:z||L,style:{fontSize:13,padding:"8px 16px"},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:z||L,style:{fontSize:13,padding:"8px 16px"},children:z?"Updating...":"Save Changes"})]})]})}),e.jsx("div",{className:"panel members",hidden:$!=="members",children:e.jsxs("div",{className:"col",style:{gap:10,padding:"16px"},children:[e.jsxs("div",{className:"col",style:{gap:6,position:"relative"},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Invite Members"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{ref:Q,type:"text",placeholder:"Search username or ID",value:r,onChange:n=>f(n.target.value),onKeyDown:n=>{n.key==="Enter"&&n.preventDefault()},onFocus:()=>{F.length>0&&U(!0)},style:{width:"100%",background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),Y&&F.length>0&&e.jsx("div",{ref:Ne,style:{position:"absolute",top:"100%",left:0,right:0,marginTop:4,background:"var(--panel)",border:"1px solid var(--divider)",borderRadius:8,maxHeight:300,overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:e.jsx("div",{className:"col",style:{gap:0},children:F.map(n=>{const g=i.some(X=>X.user_id===n.id&&X.joined_at),u=i.some(X=>X.user_id===n.id&&X.invited_at&&!X.joined_at),A=_e.some(X=>X.user_id===n.id);return e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:8,padding:"8px 12px"},children:[e.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:8,minWidth:0},children:[n.avatar_url&&e.jsx("img",{src:n.avatar_url,width:20,height:20,style:{borderRadius:"50%",flexShrink:0}}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:500,display:"flex",alignItems:"center",gap:8,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:[e.jsx("span",{children:n.username}),g&&e.jsx("span",{style:{color:"var(--muted)",fontSize:11,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Already a member"}),u&&e.jsx("span",{style:{color:"var(--accent)",fontSize:11,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Invited"})]}),e.jsxs("div",{className:"muted",style:{fontSize:11,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:["id ",n.id," • osu ",n.osu_user_id]})]})]}),le&&!g&&!u&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("button",{className:"icon-link",onClick:X=>{X.stopPropagation(),V||ft(n.id)},disabled:V,title:"Invite user",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(nt,{size:16})}),e.jsx("button",{className:"icon-link",onClick:X=>{X.stopPropagation(),A?Qe(n.id):ht(n.id)},disabled:Pe||Ce===n.id,title:A?"Unblock user":"Block user",style:{width:"auto",height:"auto",padding:"4px",color:A?"var(--accent)":"var(--danger)"},children:A?e.jsx(je,{size:16}):e.jsx(ze,{size:16})})]})]},n.id)})})})]})]}),i.length>0&&e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Members"}),e.jsx("div",{className:"col",style:{gap:4},children:(()=>{const n=i.filter(u=>u.joined_at!==null).sort((u,A)=>{const X=u.role==="owner"||u.user_id===(a==null?void 0:a.owner_id),xe=A.role==="owner"||A.user_id===(a==null?void 0:a.owner_id);return X&&!xe?-1:!X&&xe?1:(A.joined_at||0)-(u.joined_at||0)}),g=i.filter(u=>u.invited_at!==null&&u.joined_at===null);return e.jsxs(e.Fragment,{children:[n.map(u=>{const A=l&&a&&l.id===a.owner_id,X=u.user_id===(l==null?void 0:l.id),xe=u.user_id===(a==null?void 0:a.owner_id)||u.role==="owner";return e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 0"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flex:1,minWidth:0},children:[u.avatar_url&&e.jsx("img",{src:u.avatar_url,width:32,height:32,style:{borderRadius:"50%"},alt:u.username}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:u.username}),e.jsx("div",{className:"muted",style:{fontSize:12,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:u.role})]})]}),A&&!xe&&e.jsx("button",{className:"icon-link",onClick:()=>yt(u.user_id),disabled:H===u.user_id,title:"Remove member",style:{width:"auto",height:"auto",padding:"4px",color:"var(--danger)"},children:e.jsx(ue,{size:16})}),!A&&X&&e.jsx("button",{className:"icon-link",onClick:xt,disabled:H===u.user_id,title:"Leave queue",style:{width:"auto",height:"auto",padding:"4px",color:"var(--muted)"},children:e.jsx(Tt,{size:16})})]},u.user_id)}),g.length>0&&e.jsx(e.Fragment,{children:g.map(u=>e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 0",opacity:.7},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flex:1,minWidth:0},children:[u.avatar_url&&e.jsx("img",{src:u.avatar_url,width:32,height:32,style:{borderRadius:"50%"},alt:u.username}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:u.username}),e.jsx("div",{className:"muted",style:{fontSize:12,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Invited"})]})]}),e.jsx("button",{className:"icon-link",onClick:()=>vt(u.user_id),disabled:H===u.user_id,title:"Cancel invitation",style:{width:"auto",height:"auto",padding:"4px",color:"var(--danger)"},children:e.jsx(fe,{size:16})})]},u.user_id))})]})})()})]}),le&&e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Blocked Users"}),_e.length===0?e.jsx("div",{className:"muted",style:{fontSize:12,padding:"8px 0",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"No blocked users"}):e.jsx("div",{className:"col",style:{gap:4},children:_e.map(n=>e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 0"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flex:1,minWidth:0},children:[n.avatar_url&&e.jsx("img",{src:n.avatar_url,width:32,height:32,style:{borderRadius:"50%"},alt:n.username}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:n.username}),n.blocked_by_username&&e.jsxs("div",{className:"muted",style:{fontSize:12,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:["Blocked by ",n.blocked_by_username]})]})]}),e.jsx("button",{className:"icon-link",onClick:()=>Qe(n.user_id),disabled:Ce===n.user_id,title:"Unblock user",style:{width:"auto",height:"auto",padding:"4px",color:"var(--accent)"},children:e.jsx(je,{size:16})})]},n.user_id))})]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end",marginTop:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:ce,disabled:z||L,style:{fontSize:13,padding:"8px 16px"},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:z||L,style:{fontSize:13,padding:"8px 16px"},children:z?"Updating...":"Save Changes"})]})]})})]})})]})]})]}),document.body),e.jsx("style",{children:`
        /* Hide inline submit form on mobile – mobile uses floating FAB instead */
        html.is-mobile .queue-submit-desktop-only {
          display: none;
        }

        .queue-member-avatar {
          width: 32px;
          height: 32px;
          border-radius: 9999px;
          padding: 0;
          border: 1px solid rgba(255,255,255,0.08);
          overflow: hidden;
          cursor: pointer;
          background: transparent;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          text-decoration: none;
          transition: border-color 0.2s;
        }
        .queue-member-avatar:hover {
          border-color: rgba(167, 139, 250, 0.4);
        }
        .queue-member-avatar img {
          width: 100%;
          height: 100%;
          object-fit: cover;
          display: block;
        }
        .queue-member-tooltip {
          position: absolute;
          bottom: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
          background: rgba(18, 20, 24, 0.95);
          color: var(--text, #e5e7eb);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 14px;
          white-space: nowrap;
          z-index: 10000;
          pointer-events: none;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
        }
        .queue-member-tooltip::after {
          content: '';
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translateX(-50%);
          width: 0;
          height: 0;
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-top: 5px solid rgba(18, 20, 24, 0.95);
        }
        .queue-status-badge {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          border-radius: 12px;
          font-size: 12px;
          font-weight: 600;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
          border: 1px solid;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }
        .queue-status-badge:disabled {
          cursor: not-allowed;
          opacity: 0.6;
        }
        .queue-status-badge.status-open {
          background: rgba(52, 211, 153, 0.15);
          border-color: rgba(52, 211, 153, 0.4);
          color: #34d399;
        }
        .queue-status-badge.status-open:hover:not(:disabled) {
          background: rgba(52, 211, 153, 0.25);
          border-color: rgba(52, 211, 153, 0.5);
        }
        .queue-status-badge.status-closed {
          background: rgba(245, 158, 11, 0.15);
          border-color: rgba(245, 158, 11, 0.4);
          color: #f59e0b;
        }
        .queue-status-badge.status-closed:hover:not(:disabled) {
          background: rgba(245, 158, 11, 0.25);
          border-color: rgba(245, 158, 11, 0.5);
        }
      `})]}):e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"Queue not found"})}function cs(){const{data:t=[],isLoading:s}=Dt(),a=Wt(),c=Qt(),{notify:i}=me(),p=at(),m=be(),[x,v]=o.useState(new Set),{data:k}=Re(),[l,b]=o.useState(!1),[S,q]=o.useState(!1),[_,w]=o.useState(!1),B=o.useRef(null),R=o.useRef(null),W=!!(k!=null&&k.is_admin||k!=null&&k.is_mod);$t(B,R,l,()=>b(!1));const N=async d=>{a.mutate(d,{onSuccess:()=>{}})},y=async d=>{d.startsWith("n:")&&c.mutate(d)},T=async()=>{const d=t.filter(j=>!j.read&&(j.id.startsWith("n:")||j.kind==="system"&&!j.id.startsWith("b:"))).map(j=>j.id);d.length>0&&(await N(d),i("All notifications marked as read",{variant:"success"}))},C=d=>{if(!d)return null;try{const j=JSON.parse(d);if((j==null?void 0:j.type)==="queue_invite"&&(j!=null&&j.queue_id))return j}catch{}return null},Z=async(d,j)=>{if(!x.has(d.id)){v(h=>new Set(h).add(d.id));try{await M(I.moddi.queueAccept(String(j)),{method:"POST"}),i("Invitation accepted!",{variant:"success"}),y(d.id),p(`/queues/${j}`)}catch(h){i((h==null?void 0:h.message)||"Failed to accept invitation",{variant:"error"})}finally{v(h=>{const L=new Set(h);return L.delete(d.id),L})}}},P=async(d,j)=>{if(!x.has(d.id)){v(h=>new Set(h).add(d.id));try{await M(I.moddi.queueDeny(String(j)),{method:"POST"}),i("Invitation declined",{variant:"success"}),y(d.id)}catch(h){i((h==null?void 0:h.message)||"Failed to decline invitation",{variant:"error"})}finally{v(h=>{const L=new Set(h);return L.delete(d.id),L})}}},re=d=>C(d.text)?e.jsx(nt,{size:20,color:"#a78bfa"}):d.kind==="star"?e.jsx(Xe,{size:20,color:"#f59e0b"}):d.kind==="likes5"?e.jsx(Ge,{size:20,color:"#f472b6"}):d.kind==="comment"?e.jsx(ge,{size:20,color:"#60a5fa"}):d.kind==="inspiration"?e.jsx(ge,{size:20,color:"#7dd3fc"}):d.kind==="reaction"?e.jsx(Ke,{size:20,color:"#10b981"}):d.id.startsWith("b:")?e.jsx(Ve,{size:20,color:"#a78bfa"}):null,J=d=>C(d.text)?"Queue Invitation":d.kind==="star"?"Star":d.kind==="likes5"?"Likes":d.kind==="comment"?"Comment":d.kind==="inspiration"?"Inspiration":d.kind==="reaction"?"Reaction":d.id.startsWith("b:")?"Global":"System",te=t.filter(d=>!d.read&&!(d.id.startsWith("b:")&&d.expiresAt&&d.expiresAt<=Date.now())).length,O=async d=>{if(!(!(k!=null&&k.id)||_)){w(!0);try{const j={kind:d};d==="system"&&(j.text="Test system notification"),await M(I.admin.notificationsTest,{method:"POST",body:JSON.stringify(j)}),i("Test notification sent",{variant:"success"}),m.invalidateQueries({queryKey:["notifications","detailed"]}),m.invalidateQueries({queryKey:["notifications"]})}catch(j){i((j==null?void 0:j.message)||"Failed to send test notification",{variant:"error"})}finally{w(!1),b(!1),q(!1)}}};return e.jsxs("div",{className:"feed-container moddi-feed",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsx("div",{className:"feed-header",children:e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsx("div",{className:"title",children:"Notifications"}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8},children:[W&&e.jsxs("div",{style:{position:"relative"},className:"hide-on-mobile",children:[e.jsxs("button",{ref:B,className:"btn secondary",onClick:()=>b(!l),disabled:_,style:{display:"inline-flex",alignItems:"center",gap:6},children:[e.jsx(Ye,{size:14}),e.jsx("span",{children:"Test"}),e.jsx(de,{size:14,style:{transition:"transform 0.2s ease",transform:l?"rotate(180deg)":"rotate(0deg)"}})]}),l&&e.jsxs("div",{ref:R,className:"menu-panel",role:"menu",style:{position:"absolute",top:"100%",right:0,marginTop:8,minWidth:180,zIndex:1e3},children:[e.jsx("button",{className:"menu-item",type:"button",onClick:()=>O("star"),disabled:_,children:"Test Star"}),e.jsx("button",{className:"menu-item",type:"button",onClick:()=>O("likes5"),disabled:_,children:"Test Likes"}),e.jsx("button",{className:"menu-item",type:"button",onClick:()=>O("comment"),disabled:_,children:"Test Comment"}),e.jsx("button",{className:"menu-item",type:"button",onClick:()=>O("inspiration"),disabled:_,children:"Test Inspiration"}),e.jsx("button",{className:"menu-item",type:"button",onClick:()=>O("reaction"),disabled:_,children:"Test Reaction"}),e.jsx("button",{className:"menu-item",type:"button",onClick:()=>O("system"),disabled:_,children:"Test System"})]})]}),te>0&&e.jsxs("button",{className:"btn secondary",onClick:T,children:[e.jsx(Je,{size:16,style:{marginRight:6}}),"Mark all read"]})]})]})}),W&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"mobile-fab","aria-label":"Test notification",title:"Test notification",onClick:()=>q(!0),children:e.jsx(Ye,{size:22})}),e.jsx(Ae,{open:S,onClose:()=>q(!1),children:e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",style:{marginBottom:4},children:"Send Test Notification"}),e.jsx("div",{className:"muted",style:{fontSize:13,marginBottom:8},children:"Send a test notification to yourself to preview how it appears."}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsxs("button",{className:"btn secondary",onClick:()=>O("star"),disabled:_,style:{width:"100%",justifyContent:"flex-start",padding:"12px 16px",display:"flex",alignItems:"center",gap:12},children:[e.jsx(Xe,{size:18,color:"#f59e0b"}),e.jsxs("div",{className:"col",style:{gap:2,alignItems:"flex-start",flex:1},children:[e.jsx("span",{style:{fontWeight:500},children:"Star"}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"One of your posts was starred!"})]})]}),e.jsxs("button",{className:"btn secondary",onClick:()=>O("likes5"),disabled:_,style:{width:"100%",justifyContent:"flex-start",padding:"12px 16px",display:"flex",alignItems:"center",gap:12},children:[e.jsx(Ge,{size:18,color:"#f472b6"}),e.jsxs("div",{className:"col",style:{gap:2,alignItems:"flex-start",flex:1},children:[e.jsx("span",{style:{fontWeight:500},children:"Likes"}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"One of your posts reached 5 likes!"})]})]}),e.jsxs("button",{className:"btn secondary",onClick:()=>O("comment"),disabled:_,style:{width:"100%",justifyContent:"flex-start",padding:"12px 16px",display:"flex",alignItems:"center",gap:12},children:[e.jsx(ge,{size:18,color:"#60a5fa"}),e.jsxs("div",{className:"col",style:{gap:2,alignItems:"flex-start",flex:1},children:[e.jsx("span",{style:{fontWeight:500},children:"Comment"}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Someone commented on your post"})]})]}),e.jsxs("button",{className:"btn secondary",onClick:()=>O("inspiration"),disabled:_,style:{width:"100%",justifyContent:"flex-start",padding:"12px 16px",display:"flex",alignItems:"center",gap:12},children:[e.jsx(ge,{size:18,color:"#7dd3fc"}),e.jsxs("div",{className:"col",style:{gap:2,alignItems:"flex-start",flex:1},children:[e.jsx("span",{style:{fontWeight:500},children:"Inspiration"}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Someone is inspired by you!"})]})]}),e.jsxs("button",{className:"btn secondary",onClick:()=>O("reaction"),disabled:_,style:{width:"100%",justifyContent:"flex-start",padding:"12px 16px",display:"flex",alignItems:"center",gap:12},children:[e.jsx(Ke,{size:18,color:"#10b981"}),e.jsxs("div",{className:"col",style:{gap:2,alignItems:"flex-start",flex:1},children:[e.jsx("span",{style:{fontWeight:500},children:"Reaction"}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Someone raised their hand on your post!"})]})]}),e.jsxs("button",{className:"btn secondary",onClick:()=>O("system"),disabled:_,style:{width:"100%",justifyContent:"flex-start",padding:"12px 16px",display:"flex",alignItems:"center",gap:12},children:[e.jsx(Ve,{size:18,color:"#a78bfa"}),e.jsxs("div",{className:"col",style:{gap:2,alignItems:"flex-start",flex:1},children:[e.jsx("span",{style:{fontWeight:500},children:"System"}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Test system notification"})]})]})]})]})})]}),e.jsx("div",{className:"feed-list-wrapper",style:{borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:s?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"Loading..."}):t.length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No notifications yet."}):e.jsx("div",{className:"col",style:{gap:0},children:t.filter(d=>!(d.id.startsWith("b:")&&d.expiresAt&&d.expiresAt<=Date.now())).map(d=>{const j=({notif:h})=>{const[L,K]=o.useState(0),[pe,ie]=o.useState(!1),$=o.useRef(null),ae=o.useRef(null),z=o.useRef(null),ee=o.useRef(null),V=f=>{h.id.startsWith("n:")&&($.current=f.touches[0].clientX,ee.current=f.touches[0].clientY,ae.current=Date.now(),ie(!1))},ne=f=>{if($.current===null||ee.current===null||!h.id.startsWith("n:"))return;const F=f.touches[0].clientX,E=f.touches[0].clientY,Y=F-$.current,U=Math.abs(E-ee.current);Math.abs(Y)>U&&(ie(!0),K(Math.max(-80,Math.min(0,Y))))},H=()=>{if($.current===null)return;L<=-60&&y(h.id),K(0),ie(!1),$.current=null,ee.current=null,ae.current=null},se=h.id.startsWith("n:"),r=typeof h.targetPath=="string"&&h.targetPath.trim().length>0?h.targetPath.trim():null;return e.jsxs("div",{ref:z,style:{position:"relative",background:h.read?"var(--panel-dark)":"var(--panel)",borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)",padding:16,cursor:r?"pointer":"default",opacity:h.read?.7:1,transform:`translateX(${L}px)`,transition:pe?"none":"transform 0.2s ease",touchAction:se?"pan-x pan-y":"pan-y"},onTouchStart:V,onTouchMove:ne,onTouchEnd:H,onTouchCancel:H,onClick:()=>{if(!(Math.abs(L)>10)){if(!h.read&&h.id.startsWith("n:")&&N([h.id]),r){p(r);return}h.videoId&&(window.location.hash="/feed")}},children:[se&&e.jsx("div",{style:{position:"absolute",right:0,top:0,bottom:0,width:80,background:"#f87171",display:"flex",alignItems:"center",justifyContent:"center",opacity:Math.abs(L)/80,pointerEvents:"none",zIndex:0},children:e.jsx(ue,{size:20,color:"#fff"})}),e.jsxs("div",{className:"row",style:{alignItems:"flex-start",gap:12,position:"relative",zIndex:1},children:[e.jsx("div",{style:{width:40,height:40,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.05)",borderRadius:"50%"},children:re(h)}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[e.jsx("strong",{style:{fontSize:14},children:J(h)}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8},children:[e.jsx("span",{className:"muted",style:{fontSize:12},children:new Date(h.createdAt).toLocaleDateString()}),h.id.startsWith("n:")&&e.jsx("button",{className:"icon-link hide-on-mobile",onClick:f=>{f.stopPropagation(),y(h.id)},style:{padding:4},children:e.jsx(ue,{size:14})})]})]}),e.jsx("div",{style:{fontSize:14,wordBreak:"break-word"},children:(()=>{const f=C(h.text);return f?`${f.inviter_username} invited you to join queue: ${f.queue_name}`:h.text||(h.kind==="star"?"One of your posts was starred!":h.kind==="likes5"?"One of your posts reached 5 likes!":h.kind==="comment"?"Someone commented on your post":h.kind==="inspiration"?"Someone is inspired by you!":h.kind==="reaction"?"Someone raised their hand on your post!":"")})()}),(()=>{const f=C(h.text);return f&&!x.has(h.id)?e.jsxs("div",{className:"row",style:{gap:8,marginTop:12},children:[e.jsxs("button",{className:"btn",onClick:F=>{F.stopPropagation(),Z(h,f.queue_id)},style:{fontSize:13,padding:"6px 12px"},children:[e.jsx(Je,{size:14,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:F=>{F.stopPropagation(),P(h,f.queue_id)},style:{fontSize:13,padding:"6px 12px"},children:[e.jsx(fe,{size:14,style:{marginRight:4}}),"Decline"]})]}):f&&x.has(h.id)?e.jsx("div",{className:"muted",style:{fontSize:12,marginTop:8},children:"Processing..."}):null})(),h.read&&h.readAt&&e.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["Read ",new Date(h.readAt).toLocaleString()]})]})]})]},h.id)};return e.jsx(j,{notif:d},d.id)})})})]})}function Gt({tabs:t,activeTab:s,onChange:a}){return e.jsx("div",{className:"tab-header",style:{display:"flex",background:"var(--panel)",borderBottom:"1px solid rgba(255,255,255,0.08)"},children:t.map((c,i)=>{const p=c.id===s,m=i===t.length-1;return e.jsxs("button",{onClick:()=>a(c.id),style:{flex:1,padding:"14px 16px",background:"transparent",border:"none",borderRight:m?"none":"1px solid rgba(255,255,255,0.08)",color:p?"var(--text)":"var(--muted)",fontWeight:p?600:400,fontSize:14,fontFamily:"inherit",cursor:"pointer",transition:"all 0.15s ease",position:"relative"},onMouseEnter:x=>{p||(x.currentTarget.style.backgroundColor="rgba(255,255,255,0.02)")},onMouseLeave:x=>{x.currentTarget.style.backgroundColor="transparent"},children:[c.label,p&&e.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:2,background:"var(--accent, #667eea)",borderRadius:"2px 2px 0 0"}})]},c.id)})})}function Kt({queue:t}){const s=t.type||"modder";return e.jsx(Ie,{to:`/queues/${t.id}`,style:{textDecoration:"none",color:"inherit",display:"block"},children:e.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid rgba(255,255,255,0.06)",background:"var(--panel)",transition:"background-color 0.15s ease",cursor:"pointer",position:"relative"},onMouseEnter:a=>a.currentTarget.style.background="rgba(255,255,255,0.04)",onMouseLeave:a=>a.currentTarget.style.background="var(--panel)",children:[e.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",fontSize:10,fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",padding:"2px 6px",borderRadius:4,background:s==="nominator"?"rgba(139, 92, 246, 0.2)":"rgba(255, 255, 255, 0.1)",color:s==="nominator"?"#a78bfa":"var(--muted)",border:s==="nominator"?"1px solid rgba(139, 92, 246, 0.3)":"1px solid rgba(255, 255, 255, 0.1)"},children:s==="nominator"?"Nominator":"Modder"}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:12,marginBottom:8},children:[t.is_group?e.jsx(Ct,{size:18}):e.jsx(ge,{size:18}),e.jsx("strong",{style:{fontSize:16},children:t.name}),(t.is_open??1)===1?e.jsx(je,{size:18,style:{color:"#10b981"}}):e.jsx(ze,{size:18,style:{color:"#ef4444"}})]}),t.description&&e.jsx("div",{className:"muted",style:{fontSize:14,marginBottom:8},children:e.jsx(Ee,{text:t.description})}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,fontSize:12},children:[t.owner_avatar_url&&e.jsx("img",{src:t.owner_avatar_url,width:20,height:20,style:{borderRadius:"50%"}}),e.jsxs("span",{className:"muted",children:["by ",t.owner_username,(()=>{const a=t.member_count||0;return a===0?null:a===1&&t.first_member_username?` and ${t.first_member_username}`:a>1?` & ${a} others`:null})()]}),e.jsx("span",{className:"muted",children:"•"}),e.jsx("span",{className:"muted",children:new Date(t.created_at*1e3).toLocaleDateString()})]})]})})}function Vt(){const[t,s]=G.useState(!1),[a,c]=G.useState(""),[i,p]=G.useState(""),{data:m=[]}=Le(),{data:x}=Re(),{notify:v}=me(),k=dt(),l=G.useMemo(()=>x?m.some(S=>S.owner_id===x.id):!1,[x,m]),b=S=>{if(S&&S.preventDefault(),l){v("You can only create one queue. You can join other queues as a member.",{variant:"error"});return}if(!a.trim()){v("Queue name is required",{variant:"error"});return}k.mutate({name:a.trim(),description:i.trim()||null,is_group:!1},{onSuccess:()=>{v("Queue created!",{variant:"success"}),s(!1),c(""),p("")},onError:q=>{v((q==null?void 0:q.message)||"Failed to create queue",{variant:"error"})}})};return e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"mobile-fab","aria-label":"Create queue",title:"Create queue",onClick:()=>s(!0),children:e.jsx(Me,{size:22})}),e.jsx(Ae,{open:t,onClose:()=>s(!1),children:e.jsxs("form",{onSubmit:b,className:"col",style:{gap:12},children:[l?e.jsx("div",{className:"muted",style:{fontSize:14,lineHeight:1.5},children:"You already own a queue. You can join other queues as a member, but you can only create one queue."}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Queue name",value:a,onChange:S=>c(S.target.value),maxLength:100,required:!0,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"inherit",fontSize:14}}),e.jsx("textarea",{placeholder:"Description (optional)",value:i,onChange:S=>p(S.target.value),maxLength:500,rows:3,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"inherit",fontSize:14,resize:"vertical"}})]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:()=>s(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:k.isPending||l,children:k.isPending?"Creating...":"Create"})]})]})})]})}const Zt=({context:t})=>{const s=st(),{tagFilters:a,setTagFilters:c,queueOpenFilters:i,setQueueOpenFilters:p,queueTypeFilters:m,setQueueTypeFilters:x,queueStatusFilters:v,setQueueStatusFilters:k}=ke(),l=G.useMemo(()=>{if(t)return t;const N=s.pathname;return N==="/feed"?"unified-feed":N==="/mp/feed"?"mappi-feed":N==="/md/feed"?"moddi-feed":N==="/queues"||N==="/md/queues"?"moddi-queues":N.startsWith("/queues/")||N.startsWith("/md/queues/")?"moddi-queue-detail":"unified-feed"},[t,s.pathname]),b=N=>{const y={...a,[N]:!a[N]};!y.untagged&&!y.help&&!y.showcase&&!y.request&&(y.untagged=!0),c(y);try{window.dispatchEvent(new Event("moddifilterchange"))}catch{}},S=N=>{const y={...i,[N]:!i[N]};!y.open&&!y.closed&&(y.open=!0),p(y)},q=N=>{const y={...m,[N]:!m[N]};!y.modder&&!y.nominator&&(y.modder=!0),x(y)},_=N=>{const y={...v,[N]:!v[N]};["unchecked","accepted","denied","finished"].some(C=>y[C])||(y.unchecked=!0),k(y)},w=({active:N,onClick:y,label:T})=>e.jsx("button",{type:"button",onClick:y,className:"desktop-filter-chip","aria-pressed":N,"data-active":N,children:T}),B=l==="unified-feed"||l==="moddi-feed",R=l==="moddi-queues",W=l==="moddi-queue-detail";return e.jsxs("div",{className:"desktop-filter-bar",children:[B&&e.jsxs(e.Fragment,{children:[e.jsx(w,{active:a.untagged,onClick:()=>b("untagged"),label:"untagged"}),e.jsx(w,{active:a.help,onClick:()=>b("help"),label:"help"}),e.jsx(w,{active:a.showcase,onClick:()=>b("showcase"),label:"showcase"}),e.jsx(w,{active:a.request,onClick:()=>b("request"),label:"request"})]}),R&&e.jsxs(e.Fragment,{children:[e.jsx(w,{active:i.open,onClick:()=>S("open"),label:"open"}),e.jsx(w,{active:i.closed,onClick:()=>S("closed"),label:"closed"}),e.jsx("span",{className:"desktop-filter-divider"}),e.jsx(w,{active:m.modder,onClick:()=>q("modder"),label:"modder"}),e.jsx(w,{active:m.nominator,onClick:()=>q("nominator"),label:"nominator"})]}),W&&e.jsxs(e.Fragment,{children:[e.jsx(w,{active:v.unchecked,onClick:()=>_("unchecked"),label:"pending"}),e.jsx(w,{active:v.accepted,onClick:()=>_("accepted"),label:"accepted"}),e.jsx(w,{active:v.denied,onClick:()=>_("denied"),label:"denied"}),e.jsx(w,{active:v.finished,onClick:()=>_("finished"),label:"finished"})]})]})},es=[{id:"queues",label:"Queues"},{id:"submissions",label:"Submissions"}];function us(){const[t,s]=qt(),a=t.get("tab")||"queues",[c,i]=o.useState(a),{data:p=[],isLoading:m}=Le(),{data:x}=Re(),{queueOpenFilters:v,queueTypeFilters:k}=ke(),l=dt(),{notify:b}=me(),[S,q]=o.useState(!1),[_,w]=o.useState(""),[B,R]=o.useState(""),[W,N]=o.useState([]),[y,T]=o.useState(!1);o.useEffect(()=>{c==="submissions"&&C()},[c]);const C=async()=>{try{T(!0);const d=await M(I.moddi.mySubmissions);N(d.items)}catch(d){console.error(d),b("Failed to load submissions",{variant:"error"})}finally{T(!1)}},Z=d=>{i(d),s(d==="queues"?{}:{tab:d})},P=o.useMemo(()=>x?p.some(d=>d.owner_id===x.id):!1,[x,p]),re=async d=>{if(d.preventDefault(),P){b("You can only create one queue. You can join other queues as a member.",{variant:"error"});return}if(!_.trim()){b("Queue name is required",{variant:"error"});return}l.mutate({name:_.trim(),description:B.trim()||null,is_group:!1},{onSuccess:()=>{b("Queue created!",{variant:"success"}),q(!1),w(""),R("")},onError:j=>{b((j==null?void 0:j.message)||"Failed to create queue",{variant:"error"})}})},J=o.useMemo(()=>p.filter(d=>{const j=(d.is_open??1)===1;if(!(v.open&&v.closed||v.open&&!v.closed&&j||!v.open&&v.closed&&!j))return!1;const L=d.type||"modder";return L==="modder"&&k.modder||L==="nominator"&&k.nominator}),[p,v,k]),te=d=>{N(j=>j.map(h=>h.id===d.id?{...h,...d}:h))},O=d=>{N(j=>j.filter(h=>h.id!==d))};return e.jsxs("div",{className:"feed-container unified-queues",style:{width:"100%",maxWidth:"600px",margin:"0 auto"},children:[e.jsx(Gt,{tabs:es,activeTab:c,onChange:Z}),c==="queues"&&e.jsxs(e.Fragment,{children:[e.jsx(Vt,{}),e.jsx("div",{className:"feed-header",children:e.jsx("div",{style:{background:"var(--panel)",border:"1px solid var(--divider)",borderRadius:10,marginBottom:0},children:P?e.jsx("div",{style:{padding:"12px"},children:e.jsx("div",{className:"muted",style:{fontSize:14,lineHeight:1.5},children:"You already own a queue. You can join other queues as a member, but you can only create one queue."})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",cursor:"pointer",padding:"8px 12px",minHeight:36},onClick:()=>q(!S),children:[e.jsx("span",{style:{fontWeight:600,fontSize:16,lineHeight:1},children:"Create a queue!"}),S?e.jsx(zt,{size:16}):e.jsx(de,{size:16})]}),S&&e.jsx("form",{onSubmit:re,style:{padding:"12px",borderTop:"1px solid var(--border-subtle)"},children:e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("input",{type:"text",placeholder:"Queue name",value:_,onChange:d=>w(d.target.value),maxLength:100,required:!0,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"inherit",fontSize:14}}),e.jsx("textarea",{placeholder:"Description (optional)",value:B,onChange:d=>R(d.target.value),maxLength:500,rows:3,style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"inherit",fontSize:14,resize:"vertical"}}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:d=>{d.stopPropagation(),q(!1)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:l.isPending||P,onClick:d=>d.stopPropagation(),children:l.isPending?"Creating...":"Create"})]})]})})]})})}),e.jsx("div",{className:"feed-list-wrapper",style:{borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)",paddingBottom:"60px"},children:e.jsx("div",{className:"col",style:{gap:0},children:m?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"Loading..."}):J.length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No queues match the selected filter."}):J.map(d=>e.jsx(Kt,{queue:d},d.id))})}),e.jsx(Zt,{context:"moddi-queues"})]}),c==="submissions"&&e.jsx("div",{className:"feed-list-wrapper",style:{borderTop:"1px solid rgba(255,255,255,0.06)",paddingBottom:"100px"},children:y?e.jsx("div",{className:"muted",style:{padding:32,textAlign:"center"},children:"Loading..."}):W.length===0?e.jsxs("div",{style:{padding:32,textAlign:"center"},children:[e.jsx("div",{className:"muted",children:"You haven't submitted to any queues yet."}),e.jsx("button",{className:"btn",style:{marginTop:16},onClick:()=>Z("queues"),children:"Browse Queues"})]}):e.jsx("div",{className:"col",style:{gap:0},children:W.map(d=>e.jsxs("div",{style:{padding:"16px",borderBottom:"1px solid rgba(255,255,255,0.06)",background:"var(--panel)"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8},children:[e.jsx("span",{className:"muted",style:{fontSize:13},children:"Submitted to"}),e.jsx(Ie,{to:`/queues/${d.queue_id}`,style:{fontWeight:600,color:"var(--text)",textDecoration:"none",fontSize:14},onMouseEnter:j=>j.currentTarget.style.textDecoration="underline",onMouseLeave:j=>j.currentTarget.style.textDecoration="none",children:d.queue_name}),d.queue_type==="nominator"&&e.jsx("span",{style:{fontSize:10,background:"rgba(139, 92, 246, 0.2)",color:"#a78bfa",padding:"2px 6px",borderRadius:4,fontWeight:600,border:"1px solid rgba(139, 92, 246, 0.3)"},children:"NOMINATOR"})]}),e.jsx("span",{className:"muted",style:{fontSize:12},children:new Date(d.created_at*1e3).toLocaleDateString()})]}),e.jsx(Fe,{submission:d,canManage:!1,allowSelfActions:!0,onUpdate:te,onDelete:O})]},d.id))})})]})}export{I as A,Zt as D,Ut as F,cs as N,Ee as O,ds as Q,rs as T,us as U,is as a,Re as b,me as c,M as d,$t as e,os as f,Ot as g,ls as h,Wt as i,Qt as j,ot as k,Dt as l,rt as m,ns as n,Bt as o,as as p,ke as u};
