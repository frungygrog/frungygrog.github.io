const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/About-DgGXV8RR.js","assets/vendor-react-O-yBVenC.js","assets/vendor-CDuzPMMG.js","assets/moddi-routes-BAHBGzbB.js","assets/mappi-routes-BuYlJIUY.js","assets/vendor-hls-B_fsdCYC.js","assets/editor-lib-DWtn2wJw.js","assets/beatmap-preview-C79RZ3qw.js","assets/vendor-zip-ChfUW0Uy.js","assets/editor-lib-CGytSYYz.css","assets/editor-components-n6sMInZP.js","assets/editor-components-Bzmrvihl.css","assets/editor-3q5Z-n3D.js","assets/Moderation-DgVwM8bp.js","assets/Home-BkPH3_0u.js","assets/Settings-B-E92wyK.js"])))=>i.map(i=>d[i]);
var Pt=Object.defineProperty;var zt=(t,m,c)=>m in t?Pt(t,m,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[m]=c;var ht=(t,m,c)=>zt(t,typeof m!="symbol"?m+"":m,c);import{r as i,j as e,e as Ze,u as et,R as ne,L as z,T as Je,U as Dt,V as Ft,B as Xe,W as wt,X as Ot,Y as $t,Z as qt,O as ft,K as Wt,A as Nt,h as kt,P as Bt,Q as Ut,E as Ht,c as tt,H as Vt,l as _t,_ as De,y as Qt,v as Yt,b as Jt,a as Xt,i as St,g as Et,k as Ke,$ as Kt,a0 as xt,o as Gt,x as Zt,a1 as es,a2 as ts,a3 as ss,a4 as ns,a5 as V}from"./vendor-react-O-yBVenC.js";import{y as as}from"./vendor-CDuzPMMG.js";import{u as st,a as A,A as I,c as Ge,P as is,b as Ee,d as rs,C as os,T as ls}from"./mappi-routes-BuYlJIUY.js";import{H as cs,c as ds,b as us,a as ms,i as ps}from"./editor-components-n6sMInZP.js";import{u as He,a as nt,b as hs,c as fs,d as xs,e as gs,f as bs,g as vs,C as ys,M as js}from"./moddi-routes-BAHBGzbB.js";import{B as ws}from"./editor-lib-DWtn2wJw.js";import"./vendor-hls-B_fsdCYC.js";import"./beatmap-preview-C79RZ3qw.js";import"./vendor-zip-ChfUW0Uy.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))r(f);new MutationObserver(f=>{for(const d of f)if(d.type==="childList")for(const y of d.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&r(y)}).observe(document,{childList:!0,subtree:!0});function c(f){const d={};return f.integrity&&(d.integrity=f.integrity),f.referrerPolicy&&(d.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?d.credentials="include":f.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(f){if(f.ep)return;f.ep=!0;const d=c(f);fetch(f.href,d)}})();const Ns="modulepreload",ks=function(t){return"/"+t},gt={},H=function(m,c,r){let f=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),C=(y==null?void 0:y.nonce)||(y==null?void 0:y.getAttribute("nonce"));f=Promise.allSettled(c.map(S=>{if(S=ks(S),S in gt)return;gt[S]=!0;const R=S.endsWith(".css"),b=R?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${b}`))return;const w=document.createElement("link");if(w.rel=R?"stylesheet":Ns,R||(w.as="script"),w.crossOrigin="",w.href=S,C&&w.setAttribute("nonce",C),document.head.appendChild(w),R)return new Promise((L,E)=>{w.addEventListener("load",L),w.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${S}`)))})}))}function d(y){const C=new Event("vite:preloadError",{cancelable:!0});if(C.payload=y,window.dispatchEvent(C),!C.defaultPrevented)throw y}return f.then(y=>{for(const C of y||[])C.status==="rejected"&&d(C.reason);return m().catch(d)})},_s=new as({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}});class Ss extends i.Component{constructor(c){super(c);ht(this,"handleRetry",()=>{const c=this.isChunkLoadingError(this.state.error);this.setState({hasError:!1,error:null}),c&&window.location.reload()});this.state={hasError:!1,error:null}}static getDerivedStateFromError(c){return{hasError:!0,error:c}}componentDidCatch(c,r){console.error("ErrorBoundary caught an error:",c,r)}isChunkLoadingError(c){if(!c)return!1;const r=c.message.toLowerCase();return r.includes("loading chunk")||r.includes("failed to load")||r.includes("chunk load failed")||r.includes("loading css chunk")||c.name==="ChunkLoadError"}render(){var c;if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const r=this.isChunkLoadingError(this.state.error),f=((c=this.state.error)==null?void 0:c.message)||"An unexpected error occurred";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"8px",color:"var(--muted)"},children:r?"Failed to load page. This might be a network issue.":f}),r&&e.jsx("p",{style:{marginBottom:"24px",fontSize:"14px",color:"var(--muted)",opacity:.8},children:"Try checking your internet connection or reloading the page."}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{className:"btn secondary",onClick:this.handleRetry,children:r?"Reload Page":"Try Again"}),!r&&e.jsx("button",{className:"btn secondary",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})}return this.props.children}}const ge=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function Es({i:t}){const m=t*1337,c=(E,Q)=>{const q=Math.sin(m+E+Q)*1e4,K=q-Math.floor(q);return Math.floor(K*(Q-E+1)+E)},r=c(0,100),f=c(24,50),d=.7+c(0,100)/100*.3,y=f*d,C=c(0,4e3),S=c(-10,10),R=c(-8,8),b=c(0,100),w=b<60?1:b<80?1.5:2,L=[{size:200*w,alpha:.06,dx:-22,dy:12,color:ge[c(0,ge.length-1)]},{size:150*w,alpha:.08,dx:-9,dy:7,color:ge[c(0,ge.length-1)]},{size:120*w,alpha:.1,dx:0,dy:0,color:ge[c(0,ge.length-1)]},{size:90*w,alpha:.12,dx:12,dy:-4,color:ge[c(0,ge.length-1)]},{size:64*w,alpha:.13,dx:20,dy:-7,color:ge[c(0,ge.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${r}vw`,animationDuration:`${y}s`,animationDelay:`${C}ms`,"--tx":`${S}vw`,transform:`rotate(${R}deg)`},children:L.map((E,Q)=>e.jsx("svg",{width:E.size,height:E.size,viewBox:"0 0 100 100",style:{left:`${50+E.dx}%`,bottom:`${E.dy}px`,transform:"translateX(-50%)","--alpha":E.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:E.color})},Q))})}function Ct({paused:t=!1}){const m=i.useMemo(()=>new Array(20).fill(0).map((c,r)=>r),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:m.map(c=>e.jsx(Es,{i:c},c))})}function Cs(){const t=Ze(),m=et(),{lastSection:c}=He(),r=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",f=t.pathname==="/editor";t.pathname.startsWith("/mp/")||!r&&t.pathname.startsWith("/md/");const d=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!r&&!t.pathname.startsWith("/mp/")&&c==="moddi";if(f||r)return null;const y=()=>{m(d?"/mp/feed":"/md/feed")},C=ne.useRef(null),S=ne.useRef(!1),R=()=>{S.current=!1,C.current=setTimeout(()=>{S.current=!0,m("/")},500)},b=()=>{C.current&&(clearTimeout(C.current),C.current=null),S.current&&setTimeout(()=>{S.current=!1},100)},w=E=>{if(S.current){E.preventDefault(),E.stopPropagation();return}y()},L=E=>{b(),S.current&&E.preventDefault()};return ne.useEffect(()=>()=>{C.current&&clearTimeout(C.current)},[]),e.jsxs("nav",{className:"mobile-bottom-nav",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx(z,{to:d?"/md/feed":"/mp/feed",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/feed"||t.pathname==="/md/feed"?"active":""}`,"aria-label":"Feed",children:e.jsx(Je,{size:20})}),d?e.jsx(z,{to:"/md/queues",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/md/queues")?"active":""}`,"aria-label":"Queues",children:e.jsx(Dt,{size:20})}):e.jsx(z,{to:"/mp/discover",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/discover"?"active":""}`,"aria-label":"Discover",children:e.jsx(Ft,{size:20})})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:w,onTouchStart:R,onTouchEnd:L,onMouseDown:R,onMouseUp:b,onMouseLeave:b,"aria-label":d?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",title:d?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",children:e.jsx("span",{className:"mobile-coin-flip-text",children:d?"md!":"mp!"})}),e.jsxs("div",{className:"mobile-bottom-nav-right",children:[e.jsx(z,{to:"/profile",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/profile")?"active":""}`,"aria-label":"Profile",children:e.jsx(Xe,{size:20})}),e.jsx("button",{className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/settings"?"active":""}`,onClick:()=>m("/settings"),"aria-label":"Settings",children:e.jsx(wt,{size:20})})]})]})}function je(t){t._preloading||(t._preloading=!0,t().then(()=>{t._preloaded=!0}).catch(()=>{delete t._preloading}))}function Is(t){t.forEach(je)}function Rs(t){const m=()=>{Is(t)};"requestIdleCallback"in window?requestIdleCallback(m,{timeout:2e3}):setTimeout(m,1e3)}function Ts(){const t=Ze(),m=et(),{notify:c}=st(),{data:r,isLoading:f}=nt(),{data:d}=hs(!!r),{data:y=[]}=fs(!!r),C=xs(),S=gs(),R=bs(),b=vs(),[w,L]=i.useState(new Set),E=i.useRef(null),Q=i.useRef(null),q=i.useRef(null),K=i.useRef(null),N=i.useRef(null),P=i.useRef(null),M=i.useRef(null),x=i.useRef(null),{menuOpen:G,mobileNavOpen:W,notifOpen:O,filtersOpen:te,modeFilters:ie,tagFilters:de,queueStatusFilters:re,lastSection:D,setMenuOpen:Y,setMobileNavOpen:Z,setNotifOpen:T,setFiltersOpen:ee,closeAllPanels:ae,setModeFilters:l,setTagFilters:k,setQueueStatusFilters:j,setLastSection:B}=He(),oe=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",Ce=t.pathname==="/editor",ve=t.pathname.startsWith("/mp/")||!oe&&!t.pathname.startsWith("/md/")&&D==="mappi",J=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!oe&&!t.pathname.startsWith("/mp/")&&D==="moddi",Oe=t.pathname.startsWith("/md/queues/")&&t.pathname!=="/md/queues";ne.useEffect(()=>{t.pathname.startsWith("/mp/")?B("mappi"):t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"&&B("moddi")},[t.pathname,B]);const[$e,he]=ne.useState(0);ne.useEffect(()=>{const a=setInterval(()=>he(p=>p+1),1e3);return()=>clearInterval(a)},[]);const[we,Ne]=ne.useState(null);ne.useEffect(()=>{!r||!r.is_mod||(async()=>{try{const a=await A(I.admin.debugState,{requireAuth:!1}),p=Array.isArray(a==null?void 0:a.counts)?a.counts.find(h=>String(h.status)==="ready"):null;p&&Ne(Number(p.c)||0)}catch{}})()},[r]);const[ke,Ie]=ne.useState(!1),U=async()=>{Ie(!0);try{const a=await A(I.admin.clearViews,{method:"POST"});c(`Cleared ${Number((a==null?void 0:a.deleted)||0)} views from your history.`,{variant:"success"});try{localStorage.removeItem("feed_seen_ids")}catch{}try{window.dispatchEvent(new Event("filterchange"))}catch{}}catch{c("Failed to clear view history",{variant:"error"})}finally{Ie(!1)}},qe=a=>{if(!a)return null;try{const p=JSON.parse(a);if((p==null?void 0:p.type)==="queue_invite"&&(p!=null&&p.queue_id))return p}catch{}return null},_e=async(a,p)=>{if(!w.has(a.id)){L(h=>new Set(h).add(a.id));try{await A(I.moddi.queueAccept(String(p)),{method:"POST"}),c("Invitation accepted!",{variant:"success"}),b.mutate(a.id),T(!1),m(`/md/queues/${p}`)}catch(h){c((h==null?void 0:h.message)||"Failed to accept invitation",{variant:"error"})}finally{L(h=>{const _=new Set(h);return _.delete(a.id),_})}}},Re=async(a,p)=>{if(!w.has(a.id)){L(h=>new Set(h).add(a.id));try{await A(I.moddi.queueDeny(String(p)),{method:"POST"}),c("Invitation declined",{variant:"success"}),b.mutate(a.id)}catch(h){c((h==null?void 0:h.message)||"Failed to decline invitation",{variant:"error"})}finally{L(h=>{const _=new Set(h);return _.delete(a.id),_})}}},Te=async()=>{const a=y.filter(p=>p.id.startsWith("n:")||p.kind==="system"&&!p.read).map(p=>p.id);a.length>0&&R.mutate(a)},Le=async a=>{if(T(!1),R.mutate([a.id]),a.kind==="system"||a.id.startsWith("n:"))try{await A(I.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:[a.id]})})}catch{}},Me=async(a,p)=>{a.stopPropagation(),b.mutate(p)},Ae=()=>{const p=Object.entries(ie).filter(([h,_])=>_).map(([h])=>h);p.length,p.length===0&&l({standard:!0,taiko:!1,mania:!1,catch:!1});try{window.dispatchEvent(new Event("filterchange"))}catch{}ee(!1)},Se=()=>{const p=Object.entries(de).filter(([h,_])=>_).map(([h])=>h);p.length,p.length===0&&k({untagged:!0,help:!0});try{window.dispatchEvent(new Event("moddifilterchange"))}catch{}ee(!1)};return ne.useEffect(()=>{r&&!localStorage.getItem("welcomed")&&(c(`Welcome, ${r.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[r,c]),ne.useEffect(()=>{if(!O)return;const a=p=>{const h=p.target;Q.current&&!Q.current.contains(h)&&E.current&&!E.current.contains(h)&&T(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[O,T]),ne.useEffect(()=>{if(!G)return;const a=p=>{const h=p.target;K.current&&!K.current.contains(h)&&q.current&&!q.current.contains(h)&&Y(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[G,Y]),ne.useEffect(()=>{if(!W)return;const a=p=>{const h=p.target;P.current&&!P.current.contains(h)&&N.current&&!N.current.contains(h)&&Z(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[W,Z]),ne.useEffect(()=>{if(!te)return;const a=p=>{const h=p.target;x.current&&!x.current.contains(h)&&M.current&&!M.current.contains(h)&&ee(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[te,ee]),e.jsxs("div",{className:"app-shell","data-section":J?"moddi":ve?"mappi":D==="moddi"?"moddi":D==="mappi"?"mappi":void 0,children:[e.jsx(Ct,{paused:t.pathname==="/editor"}),e.jsxs("header",{className:"top-nav",children:[t.pathname!=="/editor"&&e.jsxs("div",{className:"mobile-nav",children:[e.jsx("button",{ref:N,className:"icon-link hamburger",onClick:()=>{W||ae(),Z(a=>!a)},"aria-label":"Menu","aria-expanded":W,children:e.jsx(Ot,{size:18})}),W&&e.jsxs("div",{ref:P,className:"menu-panel",role:"menu",children:[oe&&e.jsx(z,{to:t.pathname==="/"?"/about":"/",className:`menu-item ${t.pathname==="/about"?"active":""}`,onClick:()=>Z(!1),onMouseEnter:()=>t.pathname==="/"&&je(()=>H(()=>import("./About-DgGXV8RR.js"),__vite__mapDeps([0,1,2]))),children:t.pathname==="/"?"About":"Home"}),ve&&e.jsxs(e.Fragment,{children:[e.jsx(z,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>Z(!1),children:"Feed"}),e.jsx(z,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>Z(!1),children:"Discover"})]}),J&&e.jsxs(e.Fragment,{children:[e.jsx(z,{to:"/md/feed",className:`menu-item ${t.pathname==="/md/feed"?"active":""}`,onClick:()=>Z(!1),children:"Feed"}),e.jsx(z,{to:"/md/queues",className:`menu-item ${t.pathname.startsWith("/md/queues")?"active":""}`,onClick:()=>Z(!1),onMouseEnter:()=>je(()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(a=>a.Q),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),children:"Queues"})]}),!ve&&!J&&!oe&&e.jsxs(e.Fragment,{children:[e.jsx(z,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>Z(!1),children:"Feed"}),e.jsx(z,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>Z(!1),children:"Discover"})]})]})]}),oe?e.jsx(z,{to:"/",className:"title",children:J?"osu!moddi.ng":ve?"osu!mappi.ng":"mappi!"}):Ce?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(z,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(Je,{size:18})}),e.jsx(z,{to:J?"/md/feed":"/mp/feed",className:"title",children:J?"osu!moddi.ng":"osu!mappi.ng"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(z,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(Je,{size:18})}),e.jsxs(z,{to:J?"/mp/feed":"/md/feed",className:"title coin-flip-title",children:[e.jsx("span",{className:"coin-flip-front",children:J?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:J?"osu!mappi.ng":"osu!moddi.ng"})]})]}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),t.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(cs,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[oe&&e.jsx(z,{to:t.pathname==="/"?"/about":"/",className:t.pathname==="/about"?"active":"",onMouseEnter:()=>t.pathname==="/"&&je(()=>H(()=>import("./About-DgGXV8RR.js"),__vite__mapDeps([0,1,2]))),children:t.pathname==="/"?"About":"Home"}),ve&&e.jsxs(e.Fragment,{children:[e.jsx(z,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(z,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(z,{to:"/editor",className:t.pathname==="/editor"?"active":"",onMouseEnter:()=>je(()=>H(()=>import("./editor-3q5Z-n3D.js"),__vite__mapDeps([12,1,2,6,7,8,9])).then(a=>({default:a.Editor}))),children:"Editor"})]}),J&&e.jsxs(e.Fragment,{children:[e.jsx(z,{to:"/md/feed",className:t.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx(z,{to:"/md/queues",className:t.pathname.startsWith("/md/queues")?"active":"",onMouseEnter:()=>je(()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(a=>a.Q),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),children:"Queues"})]}),!ve&&!J&&!oe&&e.jsxs(e.Fragment,{children:[e.jsx(z,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(z,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(z,{to:"/editor",className:t.pathname==="/editor"?"active":"",onMouseEnter:()=>je(()=>H(()=>import("./editor-3q5Z-n3D.js"),__vite__mapDeps([12,1,2,6,7,8,9])).then(a=>({default:a.Editor}))),children:"Editor"})]})]}),e.jsx("div",{style:{marginLeft:"auto"}}),e.jsx("a",{className:"icon-link",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)","aria-label":"Join Discord",style:{marginRight:3,transform:"translateY(2px)"},children:e.jsx($t,{size:18})}),r?e.jsxs("div",{className:"user-menu",children:[e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:3},children:[e.jsx("button",{ref:E,className:"icon-link",onClick:()=>{O||ae(),T(a=>!a)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(qt,{size:18})}),C>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),O&&e.jsxs("div",{ref:Q,className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(z,{to:"/md/notifications",onClick:()=>T(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:a=>a.currentTarget.style.opacity="1",onMouseLeave:a=>a.currentTarget.style.opacity="0.7",children:"View all"}),y.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:Te,children:e.jsx(ft,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[y.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),y.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).map(a=>{const p=qe(a.text),h=a.id.startsWith("b:"),_=p?"queue-invite":a.kind==="star"?"star":a.kind==="likes5"?"likes":a.kind==="comment"?"comment":a.kind==="inspiration"?"inspiration":a.kind==="reaction"?"reaction":h?"global":"system",X=a.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${_}`,role:"button",onClick:()=>!p&&Le(a),children:[e.jsxs("div",{className:`notif-icon ${X?"deletable":""}`,"aria-hidden":"true",onClick:X&&!p?s=>Me(s,a.id):void 0,title:X&&!p?"Remove":void 0,role:X&&!p?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:p?e.jsx(Wt,{}):_==="star"?e.jsx(Nt,{}):_==="likes"?e.jsx(kt,{}):_==="comment"?e.jsx(Xe,{}):_==="inspiration"?e.jsx(Xe,{}):_==="reaction"?e.jsx(Bt,{}):_==="global"?e.jsx(Ut,{}):null}),X&&!p?e.jsx("span",{className:"swap-trash",children:e.jsx(Ht,{})}):null]}),e.jsx("div",{className:"notif-body",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Queue Invitation"}),e.jsxs("div",{className:"notif-desc",children:[p.inviter_username," invited you to join queue: ",p.queue_name]}),w.has(a.id)?e.jsx("div",{className:"muted",style:{fontSize:11,marginTop:6},children:"Processing..."}):e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:s=>{s.stopPropagation(),_e(a,p.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(ft,{size:12,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:s=>{s.stopPropagation(),Re(a,p.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(tt,{size:12,style:{marginRight:4}}),"Decline"]})]})]}):a.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:h?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:a.text||""}),h&&a.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(a.expiresAt).toLocaleString()]}):null]}):a.kind==="comment"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Comment"}),e.jsx("div",{className:"notif-desc",children:a.text||"Someone commented on your post"})]}):a.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:a.text||"Someone is inspired by you!"})]}):a.kind==="reaction"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Reaction"}),e.jsx("div",{className:"notif-desc",children:a.text||"Someone raised their hand on your post!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:a.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:a.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},a.id)})]})]})]}),d!=null&&d.blocked?e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(Vt,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:(()=>{const a=Math.max(0,Math.floor((((d==null?void 0:d.reset_at)??0)*1e3-Date.now())/1e3)),p=Math.floor(a/3600),h=Math.floor(a%3600/60),_=a%60,X=s=>String(s).padStart(2,"0");return p>0?`${p}:${X(h)}:${X(_)}`:`${h}:${X(_)}`})()})]}):null,e.jsxs("button",{ref:q,className:"icon-link",onClick:()=>{G||ae(),Y(a=>!a)},title:r.username,"aria-label":"User menu","aria-expanded":G,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[r.avatar_url&&e.jsx("img",{src:r.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:r.username}),e.jsx(_t,{size:14,style:{opacity:.8}})]}),G&&e.jsxs("div",{ref:K,className:"menu-panel",role:"menu",children:[e.jsx(z,{to:"/profile",className:"menu-item",onClick:()=>Y(!1),children:"Profile"}),r!=null&&r.is_admin||r!=null&&r.is_mod?e.jsx(z,{to:"/moderation",className:"menu-item",onClick:()=>Y(!1),onMouseEnter:()=>je(()=>H(()=>import("./Moderation-DgVwM8bp.js"),__vite__mapDeps([13,1,2,4,5,6,7,8,9]))),children:"Moderation"}):null,e.jsx("button",{className:"menu-item",type:"button",onClick:()=>S.mutate(),children:"Log out"})]})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{window.location.href=Ge+I.auth.login},disabled:f,children:f?"Checking…":"Login with osu!"})]})]}),e.jsx("main",{className:`page ${t.pathname==="/editor"||t.pathname==="/mp/discover"?"fullscreen":""}`,children:t.pathname==="/editor"?e.jsx(De,{}):t.pathname==="/mp/discover"?e.jsx(De,{}):t.pathname==="/"?e.jsx(De,{}):t.pathname==="/about"||t.pathname==="/moderation"||t.pathname==="/settings"?e.jsx("div",{className:"card",children:e.jsx(De,{})}):e.jsx(De,{})}),t.pathname!=="/editor"&&e.jsxs(e.Fragment,{children:[r&&r.is_mod&&we!==null&&e.jsx("div",{className:"site-badge","aria-hidden":!1,children:e.jsxs("div",{className:"label",children:[we," videos ready"]})}),e.jsxs("div",{className:"site-controls","aria-hidden":!1,children:[e.jsx("button",{ref:M,className:"settings-btn",onClick:()=>{te||ae(),ee(a=>!a)},"aria-expanded":te,"aria-label":"Filter settings",title:"Filter settings",children:e.jsx(wt,{size:18})}),te&&e.jsx("div",{ref:x,className:"settings-panel",role:"dialog","aria-modal":"false",children:Oe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Sort by:"}),e.jsx("div",{className:"col",style:{gap:8},children:[["unchecked","Pending","#f59e0b"],["accepted","Accepted","#10b981"],["denied","Denied","#ef4444"],["finished","Finished","#6366f1"],["archived","Archived","#6b7280"]].map(([a,p,h])=>{const _=re[a];return e.jsx("button",{className:`mode-cell ${_?"selected":""}`,"aria-pressed":_,onClick:()=>{j({...re,[a]:!_})},style:{padding:"10px 14px",borderRadius:8,fontSize:13,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontWeight:_?600:500,background:_?h+"15":"transparent",border:`1.5px solid ${_?h+"50":"rgba(255,255,255,0.08)"}`,color:_?h:"var(--text)",transition:"all 0.2s ease",cursor:"pointer",textAlign:"left",width:"100%"},onMouseEnter:X=>{_?(X.currentTarget.style.background=h+"25",X.currentTarget.style.borderColor=h+"70"):(X.currentTarget.style.background="rgba(255,255,255,0.05)",X.currentTarget.style.borderColor="rgba(255,255,255,0.12)")},onMouseLeave:X=>{X.currentTarget.style.background=_?h+"15":"transparent",X.currentTarget.style.borderColor=_?h+"50":"rgba(255,255,255,0.08)"},children:p},a)})}),e.jsx("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:e.jsx("button",{className:"btn secondary compact",onClick:()=>ee(!1),children:"Close"})})]}):J?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Sort by:"}),e.jsx("div",{className:"col",style:{gap:6},children:[["untagged","Untagged"],["help","Help"]].map(([a,p])=>{const h=de[a];return e.jsx("button",{className:`mode-cell ${h?"selected":""}`,"aria-pressed":h,onClick:()=>{k({...de,[a]:!h})},children:e.jsx("span",{children:p})},a)})}),r&&(r.is_admin||r.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:ke,onClick:U,children:ke?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>ee(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:Se,children:"Apply"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Game modes"}),e.jsx("div",{className:"col",style:{gap:6},children:[["standard","Standard",ds],["taiko","Taiko",us],["mania","Mania",ms],["catch","Catch",ps]].map(([a,p,h])=>{const _=ie[a];return e.jsxs("button",{className:`mode-cell ${_?"selected":""}`,"aria-pressed":_,onClick:()=>{l({...ie,[a]:!_})},children:[e.jsx("img",{className:"mode-icon",src:h,width:24,height:24,alt:""}),e.jsx("span",{children:p})]},a)})}),r&&(r.is_admin||r.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:ke,onClick:U,children:ke?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>ee(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:Ae,children:"Apply"})]})]})})]})]}),e.jsx(Cs,{})]})}function be(t,m=2){return i.lazy(async()=>{let c=null;for(let f=0;f<m;f++)try{return await t()}catch(d){c=d,console.warn(`Failed to load chunk (attempt ${f+1}/${m}):`,d),f<m-1&&await new Promise(y=>setTimeout(y,500*Math.pow(2,f)))}const r=(c==null?void 0:c.message)||"Unknown error";throw new Error(`Failed to load component after ${m} attempts: ${r}`)})}function Ls(){const{data:t}=nt(),{modeFilters:m}=He(),c=Object.entries(m).filter(([f,d])=>d).map(([f])=>f),r=c.length?c.join(","):"standard";return Qt({queryKey:["mappi","feed",r],queryFn:async({pageParam:f=0})=>{const d=new URLSearchParams({limit:"20",offset:String(f),modes:r}),y=`${I.feed.recent}?${d.toString()}`;return await A(y)},enabled:!!t,initialPageParam:0,getNextPageParam:(f,d)=>{var S;const y=d.reduce((R,b)=>{var w;return R+(((w=b.items)==null?void 0:w.length)||0)},0);return(((S=f.items)==null?void 0:S.length)||0)===20?y:void 0}})}function Fe(){const t=Ze(),m=Yt(),{data:c}=nt(),{modeFilters:r}=He(),{data:f,fetchNextPage:d,hasNextPage:y,isFetching:C,isFetchingNextPage:S,refetch:R}=Ls(),b=i.useMemo(()=>(f==null?void 0:f.pages.flatMap(N=>N.items||[]))||[],[f]),w=i.useMemo(()=>{const N=Object.entries(r).filter(([M,x])=>x).map(([M])=>M.toLowerCase()),P=new Set(N.length?N:["standard"]);return b.filter(M=>{const x=String(M.mode||"standard").toLowerCase();return P.has(x)})},[b,r]);i.useEffect(()=>{t.pathname==="/mp/feed"&&R()},[t.pathname,R]),i.useEffect(()=>{const N=()=>{R()};return window.addEventListener("filterchange",N),()=>window.removeEventListener("filterchange",N)},[R]);const L=N=>{m.setQueryData(["mappi","feed"],P=>P&&{...P,pages:P.pages.map(M=>({...M,items:M.items.map(x=>x.id===N.id?N:x)}))})},E=N=>{m.setQueryData(["mappi","feed"],P=>P&&{...P,pages:P.pages.map(M=>({...M,items:M.items.filter(x=>x.id!==N)}))})},Q=()=>{R()},q=C&&!S,K=y??!1;return e.jsxs("div",{className:"feed-container",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"title",style:{marginBottom:8},children:"Feed"}),e.jsx("div",{className:"muted",style:{fontSize:12,marginBottom:12},children:"Clips auto-delete after 60 days. Starred posts are preserved."}),e.jsx(ys,{section:"mappi",onUpload:Q})]}),e.jsx("div",{style:{marginTop:12,borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:e.jsxs("div",{className:"col",style:{gap:0},children:[w.length===0&&!q&&e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No videos match the selected filter."}),w.map(N=>e.jsx(is,{post:N,section:"mappi",onUpdate:L,onDelete:E,me:c},N.id)),w.length>0&&K&&e.jsx("div",{style:{padding:"16px",textAlign:"center",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsx("button",{className:"btn secondary",onClick:()=>d(),disabled:S,children:S?"Loading...":"Load more"})})]})})]})}const pe={};function Ms(){try{const t=localStorage.getItem("feed_seen_ids");if(t){const m=JSON.parse(t);Array.isArray(m)&&(pe.seenIds=m.filter(c=>typeof c=="number"))}}catch{}return pe}function bt(t){Object.assign(pe,t);try{const m=Array.from(new Set(pe.seenIds||[])).slice(-200);localStorage.setItem("feed_seen_ids",JSON.stringify(m))}catch{}}function vt(){var ut,mt,pt;const{notify:t}=st(),[m,c]=i.useState(pe.history||[]),[r,f]=i.useState(pe.index??-1),[d,y]=i.useState(pe.queue||[]),[C,S]=i.useState(!1),[R,b]=i.useState(!1),[w,L]=i.useState(pe.eligibleCount??null),[E,Q]=i.useState(pe.viewedCount??0),[q,K]=i.useState(!1),[N,P]=i.useState(!0),[M,x]=i.useState(!1),[G,W]=i.useState(!1),[O,te]=i.useState(!1),[ie,de]=i.useState(!1),[re,D]=i.useState(!1),[Y,Z]=i.useState([]),[T,ee]=i.useState(""),[ae,l]=i.useState(null),[k,j]=i.useState(!1),[B,oe]=i.useState(null),[Ce,ve]=i.useState(!1),J=i.useRef(new Set(pe.seenIds||[])),Oe=i.useRef(new Set),$e=i.useRef(!1),he=i.useRef(pe.lastShownVideoId??null),we=i.useRef(!1),Ne=i.useRef(0),ke=i.useRef(0),Ie=i.useRef(0),U=i.useRef(null),qe=i.useRef(null),_e=i.useRef(null),Re=i.useRef(null),Te=i.useRef(null),Le=i.useRef(null),Me=i.useRef(null),Ae=i.useRef(null),Se=i.useRef(0),a=i.useRef(0),p=i.useRef(null),h=i.useRef(null),[_,X]=i.useState(0),s=i.useMemo(()=>r>=0?m[r]:null,[m,r]);i.useEffect(()=>{Ms()},[]),i.useEffect(()=>{bt({history:m,index:r,queue:d,seenIds:Array.from(J.current),eligibleCount:w??void 0,viewedCount:E,lastShownVideoId:he.current??void 0})},[m,r,d,w,E]);const ye=i.useCallback(()=>{try{const n=localStorage.getItem("filter_modes"),o=(n?String(n):"standard").toLowerCase().split(",").map(v=>v.trim()).filter(Boolean),u=["standard","taiko","mania","catch"],g=Array.from(new Set(o.filter(v=>u.includes(v))));return g.length?g:["standard"]}catch{return["standard"]}},[]),at=i.useCallback(()=>{const n=new Set;return he.current!==null&&n.add(he.current),Array.from(J.current).slice(-200).forEach(u=>n.add(u)),d.forEach(u=>n.add(u.id)),Array.from(n)},[d]),Ve=i.useCallback(async(n=3)=>{var g,v,$,ue;if($e.current)return[];const o=Date.now();if(o<Ne.current){const le=Math.ceil((Ne.current-o)/1e3);return t(`Rate limited. Please wait ${le}s.`,{durationMs:3e3,variant:"warn"}),[]}const u=o-Ie.current;if(u<2e3){const le=2e3-u;await new Promise(me=>setTimeout(me,le))}$e.current=!0,Ie.current=Date.now();try{const le=at(),me=ye().join(","),xe=[],Be=new Set(d.map(se=>se.id));let Ue=[...le];const Pe=Math.min(n,3);for(let se=0;se<Pe;se++){if(se>0){const F=Date.now()-ke.current,ce=1e3;F<ce&&await new Promise(ze=>setTimeout(ze,ce-F))}try{ke.current=Date.now();const F=await A(I.feed.next+Ee({exclude:Ue.join(","),modes:me}),{requireAuth:!1}),ce=F&&("id"in F?F:F.video)||null;if(!ce)break;if(J.current.has(ce.id)||Be.has(ce.id)||ce.id===he.current){Ue.push(ce.id);continue}xe.push(ce),Ue.push(ce.id),Be.add(ce.id)}catch(F){if((g=F==null?void 0:F.message)!=null&&g.includes("401")||(v=F==null?void 0:F.message)!=null&&v.includes("Unauthorized")){K(!0);break}else if(($=F==null?void 0:F.message)!=null&&$.includes("429")||(ue=F==null?void 0:F.message)!=null&&ue.includes("rate limit")){Ne.current=Date.now()+5e3,t("Rate limited. Please wait a moment.",{durationMs:5e3,variant:"warn"});break}}}if(xe.length>0&&y(se=>{const F=new Set(se.map(ze=>ze.id)),ce=xe.filter(ze=>!F.has(ze.id));return[...se,...ce]}),xe.length===0&&d.length===0)try{const se=ye().join(","),F=await A(I.feed.progress(se),{requireAuth:!1});L(Number(F.eligible||0)),Q(Number(F.viewed||0)),b(Number(F.caught_up||0)===1)}catch{}return xe}catch{return[]}finally{$e.current=!1}},[at,ye,d,t]),fe=i.useCallback(async()=>{if(!C){S(!0);try{d.length<=2&&Ve(3).catch(()=>{});let n;if(d.length>0)n=d[0],y(o=>o.filter(u=>u.id!==n.id));else{const o=await Ve(3);o.length>0&&(n=o[0],o.length>1&&y(u=>{const g=new Set(u.map($=>$.id)),v=o.slice(1).filter($=>!g.has($.id));return[...u,...v]}))}if(n)he.current=n.id,J.current.add(n.id),bt({seenIds:Array.from(J.current)}),c(o=>{const u=[...o.slice(0,r+1),n];return f(u.length-1),u}),Oe.current.has(n.id)||(Oe.current.add(n.id),A(I.videos.view(n.id),{method:"POST"}).then(o=>{o&&c(u=>{const g=[...u],v=g.findIndex($=>$.id===n.id);return v!==-1&&(g[v]={...g[v],views_count:o.views_count??g[v].views_count??0,viewed_by_me:!0}),g})}).catch(()=>{}));else try{const o=ye().join(","),u=await A(I.feed.progress(o),{requireAuth:!1});L(Number(u.eligible||0)),Q(Number(u.viewed||0)),b(Number(u.eligible||0)>0&&Number(u.viewed||0)>=Number(u.eligible||0))}catch{}}finally{S(!1)}}},[C,d,Ve,r,ye]),It=i.useCallback(()=>{U.current&&!U.current.paused&&U.current.pause(),x(!0),D(!1)},[]),Qe=i.useCallback(()=>{r>0&&(f(r-1),x(!1))},[r]),Ye=i.useCallback(()=>{const n=Date.now();if(!(n-a.current<300)){if(a.current=n,N||(we.current=!0,P(!1)),r<m.length-1){const o=m[r+1];console.log("[Discover] Navigating to next video in history:",{currentIndex:r,nextIndex:r+1,currentVideoId:s==null?void 0:s.id,nextVideoId:o==null?void 0:o.id,nextVideoStreamUID:o==null?void 0:o.stream_uid}),o&&(he.current=o.id),f(r+1),x(!1);return}if(!R){if(Date.now()<Ne.current){const o=Math.ceil((Ne.current-Date.now())/1e3);t(`Rate limited. Please wait ${o}s.`,{durationMs:3e3,variant:"warn"});return}console.log("[Discover] Fetching next video (queue empty)"),fe()}}},[r,m,N,R,fe,t,s]);i.useEffect(()=>{const n=qe.current;if(!n)return;const o=v=>{if(q||Math.abs(v.deltaY)<Math.abs(v.deltaX))return;v.preventDefault(),v.stopPropagation();const $=Date.now();if(!($<Se.current)){if(Se.current=$+1e3,!s){v.deltaY>0&&!C&&fe();return}v.deltaY>0?Ye():Qe()}},u=v=>{p.current=v.touches[0].clientY,h.current=Date.now()},g=v=>{if(q||p.current===null||h.current===null)return;const $=v.changedTouches[0].clientY,ue=Date.now(),le=p.current-$,me=ue-h.current;if(p.current=null,h.current=null,Math.abs(le)<50||me>300)return;const xe=Date.now();if(!(xe<Se.current)){if(Se.current=xe+1e3,!s){le>0&&!C&&fe();return}le>0?Ye():Qe()}};return n.addEventListener("wheel",o,{passive:!1,capture:!0}),n.addEventListener("touchstart",u,{passive:!0}),n.addEventListener("touchend",g,{passive:!0}),window.addEventListener("wheel",o,{passive:!1,capture:!0}),()=>{n.removeEventListener("wheel",o,{capture:!0}),n.removeEventListener("touchstart",u),n.removeEventListener("touchend",g),window.removeEventListener("wheel",o,{capture:!0})}},[Ye,Qe,s,C,fe,q]);const Rt=i.useCallback(async()=>{var n,o;if(!(!s||Ce)){ve(!0);try{const u=s.liked_by_me?"DELETE":"POST",g=await A(I.videos.like(s.id),{method:u});c(v=>{const $=[...v],ue=$.findIndex(le=>le.id===s.id);return ue!==-1&&($[ue]={...$[ue],liked_by_me:!s.liked_by_me,likes_count:g.likes_count}),$})}catch(u){((n=u==null?void 0:u.message)!=null&&n.includes("429")||(o=u==null?void 0:u.message)!=null&&o.includes("rate limit"))&&t("Please slow down a bit.",{durationMs:5e3,variant:"warn"})}finally{ve(!1)}}},[s,Ce,t]),it=i.useCallback(async n=>{if(s)try{await A(I.videos.flag(s.id),{method:"POST",body:JSON.stringify({reason:n})}),t("Thanks for your report.",{variant:"info"})}catch{t("Report failed",{variant:"error"})}finally{te(!1)}},[s,t]),Tt=i.useCallback(async()=>{if(!s)return;const n=!s.is_starred,o=n?"star":"unstar";try{await A(I.admin.videosAction(s.id,o),{method:"POST"}),c(u=>{const g=[...u],v=g.findIndex($=>$.id===s.id);return v!==-1&&(g[v]={...g[v],is_starred:n}),g}),de(!1),t(n?"Post starred":"Star removed",{variant:"success"})}catch{t("Action failed",{variant:"error"})}},[s,t]),rt=i.useCallback(async()=>{if(!(!s||!confirm("Permanently delete this video?")))try{await A(I.videos.delete(s.id),{method:"DELETE"}),t("Deleted",{variant:"warn"}),te(!1),c(n=>{const o=n.filter((u,g)=>g!==r);return o.length===0?(f(-1),setTimeout(fe,0)):f(u=>Math.max(0,Math.min(u,o.length-1))),o})}catch{alert("Delete failed")}},[s,r,fe,t]),We=i.useCallback(async()=>{if(s!=null&&s.id)try{const n=await A(I.videos.comments(s.id),{requireAuth:!1});Z(n.items||[])}catch{}},[s==null?void 0:s.id]);i.useEffect(()=>{G&&(s!=null&&s.id)&&We()},[G,s==null?void 0:s.id,We]);const ot=i.useCallback(async n=>{if(n.preventDefault(),!(!T.trim()||!(s!=null&&s.id))){j(!0);try{await A(I.videos.comments(s.id),{method:"POST",body:JSON.stringify({text:T.trim(),parent_id:ae||void 0})}),ee(""),l(null),We(),c(o=>{const u=[...o],g=u.findIndex(v=>v.id===s.id);return g!==-1&&(u[g]={...u[g],comments_count:(u[g].comments_count||0)+1}),u}),t("Comment posted!",{variant:"success"})}catch(o){t((o==null?void 0:o.message)||"Failed to post comment",{variant:"error"})}finally{j(!1)}}},[T,s,ae,We,t]),Lt=i.useCallback(n=>{Z(o=>o.filter(u=>u.id!==n)),c(o=>{const u=[...o],g=u.findIndex(v=>v.id===(s==null?void 0:s.id));return g!==-1&&(u[g]={...u[g],comments_count:Math.max(0,(u[g].comments_count||0)-1)}),u})},[s==null?void 0:s.id]),{topLevelComments:lt,repliesMap:ct}=i.useMemo(()=>{const n=Y.filter(u=>!u.parent_id),o=new Map;return Y.filter(u=>u.parent_id).forEach(u=>{const g=u.parent_id;o.has(g)||o.set(g,[]),o.get(g).push(u)}),{topLevelComments:n,repliesMap:o}},[Y]),Mt=i.useCallback(()=>{if(!U.current)return;const n=!N;P(n),U.current.muted=n,n||(we.current=!0),!n&&U.current.paused&&U.current.play().catch(()=>{})},[N]),At=i.useCallback(n=>{U.current=n,n&&(n.muted=N)},[N]);i.useEffect(()=>{x(!1),W(!1),we.current?P(!1):P(!0)},[s==null?void 0:s.id,s==null?void 0:s.stream_uid,r,m.length]),i.useEffect(()=>{U.current&&(U.current.muted=N)},[N]),i.useEffect(()=>{if(!s)return;const n=!we.current;P(n);const o=setTimeout(()=>{U.current&&(U.current.muted=n)},100);return()=>clearTimeout(o)},[s==null?void 0:s.id]),i.useEffect(()=>{s&&(he.current=s.id)},[s==null?void 0:s.id]),i.useEffect(()=>{M&&U.current&&!U.current.paused&&U.current.pause()},[M]),i.useEffect(()=>{m.length===0&&fe()},[]),i.useEffect(()=>{(async()=>{try{const n=ye().join(","),o=await A(I.feed.progress(n),{requireAuth:!1}),u=Number(o.eligible||0),g=Number(o.viewed||0);L(u),Q(g),b(u>0&&g>=u)}catch{}})()},[ye]),i.useEffect(()=>{const n=()=>{c([]),y([]),J.current.clear(),he.current=null,f(-1),b(!1),(async()=>{try{const o=ye().join(","),u=await A(I.feed.progress(o),{requireAuth:!1}),g=Number(u.eligible||0),v=Number(u.viewed||0);L(g),Q(v),b(!1)}catch{}fe()})()};return window.addEventListener("filterchange",n),()=>window.removeEventListener("filterchange",n)},[ye,fe]),i.useEffect(()=>{(async()=>{try{const n=await A(I.auth.me,{requireAuth:!1});oe(n)}catch{}})()},[]),i.useEffect(()=>{const n=()=>{const o=document.querySelector(".top-nav");o&&X(o.offsetHeight)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),i.useEffect(()=>{var u;if(!_e.current||!Re.current||!s||!U.current)return;const n=()=>{var F;const g=(F=Re.current)==null?void 0:F.querySelector("div"),v=U.current;if(!g||!v||!_e.current)return;const $=_e.current,ue=$.offsetWidth-32,le=$.offsetHeight-32;let me;s.width&&s.height?me=s.width/s.height:v.videoWidth>0&&v.videoHeight>0?me=v.videoWidth/v.videoHeight:me=16/9;const xe=16/9,Be=ue/xe;let Pe=Math.min(le,Be),se=Pe*me;se>ue&&(se=ue,Pe=se/me),g.style.width=`${se}px`,g.style.height=`${Pe}px`,g.style.maxWidth="100%",g.style.maxHeight="100%"},o=()=>{requestAnimationFrame(n)};if(U.current.readyState>=1)n();else{const g=()=>{var v;n(),(v=U.current)==null||v.removeEventListener("loadedmetadata",g)};(u=U.current)==null||u.addEventListener("loadedmetadata",g)}return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[s==null?void 0:s.id,s==null?void 0:s.width,s==null?void 0:s.height]),i.useEffect(()=>{if(!O)return;const n=o=>{Te.current&&!Te.current.contains(o.target)&&te(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[O]),i.useEffect(()=>{if(!ie)return;const n=o=>{Le.current&&!Le.current.contains(o.target)&&de(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[ie]),i.useEffect(()=>{if(!re)return;const n=o=>{Me.current&&!Me.current.contains(o.target)&&Ae.current&&!Ae.current.contains(o.target)&&D(!1)};return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[re]);const dt=!!(B!=null&&B.is_admin||B!=null&&B.is_mod);return e.jsxs(e.Fragment,{children:[e.jsx(Ct,{paused:!1}),e.jsx("style",{children:`
        .video-area .discover-player-wrapper {
          position: relative !important;
          width: 100% !important;
          height: 100% !important;
          max-width: 100% !important;
          max-height: 100% !important;
          min-height: 100% !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          box-sizing: border-box !important;
        }
        .video-area .discover-player-wrapper > div {
          position: relative !important;
          /* Dimensions will be set by JavaScript to ensure proper fit */
          box-sizing: border-box !important;
          /* Center the video within container */
          flex-shrink: 1 !important;
          min-width: 0 !important;
          min-height: 0 !important;
          align-self: center !important;
        }
        .video-area .discover-player-wrapper > div[style] {
          /* JavaScript will set width and height, but ensure max constraints */
          max-width: 100% !important;
          max-height: 100% !important;
          box-sizing: border-box !important;
          flex-shrink: 1 !important;
          min-width: 0 !important;
          min-height: 0 !important;
        }
        /* Ensure wrapper constrains width to prevent overflow */
        .video-area .discover-player-wrapper {
          max-width: 100% !important;
          width: 100% !important;
          overflow: hidden !important;
          /* Use flexbox to center and constrain */
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }
        .video-area .discover-player-wrapper video {
          /* Ensure video content is fully visible - no cropping */
          width: 100% !important;
          height: 100% !important;
          object-fit: contain !important;
          max-width: 100% !important;
          max-height: 100% !important;
        }
      `}),e.jsxs("div",{ref:qe,className:"player-wrap",style:{height:"100dvh",width:"100%",position:"fixed",top:0,left:0,right:0,bottom:0,overflow:"hidden",background:"transparent",zIndex:1},children:[R&&e.jsx("div",{className:"chip info",style:{position:"absolute",top:_+20,left:"50%",transform:"translateX(-50%)",zIndex:10,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(10px)"},children:"You're all caught up. Check 'Feed' to watch videos you've seen already."}),e.jsx("div",{ref:_e,className:"video-area discover-video-container",style:{position:"absolute",top:_,left:0,right:0,bottom:0,maxHeight:`calc(100dvh - ${_}px)`,height:`calc(100dvh - ${_}px)`,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",transition:"bottom 0.3s ease-out, max-height 0.3s ease-out, height 0.3s ease-out",overflow:"hidden",boxSizing:"border-box",padding:"16px",maxWidth:"100vw",width:"100%"},children:q?e.jsxs("div",{className:"col",style:{alignItems:"center",zIndex:10},children:[e.jsx("div",{className:"muted",style:{marginBottom:8},children:"Please log in to view videos."}),e.jsx("button",{className:"btn",onClick:()=>window.location.href=Ge+I.auth.login,children:"Login with osu!"})]}):s?e.jsx("div",{style:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",overflow:"hidden"},children:e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:10,pointerEvents:"none"}}),e.jsxs("div",{onClick:Mt,style:{position:"relative",width:"100%",height:"100%",cursor:"pointer",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",maxWidth:"100%",maxHeight:"100%"},children:[e.jsx("div",{ref:Re,className:"discover-player-wrapper",children:e.jsx(rs,{streamUID:s.stream_uid,playbackUrl:s.playback_url,aspectRatio:s.width&&s.height?s.width/s.height:null,preferNative:!0,autoplay:!0,loop:!0,muted:N,controls:!1,onVideoRef:At})}),e.jsx("div",{style:{position:"absolute",top:16,right:16,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(10px)",borderRadius:"50%",width:56,height:56,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",transition:"opacity 0.3s ease",opacity:N?1:0,zIndex:2},children:N?e.jsx(Jt,{size:28,color:"#fff"}):e.jsx(Xt,{size:28,color:"#fff"})})]})]})}):R?null:e.jsxs("div",{className:"muted",style:{zIndex:10,textAlign:"center",padding:"20px",maxWidth:"400px",pointerEvents:"none"},children:[e.jsx("div",{style:{marginBottom:12,fontSize:14,fontWeight:500},children:"How to navigate"}),e.jsxs("div",{style:{fontSize:12,lineHeight:1.6},children:[e.jsx("div",{children:"• Scroll up/down or swipe to change videos"}),e.jsx("div",{children:"• Click video to toggle mute/unmute"}),e.jsx("div",{children:"• Hold to pause temporarily"})]})]})}),s&&!M&&e.jsxs("div",{style:{position:"absolute",right:16,top:"50%",display:"flex",flexDirection:"column",gap:20,alignItems:"center",zIndex:15,pointerEvents:"auto",transform:"translateY(-50%) scale(1)",transformOrigin:"center right"},onClick:n=>n.stopPropagation(),children:[e.jsx(z,{to:`/profile/${(ut=s.uploader)==null?void 0:ut.id}`,style:{width:48,height:48,borderRadius:"50%",border:"2px solid rgba(255,255,255,0.3)",overflow:"hidden",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},children:(mt=s.uploader)!=null&&mt.avatar_url?e.jsx("img",{src:s.uploader.avatar_url,width:48,height:48,style:{borderRadius:"50%",objectFit:"cover",display:"block"},alt:s.uploader.username}):e.jsx("div",{style:{width:48,height:48,background:"rgba(255,255,255,0.1)"}})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("button",{onClick:Rt,disabled:Ce,"aria-label":s.liked_by_me?"Unlike":"Like",title:s.liked_by_me?"Unlike":"Like",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:s.liked_by_me?"#f87171":"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:n=>n.currentTarget.style.transform="scale(1.1)",onMouseLeave:n=>n.currentTarget.style.transform="scale(1)",children:s.liked_by_me?e.jsx(kt,{size:28}):e.jsx(St,{size:28})}),e.jsx("span",{style:{color:"#fff",fontSize:12,fontWeight:600,textShadow:"0 1px 3px rgba(0,0,0,0.8)"},children:s.likes_count??0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("button",{onClick:()=>W(!0),"aria-label":"Comments",title:"Comments",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:n=>n.currentTarget.style.transform="scale(1.1)",onMouseLeave:n=>n.currentTarget.style.transform="scale(1)",children:e.jsx(Et,{size:28})}),e.jsx("span",{style:{color:"#fff",fontSize:12,fontWeight:600,textShadow:"0 1px 3px rgba(0,0,0,0.8)"},children:s.comments_count??0})]}),s.beatmap_url&&e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:Ae,onClick:()=>D(n=>!n),title:"Beatmap options","aria-label":"Beatmap options",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:n=>n.currentTarget.style.transform="scale(1.1)",onMouseLeave:n=>n.currentTarget.style.transform="scale(1)",children:e.jsx(Ke,{size:24})}),re&&e.jsxs("div",{ref:Me,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:160,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsxs("a",{className:"menu-item",href:s.beatmap_url,target:"_blank",rel:"noreferrer",onClick:()=>D(!1),children:[e.jsx(Ke,{size:16,style:{marginRight:8}}),"osu.ppy.sh"]}),s.beatmapset_id&&e.jsx("button",{className:"menu-item",onClick:It,children:"Preview"})]})]}),dt?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{onClick:()=>de(n=>!n),title:"Manage","aria-label":"Manage",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:n=>n.currentTarget.style.transform="scale(1.1)",onMouseLeave:n=>n.currentTarget.style.transform="scale(1)",children:e.jsx(xt,{size:24})}),ie&&e.jsxs("div",{ref:Le,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:180,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsx("button",{className:"menu-item",onClick:Tt,children:s.is_starred?"Unstar post":"Star post"}),e.jsx("button",{className:"menu-item",onClick:rt,children:"Delete video"})]})]}):e.jsx("button",{onClick:()=>te(n=>!n),title:"Report","aria-label":"Report",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:n=>n.currentTarget.style.transform="scale(1.1)",onMouseLeave:n=>n.currentTarget.style.transform="scale(1)",children:e.jsx(Kt,{size:24})}),O&&e.jsxs("div",{ref:Te,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:160,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsx("div",{className:"muted",style:{fontSize:12,padding:"4px 8px"},children:"Report as…"}),e.jsx("button",{className:"menu-item",onClick:()=>it("unrelated"),children:"Unrelated"}),e.jsx("button",{className:"menu-item",onClick:()=>it("explicit"),children:"Explicit"}),dt&&e.jsx("button",{className:"menu-item",onClick:rt,children:"Delete video"})]})]}),s&&!M&&e.jsxs("div",{style:{position:"absolute",left:16,bottom:80,right:80,zIndex:15,pointerEvents:"none",display:"flex",flexDirection:"column",gap:12,transformOrigin:"bottom left"},onClick:n=>n.stopPropagation(),children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,pointerEvents:"auto"},children:e.jsx(z,{to:`/profile/${(pt=s.uploader)==null?void 0:pt.id}`,style:{textDecoration:"none",color:"#fff",fontWeight:600,fontSize:"clamp(14px, 16px, 18px)",display:"flex",alignItems:"center",gap:8,textShadow:"0 1px 3px rgba(0,0,0,0.8)",transition:"font-size 0.3s ease-out"},children:(()=>{var g,v,$;const n=(g=s.uploader)==null?void 0:g.is_admin,o=(v=s.uploader)==null?void 0:v.is_mod,u=n?"#fff3bf":o?"#d7fbe8":"#fff";return e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:u},children:["@",($=s.uploader)==null?void 0:$.username]}),s.is_starred&&e.jsx(Nt,{size:16,color:"#f59e0b",title:"Starred"}),(n||o)&&e.jsx(xt,{size:14,color:u,title:n?"admin":"mod"})]})})()})}),(s.description??"").trim()&&e.jsx("div",{style:{color:"#fff",fontSize:"clamp(12px, 14px, 16px)",lineHeight:1.5,textShadow:"0 1px 3px rgba(0,0,0,0.8)",maxWidth:"85%",wordBreak:"break-word",pointerEvents:"auto",transition:"font-size 0.3s ease-out"},children:s.description}),s.beatmap_title&&e.jsxs("div",{style:{color:"rgba(255,255,255,0.9)",fontSize:"clamp(11px, 13px, 15px)",textShadow:"0 1px 3px rgba(0,0,0,0.8)",pointerEvents:"auto",transition:"font-size 0.3s ease-out"},children:[s.beatmap_artist," – ",s.beatmap_title," ",s.beatmap_mapper?`(by ${s.beatmap_mapper})`:""," ",s.beatmap_version?`[${s.beatmap_version}]`:""]})]}),G&&s&&e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `}),e.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:"50%",background:"var(--panel)",borderTop:"1px solid rgba(255,255,255,0.08)",borderTopLeftRadius:20,borderTopRightRadius:20,display:"flex",flexDirection:"column",zIndex:20,boxShadow:"0 -4px 20px rgba(0,0,0,0.3)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:["Comments (",s.comments_count??0,")"]}),e.jsx("button",{onClick:()=>W(!1),style:{background:"transparent",border:"none",color:"var(--text)",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"Close comments",children:e.jsx(tt,{size:24})})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"8px 0"},children:lt.length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No comments yet. Be the first to comment!"}):e.jsx("div",{className:"col",style:{gap:0},children:lt.map(n=>e.jsx(os,{comment:n,replies:ct.get(n.id)||[],me:B,section:"mappi",onReply:o=>l(o),onDelete:Lt,replyingTo:ae,replyText:T,onReplyTextChange:ee,onReplySubmit:ot,posting:k,onCancelReply:()=>{l(null),ee("")},repliesMap:ct},n.id))})}),B&&!ae&&e.jsx("div",{style:{padding:"12px 20px",borderTop:"1px solid rgba(255,255,255,0.06)",background:"var(--panel-dark)"},children:e.jsxs("form",{onSubmit:ot,style:{display:"flex",alignItems:"flex-end",gap:8},children:[e.jsx("textarea",{placeholder:"Write a comment...",value:T,onChange:n=>ee(n.target.value),rows:1,style:{flex:1,background:"#0b0d10",border:"1px solid rgba(255,255,255,0.12)",borderRadius:6,padding:"8px 12px",color:"var(--text)",fontFamily:"inherit",fontSize:13,resize:"none",minHeight:"36px",maxHeight:"120px",overflowY:"auto"},onInput:n=>{const o=n.target;o.style.height="auto",o.style.height=`${Math.min(o.scrollHeight,120)}px`}}),e.jsx("button",{type:"submit",className:"btn compact",disabled:k||!T.trim(),style:{padding:"8px 16px",fontSize:13,flexShrink:0},children:k?"...":"Post"})]})})]})]}),M&&(s==null?void 0:s.beatmapset_id)&&e.jsx(ws,{open:M,onClose:()=>x(!1),downloadUrl:`${Ge}${I.osu.downloadBeatmapset(s.beatmapset_id)}`,beatmapId:s.beatmap_id??void 0,beatmapVersion:s.beatmap_version??void 0})]})]})}function yt(t){if(!t)return"standard";const m=String(t).toLowerCase().trim();return m==="osu"||m==="0"||m==="standard"?"standard":m==="taiko"||m==="1"?"taiko":m==="catch"||m==="fruits"||m==="2"?"catch":m==="mania"||m==="3"?"mania":"standard"}const As=({open:t,onClose:m,videoId:c,initialDescription:r,initialBeatmapUrl:f,onSave:d})=>{const[y,C]=i.useState(r||""),[S,R]=i.useState(f||""),[b,w]=i.useState(null),[L,E]=i.useState(null),[Q,q]=i.useState(""),[K,N]=i.useState(!1),P=i.useRef(0);i.useEffect(()=>{t&&(C(r||""),R(f||""),w(null),E(null),q(""))},[t,r,f]),i.useEffect(()=>{if(!t)return;P.current&&window.clearTimeout(P.current);const x=(S||"").trim();if(!x){q(""),w(null),E(null);return}if(!/^https?:\/\/osu\.ppy\.sh\/(beatmapsets|beatmaps)\//i.test(x)){q(""),w(null),E(null);return}return P.current=window.setTimeout(async()=>{var W;try{let O;try{O=new URL(x)}catch{q("Invalid URL format");return}const te=O.hash.match(/#osu\/(\d+)/),ie=te?te[1]:null;O.hash="";const re={url:O.toString()};ie&&(re.beatmap_id=ie);const D=await A(I.osu.resolveBeatmap+Ee(re),{requireAuth:!1}),Y=Array.isArray(D==null?void 0:D.diffs)?D.diffs:[];if(!Y.length&&!D.setId){q("No difficulties found"),w(null),E(null);return}if(w({setId:Number(D.setId)||0,beatmapId:D.beatmapId??null,title:String(D.title||""),artist:String(D.artist||""),mapper:String(D.mapper||""),diffs:Y}),Y.length>0){const Z=Number.isFinite(Number(D.beatmapId))?Number(D.beatmapId):Number((W=Y[0])==null?void 0:W.id),T=Y.find(ae=>Number(ae.id)===Z)||Y[0],ee=yt(T==null?void 0:T.mode);E({beatmapId:Number(T==null?void 0:T.id)||null,version:String((T==null?void 0:T.version)||""),mode:ee})}q("")}catch(O){q(`Failed to resolve: ${(O==null?void 0:O.message)||"Unknown error"}`),w(null),E(null)}},400),()=>{P.current&&window.clearTimeout(P.current)}},[S,t]);const M=async()=>{if(!K){N(!0);try{await A(I.videos.update(c),{method:"PATCH",body:JSON.stringify({description:y.slice(0,100),beatmap_url:S.trim()||void 0})});const x=!!S.trim();if(b||!x)try{await A(I.videos.update(c)+"/beatmap",{method:"PATCH",body:JSON.stringify({beatmapset_id:x&&b&&b.setId>0?b.setId:null,beatmap_id:x&&(L!=null&&L.beatmapId)?L.beatmapId:null,beatmap_version:x&&(L!=null&&L.version)?L.version:null,beatmap_title:x&&(b!=null&&b.title)?b.title:null,beatmap_artist:x&&(b!=null&&b.artist)?b.artist:null,beatmap_mapper:x&&(b!=null&&b.mapper)?b.mapper:null,beatmap_url:x?S.trim():null})})}catch(W){console.warn("Failed to update beatmap metadata:",W)}d(y,S.trim()||null),m()}catch(x){alert((x==null?void 0:x.message)||"Failed to update post")}finally{N(!1)}}};return t?e.jsxs("div",{className:"overlay",role:"dialog","aria-modal":"true",onClick:x=>x.target===x.currentTarget&&m(),children:[e.jsx("div",{className:"overlay-backdrop",onClick:m}),e.jsxs("div",{className:"overlay-card",style:{maxWidth:"600px",width:"calc(100vw - 24px)"},children:[e.jsx("button",{className:"overlay-close",onClick:m,"aria-label":"Close",children:e.jsx(tt,{size:18})}),e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",children:"Edit Post"}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Description (max 100 chars)"}),e.jsx("textarea",{maxLength:100,placeholder:"Description (max 100 chars)",value:y,onChange:x=>C(x.target.value),style:{height:64,resize:"vertical",background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"}})]}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Beatmap URL (optional)"}),b?e.jsx("div",{className:"col",style:{gap:8},children:e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{className:"chip-btn",style:{cursor:"default"},children:[e.jsxs("strong",{style:{marginRight:6},children:[b.artist," – ",b.title]}),e.jsxs("span",{className:"muted",children:["by ",b.mapper]})]}),e.jsx("select",{value:(L==null?void 0:L.beatmapId)??b.beatmapId??void 0,onChange:x=>{const G=Number(x.target.value),W=(b==null?void 0:b.diffs.find(O=>Number(O.id)===G))||null;if(W){const O=yt(W.mode);E({beatmapId:G,version:W.version,mode:O})}},style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"},children:b.diffs.map(x=>e.jsxs("option",{value:x.id,children:[x.version," (",x.mode,")"]},x.id))}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>{w(null),E(null),R("")},children:"Clear"})]})}):e.jsx("input",{type:"url",placeholder:"Beatmap URL (optional) e.g. https://osu.ppy.sh/beatmapsets/...",value:S,onChange:x=>R(x.target.value),style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"}}),Q&&e.jsx("div",{className:"muted",style:{color:"var(--danger)",fontSize:12},children:Q})]}),e.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn secondary",onClick:m,disabled:K,children:"Cancel"}),e.jsx("button",{className:"btn",onClick:M,disabled:K,children:K?"Saving...":"Save"})]})]})]})]}):null};function jt(){const t=Gt(),m=et(),{notify:c}=st(),[r,f]=i.useState(null),[d,y]=i.useState(null),[C,S]=i.useState(""),[R,b]=i.useState([]),[w,L]=i.useState([]),[E,Q]=i.useState([]),[q,K]=i.useState(""),[N,P]=i.useState(null),[M,x]=i.useState([]),[G,W]=i.useState(null),[O,te]=i.useState(""),[ie,de]=i.useState([]),[re,D]=i.useState(null),[Y,Z]=i.useState(!1),T=i.useMemo(()=>{const l=t.id?Number(t.id):null;return l?r?r.id===l:!1:!0},[t.id,r]);function ee(l){const k=l.stream_uid||String(l.id),j=t.id?`/profile/${t.id}`:"/profile";m(`/mp/feed/${k}`,{state:{returnTo:j}})}i.useEffect(()=>{(async()=>{try{const l=await A(I.auth.me,{requireAuth:!1});f(l),l&&Array.isArray(l.inspirations)&&x(l.inspirations)}catch(l){S((l==null?void 0:l.message)||"Not logged in")}})()},[]),i.useEffect(()=>{(async()=>{try{const l=t.id?Number(t.id):null;if(l){const k=await A(I.users.get(l),{requireAuth:!1});y(k),K(k.about||""),Array.isArray(k.inspirations)&&x(k.inspirations);const j=await A(I.users.videos(l)+Ee({limit:"60"}),{requireAuth:!1});Q(j.items||[]);const B=await A(I.users.likes(l)+Ee({limit:"60"}),{requireAuth:!1});L(B.items||[])}else{if(!r)return;y(r),K(r.about||""),Array.isArray(r.inspirations)&&x(r.inspirations);const k=await A(I.users.myVideos+Ee({limit:"50"}),{requireAuth:!1});b(k.items||[]);const j=await A(I.users.likes(r.id)+Ee({limit:"60"}),{requireAuth:!1});L(j.items||[])}}catch{}})()},[t.id,r]),i.useEffect(()=>{Z(!1)},[d==null?void 0:d.id]);async function ae(l){try{const j=(await A(I.auth.me,{method:"PATCH",body:JSON.stringify({inspirations:l})})).user||d;y(j),Array.isArray(j==null?void 0:j.inspirations)&&x(j.inspirations),t.id||f(j)}catch{}}return i.useEffect(()=>{let l;return G!==null&&O.trim().length>=2?l=setTimeout(async()=>{try{const k=await A(I.osu.usersSearch(O),{requireAuth:!1});de(Array.isArray(k.items)?k.items:[])}catch{}},250):de([]),()=>{l&&clearTimeout(l)}},[O,G]),e.jsxs("div",{className:"feed-container",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"row wrap",style:{alignItems:"center"},children:d?e.jsxs(e.Fragment,{children:[d.avatar_url&&e.jsx("img",{src:d.avatar_url,width:48,height:48,style:{borderRadius:"50%"}}),e.jsxs("div",{className:"col",children:[e.jsxs("div",{className:"title",style:{display:"flex",alignItems:"center",gap:8},children:[d.username,d.osu_user_id&&e.jsx("a",{href:`https://osu.ppy.sh/users/${d.osu_user_id}`,target:"_blank",rel:"noreferrer",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:"var(--text)",opacity:.7,cursor:"pointer",padding:0,textDecoration:"none",transition:"opacity 0.2s ease"},onMouseEnter:l=>l.currentTarget.style.opacity="1",onMouseLeave:l=>l.currentTarget.style.opacity="0.7",title:"View osu! profile","aria-label":"View osu! profile",children:e.jsx(Ke,{size:16})})]}),e.jsxs("div",{className:"muted",children:["ID: ",d.id]})]}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[!T&&M.length>0&&e.jsx("span",{className:"muted",style:{fontSize:12},children:"inspired by:"}),M.map((l,k)=>T?e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>D(l.id),onMouseLeave:()=>D(null),children:[e.jsx("button",{className:"insp-avatar",onClick:()=>{if(!confirm("Remove this inspiration?"))return;const j=M.filter((B,oe)=>oe!==k);x(j),ae(j)},children:e.jsx("img",{src:l.avatar_url,alt:l.username})}),re===l.id&&e.jsxs("div",{className:"insp-tooltip",children:[l.username," — click to remove"]})]},l.id):e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>D(l.id),onMouseLeave:()=>D(null),children:[e.jsx("a",{href:`https://osu.ppy.sh/users/${l.id}`,target:"_blank",rel:"noreferrer",className:"insp-avatar link",children:e.jsx("img",{src:l.avatar_url,alt:l.username})}),re===l.id&&e.jsx("div",{className:"insp-tooltip",children:l.username})]},l.id)),T&&M.length<3&&new Array(3-M.length).fill(0).map((l,k)=>e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>D(-k-1),onMouseLeave:()=>D(null),children:[e.jsx("button",{className:"insp-add",onClick:()=>{W(k),te(""),de([])},children:"+"}),re===-k-1&&e.jsx("div",{className:"insp-tooltip",children:"Add inspiration"}),G===k&&e.jsxs("div",{className:"insp-pop",role:"dialog","aria-label":"Search osu! users",children:[e.jsx("input",{autoFocus:!0,placeholder:"Search username",value:O,onChange:j=>te(j.target.value)}),e.jsxs("div",{className:"insp-results",children:[ie.length===0&&O.trim().length>=2&&e.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:"No results"}),ie.map(j=>e.jsxs("button",{className:"insp-result",onClick:()=>{if(r&&Number(r.osu_user_id)===Number(j.id)){c("Kinda based, but no.",{variant:"warn"}),W(null);return}if(M.some(oe=>oe.id===j.id)){W(null);return}const B=[...M,{id:j.id,username:j.username,avatar_url:j.avatar_url}].slice(0,3);x(B),W(null),ae(B)},children:[e.jsx("img",{src:j.avatar_url,alt:"avatar"}),e.jsx("span",{children:j.username})]},j.id))]}),e.jsx("button",{className:"insp-close",onClick:()=>W(null),children:"Close"})]})]},`slot-${k}`))]}),T&&e.jsx("div",{className:"muted",style:{fontSize:12},children:"Who inspires you?"})]})]}):e.jsx("div",{className:"muted",children:C||"Loading…"})}),e.jsxs("div",{className:"col",style:{marginTop:12,gap:4},children:[e.jsx("div",{className:"title",children:"About"}),T?e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("textarea",{value:q,onChange:l=>K(l.target.value),rows:3,maxLength:1e3,placeholder:"Write something about yourself (max 1000 chars)"}),e.jsx("div",{className:"row",style:{justifyContent:"flex-end"},children:e.jsx("button",{className:"btn compact",onClick:async()=>{try{const l=await A(I.auth.me,{method:"PATCH",body:JSON.stringify({about:q})});y(l.user||d),f(l.user||r)}catch{}},children:"Save"})})]}):(()=>{const l=((d==null?void 0:d.about)||"").trim()||"No bio.",k=l.length>200,j=k&&!Y?l.slice(0,200)+"...":l;return e.jsxs("div",{className:"col",style:{gap:4},children:[e.jsx("div",{className:"muted",style:{whiteSpace:"pre-wrap"},children:j}),k&&e.jsx("button",{onClick:()=>Z(!Y),style:{display:"flex",alignItems:"center",gap:4,background:"transparent",border:"none",color:"var(--muted)",cursor:"pointer",padding:0,fontSize:14,fontFamily:"inherit",marginTop:4},children:Y?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show less"}),e.jsx(Zt,{size:14})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show more"}),e.jsx(_t,{size:14})]})})]})})()]})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Profile sections",children:[e.jsx("button",{role:"tab","aria-selected":!0,className:"profile-tab active","data-tab":"uploads",onClick:l=>{const k=l.currentTarget.closest(".profile-tabs-unified");k.querySelectorAll(".profile-tab").forEach(B=>{B.classList.remove("active"),B.setAttribute("aria-selected","false")}),l.currentTarget.classList.add("active"),l.currentTarget.setAttribute("aria-selected","true"),k.querySelector(".profile-tabs-content").setAttribute("data-active","uploads")},children:"Uploads"}),e.jsx("button",{role:"tab","aria-selected":!1,className:"profile-tab","data-tab":"likes",onClick:l=>{const k=l.currentTarget.closest(".profile-tabs-unified");k.querySelectorAll(".profile-tab").forEach(B=>{B.classList.remove("active"),B.setAttribute("aria-selected","false")}),l.currentTarget.classList.add("active"),l.currentTarget.setAttribute("aria-selected","true"),k.querySelector(".profile-tabs-content").setAttribute("data-active","likes")},children:"Likes"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":"uploads",children:[e.jsx("div",{className:"panel uploads",hidden:!1,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[(T?R:E).length===0&&e.jsx("div",{className:"profile-empty-state",children:"No uploads yet."}),(T?R:E).map(l=>(T&&d?(d.id,d.username,d.avatar_url,d.is_admin,d.is_mod):l.uploader,e.jsxs("button",{className:"recent-cell",onClick:()=>ee({...l}),children:[l.poster_url?e.jsx("img",{className:"recent-thumb",src:l.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsx("div",{className:"cell-footer",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(St,{size:12}),e.jsx("span",{children:l.likes_count??0})]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(Et,{size:12}),e.jsx("span",{children:l.comments_count??0})]})]})})]},l.id)))]})})}),e.jsx("div",{className:"panel likes",hidden:!0,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[w.length===0&&e.jsx("div",{className:"profile-empty-state",children:"No likes yet."}),w.map(l=>{var k,j;return e.jsxs("button",{className:"recent-cell",onClick:()=>ee(l),children:[l.poster_url?e.jsx("img",{className:"recent-thumb",src:l.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsxs("div",{className:"cell-footer",children:[((k=l.uploader)==null?void 0:k.avatar_url)&&e.jsx("img",{className:"cell-avatar",src:l.uploader.avatar_url,alt:"avatar"}),e.jsx("span",{className:"cell-name",children:(j=l.uploader)==null?void 0:j.username})]})]},l.id)})]})})})]})]}),N&&e.jsx(As,{open:!!N,onClose:()=>P(null),videoId:N.id,initialDescription:N.description,initialBeatmapUrl:N.beatmap_url,onSave:(l,k)=>{b(R.map(j=>j.id===N.id?{...j,description:l||null,beatmap_url:k}:j)),P(null)}}),e.jsx("style",{children:`
        .insp-avatar { width: 32px; height: 32px; border-radius: 9999px; padding: 0; border: none; overflow: hidden; cursor: pointer; background: rgba(255,255,255,0.06); display: inline-flex; align-items: center; justify-content: center; }
        .insp-avatar.link { background: transparent; border: 1px solid rgba(255,255,255,0.08); }
        .insp-avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .insp-add { width: 32px; height: 32px; border-radius: 9999px; border: 1px dashed rgba(255,255,255,0.25); background: transparent; color: #e5e7eb; font-weight: 700; cursor: pointer; }
        .insp-add:hover { border-color: rgba(255,255,255,0.5); }
        .insp-tooltip {
          position: absolute;
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
          background: rgba(18, 20, 24, 0.95);
          color: var(--text, #e5e7eb);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 14px;
          white-space: nowrap;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
          z-index: 10000;
          pointer-events: none;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
        }
        .insp-tooltip::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          width: 0;
          height: 0;
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-bottom: 5px solid rgba(18, 20, 24, 0.95);
        }
        .insp-pop { position: absolute; right: 0; top: 40px; width: 260px; background: var(--panel); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; box-shadow: 0 12px 30px rgba(0,0,0,0.4); padding: 8px; z-index: 10; }
        .insp-pop input { width: 100%; padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.08); background: var(--panel-dark); color: #fff; outline: none; box-sizing: border-box; display: block; }
        .insp-results { margin-top: 6px; max-height: 220px; overflow: auto; display: grid; gap: 4px; }
        .insp-result { display: grid; grid-template-columns: 24px 1fr; gap: 8px; align-items: center; padding: 6px 8px; border-radius: 8px; border: 1px solid transparent; background: transparent; color: #e5e7eb; cursor: pointer; text-align: left; }
        .insp-result:hover { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.08); }
        .insp-result img { width: 24px; height: 24px; border-radius: 9999px; object-fit: cover; }
        .insp-close { margin-top: 6px; width: 100%; padding: 6px 8px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.04); color: #e5e7eb; cursor: pointer; }
      `})]})}const Ps=be(()=>H(()=>import("./Home-BkPH3_0u.js"),__vite__mapDeps([14,1,2]))),zs=be(()=>H(()=>import("./mappi-routes-BuYlJIUY.js").then(t=>t.e),__vite__mapDeps([4,1,2,5,6,7,8,9]))),Ds=be(()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.P),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),Fs=be(()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.Q),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),Os=be(()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.h),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),$s=be(()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.N),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),qs=be(()=>H(()=>import("./Moderation-DgVwM8bp.js"),__vite__mapDeps([13,1,2,4,5,6,7,8,9]))),Ws=be(()=>H(()=>import("./About-DgGXV8RR.js"),__vite__mapDeps([0,1,2]))),Bs=be(()=>H(()=>import("./Settings-B-E92wyK.js"),__vite__mapDeps([15,1,2]))),Us=be(()=>H(()=>import("./editor-3q5Z-n3D.js"),__vite__mapDeps([12,1,2,6,7,8,9])).then(t=>({default:t.Editor}))),Hs=()=>e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"50vh",color:"var(--muted)"},children:"Loading..."}),Vs=()=>(i.useEffect(()=>{Rs([()=>H(()=>import("./mappi-routes-BuYlJIUY.js").then(t=>t.e),__vite__mapDeps([4,1,2,5,6,7,8,9])),()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.P),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11])),()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.Q),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11])),()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.h),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11])),()=>H(()=>import("./moddi-routes-BAHBGzbB.js").then(t=>t.N),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))])},[]),e.jsx(i.Suspense,{fallback:e.jsx(Hs,{}),children:e.jsx(ns,{children:e.jsxs(V,{element:e.jsx(Ts,{}),children:[e.jsx(V,{path:"/",element:e.jsx(Ps,{})}),e.jsx(V,{path:"/mp/discover",element:e.jsx(vt,{})}),e.jsx(V,{path:"/mp/feed",element:e.jsx(Fe,{})}),e.jsx(V,{path:"/mp/feed/:uid",element:e.jsx(zs,{})}),e.jsx(V,{path:"/md/feed",element:e.jsx(js,{})}),e.jsx(V,{path:"/md/feed/:uid",element:e.jsx(Ds,{})}),e.jsx(V,{path:"/md/queues",element:e.jsx(Fs,{})}),e.jsx(V,{path:"/md/queues/:id",element:e.jsx(Os,{})}),e.jsx(V,{path:"/md/notifications",element:e.jsx($s,{})}),e.jsx(V,{path:"/profile",element:e.jsx(jt,{})}),e.jsx(V,{path:"/profile/:id",element:e.jsx(jt,{})}),e.jsx(V,{path:"/moderation",element:e.jsx(qs,{})}),e.jsx(V,{path:"/about",element:e.jsx(Ws,{})}),e.jsx(V,{path:"/settings",element:e.jsx(Bs,{})}),e.jsx(V,{path:"/editor",element:e.jsx(Us,{})}),e.jsx(V,{path:"/feed",element:e.jsx(vt,{})}),e.jsx(V,{path:"/upload",element:e.jsx(Fe,{})}),e.jsx(V,{path:"/posts",element:e.jsx(Fe,{})}),e.jsx(V,{path:"/recents",element:e.jsx(Fe,{})}),e.jsx(V,{path:"/recent",element:e.jsx(Fe,{})})]})})})),Qs=()=>e.jsx(ss,{children:e.jsx(Vs,{})});es(document.getElementById("root")).render(e.jsx(ne.StrictMode,{children:e.jsx(Ss,{children:e.jsx(ts,{client:_s,children:e.jsx(ls,{children:e.jsx(Qs,{})})})})}));
