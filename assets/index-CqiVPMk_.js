const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-QfUQ1byH.js","assets/vendor-react-Bj2Cd7tG.js","assets/vendor-CBpd7OPg.js","assets/Discover-BYUgAJQM.js","assets/Player-6g6U1utb.js","assets/beatmap-preview-C7RhKmiP.js","assets/editor-lib-FG3lxfNK.js","assets/editor-lib-CGytSYYz.css","assets/editor-components-B-SB05wW.js","assets/editor-components-Bzmrvihl.css","assets/Feed-B2y-mDQB.js","assets/Post-C6iWKDAt.js","assets/Popup-BlKZUnaV.js","assets/Compose-DBsxUALw.js","assets/PostDetail-CHZnB9Lc.js","assets/Comment-C87DNMr5.js","assets/Overlay-CC029a9L.js","assets/Feed-egqpKEda.js","assets/PostDetail-B7KdKzVh.js","assets/Queues-QdljHQFV.js","assets/QueueDetail-CpqcaxRl.js","assets/Notifications-CRPf0PBW.js","assets/Profile-Dg4MH494.js","assets/Moderation-DDZ1iGbg.js","assets/About-Do-UmwaJ.js","assets/editor-B_Fd3idJ.js"])))=>i.map(i=>d[i]);
import{r as f,j as e,d as ge,u as V,e as K,f as X,g as ye,R as A,h as je,L as h,i as se,k as ve,l as Ne,A as be,m as we,n as _e,o as ke,p as Ce,q as Se,s as Ee,O as B,S as Fe,t as Te,v as Ae,w as Oe,Q as Ie,H as $e,x as Pe,y}from"./vendor-react-Bj2Cd7tG.js";import{l as Me}from"./vendor-CBpd7OPg.js";import{H as Re,i as De,a as Le,b as ze,c as qe}from"./editor-components-B-SB05wW.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))p(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&p(c)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function p(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}})();const We="modulepreload",Be=function(t){return"/"+t},ae={},C=function(s,i,p){let n=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),x=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));n=Promise.allSettled(i.map(v=>{if(v=Be(v),v in ae)return;ae[v]=!0;const F=v.endsWith(".css"),m=F?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${m}`))return;const l=document.createElement("link");if(l.rel=F?"stylesheet":We,F||(l.as="script"),l.crossOrigin="",l.href=v,x&&l.setAttribute("nonce",x),document.head.appendChild(l),F)return new Promise((N,g)=>{l.addEventListener("load",N),l.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${v}`)))})}))}function r(c){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=c,window.dispatchEvent(x),!x.defaultPrevented)throw c}return n.then(c=>{for(const x of c||[])x.status==="rejected"&&r(x.reason);return s().catch(r)})},He=new Me({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}}),oe=f.createContext(null);function Ve({children:t}){const[s,i]=f.useState([]),p=f.useRef(1),n=f.useRef(new Map),r=m=>{const l=n.current.get(m);l&&(clearTimeout(l),n.current.delete(m))},c=(m,l)=>{r(m);const N=window.setTimeout(()=>x(m),l);n.current.set(m,N)},x=f.useCallback(m=>{r(m),i(l=>l.filter(N=>N.id!==m))},[]),v=f.useCallback((m,l)=>{const N=typeof l=="number"?l:(l==null?void 0:l.durationMs)??5e3,g=typeof l=="number"?"info":(l==null?void 0:l.variant)??"info",O=(()=>{try{return window.matchMedia("(max-width: 600px), (pointer: coarse)").matches}catch{return!1}})();let _=null;return i(O?k=>{const b=k[0];if(b&&b.message===m&&b.variant===g){const j={...b,count:b.count+1,duration:N};return _=j.id,[j]}k.forEach(j=>r(j.id));const w=p.current++,I={id:w,message:m,duration:N,variant:g,count:1};return _=w,[I]}:k=>{const b=k.findIndex(j=>j.message===m&&j.variant===g);if(b!==-1){const j=[...k],$={...j[b],count:j[b].count+1};return j[b]=$,_=$.id,j}const w=p.current++,I={id:w,message:m,duration:N,variant:g,count:1};return _=w,[...k,I]}),_!=null&&c(_,N),_??-1},[]),F=f.useMemo(()=>({notify:v,close:x}),[v,x]);return e.jsxs(oe.Provider,{value:F,children:[t,e.jsx("div",{className:"toasts",children:s.map(m=>e.jsxs("div",{className:`toast ${m.variant}`,children:[e.jsxs("div",{className:"toast-text",children:[m.message,m.count>1&&e.jsxs("span",{style:{marginLeft:6,opacity:.8},children:["×",m.count]})]}),e.jsx("button",{className:"toast-close",onClick:()=>x(m.id),"aria-label":"Close",children:"×"})]},m.id))})]})}function Ue(){const t=f.useContext(oe);if(!t)throw new Error("useToasts must be used within ToastProvider");return t}class Qe extends f.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,i){console.error("ErrorBoundary caught an error:",s,i)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"24px",color:"var(--muted)"},children:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred"}),e.jsx("button",{className:"btn secondary",onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},children:"Reload Page"})]}):this.props.children}}const T=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function Ke({i:t}){const s=t*1337,i=(g,O)=>{const _=Math.sin(s+g+O)*1e4,k=_-Math.floor(_);return Math.floor(k*(O-g+1)+g)},p=i(0,100),n=i(24,50),r=.7+i(0,100)/100*.3,c=n*r,x=i(0,4e3),v=i(-10,10),F=i(-8,8),m=i(0,100),l=m<60?1:m<80?1.5:2,N=[{size:200*l,alpha:.06,dx:-22,dy:12,color:T[i(0,T.length-1)]},{size:150*l,alpha:.08,dx:-9,dy:7,color:T[i(0,T.length-1)]},{size:120*l,alpha:.1,dx:0,dy:0,color:T[i(0,T.length-1)]},{size:90*l,alpha:.12,dx:12,dy:-4,color:T[i(0,T.length-1)]},{size:64*l,alpha:.13,dx:20,dy:-7,color:T[i(0,T.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${p}vw`,animationDuration:`${c}s`,animationDelay:`${x}ms`,"--tx":`${v}vw`,transform:`rotate(${F}deg)`},children:N.map((g,O)=>e.jsx("svg",{width:g.size,height:g.size,viewBox:"0 0 100 100",style:{left:`${50+g.dx}%`,bottom:`${g.dy}px`,transform:"translateX(-50%)","--alpha":g.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:g.color})},O))})}function Xe({paused:t=!1}){const s=f.useMemo(()=>new Array(20).fill(0).map((i,p)=>p),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:s.map(i=>e.jsx(Ke,{i},i))})}const Ge=()=>{try{const t=localStorage.getItem("filter_modes")||"standard",s=new Set(t.toLowerCase().split(",").map(i=>i.trim()).filter(Boolean));return{standard:s.has("standard")||s.size===0,taiko:s.has("taiko"),mania:s.has("mania"),catch:s.has("catch")}}catch{return{standard:!0,taiko:!1,mania:!1,catch:!1}}},Je=()=>{try{const t=localStorage.getItem("filter_moddi_tags")||"untagged,help",s=new Set(t.toLowerCase().split(",").map(i=>i.trim()).filter(Boolean));return{untagged:s.has("untagged")||s.size===0,help:s.has("help")||s.size===0}}catch{return{untagged:!0,help:!0}}},Ze=()=>{try{const t=localStorage.getItem("last_section");return t==="mappi"||t==="moddi"?t:null}catch{return null}},Ye=ge(t=>({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1,filtersOpen:!1,modeFilters:Ge(),tagFilters:Je(),lastSection:Ze(),setMenuOpen:s=>t({menuOpen:s}),setMobileNavOpen:s=>t({mobileNavOpen:s}),setNotifOpen:s=>t({notifOpen:s}),setFiltersOpen:s=>t({filtersOpen:s}),closeAllPanels:()=>t({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1,filtersOpen:!1}),setModeFilters:s=>{t({modeFilters:s});try{const p=Object.entries(s).filter(([r,c])=>c).map(([r])=>r),n=p.length?p:["standard"];localStorage.setItem("filter_modes",n.join(","))}catch{}},setTagFilters:s=>{t({tagFilters:s});try{const p=Object.entries(s).filter(([r,c])=>c).map(([r])=>r),n=p.length?p:["untagged","help"];localStorage.setItem("filter_moddi_tags",n.join(","))}catch{}},setLastSection:s=>{t({lastSection:s});try{s?localStorage.setItem("last_section",s):localStorage.removeItem("last_section")}catch{}}})),et="https://api.osumappi.ng";function H(){var t;try{return((t=document.cookie.split("; ").map(s=>s.split("=")).find(([s])=>s==="csrf"))==null?void 0:t[1])||""}catch{return""}}async function M(t,s={}){const{requireAuth:i=!0,skipCsrf:p=!1,...n}=s,r={...n.headers};if(n.body&&!r["Content-Type"]&&(r["Content-Type"]="application/json"),i&&!p){const x=H();x&&(r["X-CSRF-Token"]=x)}const c=await fetch(`${et}${t}`,{...n,credentials:"include",headers:r});if(!c.ok){const x=await c.json().catch(()=>({error:`HTTP ${c.status}`}));throw new Error(x.error||`HTTP ${c.status}: ${c.statusText}`)}return c.json()}const z={auth:{login:"/api/auth/login",logout:"/api/auth/logout",me:"/api/me"},user:{quota:"/api/me/upload_quota",notifications:"/api/me/notifications",markNotificationsRead:"/api/me/notifications/mark_read",deleteNotification:t=>`/api/me/notifications/${encodeURIComponent(t)}`},feed:{next:"/api/feed/next",batch:"/api/feed/batch",recent:"/api/videos/recent"},videos:{like:t=>`/api/videos/${t}/like`,view:t=>`/api/videos/${t}/view`,update:t=>`/api/videos/${t}`,delete:t=>`/api/videos/${t}`},moddi:{posts:"/api/moddiposts",post:t=>`/api/moddiposts/${t}`,queues:"/api/moddi/queues",queue:t=>`/api/moddi/queues/${t}`,queueSubmit:t=>`/api/moddi/queues/${t}/submit`},osu:{resolveBeatmap:"/api/osu/beatmap/resolve"},admin:{clearViews:"/api/admin/me/clear_views",debugState:"/api/debug/state"}};function tt(){return V({queryKey:["user","me"],queryFn:async()=>{try{return await M(z.auth.me)}catch{return null}},staleTime:5*60*1e3})}function st(t=!0){return V({queryKey:["user","quota"],queryFn:async()=>{try{return await M(z.user.quota)}catch{return null}},enabled:t,refetchInterval:30*1e3})}function at(){const t=K();return X({mutationFn:async()=>{await M(z.auth.logout,{method:"POST"})},onSuccess:()=>{t.setQueryData(["user","me"],null),t.clear(),window.location.href="/"}})}function re(t=!0){return V({queryKey:["notifications"],queryFn:async()=>{try{const s=await M(z.user.notifications);return Array.isArray(s.items)?s.items:[]}catch{return[]}},enabled:t,refetchInterval:45*1e3})}function Ct(){return V({queryKey:["notifications","detailed"],queryFn:async()=>{try{const t=await M("/api/me/notifications/detailed");return Array.isArray(t.items)?t.items:[]}catch{return[]}},refetchInterval:30*1e3})}function it(){const{data:t=[]}=re();return t.filter(s=>s.kind==="system"&&s.id.startsWith("b:")&&(s.expiresAt||0)<=Date.now()?!1:!s.read).length}function nt(){const t=K();return X({mutationFn:async s=>{await M(z.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:s})})},onSuccess:()=>{t.setQueryData(["notifications"],s=>(s==null?void 0:s.map(i=>({...i,read:!0})))||[])}})}function ot(){const t=K();return X({mutationFn:async s=>{const i=H();await M(z.user.deleteNotification(s),{method:"DELETE",headers:{"X-CSRF-Token":i}})},onSuccess:(s,i)=>{t.setQueryData(["notifications"],p=>(p==null?void 0:p.filter(n=>n.id!==i))||[])}})}function rt(){const t=ye(),{notify:s}=Ue(),{data:i,isLoading:p}=tt(),{data:n}=st(!!i),{data:r=[]}=re(!!i),c=it(),x=at(),v=nt(),F=ot(),{menuOpen:m,mobileNavOpen:l,notifOpen:N,filtersOpen:g,modeFilters:O,tagFilters:_,lastSection:k,setMenuOpen:b,setMobileNavOpen:w,setNotifOpen:I,setFiltersOpen:j,closeAllPanels:$,setModeFilters:G,setTagFilters:J,setLastSection:U}=Ye(),P=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",le=t.pathname==="/editor",R=t.pathname.startsWith("/mp/")||!P&&!t.pathname.startsWith("/md/")&&k==="mappi",S=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!P&&!t.pathname.startsWith("/mp/")&&k==="moddi";A.useEffect(()=>{t.pathname.startsWith("/mp/")?U("mappi"):t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"&&U("moddi")},[t.pathname,U]);const[Nt,ce]=A.useState(0);A.useEffect(()=>{const a=setInterval(()=>ce(o=>o+1),1e3);return()=>clearInterval(a)},[]);const[Z,Q]=A.useState(null);A.useEffect(()=>{(async()=>{try{const a=window.location.hostname,o=a.split("."),d=o.length>=2?`${o[o.length-2]}.${o[o.length-1]}`:a,u=`https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(d)}&type=NS`,E=await fetch(u,{headers:{accept:"application/dns-json"}});if(!E.ok){Q(!1);return}const D=await E.json().catch(()=>({})),xe=(Array.isArray(D==null?void 0:D.Answer)?D.Answer:[]).some(L=>/cloudflare\.com\.?$/i.test(String((L==null?void 0:L.data)||(L==null?void 0:L.name)||"")));Q(xe)}catch{Q(!1)}})()},[]);const[Y,de]=A.useState(null);A.useEffect(()=>{!i||!i.is_mod||(async()=>{try{const o=await fetch("https://api.osumappi.ng/api/debug/state",{credentials:"include"});if(o.ok){const d=await o.json(),u=Array.isArray(d==null?void 0:d.counts)?d.counts.find(E=>String(E.status)==="ready"):null;u&&de(Number(u.c)||0)}}catch{}})()},[i]);const[W,ee]=A.useState(!1),te=async()=>{ee(!0);try{const a="https://api.osumappi.ng",o=H(),d=await fetch(`${a}/api/admin/me/clear_views`,{method:"POST",credentials:"include",headers:{"X-CSRF-Token":o}});if(d.ok){const u=await d.json().catch(()=>({}));s(`Cleared ${Number((u==null?void 0:u.deleted)||0)} views from your history.`,{variant:"success"});try{localStorage.removeItem("feed_seen_ids")}catch{}try{window.dispatchEvent(new Event("filterchange"))}catch{}}else s("Failed to clear view history",{variant:"error"})}catch{s("Failed to clear view history",{variant:"error"})}finally{ee(!1)}},me=async()=>{const a=r.filter(o=>o.id.startsWith("n:")||o.kind==="system"&&!o.read).map(o=>o.id);a.length>0&&v.mutate(a)},ue=async a=>{if(I(!1),v.mutate([a.id]),a.kind==="system"||a.id.startsWith("n:")){const o=H();try{await fetch("https://api.osumappi.ng/api/me/notifications/mark_read",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":o},body:JSON.stringify({ids:[a.id]})})}catch{}}},pe=async(a,o)=>{a.stopPropagation(),F.mutate(o)},he=()=>{const o=Object.entries(O).filter(([d,u])=>u).map(([d])=>d);o.length,o.length===0&&G({standard:!0,taiko:!1,mania:!1,catch:!1});try{window.dispatchEvent(new Event("filterchange"))}catch{}j(!1)},fe=()=>{const o=Object.entries(_).filter(([d,u])=>u).map(([d])=>d);o.length,o.length===0&&J({untagged:!0,help:!0});try{window.dispatchEvent(new Event("moddifilterchange"))}catch{}j(!1)};return A.useEffect(()=>{i&&!localStorage.getItem("welcomed")&&(s(`Welcome, ${i.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[i,s]),e.jsxs("div",{className:"app-shell","data-section":S?"moddi":R?"mappi":k==="moddi"?"moddi":k==="mappi"?"mappi":void 0,children:[e.jsx(Xe,{paused:t.pathname==="/editor"}),e.jsxs("header",{className:"top-nav",children:[t.pathname!=="/editor"&&e.jsxs("div",{className:"mobile-nav",children:[e.jsx("button",{className:"icon-link hamburger",onClick:()=>{l||$(),w(a=>!a)},"aria-label":"Menu","aria-expanded":l,children:e.jsx(je,{size:18})}),l&&e.jsxs("div",{className:"menu-panel",role:"menu",children:[P&&e.jsx(h,{to:t.pathname==="/"?"/about":"/",className:`menu-item ${t.pathname==="/about"?"active":""}`,onClick:()=>w(!1),children:t.pathname==="/"?"About":"Home"}),R&&e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>w(!1),children:"Feed"}),e.jsx(h,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>w(!1),children:"Discover"})]}),S&&e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/md/feed",className:`menu-item ${t.pathname==="/md/feed"?"active":""}`,onClick:()=>w(!1),children:"Feed"}),e.jsx(h,{to:"/md/queues",className:`menu-item ${t.pathname.startsWith("/md/queues")?"active":""}`,onClick:()=>w(!1),children:"Queues"})]}),!R&&!S&&!P&&e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>w(!1),children:"Feed"}),e.jsx(h,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>w(!1),children:"Discover"})]})]})]}),P?e.jsx(h,{to:"/",className:"title",children:S?"osu!moddi.ng":R?"osu!mappi.ng":"mappi!"}):le?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(h,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(se,{size:18})}),e.jsx(h,{to:S?"/md/feed":"/mp/feed",className:"title",children:S?"osu!moddi.ng":"osu!mappi.ng"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(h,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(se,{size:18})}),e.jsxs(h,{to:S?"/mp/feed":"/md/feed",className:"title coin-flip-title",children:[e.jsx("span",{className:"coin-flip-front",children:S?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:S?"osu!mappi.ng":"osu!moddi.ng"})]})]}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),t.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(Re,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[P&&e.jsx(h,{to:t.pathname==="/"?"/about":"/",className:t.pathname==="/about"?"active":"",children:t.pathname==="/"?"About":"Home"}),R&&e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(h,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(h,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]}),S&&e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/md/feed",className:t.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx(h,{to:"/md/queues",className:t.pathname.startsWith("/md/queues")?"active":"",children:"Queues"})]}),!R&&!S&&!P&&e.jsxs(e.Fragment,{children:[e.jsx(h,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(h,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(h,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]})]}),e.jsx("div",{style:{marginLeft:"auto"}}),i?e.jsxs("div",{className:"user-menu",children:[e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:6},children:[e.jsx("button",{className:"icon-link",onClick:()=>{N||$(),I(a=>!a)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(ve,{size:18})}),c>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),N&&e.jsxs("div",{className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(h,{to:"/md/notifications",onClick:()=>I(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:a=>a.currentTarget.style.opacity="1",onMouseLeave:a=>a.currentTarget.style.opacity="0.7",children:"View all"}),r.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:me,children:e.jsx(Ne,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[r.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),r.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).map(a=>{const o=a.id.startsWith("b:"),d=a.kind==="star"?"star":a.kind==="likes5"?"likes":a.kind==="inspiration"?"inspiration":o?"global":"system",u=a.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${d}`,role:"button",onClick:()=>ue(a),children:[e.jsxs("div",{className:`notif-icon ${u?"deletable":""}`,"aria-hidden":"true",onClick:u?E=>pe(E,a.id):void 0,title:u?"Remove":void 0,role:u?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:d==="star"?e.jsx(be,{}):d==="likes"?e.jsx(we,{}):d==="inspiration"?e.jsx(_e,{}):d==="global"?e.jsx(ke,{}):null}),u?e.jsx("span",{className:"swap-trash",children:e.jsx(Ce,{})}):null]}),e.jsx("div",{className:"notif-body",children:a.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:o?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:a.text||""}),o&&a.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(a.expiresAt).toLocaleString()]}):null]}):a.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:a.text||"Someone is inspired by you!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:a.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:a.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},a.id)})]})]})]}),n!=null&&n.blocked?e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(Se,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:(()=>{const a=Math.max(0,Math.floor((((n==null?void 0:n.reset_at)??0)*1e3-Date.now())/1e3)),o=Math.floor(a/3600),d=Math.floor(a%3600/60),u=a%60,E=D=>String(D).padStart(2,"0");return o>0?`${o}:${E(d)}:${E(u)}`:`${d}:${E(u)}`})()})]}):null,e.jsxs("button",{className:"icon-link",onClick:()=>{m||$(),b(a=>!a)},title:i.username,"aria-label":"User menu","aria-expanded":m,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[i.avatar_url&&e.jsx("img",{src:i.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:i.username}),e.jsx(Ee,{size:14,style:{opacity:.8}})]}),m&&e.jsxs("div",{className:"menu-panel",role:"menu",children:[e.jsx(h,{to:"/profile",className:"menu-item",onClick:()=>b(!1),children:"Profile"}),i!=null&&i.is_admin||i!=null&&i.is_mod?e.jsx(h,{to:"/moderation",className:"menu-item",onClick:()=>b(!1),children:"Moderation"}):null,e.jsx("button",{className:"menu-item",type:"button",onClick:()=>x.mutate(),children:"Log out"})]})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{const a="https://api.osumappi.ng";window.location.href=`${a}/api/auth/login`},disabled:p,children:p?"Checking…":"Login with osu!"})]})]}),e.jsx("main",{className:`page ${t.pathname==="/editor"?"fullscreen":""}`,children:t.pathname==="/editor"?e.jsx(B,{}):t.pathname==="/"?e.jsx(B,{}):t.pathname==="/mp/discover"||t.pathname==="/about"||t.pathname==="/profile"||t.pathname.startsWith("/profile/")||t.pathname==="/moderation"?e.jsx("div",{className:"card",children:e.jsx(B,{})}):e.jsx(B,{})}),t.pathname!=="/editor"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"site-badge","aria-hidden":!1,children:[e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("a",{className:"discord",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)",children:e.jsx(Fe,{size:18})}),e.jsx("span",{className:`cloudflare ${Z?"active":""}`,title:Z?"Cloudflare DNS active":"Cloudflare not detected",children:e.jsx(Te,{size:18})})]}),i&&i.is_mod&&Y!==null&&e.jsxs("div",{className:"label",children:[Y," videos ready"]})]}),e.jsxs("div",{className:"site-controls","aria-hidden":!1,children:[e.jsx("button",{className:"settings-btn",onClick:()=>{g||$(),j(a=>!a)},"aria-expanded":g,"aria-label":"Filter settings",title:"Filter settings",children:e.jsx(Ae,{size:18})}),g&&e.jsx("div",{className:"settings-panel",role:"dialog","aria-modal":"false",children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Tags"}),e.jsx("div",{className:"col",style:{gap:6},children:[["untagged","Untagged"],["help","Help"]].map(([a,o])=>{const d=_[a];return e.jsx("button",{className:`mode-cell ${d?"selected":""}`,"aria-pressed":d,onClick:()=>{J(u=>({...u,[a]:!d}))},children:e.jsx("span",{children:o})},a)})}),i&&(i.is_admin||i.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:W,onClick:te,children:W?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>j(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:fe,children:"Apply"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Game modes"}),e.jsx("div",{className:"col",style:{gap:6},children:[["standard","Standard",De],["taiko","Taiko",Le],["mania","Mania",ze],["catch","Catch",qe]].map(([a,o,d])=>{const u=O[a];return e.jsxs("button",{className:`mode-cell ${u?"selected":""}`,"aria-pressed":u,onClick:()=>{G(E=>({...E,[a]:!u}))},children:[e.jsx("img",{className:"mode-icon",src:d,width:24,height:24,alt:""}),e.jsx("span",{children:o})]},a)})}),i&&(i.is_admin||i.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:W,onClick:te,children:W?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>j(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:he,children:"Apply"})]})]})})]})]})]})}const lt=f.lazy(()=>C(()=>import("./Home-QfUQ1byH.js"),__vite__mapDeps([0,1,2]))),ie=f.lazy(()=>C(()=>import("./Discover-BYUgAJQM.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9]))),q=f.lazy(()=>C(()=>import("./Feed-B2y-mDQB.js"),__vite__mapDeps([10,1,2,11,12,4,6,5,7,13,8,9]))),ct=f.lazy(()=>C(()=>import("./PostDetail-CHZnB9Lc.js"),__vite__mapDeps([14,1,2,11,12,4,6,5,7,15,16,8,9]))),dt=f.lazy(()=>C(()=>import("./Feed-egqpKEda.js"),__vite__mapDeps([17,1,2,11,12,4,6,5,7,13,8,9]))),mt=f.lazy(()=>C(()=>import("./PostDetail-B7KdKzVh.js"),__vite__mapDeps([18,1,2,11,12,4,6,5,7,15,8,9]))),ut=f.lazy(()=>C(()=>import("./Queues-QdljHQFV.js"),__vite__mapDeps([19,1,2,8,9]))),pt=f.lazy(()=>C(()=>import("./QueueDetail-CpqcaxRl.js"),__vite__mapDeps([20,1,2,8,9]))),ht=f.lazy(()=>C(()=>import("./Notifications-CRPf0PBW.js"),__vite__mapDeps([21,1,2,8,9]))),ne=f.lazy(()=>C(()=>import("./Profile-Dg4MH494.js"),__vite__mapDeps([22,1,2,16,4,5,6,7,12,8,9]))),ft=f.lazy(()=>C(()=>import("./Moderation-DDZ1iGbg.js"),__vite__mapDeps([23,1,2,8,9]))),xt=f.lazy(()=>C(()=>import("./About-Do-UmwaJ.js"),__vite__mapDeps([24,1,2]))),gt=f.lazy(()=>C(()=>import("./editor-B_Fd3idJ.js"),__vite__mapDeps([25,1,2,6,5,7])).then(t=>({default:t.Editor}))),yt=()=>e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"50vh",color:"var(--muted)"},children:"Loading..."}),jt=()=>e.jsx(f.Suspense,{fallback:e.jsx(yt,{}),children:e.jsx(Pe,{children:e.jsxs(y,{element:e.jsx(rt,{}),children:[e.jsx(y,{path:"/",element:e.jsx(lt,{})}),e.jsx(y,{path:"/mp/discover",element:e.jsx(ie,{})}),e.jsx(y,{path:"/mp/feed",element:e.jsx(q,{})}),e.jsx(y,{path:"/mp/feed/:uid",element:e.jsx(ct,{})}),e.jsx(y,{path:"/md/feed",element:e.jsx(dt,{})}),e.jsx(y,{path:"/md/feed/:uid",element:e.jsx(mt,{})}),e.jsx(y,{path:"/md/queues",element:e.jsx(ut,{})}),e.jsx(y,{path:"/md/queues/:id",element:e.jsx(pt,{})}),e.jsx(y,{path:"/md/notifications",element:e.jsx(ht,{})}),e.jsx(y,{path:"/profile",element:e.jsx(ne,{})}),e.jsx(y,{path:"/profile/:id",element:e.jsx(ne,{})}),e.jsx(y,{path:"/moderation",element:e.jsx(ft,{})}),e.jsx(y,{path:"/about",element:e.jsx(xt,{})}),e.jsx(y,{path:"/editor",element:e.jsx(gt,{})}),e.jsx(y,{path:"/feed",element:e.jsx(ie,{})}),e.jsx(y,{path:"/upload",element:e.jsx(q,{})}),e.jsx(y,{path:"/posts",element:e.jsx(q,{})}),e.jsx(y,{path:"/recents",element:e.jsx(q,{})}),e.jsx(y,{path:"/recent",element:e.jsx(q,{})})]})})}),vt=()=>e.jsx($e,{children:e.jsx(jt,{})});Oe(document.getElementById("root")).render(e.jsx(A.StrictMode,{children:e.jsx(Qe,{children:e.jsx(Ie,{client:He,children:e.jsx(Ve,{children:e.jsx(vt,{})})})})}));export{z as A,tt as a,Ye as b,M as c,Ct as d,nt as e,ot as f,Ue as u};
