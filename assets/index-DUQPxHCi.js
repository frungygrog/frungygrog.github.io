const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-CcFVd-cs.js","assets/vendor-react-BcGuPv3N.js","assets/vendor-5bngNAZ_.js","assets/Discover-GS7cXqqX.js","assets/Popup-CfRPiBaA.js","assets/editor-lib-B1vDSaUI.js","assets/beatmap-preview-q2bqO_ZX.js","assets/editor-lib-CGytSYYz.css","assets/Comment-DzMxoqI5.js","assets/editor-components-ZomeoNmo.js","assets/editor-components-Bzmrvihl.css","assets/Feed-CTLA210o.js","assets/Post-CEKhasr7.js","assets/Compose-DdK3eLJh.js","assets/PostDetail-DAooF80l.js","assets/Overlay-DdGncPB6.js","assets/Feed-Dm6FBfLt.js","assets/PostDetail-DBxzrL0E.js","assets/Queues-RTsd_tkC.js","assets/QueueDetail-kZzBOEKn.js","assets/Notifications-CiStgLvT.js","assets/Profile-VlxKspXf.js","assets/Moderation-ChdNi2jb.js","assets/About-BOIwQfw1.js","assets/editor-DnNoAVNn.js"])))=>i.map(i=>d[i]);
import{r as h,j as e,d as we,u as H,e as J,f as X,g as _e,i as ke,R as I,k as Se,L as f,l as se,S as Ce,m as Fe,n as ae,o as $e,A as Ee,p as Te,q as Oe,s as qe,t as Ae,c as Ie,v as Pe,w as Re,O as B,x as Me,y as ze,Q as De,H as Le,z as Be,B as y}from"./vendor-react-BcGuPv3N.js";import{x as Ue}from"./vendor-5bngNAZ_.js";import{H as Ve,i as We,a as Qe,b as He,c as Ke}from"./editor-components-ZomeoNmo.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function i(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(l){if(l.ep)return;l.ep=!0;const c=i(l);fetch(l.href,c)}})();const Je="modulepreload",Xe=function(t){return"/"+t},ie={},k=function(s,i,n){let l=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),x=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));l=Promise.allSettled(i.map(N=>{if(N=Xe(N),N in ie)return;ie[N]=!0;const E=N.endsWith(".css"),p=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${N}"]${p}`))return;const u=document.createElement("link");if(u.rel=E?"stylesheet":Je,E||(u.as="script"),u.crossOrigin="",u.href=N,x&&u.setAttribute("nonce",x),document.head.appendChild(u),E)return new Promise((v,g)=>{u.addEventListener("load",v),u.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${N}`)))})}))}function c(d){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=d,window.dispatchEvent(x),!x.defaultPrevented)throw d}return l.then(d=>{for(const x of d||[])x.status==="rejected"&&c(x.reason);return s().catch(c)})},Ge=new Ue({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}}),oe=h.createContext(null);function Ze({children:t}){const[s,i]=h.useState([]),n=h.useRef(1),l=h.useRef(new Map),c=p=>{const u=l.current.get(p);u&&(clearTimeout(u),l.current.delete(p))},d=(p,u)=>{c(p);const v=window.setTimeout(()=>x(p),u);l.current.set(p,v)},x=h.useCallback(p=>{c(p),i(u=>u.filter(v=>v.id!==p))},[]),N=h.useCallback((p,u)=>{const v=typeof u=="number"?u:(u==null?void 0:u.durationMs)??5e3,g=typeof u=="number"?"info":(u==null?void 0:u.variant)??"info",T=(()=>{try{return window.matchMedia("(max-width: 600px), (pointer: coarse)").matches}catch{return!1}})();let _=null;return i(T?S=>{const w=S[0];if(w&&w.message===p&&w.variant===g){const j={...w,count:w.count+1,duration:v};return _=j.id,[j]}S.forEach(j=>c(j.id));const q=n.current++,M={id:q,message:p,duration:v,variant:g,count:1};return _=q,[M]}:S=>{const w=S.findIndex(j=>j.message===p&&j.variant===g);if(w!==-1){const j=[...S],z={...j[w],count:j[w].count+1};return j[w]=z,_=z.id,j}const q=n.current++,M={id:q,message:p,duration:v,variant:g,count:1};return _=q,[...S,M]}),_!=null&&d(_,v),_??-1},[]),E=h.useMemo(()=>({notify:N,close:x}),[N,x]);return e.jsxs(oe.Provider,{value:E,children:[t,e.jsx("div",{className:"toasts",children:s.map(p=>e.jsxs("div",{className:`toast ${p.variant}`,children:[e.jsxs("div",{className:"toast-text",children:[p.message,p.count>1&&e.jsxs("span",{style:{marginLeft:6,opacity:.8},children:["×",p.count]})]}),e.jsx("button",{className:"toast-close",onClick:()=>x(p.id),"aria-label":"Close",children:"×"})]},p.id))})]})}function Ye(){const t=h.useContext(oe);if(!t)throw new Error("useToasts must be used within ToastProvider");return t}class et extends h.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,i){console.error("ErrorBoundary caught an error:",s,i)}render(){var s;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"24px",color:"var(--muted)"},children:((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred"}),e.jsx("button",{className:"btn secondary",onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},children:"Reload Page"})]}):this.props.children}}const O=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function tt({i:t}){const s=t*1337,i=(g,T)=>{const _=Math.sin(s+g+T)*1e4,S=_-Math.floor(_);return Math.floor(S*(T-g+1)+g)},n=i(0,100),l=i(24,50),c=.7+i(0,100)/100*.3,d=l*c,x=i(0,4e3),N=i(-10,10),E=i(-8,8),p=i(0,100),u=p<60?1:p<80?1.5:2,v=[{size:200*u,alpha:.06,dx:-22,dy:12,color:O[i(0,O.length-1)]},{size:150*u,alpha:.08,dx:-9,dy:7,color:O[i(0,O.length-1)]},{size:120*u,alpha:.1,dx:0,dy:0,color:O[i(0,O.length-1)]},{size:90*u,alpha:.12,dx:12,dy:-4,color:O[i(0,O.length-1)]},{size:64*u,alpha:.13,dx:20,dy:-7,color:O[i(0,O.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${n}vw`,animationDuration:`${d}s`,animationDelay:`${x}ms`,"--tx":`${N}vw`,transform:`rotate(${E}deg)`},children:v.map((g,T)=>e.jsx("svg",{width:g.size,height:g.size,viewBox:"0 0 100 100",style:{left:`${50+g.dx}%`,bottom:`${g.dy}px`,transform:"translateX(-50%)","--alpha":g.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:g.color})},T))})}function st({paused:t=!1}){const s=h.useMemo(()=>new Array(20).fill(0).map((i,n)=>n),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:s.map(i=>e.jsx(tt,{i},i))})}const at=()=>{try{const t=localStorage.getItem("filter_modes")||"standard",s=new Set(t.toLowerCase().split(",").map(i=>i.trim()).filter(Boolean));return{standard:s.has("standard")||s.size===0,taiko:s.has("taiko"),mania:s.has("mania"),catch:s.has("catch")}}catch{return{standard:!0,taiko:!1,mania:!1,catch:!1}}},it=()=>{try{const t=localStorage.getItem("filter_moddi_tags")||"untagged,help",s=new Set(t.toLowerCase().split(",").map(i=>i.trim()).filter(Boolean));return{untagged:s.has("untagged")||s.size===0,help:s.has("help")||s.size===0}}catch{return{untagged:!0,help:!0}}},nt=()=>{try{const t=localStorage.getItem("filter_queue_status")||"unchecked,accepted,denied,finished",s=new Set(t.toLowerCase().split(",").map(i=>i.trim()).filter(Boolean));return{unchecked:s.has("unchecked")||s.size===0,accepted:s.has("accepted")||s.size===0,denied:s.has("denied")||s.size===0,finished:s.has("finished")||s.size===0,archived:s.has("archived")}}catch{return{unchecked:!0,accepted:!0,denied:!0,finished:!0,archived:!1}}},rt=()=>{try{const t=localStorage.getItem("last_section");return t==="mappi"||t==="moddi"?t:null}catch{return null}},ot=we(t=>({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1,filtersOpen:!1,modeFilters:at(),tagFilters:it(),queueStatusFilters:nt(),lastSection:rt(),setMenuOpen:s=>t({menuOpen:s}),setMobileNavOpen:s=>t({mobileNavOpen:s}),setNotifOpen:s=>t({notifOpen:s}),setFiltersOpen:s=>t({filtersOpen:s}),closeAllPanels:()=>t({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1,filtersOpen:!1}),setModeFilters:s=>{t({modeFilters:s});try{const n=Object.entries(s).filter(([c,d])=>d).map(([c])=>c),l=n.length?n:["standard"];localStorage.setItem("filter_modes",l.join(","))}catch{}},setTagFilters:s=>{t({tagFilters:s});try{const n=Object.entries(s).filter(([c,d])=>d).map(([c])=>c),l=n.length?n:["untagged","help"];localStorage.setItem("filter_moddi_tags",l.join(","))}catch{}},setQueueStatusFilters:s=>{t({queueStatusFilters:s});try{const n=Object.entries(s).filter(([c,d])=>d).map(([c])=>c),l=n.length?n:["unchecked","accepted","denied","finished"];localStorage.setItem("filter_queue_status",l.join(","))}catch{}},setLastSection:s=>{t({lastSection:s});try{s?localStorage.setItem("last_section",s):localStorage.removeItem("last_section")}catch{}}})),lt="https://api.osumappi.ng";function le(){var t;try{return((t=document.cookie.split("; ").map(s=>s.split("=")).find(([s])=>s==="csrf"))==null?void 0:t[1])||""}catch{return""}}async function $(t,s={}){const{requireAuth:i=!0,skipCsrf:n=!1,...l}=s,c={...l.headers};if(l.body&&!c["Content-Type"]&&(c["Content-Type"]="application/json"),i&&!n){const x=le();x&&(c["X-CSRF-Token"]=x)}const d=await fetch(`${lt}${t}`,{...l,credentials:"include",headers:c});if(!d.ok){const x=await d.json().catch(()=>({error:`HTTP ${d.status}`}));throw new Error(x.error||`HTTP ${d.status}: ${d.statusText}`)}return d.json()}function qt(t){const s=new URLSearchParams;for(const[n,l]of Object.entries(t))l!=null&&s.append(n,String(l));const i=s.toString();return i?`?${i}`:""}const F={auth:{login:"/api/auth/login",logout:"/api/auth/logout",me:"/api/me"},user:{quota:"/api/me/upload_quota",notifications:"/api/me/notifications",markNotificationsRead:"/api/me/notifications/mark_read",deleteNotification:t=>`/api/me/notifications/${encodeURIComponent(t)}`},feed:{next:"/api/feed/next",batch:"/api/feed/batch",progress:t=>`/api/feed/progress${t?`?modes=${encodeURIComponent(t)}`:""}`,recent:"/api/videos/recent"},videos:{like:t=>`/api/videos/${t}/like`,view:t=>`/api/videos/${t}/view`,update:t=>`/api/videos/${t}`,delete:t=>`/api/videos/${t}`,flag:t=>`/api/videos/${t}/flag`,comments:t=>`/api/videos/${t}/comments`,get:t=>`/api/videos/${t}`},uploads:{new:"/api/uploads/new"},moddi:{posts:"/api/moddiposts",post:t=>`/api/moddiposts/${t}`,postReact:t=>`/api/moddiposts/${t}/react`,postComments:t=>`/api/moddiposts/${t}/comments`,queues:"/api/moddi/queues",queue:t=>`/api/moddi/queues/${t}`,queueSubmit:t=>`/api/moddi/queues/${t}/submit`,queueAccept:t=>`/api/moddi/queues/${t}/accept`,queueDeny:t=>`/api/moddi/queues/${t}/deny`,queueInvite:t=>`/api/moddi/queues/${t}/invite`,queueMember:(t,s)=>`/api/moddi/queues/${t}/members/${s}`,queueSubmission:(t,s)=>`/api/moddi/queues/${t}/submissions/${s}`,usersSearch:t=>`/api/moddi/users/search?q=${encodeURIComponent(t)}`},osu:{resolveBeatmap:"/api/osu/beatmap/resolve",downloadBeatmapset:t=>`/api/osu/beatmapsets/${t}/download?noVideo=1`,usersSearch:t=>`/api/osu/users/search?q=${encodeURIComponent(t)}`},users:{get:t=>`/api/users/${t}`,videos:t=>`/api/users/${t}/videos`,likes:t=>`/api/users/${t}/likes`,myVideos:"/api/me/videos"},admin:{clearViews:"/api/admin/me/clear_views",debugState:"/api/debug/state",settingsModeration:"/api/admin/settings/moderation",videosPending:"/api/admin/videos/pending",videosApprove:t=>`/api/admin/videos/${t}/approve`,videosReject:t=>`/api/admin/videos/${t}/reject`,videosAction:(t,s)=>`/api/admin/videos/${t}/${s}`,analytics:"/api/admin/analytics",usersSearch:t=>`/api/admin/users/search?q=${encodeURIComponent(t)}`,userVideos:t=>`/api/admin/users/${t}/videos`,userUpdate:t=>`/api/admin/users/${t}`,notificationsSystem:"/api/admin/notifications/system"}};function ct(){return H({queryKey:["user","me"],queryFn:async()=>{try{return await $(F.auth.me)}catch{return null}},staleTime:5*60*1e3})}function dt(t=!0){return H({queryKey:["user","quota"],queryFn:async()=>{try{return await $(F.user.quota)}catch{return null}},enabled:t,refetchInterval:30*1e3})}function ut(){const t=J();return X({mutationFn:async()=>{await $(F.auth.logout,{method:"POST"})},onSuccess:()=>{t.setQueryData(["user","me"],null),t.clear(),window.location.href="/"}})}function ce(t=!0){return H({queryKey:["notifications"],queryFn:async()=>{try{const s=await $(F.user.notifications);return Array.isArray(s.items)?s.items:[]}catch{return[]}},enabled:t,refetchInterval:45*1e3})}function At(){return H({queryKey:["notifications","detailed"],queryFn:async()=>{try{const t=await $("/api/me/notifications/detailed");return Array.isArray(t.items)?t.items:[]}catch{return[]}},refetchInterval:30*1e3})}function mt(){const{data:t=[]}=ce();return t.filter(s=>s.kind==="system"&&s.id.startsWith("b:")&&(s.expiresAt||0)<=Date.now()?!1:!s.read).length}function pt(){const t=J();return X({mutationFn:async s=>{await $(F.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:s})})},onSuccess:()=>{t.setQueryData(["notifications"],s=>(s==null?void 0:s.map(i=>({...i,read:!0})))||[])}})}function ht(){const t=J();return X({mutationFn:async s=>{const i=le();await $(F.user.deleteNotification(s),{method:"DELETE",headers:{"X-CSRF-Token":i}})},onSuccess:(s,i)=>{t.setQueryData(["notifications"],n=>(n==null?void 0:n.filter(l=>l.id!==i))||[])}})}function ft(){const t=_e(),s=ke(),{notify:i}=Ye(),{data:n,isLoading:l}=ct(),{data:c}=dt(!!n),{data:d=[]}=ce(!!n),x=mt(),N=ut(),E=pt(),p=ht(),[u,v]=h.useState(new Set),{menuOpen:g,mobileNavOpen:T,notifOpen:_,filtersOpen:S,modeFilters:w,tagFilters:q,queueStatusFilters:M,lastSection:j,setMenuOpen:z,setMobileNavOpen:A,setNotifOpen:V,setFiltersOpen:D,closeAllPanels:W,setModeFilters:G,setTagFilters:Z,setQueueStatusFilters:de,setLastSection:K}=ot(),P=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",ue=t.pathname==="/editor",L=t.pathname.startsWith("/mp/")||!P&&!t.pathname.startsWith("/md/")&&j==="mappi",C=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!P&&!t.pathname.startsWith("/mp/")&&j==="moddi",me=t.pathname.startsWith("/md/queues/")&&t.pathname!=="/md/queues";I.useEffect(()=>{t.pathname.startsWith("/mp/")?K("mappi"):t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"&&K("moddi")},[t.pathname,K]);const[$t,pe]=I.useState(0);I.useEffect(()=>{const a=setInterval(()=>pe(r=>r+1),1e3);return()=>clearInterval(a)},[]);const[Y,he]=I.useState(null);I.useEffect(()=>{!n||!n.is_mod||(async()=>{try{const a=await $(F.admin.debugState,{requireAuth:!1}),r=Array.isArray(a==null?void 0:a.counts)?a.counts.find(o=>String(o.status)==="ready"):null;r&&he(Number(r.c)||0)}catch{}})()},[n]);const[Q,ee]=I.useState(!1),te=async()=>{ee(!0);try{const a=await $(F.admin.clearViews,{method:"POST"});i(`Cleared ${Number((a==null?void 0:a.deleted)||0)} views from your history.`,{variant:"success"});try{localStorage.removeItem("feed_seen_ids")}catch{}try{window.dispatchEvent(new Event("filterchange"))}catch{}}catch{i("Failed to clear view history",{variant:"error"})}finally{ee(!1)}},fe=a=>{if(!a)return null;try{const r=JSON.parse(a);if((r==null?void 0:r.type)==="queue_invite"&&(r!=null&&r.queue_id))return r}catch{}return null},xe=async(a,r)=>{if(!u.has(a.id)){v(o=>new Set(o).add(a.id));try{await $(F.moddi.queueAccept(String(r)),{method:"POST"}),i("Invitation accepted!",{variant:"success"}),p.mutate(a.id),V(!1),s(`/md/queues/${r}`)}catch(o){i((o==null?void 0:o.message)||"Failed to accept invitation",{variant:"error"})}finally{v(o=>{const m=new Set(o);return m.delete(a.id),m})}}},ge=async(a,r)=>{if(!u.has(a.id)){v(o=>new Set(o).add(a.id));try{await $(F.moddi.queueDeny(String(r)),{method:"POST"}),i("Invitation declined",{variant:"success"}),p.mutate(a.id)}catch(o){i((o==null?void 0:o.message)||"Failed to decline invitation",{variant:"error"})}finally{v(o=>{const m=new Set(o);return m.delete(a.id),m})}}},ye=async()=>{const a=d.filter(r=>r.id.startsWith("n:")||r.kind==="system"&&!r.read).map(r=>r.id);a.length>0&&E.mutate(a)},ve=async a=>{if(V(!1),E.mutate([a.id]),a.kind==="system"||a.id.startsWith("n:"))try{await $(F.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:[a.id]})})}catch{}},je=async(a,r)=>{a.stopPropagation(),p.mutate(r)},be=()=>{const r=Object.entries(w).filter(([o,m])=>m).map(([o])=>o);r.length,r.length===0&&G({standard:!0,taiko:!1,mania:!1,catch:!1});try{window.dispatchEvent(new Event("filterchange"))}catch{}D(!1)},Ne=()=>{const r=Object.entries(q).filter(([o,m])=>m).map(([o])=>o);r.length,r.length===0&&Z({untagged:!0,help:!0});try{window.dispatchEvent(new Event("moddifilterchange"))}catch{}D(!1)};return I.useEffect(()=>{n&&!localStorage.getItem("welcomed")&&(i(`Welcome, ${n.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[n,i]),e.jsxs("div",{className:"app-shell","data-section":C?"moddi":L?"mappi":j==="moddi"?"moddi":j==="mappi"?"mappi":void 0,children:[e.jsx(st,{paused:t.pathname==="/editor"}),e.jsxs("header",{className:"top-nav",children:[t.pathname!=="/editor"&&e.jsxs("div",{className:"mobile-nav",children:[e.jsx("button",{className:"icon-link hamburger",onClick:()=>{T||W(),A(a=>!a)},"aria-label":"Menu","aria-expanded":T,children:e.jsx(Se,{size:18})}),T&&e.jsxs("div",{className:"menu-panel",role:"menu",children:[P&&e.jsx(f,{to:t.pathname==="/"?"/about":"/",className:`menu-item ${t.pathname==="/about"?"active":""}`,onClick:()=>A(!1),children:t.pathname==="/"?"About":"Home"}),L&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>A(!1),children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>A(!1),children:"Discover"})]}),C&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/md/feed",className:`menu-item ${t.pathname==="/md/feed"?"active":""}`,onClick:()=>A(!1),children:"Feed"}),e.jsx(f,{to:"/md/queues",className:`menu-item ${t.pathname.startsWith("/md/queues")?"active":""}`,onClick:()=>A(!1),children:"Queues"})]}),!L&&!C&&!P&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>A(!1),children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>A(!1),children:"Discover"})]})]})]}),P?e.jsx(f,{to:"/",className:"title",children:C?"osu!moddi.ng":L?"osu!mappi.ng":"mappi!"}):ue?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(f,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(se,{size:18})}),e.jsx(f,{to:C?"/md/feed":"/mp/feed",className:"title",children:C?"osu!moddi.ng":"osu!mappi.ng"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(f,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(se,{size:18})}),e.jsxs(f,{to:C?"/mp/feed":"/md/feed",className:"title coin-flip-title",children:[e.jsx("span",{className:"coin-flip-front",children:C?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:C?"osu!mappi.ng":"osu!moddi.ng"})]})]}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),t.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(Ve,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[P&&e.jsx(f,{to:t.pathname==="/"?"/about":"/",className:t.pathname==="/about"?"active":"",children:t.pathname==="/"?"About":"Home"}),L&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(f,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]}),C&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/md/feed",className:t.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx(f,{to:"/md/queues",className:t.pathname.startsWith("/md/queues")?"active":"",children:"Queues"})]}),!L&&!C&&!P&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(f,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]})]}),e.jsx("div",{style:{marginLeft:"auto"}}),e.jsx("a",{className:"icon-link",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)","aria-label":"Join Discord",style:{marginRight:6},children:e.jsx(Ce,{size:18})}),n?e.jsxs("div",{className:"user-menu",children:[e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:6},children:[e.jsx("button",{className:"icon-link",onClick:()=>{_||W(),V(a=>!a)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(Fe,{size:18})}),x>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),_&&e.jsxs("div",{className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(f,{to:"/md/notifications",onClick:()=>V(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:a=>a.currentTarget.style.opacity="1",onMouseLeave:a=>a.currentTarget.style.opacity="0.7",children:"View all"}),d.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:ye,children:e.jsx(ae,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[d.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),d.filter(a=>!(a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now())).map(a=>{const r=fe(a.text),o=a.id.startsWith("b:"),m=r?"queue-invite":a.kind==="star"?"star":a.kind==="likes5"?"likes":a.kind==="inspiration"?"inspiration":o?"global":"system",b=a.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${m}`,role:"button",onClick:()=>!r&&ve(a),children:[e.jsxs("div",{className:`notif-icon ${b?"deletable":""}`,"aria-hidden":"true",onClick:b&&!r?R=>je(R,a.id):void 0,title:b&&!r?"Remove":void 0,role:b&&!r?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:r?e.jsx($e,{}):m==="star"?e.jsx(Ee,{}):m==="likes"?e.jsx(Te,{}):m==="inspiration"?e.jsx(Oe,{}):m==="global"?e.jsx(qe,{}):null}),b&&!r?e.jsx("span",{className:"swap-trash",children:e.jsx(Ae,{})}):null]}),e.jsx("div",{className:"notif-body",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Queue Invitation"}),e.jsxs("div",{className:"notif-desc",children:[r.inviter_username," invited you to join queue: ",r.queue_name]}),u.has(a.id)?e.jsx("div",{className:"muted",style:{fontSize:11,marginTop:6},children:"Processing..."}):e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:R=>{R.stopPropagation(),xe(a,r.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(ae,{size:12,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:R=>{R.stopPropagation(),ge(a,r.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(Ie,{size:12,style:{marginRight:4}}),"Decline"]})]})]}):a.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:o?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:a.text||""}),o&&a.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(a.expiresAt).toLocaleString()]}):null]}):a.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:a.text||"Someone is inspired by you!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:a.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:a.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},a.id)})]})]})]}),c!=null&&c.blocked?e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(Pe,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:(()=>{const a=Math.max(0,Math.floor((((c==null?void 0:c.reset_at)??0)*1e3-Date.now())/1e3)),r=Math.floor(a/3600),o=Math.floor(a%3600/60),m=a%60,b=R=>String(R).padStart(2,"0");return r>0?`${r}:${b(o)}:${b(m)}`:`${o}:${b(m)}`})()})]}):null,e.jsxs("button",{className:"icon-link",onClick:()=>{g||W(),z(a=>!a)},title:n.username,"aria-label":"User menu","aria-expanded":g,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[n.avatar_url&&e.jsx("img",{src:n.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:n.username}),e.jsx(Re,{size:14,style:{opacity:.8}})]}),g&&e.jsxs("div",{className:"menu-panel",role:"menu",children:[e.jsx(f,{to:"/profile",className:"menu-item",onClick:()=>z(!1),children:"Profile"}),n!=null&&n.is_admin||n!=null&&n.is_mod?e.jsx(f,{to:"/moderation",className:"menu-item",onClick:()=>z(!1),children:"Moderation"}):null,e.jsx("button",{className:"menu-item",type:"button",onClick:()=>N.mutate(),children:"Log out"})]})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{window.location.href=F.auth.login},disabled:l,children:l?"Checking…":"Login with osu!"})]})]}),e.jsx("main",{className:`page ${t.pathname==="/editor"||t.pathname==="/mp/discover"?"fullscreen":""}`,children:t.pathname==="/editor"?e.jsx(B,{}):t.pathname==="/mp/discover"?e.jsx(B,{}):t.pathname==="/"?e.jsx(B,{}):t.pathname==="/about"||t.pathname==="/profile"||t.pathname.startsWith("/profile/")||t.pathname==="/moderation"?e.jsx("div",{className:"card",children:e.jsx(B,{})}):e.jsx(B,{})}),t.pathname!=="/editor"&&e.jsxs(e.Fragment,{children:[n&&n.is_mod&&Y!==null&&e.jsx("div",{className:"site-badge","aria-hidden":!1,children:e.jsxs("div",{className:"label",children:[Y," videos ready"]})}),e.jsxs("div",{className:"site-controls","aria-hidden":!1,children:[e.jsx("button",{className:"settings-btn",onClick:()=>{S||W(),D(a=>!a)},"aria-expanded":S,"aria-label":"Filter settings",title:"Filter settings",children:e.jsx(Me,{size:18})}),S&&e.jsx("div",{className:"settings-panel",role:"dialog","aria-modal":"false",children:me?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Sort by:"}),e.jsx("div",{className:"col",style:{gap:8},children:[["unchecked","Unchecked","#f59e0b"],["accepted","Accepted","#10b981"],["denied","Denied","#ef4444"],["finished","Finished","#6366f1"],["archived","Archived","#6b7280"]].map(([a,r,o])=>{const m=M[a];return e.jsx("button",{className:`mode-cell ${m?"selected":""}`,"aria-pressed":m,onClick:()=>{de({...M,[a]:!m})},style:{padding:"10px 14px",borderRadius:8,fontSize:13,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontWeight:m?600:500,background:m?o+"15":"transparent",border:`1.5px solid ${m?o+"50":"rgba(255,255,255,0.08)"}`,color:m?o:"var(--text)",transition:"all 0.2s ease",cursor:"pointer",textAlign:"left",width:"100%"},onMouseEnter:b=>{m?(b.currentTarget.style.background=o+"25",b.currentTarget.style.borderColor=o+"70"):(b.currentTarget.style.background="rgba(255,255,255,0.05)",b.currentTarget.style.borderColor="rgba(255,255,255,0.12)")},onMouseLeave:b=>{b.currentTarget.style.background=m?o+"15":"transparent",b.currentTarget.style.borderColor=m?o+"50":"rgba(255,255,255,0.08)"},children:r},a)})}),e.jsx("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:e.jsx("button",{className:"btn secondary compact",onClick:()=>D(!1),children:"Close"})})]}):C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Sort by:"}),e.jsx("div",{className:"col",style:{gap:6},children:[["untagged","Untagged"],["help","Help"]].map(([a,r])=>{const o=q[a];return e.jsx("button",{className:`mode-cell ${o?"selected":""}`,"aria-pressed":o,onClick:()=>{Z({...q,[a]:!o})},children:e.jsx("span",{children:r})},a)})}),n&&(n.is_admin||n.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:Q,onClick:te,children:Q?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>D(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:Ne,children:"Apply"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Game modes"}),e.jsx("div",{className:"col",style:{gap:6},children:[["standard","Standard",We],["taiko","Taiko",Qe],["mania","Mania",He],["catch","Catch",Ke]].map(([a,r,o])=>{const m=w[a];return e.jsxs("button",{className:`mode-cell ${m?"selected":""}`,"aria-pressed":m,onClick:()=>{G({...w,[a]:!m})},children:[e.jsx("img",{className:"mode-icon",src:o,width:24,height:24,alt:""}),e.jsx("span",{children:r})]},a)})}),n&&(n.is_admin||n.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:Q,onClick:te,children:Q?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>D(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:be,children:"Apply"})]})]})})]})]})]})}const xt=h.lazy(()=>k(()=>import("./Home-CcFVd-cs.js"),__vite__mapDeps([0,1,2]))),ne=h.lazy(()=>k(()=>import("./Discover-GS7cXqqX.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10]))),U=h.lazy(()=>k(()=>import("./Feed-CTLA210o.js"),__vite__mapDeps([11,1,2,12,4,5,6,7,13,9,10]))),gt=h.lazy(()=>k(()=>import("./PostDetail-DAooF80l.js"),__vite__mapDeps([14,1,2,12,4,5,6,7,8,15,9,10]))),yt=h.lazy(()=>k(()=>import("./Feed-Dm6FBfLt.js"),__vite__mapDeps([16,1,2,12,4,5,6,7,13,9,10]))),vt=h.lazy(()=>k(()=>import("./PostDetail-DBxzrL0E.js"),__vite__mapDeps([17,1,2,12,4,5,6,7,8,9,10]))),jt=h.lazy(()=>k(()=>import("./Queues-RTsd_tkC.js"),__vite__mapDeps([18,1,2,9,10]))),bt=h.lazy(()=>k(()=>import("./QueueDetail-kZzBOEKn.js"),__vite__mapDeps([19,1,2,5,6,7,9,10]))),Nt=h.lazy(()=>k(()=>import("./Notifications-CiStgLvT.js"),__vite__mapDeps([20,1,2,9,10]))),re=h.lazy(()=>k(()=>import("./Profile-VlxKspXf.js"),__vite__mapDeps([21,1,2,15,4,6,5,7,9,10]))),wt=h.lazy(()=>k(()=>import("./Moderation-ChdNi2jb.js"),__vite__mapDeps([22,1,2,9,10]))),_t=h.lazy(()=>k(()=>import("./About-BOIwQfw1.js"),__vite__mapDeps([23,1,2]))),kt=h.lazy(()=>k(()=>import("./editor-DnNoAVNn.js"),__vite__mapDeps([24,1,2,5,6,7])).then(t=>({default:t.Editor}))),St=()=>e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"50vh",color:"var(--muted)"},children:"Loading..."}),Ct=()=>e.jsx(h.Suspense,{fallback:e.jsx(St,{}),children:e.jsx(Be,{children:e.jsxs(y,{element:e.jsx(ft,{}),children:[e.jsx(y,{path:"/",element:e.jsx(xt,{})}),e.jsx(y,{path:"/mp/discover",element:e.jsx(ne,{})}),e.jsx(y,{path:"/mp/feed",element:e.jsx(U,{})}),e.jsx(y,{path:"/mp/feed/:uid",element:e.jsx(gt,{})}),e.jsx(y,{path:"/md/feed",element:e.jsx(yt,{})}),e.jsx(y,{path:"/md/feed/:uid",element:e.jsx(vt,{})}),e.jsx(y,{path:"/md/queues",element:e.jsx(jt,{})}),e.jsx(y,{path:"/md/queues/:id",element:e.jsx(bt,{})}),e.jsx(y,{path:"/md/notifications",element:e.jsx(Nt,{})}),e.jsx(y,{path:"/profile",element:e.jsx(re,{})}),e.jsx(y,{path:"/profile/:id",element:e.jsx(re,{})}),e.jsx(y,{path:"/moderation",element:e.jsx(wt,{})}),e.jsx(y,{path:"/about",element:e.jsx(_t,{})}),e.jsx(y,{path:"/editor",element:e.jsx(kt,{})}),e.jsx(y,{path:"/feed",element:e.jsx(ne,{})}),e.jsx(y,{path:"/upload",element:e.jsx(U,{})}),e.jsx(y,{path:"/posts",element:e.jsx(U,{})}),e.jsx(y,{path:"/recents",element:e.jsx(U,{})}),e.jsx(y,{path:"/recent",element:e.jsx(U,{})})]})})}),Ft=()=>e.jsx(Le,{children:e.jsx(Ct,{})});ze(document.getElementById("root")).render(e.jsx(I.StrictMode,{children:e.jsx(et,{children:e.jsx(De,{client:Ge,children:e.jsx(Ze,{children:e.jsx(Ft,{})})})})}));export{F as A,st as B,$ as a,qt as b,lt as c,ct as d,ot as e,At as f,pt as g,ht as h,Ye as u};
