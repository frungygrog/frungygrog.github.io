import{r as p,j as e}from"./vendor-react-Bj2Cd7tG.js";import{u as V}from"./index-C9X7C0OI.js";import"./vendor-CBpd7OPg.js";import"./editor-components-B-SB05wW.js";const h="https://api.osumappi.ng";function g(i){var c;return(c=document.cookie.split("; ").map(u=>u.split("=")).find(([u])=>u===i))==null?void 0:c[1]}function te(){var X,B,J,G,H;const[i,c]=p.useState(null),[u,T]=p.useState([]),[F,W]=p.useState(""),[L,D]=p.useState([]),[d,k]=p.useState(null),[_,N]=p.useState([]),[w,x]=p.useState("all"),[o,C]=p.useState("approvals"),[v,A]=p.useState(null),[M,$]=p.useState(""),[R,n]=p.useState(!1),{notify:r}=V(),[t,b]=p.useState(null),[O,U]=p.useState(!1);p.useEffect(()=>{(async()=>{try{const s=await fetch(`${h}/api/me`,{credentials:"include"});if(s.ok){const l=await s.json();if(c(l),l!=null&&l.is_admin)try{const a=await fetch(`${h}/api/admin/settings/moderation`,{credentials:"include"});if(a.ok){const m=await a.json();A(!!m.require_approval)}}catch{}}}catch{}try{const s=await fetch(`${h}/api/admin/videos/pending?limit=50`,{credentials:"include"});if(s.ok){const l=await s.json();T(l.items||[])}}catch{}})()},[]);async function Y(){U(!0);try{const s=await fetch(`${h}/api/admin/analytics`,{credentials:"include"});s.ok&&b(await s.json())}finally{U(!1)}}async function I(){const s=await fetch(`${h}/api/admin/users/search?q=${encodeURIComponent(F)}`,{credentials:"include"});if(s.ok){const l=await s.json();D(l.items||[])}}async function Q(s){k(s),N([]);const l=await fetch(`${h}/api/admin/users/${s.id}/videos?limit=50`,{credentials:"include"});if(l.ok){const a=await l.json();N(a.items||[])}}async function q(s,l){const a=g("csrf")||"",m=await fetch(`${h}/api/admin/users/${s.id}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":a},body:JSON.stringify({is_mod:l})});if(m.ok){const S=await m.json().catch(()=>({})),y=(S==null?void 0:S.user)||{...s,is_mod:l};r(l?"Granted moderation":"Revoked moderation",{variant:l?"success":"warn"}),k(y),D(L.map(K=>K.id===s.id?y:K))}else alert("Failed to update")}const P=!!(i!=null&&i.is_admin||i!=null&&i.is_mod),f=!!(i!=null&&i.is_admin),E=v===null?null:!v;return e.jsxs("div",{className:"col",style:{width:"100%"},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:10},children:[e.jsx("div",{className:"title",children:"Moderation"}),f&&E!==null&&e.jsxs("div",{className:"row",style:{alignItems:"center",gap:6},children:[e.jsx("span",{className:"muted",style:{fontSize:12},children:"Auto-approve"}),e.jsx("button",{className:`btn ${E?"":"secondary"}`,style:{padding:"6px 10px"},onClick:async()=>{if(v===null)return;const s=!v,l=g("csrf")||"";(await fetch(`${h}/api/admin/settings/moderation`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":l},body:JSON.stringify({require_approval:s})})).ok?(A(s),r(s?"Auto-approve disabled":"Auto-approve enabled",{variant:s?"warn":"success"})):alert("Failed to update setting")},children:E?"On":"Off"})]})]}),P&&e.jsxs("div",{className:"tabs",role:"tablist","aria-label":"Moderation tabs",children:[e.jsx("button",{role:"tab","aria-selected":o==="approvals",className:`tab ${o==="approvals"?"active":""}`,onClick:()=>C("approvals"),children:"Approvals"}),(f||(i==null?void 0:i.is_mod))&&e.jsx("button",{role:"tab","aria-selected":o==="manage",className:`tab ${o==="manage"?"active":""}`,onClick:()=>C("manage"),children:"Manage"}),(f||(i==null?void 0:i.is_mod))&&e.jsx("button",{role:"tab","aria-selected":o==="analytics",className:`tab ${o==="analytics"?"active":""}`,onClick:()=>{C("analytics"),t||Y()},children:"Analytics"}),(f||(i==null?void 0:i.is_mod))&&e.jsx("button",{role:"tab","aria-selected":o==="message",className:`tab ${o==="message"?"active":""}`,onClick:()=>C("message"),children:"Message"})]})]}),e.jsx("hr",{className:"subtle-divider"}),!P&&e.jsx("div",{className:"muted",children:"You do not have access."}),o==="approvals"&&P&&(()=>{const s=u.filter(a=>!a.flagged_only),l=u.filter(a=>!!a.flagged_only);return e.jsxs("div",{className:"row wrap",style:{marginTop:12,gap:16,alignItems:"flex-start"},children:[e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Pending approvals"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[s.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",children:[s.length===0&&e.jsx("div",{className:"muted",children:"Nothing pending."}),s.map(a=>e.jsxs("div",{className:"row wrap",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[a.poster_url?e.jsx("img",{src:a.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:a.description||"",children:a.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:["uploader: ",a.username,a.needs_review?e.jsx("span",{style:{marginLeft:6,color:"#f59e0b"},children:"(needs review)"}):e.jsx("span",{style:{marginLeft:6,color:"#60a5fa"},children:"(pending)"}),typeof a.flags_count=="number"&&a.flags_count>0?e.jsxs("span",{className:"muted",style:{marginLeft:6},children:["• ",a.flags_count," reports"]}):null]})]})]}),e.jsxs("div",{className:"row wrap",children:[e.jsx("button",{className:"btn secondary",onClick:async()=>{const m=g("csrf")||"";(await fetch(`${h}/api/admin/videos/${a.id}/reject`,{method:"POST",credentials:"include",headers:{"X-CSRF-Token":m}})).ok&&(T(u.filter(y=>y.id!==a.id)),r("Rejected",{variant:"warn"}))},children:"Reject"}),e.jsx("button",{className:"btn",style:{marginLeft:8},onClick:async()=>{const m=g("csrf")||"";(await fetch(`${h}/api/admin/videos/${a.id}/approve`,{method:"POST",credentials:"include",headers:{"X-CSRF-Token":m}})).ok&&(T(u.filter(y=>y.id!==a.id)),r("Approved",{variant:"success"}))},children:"Approve"}),e.jsx("button",{className:"btn secondary",style:{marginLeft:8},onClick:async()=>{if(!confirm("Permanently delete this video?"))return;const m=g("csrf")||"";(await fetch(`${h}/api/videos/${a.id}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":m}})).ok?(T(u.filter(y=>y.id!==a.id)),r("Deleted",{variant:"warn"})):alert("Delete failed")},children:"Delete"})]})]},a.id))]})]}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Flagged (FYI)"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[l.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",children:[l.length===0&&e.jsx("div",{className:"muted",children:"No flagged items."}),l.map(a=>e.jsxs("div",{className:"row wrap",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[a.poster_url?e.jsx("img",{src:a.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:a.description||"",children:a.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:["uploader: ",a.username,e.jsx("span",{style:{marginLeft:6,color:"#9ca3af"},children:"(flagged)"}),typeof a.flags_count=="number"&&a.flags_count>0?e.jsxs("span",{className:"muted",style:{marginLeft:6},children:["• ",a.flags_count," reports"]}):null]})]})]}),e.jsx("div",{className:"row wrap",children:e.jsx("button",{className:"btn secondary",onClick:async()=>{if(!confirm("Permanently delete this video?"))return;const m=g("csrf")||"";(await fetch(`${h}/api/videos/${a.id}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":m}})).ok?(T(u.filter(y=>y.id!==a.id)),r("Deleted",{variant:"warn"})):alert("Delete failed")},children:"Delete"})})]},a.id))]}),e.jsx("div",{className:"muted",style:{fontSize:12,marginTop:6},children:"Flagged items don’t require approval; use Delete only if necessary."})]})]})})(),o==="manage"&&(f||(i==null?void 0:i.is_mod))&&e.jsx("div",{className:"col",style:{marginTop:16},children:e.jsxs("div",{className:"mod-manage-grid",children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"User management"}),e.jsxs("div",{className:"row wrap",style:{gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:F,onChange:s=>W(s.target.value),onKeyDown:s=>{s.key==="Enter"&&I()}}),e.jsx("button",{className:"btn",onClick:I,style:{padding:"6px 10px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:8},children:e.jsx("div",{className:"col",style:{gap:6},children:L.map(s=>e.jsxs("button",{className:"btn secondary",onClick:()=>Q(s),style:{justifyContent:"flex-start"},children:[s.avatar_url&&e.jsx("img",{src:s.avatar_url,width:18,height:18,style:{borderRadius:"50%",marginRight:8}}),e.jsx("span",{className:"one-line",style:{marginRight:8},children:s.username}),e.jsxs("span",{className:"muted",children:["(id ",s.id,", osu ",s.osu_user_id,")"]}),s.is_admin?e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"admin"}):s.is_mod?e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"mod"}):s.is_blacklisted?e.jsx("span",{style:{marginLeft:"auto",color:"#f87171"},children:"blacklisted"}):null]},s.id))})})]}),e.jsx("div",{className:"v-divider","aria-hidden":"true"}),e.jsx("div",{className:"col",style:{minWidth:0},children:d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row wrap",style:{alignItems:"center"},children:[d.avatar_url&&e.jsx("img",{src:d.avatar_url,width:28,height:28,style:{borderRadius:"50%",marginRight:8}}),e.jsx("div",{className:"title",style:{marginRight:8,fontSize:18},children:d.username}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["id ",d.id," • osu ",d.osu_user_id]}),e.jsx("div",{style:{marginLeft:"auto"}}),f?d.is_admin?e.jsx("span",{}):d.is_mod?e.jsx("button",{className:"btn secondary",style:{padding:"6px 10px"},onClick:()=>q(d,!1),children:"Revoke moderation"}):e.jsx("button",{className:"btn",style:{padding:"6px 10px"},onClick:()=>q(d,!0),children:"Grant moderation"}):null,!d.is_admin&&(d.is_blacklisted?e.jsx("button",{className:"btn",style:{marginLeft:8,padding:"6px 10px"},onClick:async()=>{const s=g("csrf")||"",l=await fetch(`${h}/api/admin/users/${d.id}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":s},body:JSON.stringify({is_blacklisted:!1})});l.ok?(await l.json().catch(()=>null),k({...d,is_blacklisted:!1}),r("User unblacklisted",{variant:"success"})):alert("Failed")},children:"Unblacklist"}):e.jsx("button",{className:"btn secondary",style:{marginLeft:8,padding:"6px 10px"},onClick:async()=>{const s=g("csrf")||"",l=await fetch(`${h}/api/admin/users/${d.id}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":s},body:JSON.stringify({is_blacklisted:!0})});l.ok?(await l.json().catch(()=>null),k({...d,is_blacklisted:!0}),r("User blacklisted",{variant:"warn"})):alert("Failed")},children:"Blacklist"}))]}),d.is_admin?e.jsx("div",{className:"caption",style:{marginTop:4},children:"Admins always retain access"}):null,e.jsxs("div",{className:"col",style:{marginTop:12},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Uploads"}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("span",{className:"muted",style:{fontSize:12},children:"Show"}),e.jsx("button",{className:`btn ${w==="all"?"":"secondary"}`,onClick:()=>x("all"),children:"All"}),e.jsx("button",{className:`btn ${w==="review"?"":"secondary"}`,onClick:()=>x("review"),children:"Needs review"})]})]}),e.jsxs("div",{className:"scroll-panel sm",style:{marginTop:8},children:[_.length===0&&e.jsx("div",{className:"muted",children:"No uploads."}),_.filter(s=>{if(w==="all")return!0;const l=(v?!s.approved_at:!1)&&s.status==="ready",a=!!s.needs_review;return l||a}).map(s=>e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[s.poster_url?e.jsx("img",{src:s.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:s.description||"",children:s.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:[s.status.toUpperCase()," • ",new Date(s.created_at*1e3).toLocaleString(),s.needs_review?e.jsx("span",{style:{marginLeft:6,color:"#f59e0b"},children:"(purgatory)"}):null,v&&!s.approved_at&&s.status==="ready"?e.jsx("span",{style:{marginLeft:6,color:"#60a5fa"},children:"(pending)"}):null]})]})]}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("span",{className:"muted",children:s.likes_count??0}),e.jsx("span",{style:{color:"var(--accent)"},children:"★"}),(f||(i==null?void 0:i.is_mod))&&(!!s.needs_review||v&&!s.approved_at&&s.status==="ready")&&e.jsx("button",{className:"btn",onClick:async()=>{const l=g("csrf")||"";(await fetch(`${h}/api/admin/videos/${s.id}/approve`,{method:"POST",credentials:"include",headers:{"X-CSRF-Token":l}})).ok?(N(_.map(m=>m.id===s.id?{...m,approved_at:Math.floor(Date.now()/1e3),needs_review:0}:m)),r("Approved",{variant:"success"})):alert("Approve failed")},children:"Approve"}),(f||(i==null?void 0:i.is_mod))&&e.jsx("button",{className:"btn secondary",style:{marginLeft:8},onClick:async()=>{if(!confirm("Permanently delete this video?"))return;const l=g("csrf")||"";(await fetch(`${h}/api/videos/${s.id}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":l}})).ok?(N(_.filter(m=>m.id!==s.id)),r("Deleted",{variant:"warn"})):alert("Delete failed")},children:"Delete"})]})]},s.id))]})]})]}):e.jsx("div",{className:"muted",children:"Select a user to view details and uploads."})})]})}),!1,o==="message"&&(f||(i==null?void 0:i.is_mod))&&e.jsx("div",{className:"col",style:{marginTop:16},children:e.jsxs("div",{className:"mod-manage-grid",children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"Send a system message"}),e.jsxs("div",{className:"row wrap",style:{gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:F,onChange:s=>W(s.target.value),onKeyDown:s=>{s.key==="Enter"&&I()}}),e.jsx("button",{className:"btn",onClick:I,style:{padding:"6px 10px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:8},children:e.jsx("div",{className:"col",style:{gap:6},children:L.map(s=>e.jsxs("button",{className:"btn secondary",onClick:()=>k(s),style:{justifyContent:"flex-start"},children:[s.avatar_url&&e.jsx("img",{src:s.avatar_url,width:18,height:18,style:{borderRadius:"50%",marginRight:8}}),e.jsx("span",{className:"one-line",style:{marginRight:8},children:s.username}),e.jsxs("span",{className:"muted",children:["(id ",s.id,", osu ",s.osu_user_id,")"]}),(d==null?void 0:d.id)===s.id&&e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"selected"})]},s.id))})})]}),e.jsx("div",{className:"v-divider","aria-hidden":"true"}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"Compose"}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:R,onChange:s=>n(s.currentTarget.checked)}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Send to all users (global)"})]}),e.jsx("textarea",{placeholder:"Message (shown in notifications)",style:{height:120,resize:"vertical"},value:M,onChange:s=>$(s.target.value)}),e.jsx("div",{className:"row wrap",style:{justifyContent:"flex-end",gap:8},children:e.jsx("button",{className:"btn",onClick:()=>{const s=(M||"").trim();if(!s){alert("Enter a message");return}(async()=>{try{const l=g("csrf")||"",a={text:s,global:R};!R&&(d!=null&&d.id)&&(a.user_id=d.id),(await fetch(`${h}/api/admin/notifications/system`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":l},body:JSON.stringify(a)})).ok?($(""),r("Message sent",{variant:"success"})):alert("Failed to send")}catch{alert("Failed to send")}})()},children:"Send"})}),e.jsx("div",{className:"caption",style:{marginTop:6},children:'System messages persist for 24 hours and show an "Expires at" timestamp.'})]})]})}),o==="analytics"&&(f||(i==null?void 0:i.is_mod))&&e.jsxs("div",{className:"col",style:{marginTop:16,gap:12},children:[e.jsx("div",{className:"title",children:"Analytics"}),O&&e.jsx("div",{className:"muted",children:"Loading…"}),!O&&!t&&e.jsx("div",{className:"muted",children:"No data."}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",style:{flexWrap:"wrap",gap:10},children:[e.jsx(j,{label:"Users",value:t.totals.users_total}),e.jsx(j,{label:"Admins",value:t.totals.users_admin}),e.jsx(j,{label:"Mods",value:t.totals.users_mod}),e.jsx(j,{label:"Blacklisted",value:t.totals.users_blacklisted}),e.jsx(j,{label:"Videos",value:t.totals.videos_total}),e.jsx(j,{label:"Ready",value:t.totals.videos_ready}),e.jsx(j,{label:"Pending",value:t.totals.pending_count}),e.jsx(j,{label:"Purgatory",value:t.totals.purgatory_count}),e.jsx(j,{label:"Likes",value:t.totals.likes_total}),e.jsx(j,{label:"Flags",value:t.totals.flags_total})]}),e.jsxs("div",{className:"row",style:{flexWrap:"wrap",gap:20,marginTop:8},children:[e.jsx(z,{title:"New users (30d)",series:t.series.users,color:"#60a5fa"}),e.jsx(z,{title:"New videos (30d)",series:t.series.videos,color:"#34d399"}),((B=(X=t.stream)==null?void 0:X.graphql)==null?void 0:B.minutes_viewed)&&t.stream.graphql.minutes_viewed.length>0&&e.jsx(z,{title:"Minutes viewed (30d)",series:t.stream.graphql.minutes_viewed,color:"#f59e0b"})]}),e.jsxs("div",{className:"col",style:{gap:6,marginTop:8},children:[e.jsx("div",{className:"title",children:"Feed & Stream"}),e.jsxs("div",{className:"muted",children:["Feed: ",t.feed.count," items in rotation",t.feed.cursor?` • cursor ${t.feed.cursor}`:""]}),e.jsxs("div",{className:"muted",children:["Approx. ready seconds: ",t.stream.approximate.total_duration_sec," • ready videos: ",t.stream.approximate.videos_ready]}),t.stream.api&&e.jsxs("div",{className:"muted",style:{fontSize:12},children:["Stream API: ",t.stream.api.ok?"ok":"unavailable",(G=(J=t.stream.api)==null?void 0:J.result_info)!=null&&G.count?` • count ${t.stream.api.result_info.count}`:"",(H=t.stream.api)!=null&&H.sample_status?` • sample status ${String(t.stream.api.sample_status)}`:""]})]})]})]})]})}function j({label:i,value:c}){return e.jsxs("div",{className:"col",style:{padding:"8px 10px",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,minWidth:120},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:i}),e.jsx("div",{className:"title",children:c})]})}function z({title:i,series:c,color:u}){const k=c.map(n=>n.count),_=Math.max(1,...k),N=p.useMemo(()=>{const n=_,r=Math.pow(10,Math.floor(Math.log10(n))),t=n/r;return(t<=1?1:t<=2?2:t<=5?5:10)*r},[_]),w=350,x=124,o=p.useMemo(()=>c.map((n,r)=>{const t=42+r/Math.max(1,c.length-1)*w,b=8+(1-n.count/(N||1))*x;return[t,b]}),[c,N,w,x]),C=p.useMemo(()=>o.map((n,r)=>r===0?`M ${n[0]} ${n[1]}`:`L ${n[0]} ${n[1]}`).join(" "),[o]),v=[0,.25,.5,.75,1],A=p.useMemo(()=>{if(c.length===0)return[];const n=[0,.25,.5,.75,1].map(r=>Math.min(c.length-1,Math.round(r*(c.length-1))));return Array.from(new Set(n))},[c]),M=n=>{if(!n||n.length<10)return n||"";const r=n.slice(5,7).replace(/^0/,""),t=n.slice(8,10).replace(/^0/,"");return`${r}/${t}`};function $(n){const r=Number.isInteger(n);return n>=1e6?`${(n/1e6).toFixed(1).replace(/\.0$/,"")}M`:n>=1e3?`${(n/1e3).toFixed(1).replace(/\.0$/,"")}k`:r?String(n):n<10?n.toFixed(1):n.toFixed(1).replace(/\.0$/,"")}const R=c.length?c[c.length-1].count:0;return e.jsxs("div",{className:"col",style:{border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:10},children:[e.jsxs("div",{className:"row",style:{alignItems:"baseline",justifyContent:"space-between",marginBottom:6},children:[e.jsx("div",{className:"muted",children:i}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["latest: ",$(R)]})]}),e.jsxs("svg",{width:400,height:160,role:"img","aria-label":i,children:[e.jsx("rect",{x:0,y:0,width:400,height:160,fill:"#0f1217",rx:8}),v.map((n,r)=>{const t=8+(1-n)*x,b=n*N;return e.jsxs("g",{children:[e.jsx("line",{x1:42,y1:t,x2:392,y2:t,stroke:"rgba(255,255,255,0.08)",strokeWidth:1}),e.jsx("text",{x:36,y:t+4,textAnchor:"end",fontSize:10,fill:"rgba(255,255,255,0.6)",children:$(b)})]},r)}),e.jsx("line",{x1:42,y1:8,x2:42,y2:8+x,stroke:"rgba(255,255,255,0.25)",strokeWidth:1}),e.jsx("line",{x1:42,y1:8+x,x2:42+w,y2:8+x,stroke:"rgba(255,255,255,0.25)",strokeWidth:1}),A.map((n,r)=>{var b;const t=42+n/Math.max(1,c.length-1)*w;return e.jsxs("g",{children:[e.jsx("line",{x1:t,y1:8,x2:t,y2:8+x,stroke:"rgba(255,255,255,0.08)",strokeWidth:1}),e.jsx("text",{x:t,y:8+x+12,textAnchor:"middle",fontSize:10,fill:"rgba(255,255,255,0.6)",children:M((b=c[n])==null?void 0:b.day)})]},r)}),e.jsx("path",{d:C,fill:"none",stroke:u,strokeWidth:2}),o.length>0&&e.jsx("circle",{cx:o[o.length-1][0],cy:o[o.length-1][1],r:3,fill:u})]})]})}export{te as default};
