const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-Yi2VIAfX.js","assets/vendor-react-DRMPtHf0.js","assets/vendor-Dm_EoMJn.js","assets/Discover-CaggoxQI.js","assets/Player-BRfwXn_C.js","assets/beatmap-preview-Cn-wWWdw.js","assets/editor-lib-1S8E8MTP.js","assets/editor-lib-CGytSYYz.css","assets/editor-components-B-NcqUmU.js","assets/editor-components-Bzmrvihl.css","assets/Feed-CtqMMTve.js","assets/Post-B8qwSxMH.js","assets/Popup-CtE3GQHY.js","assets/Compose-D29P4Wmy.js","assets/PostDetail-kE23ta4K.js","assets/Comment-Dcsz1cQG.js","assets/Overlay-B5uJ0CNY.js","assets/Feed-BJd14dXJ.js","assets/PostDetail-D4Tu3G75.js","assets/Queues-CPFEZJ0N.js","assets/QueueDetail-C_uEX8eS.js","assets/Notifications-Bmw6YKik.js","assets/Profile-2QOaCj6l.js","assets/Moderation-tH1VnJo7.js","assets/About-8L8QxYpy.js","assets/editor-CKF6zFwf.js"])))=>i.map(i=>d[i]);
import{r as p,j as e,d as Ee,u as K,e as Z,f as Y,g as Te,i as Ae,R as O,k as Oe,L as f,l as oe,m as Ie,n as re,o as Pe,A as $e,p as ze,q as De,s as Re,t as Me,c as qe,v as Le,w as Be,O as V,S as We,x as Qe,y as Ue,z as He,Q as Ve,H as Xe,B as Ke,C as j}from"./vendor-react-DRMPtHf0.js";import{x as Je}from"./vendor-Dm_EoMJn.js";import{H as Ge,i as Ze,a as Ye,b as et,c as tt}from"./editor-components-B-NcqUmU.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))o(d);new MutationObserver(d=>{for(const c of d)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function n(d){const c={};return d.integrity&&(c.integrity=d.integrity),d.referrerPolicy&&(c.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?c.credentials="include":d.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(d){if(d.ep)return;d.ep=!0;const c=n(d);fetch(d.href,c)}})();const st="modulepreload",at=function(t){return"/"+t},ce={},_=function(a,n,o){let d=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),x=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));d=Promise.allSettled(n.map(b=>{if(b=at(b),b in ce)return;ce[b]=!0;const E=b.endsWith(".css"),h=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${h}`))return;const m=document.createElement("link");if(m.rel=E?"stylesheet":st,E||(m.as="script"),m.crossOrigin="",m.href=b,x&&m.setAttribute("nonce",x),document.head.appendChild(m),E)return new Promise((v,y)=>{m.addEventListener("load",v),m.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${b}`)))})}))}function c(u){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=u,window.dispatchEvent(x),!x.defaultPrevented)throw u}return d.then(u=>{for(const x of u||[])x.status==="rejected"&&c(x.reason);return a().catch(c)})},it=new Je({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}}),he=p.createContext(null);function nt({children:t}){const[a,n]=p.useState([]),o=p.useRef(1),d=p.useRef(new Map),c=h=>{const m=d.current.get(h);m&&(clearTimeout(m),d.current.delete(h))},u=(h,m)=>{c(h);const v=window.setTimeout(()=>x(h),m);d.current.set(h,v)},x=p.useCallback(h=>{c(h),n(m=>m.filter(v=>v.id!==h))},[]),b=p.useCallback((h,m)=>{const v=typeof m=="number"?m:(m==null?void 0:m.durationMs)??5e3,y=typeof m=="number"?"info":(m==null?void 0:m.variant)??"info",T=(()=>{try{return window.matchMedia("(max-width: 600px), (pointer: coarse)").matches}catch{return!1}})();let w=null;return n(T?C=>{const k=C[0];if(k&&k.message===h&&k.variant===y){const N={...k,count:k.count+1,duration:v};return w=N.id,[N]}C.forEach(N=>c(N.id));const I=o.current++,B={id:I,message:h,duration:v,variant:y,count:1};return w=I,[B]}:C=>{const k=C.findIndex(N=>N.message===h&&N.variant===y);if(k!==-1){const N=[...C],D={...N[k],count:N[k].count+1};return N[k]=D,w=D.id,N}const I=o.current++,B={id:I,message:h,duration:v,variant:y,count:1};return w=I,[...C,B]}),w!=null&&u(w,v),w??-1},[]),E=p.useMemo(()=>({notify:b,close:x}),[b,x]);return e.jsxs(he.Provider,{value:E,children:[t,e.jsx("div",{className:"toasts",children:a.map(h=>e.jsxs("div",{className:`toast ${h.variant}`,children:[e.jsxs("div",{className:"toast-text",children:[h.message,h.count>1&&e.jsxs("span",{style:{marginLeft:6,opacity:.8},children:["×",h.count]})]}),e.jsx("button",{className:"toast-close",onClick:()=>x(h.id),"aria-label":"Close",children:"×"})]},h.id))})]})}function ot(){const t=p.useContext(he);if(!t)throw new Error("useToasts must be used within ToastProvider");return t}class rt extends p.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,n){console.error("ErrorBoundary caught an error:",a,n)}render(){var a;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"24px",color:"var(--muted)"},children:((a=this.state.error)==null?void 0:a.message)||"An unexpected error occurred"}),e.jsx("button",{className:"btn secondary",onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},children:"Reload Page"})]}):this.props.children}}const A=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function ct({i:t}){const a=t*1337,n=(y,T)=>{const w=Math.sin(a+y+T)*1e4,C=w-Math.floor(w);return Math.floor(C*(T-y+1)+y)},o=n(0,100),d=n(24,50),c=.7+n(0,100)/100*.3,u=d*c,x=n(0,4e3),b=n(-10,10),E=n(-8,8),h=n(0,100),m=h<60?1:h<80?1.5:2,v=[{size:200*m,alpha:.06,dx:-22,dy:12,color:A[n(0,A.length-1)]},{size:150*m,alpha:.08,dx:-9,dy:7,color:A[n(0,A.length-1)]},{size:120*m,alpha:.1,dx:0,dy:0,color:A[n(0,A.length-1)]},{size:90*m,alpha:.12,dx:12,dy:-4,color:A[n(0,A.length-1)]},{size:64*m,alpha:.13,dx:20,dy:-7,color:A[n(0,A.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${o}vw`,animationDuration:`${u}s`,animationDelay:`${x}ms`,"--tx":`${b}vw`,transform:`rotate(${E}deg)`},children:v.map((y,T)=>e.jsx("svg",{width:y.size,height:y.size,viewBox:"0 0 100 100",style:{left:`${50+y.dx}%`,bottom:`${y.dy}px`,transform:"translateX(-50%)","--alpha":y.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:y.color})},T))})}function lt({paused:t=!1}){const a=p.useMemo(()=>new Array(20).fill(0).map((n,o)=>o),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:a.map(n=>e.jsx(ct,{i:n},n))})}const dt=()=>{try{const t=localStorage.getItem("filter_modes")||"standard",a=new Set(t.toLowerCase().split(",").map(n=>n.trim()).filter(Boolean));return{standard:a.has("standard")||a.size===0,taiko:a.has("taiko"),mania:a.has("mania"),catch:a.has("catch")}}catch{return{standard:!0,taiko:!1,mania:!1,catch:!1}}},ut=()=>{try{const t=localStorage.getItem("filter_moddi_tags")||"untagged,help",a=new Set(t.toLowerCase().split(",").map(n=>n.trim()).filter(Boolean));return{untagged:a.has("untagged")||a.size===0,help:a.has("help")||a.size===0}}catch{return{untagged:!0,help:!0}}},mt=()=>{try{const t=localStorage.getItem("filter_queue_status")||"unchecked,accepted,denied,finished",a=new Set(t.toLowerCase().split(",").map(n=>n.trim()).filter(Boolean));return{unchecked:a.has("unchecked")||a.size===0,accepted:a.has("accepted")||a.size===0,denied:a.has("denied")||a.size===0,finished:a.has("finished")||a.size===0,archived:a.has("archived")}}catch{return{unchecked:!0,accepted:!0,denied:!0,finished:!0,archived:!1}}},ht=()=>{try{const t=localStorage.getItem("last_section");return t==="mappi"||t==="moddi"?t:null}catch{return null}},pt=Ee(t=>({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1,filtersOpen:!1,modeFilters:dt(),tagFilters:ut(),queueStatusFilters:mt(),lastSection:ht(),setMenuOpen:a=>t({menuOpen:a}),setMobileNavOpen:a=>t({mobileNavOpen:a}),setNotifOpen:a=>t({notifOpen:a}),setFiltersOpen:a=>t({filtersOpen:a}),closeAllPanels:()=>t({menuOpen:!1,mobileNavOpen:!1,notifOpen:!1,filtersOpen:!1}),setModeFilters:a=>{t({modeFilters:a});try{const o=Object.entries(a).filter(([c,u])=>u).map(([c])=>c),d=o.length?o:["standard"];localStorage.setItem("filter_modes",d.join(","))}catch{}},setTagFilters:a=>{t({tagFilters:a});try{const o=Object.entries(a).filter(([c,u])=>u).map(([c])=>c),d=o.length?o:["untagged","help"];localStorage.setItem("filter_moddi_tags",d.join(","))}catch{}},setQueueStatusFilters:a=>{t({queueStatusFilters:a});try{const o=Object.entries(a).filter(([c,u])=>u).map(([c])=>c),d=o.length?o:["unchecked","accepted","denied","finished"];localStorage.setItem("filter_queue_status",d.join(","))}catch{}},setLastSection:a=>{t({lastSection:a});try{a?localStorage.setItem("last_section",a):localStorage.removeItem("last_section")}catch{}}})),ft="https://api.osumappi.ng";function X(){var t;try{return((t=document.cookie.split("; ").map(a=>a.split("=")).find(([a])=>a==="csrf"))==null?void 0:t[1])||""}catch{return""}}async function z(t,a={}){const{requireAuth:n=!0,skipCsrf:o=!1,...d}=a,c={...d.headers};if(d.body&&!c["Content-Type"]&&(c["Content-Type"]="application/json"),n&&!o){const x=X();x&&(c["X-CSRF-Token"]=x)}const u=await fetch(`${ft}${t}`,{...d,credentials:"include",headers:c});if(!u.ok){const x=await u.json().catch(()=>({error:`HTTP ${u.status}`}));throw new Error(x.error||`HTTP ${u.status}: ${u.statusText}`)}return u.json()}const L={auth:{login:"/api/auth/login",logout:"/api/auth/logout",me:"/api/me"},user:{quota:"/api/me/upload_quota",notifications:"/api/me/notifications",markNotificationsRead:"/api/me/notifications/mark_read",deleteNotification:t=>`/api/me/notifications/${encodeURIComponent(t)}`},feed:{next:"/api/feed/next",batch:"/api/feed/batch",recent:"/api/videos/recent"},videos:{like:t=>`/api/videos/${t}/like`,view:t=>`/api/videos/${t}/view`,update:t=>`/api/videos/${t}`,delete:t=>`/api/videos/${t}`},moddi:{posts:"/api/moddiposts",post:t=>`/api/moddiposts/${t}`,queues:"/api/moddi/queues",queue:t=>`/api/moddi/queues/${t}`,queueSubmit:t=>`/api/moddi/queues/${t}/submit`},osu:{resolveBeatmap:"/api/osu/beatmap/resolve"},admin:{clearViews:"/api/admin/me/clear_views",debugState:"/api/debug/state"}};function xt(){return K({queryKey:["user","me"],queryFn:async()=>{try{return await z(L.auth.me)}catch{return null}},staleTime:5*60*1e3})}function gt(t=!0){return K({queryKey:["user","quota"],queryFn:async()=>{try{return await z(L.user.quota)}catch{return null}},enabled:t,refetchInterval:30*1e3})}function yt(){const t=Z();return Y({mutationFn:async()=>{await z(L.auth.logout,{method:"POST"})},onSuccess:()=>{t.setQueryData(["user","me"],null),t.clear(),window.location.href="/"}})}function pe(t=!0){return K({queryKey:["notifications"],queryFn:async()=>{try{const a=await z(L.user.notifications);return Array.isArray(a.items)?a.items:[]}catch{return[]}},enabled:t,refetchInterval:45*1e3})}function Lt(){return K({queryKey:["notifications","detailed"],queryFn:async()=>{try{const t=await z("/api/me/notifications/detailed");return Array.isArray(t.items)?t.items:[]}catch{return[]}},refetchInterval:30*1e3})}function jt(){const{data:t=[]}=pe();return t.filter(a=>a.kind==="system"&&a.id.startsWith("b:")&&(a.expiresAt||0)<=Date.now()?!1:!a.read).length}function vt(){const t=Z();return Y({mutationFn:async a=>{await z(L.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:a})})},onSuccess:()=>{t.setQueryData(["notifications"],a=>(a==null?void 0:a.map(n=>({...n,read:!0})))||[])}})}function Nt(){const t=Z();return Y({mutationFn:async a=>{const n=X();await z(L.user.deleteNotification(a),{method:"DELETE",headers:{"X-CSRF-Token":n}})},onSuccess:(a,n)=>{t.setQueryData(["notifications"],o=>(o==null?void 0:o.filter(d=>d.id!==n))||[])}})}const le="https://api.osumappi.ng";function de(t){var a;return(a=document.cookie.split("; ").map(n=>n.split("=")).find(([n])=>n===t))==null?void 0:a[1]}function bt(){const t=Te(),a=Ae(),{notify:n}=ot(),{data:o,isLoading:d}=xt(),{data:c}=gt(!!o),{data:u=[]}=pe(!!o),x=jt(),b=yt(),E=vt(),h=Nt(),[m,v]=p.useState(new Set),{menuOpen:y,mobileNavOpen:T,notifOpen:w,filtersOpen:C,modeFilters:k,tagFilters:I,queueStatusFilters:B,lastSection:N,setMenuOpen:D,setMobileNavOpen:P,setNotifOpen:Q,setFiltersOpen:R,closeAllPanels:U,setModeFilters:ee,setTagFilters:te,setQueueStatusFilters:fe,setLastSection:J}=pt(),$=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",xe=t.pathname==="/editor",M=t.pathname.startsWith("/mp/")||!$&&!t.pathname.startsWith("/md/")&&N==="mappi",S=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!$&&!t.pathname.startsWith("/mp/")&&N==="moddi",ge=t.pathname.startsWith("/md/queues/")&&t.pathname!=="/md/queues";O.useEffect(()=>{t.pathname.startsWith("/mp/")?J("mappi"):t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"&&J("moddi")},[t.pathname,J]);const[zt,ye]=O.useState(0);O.useEffect(()=>{const s=setInterval(()=>ye(i=>i+1),1e3);return()=>clearInterval(s)},[]);const[se,G]=O.useState(null);O.useEffect(()=>{(async()=>{try{const s=window.location.hostname,i=s.split("."),r=i.length>=2?`${i[i.length-2]}.${i[i.length-1]}`:s,l=`https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(r)}&type=NS`,g=await fetch(l,{headers:{accept:"application/dns-json"}});if(!g.ok){G(!1);return}const F=await g.json().catch(()=>({})),Fe=(Array.isArray(F==null?void 0:F.Answer)?F.Answer:[]).some(q=>/cloudflare\.com\.?$/i.test(String((q==null?void 0:q.data)||(q==null?void 0:q.name)||"")));G(Fe)}catch{G(!1)}})()},[]);const[ae,je]=O.useState(null);O.useEffect(()=>{!o||!o.is_mod||(async()=>{try{const i=await fetch("https://api.osumappi.ng/api/debug/state",{credentials:"include"});if(i.ok){const r=await i.json(),l=Array.isArray(r==null?void 0:r.counts)?r.counts.find(g=>String(g.status)==="ready"):null;l&&je(Number(l.c)||0)}}catch{}})()},[o]);const[H,ie]=O.useState(!1),ne=async()=>{ie(!0);try{const s="https://api.osumappi.ng",i=X(),r=await fetch(`${s}/api/admin/me/clear_views`,{method:"POST",credentials:"include",headers:{"X-CSRF-Token":i}});if(r.ok){const l=await r.json().catch(()=>({}));n(`Cleared ${Number((l==null?void 0:l.deleted)||0)} views from your history.`,{variant:"success"});try{localStorage.removeItem("feed_seen_ids")}catch{}try{window.dispatchEvent(new Event("filterchange"))}catch{}}else n("Failed to clear view history",{variant:"error"})}catch{n("Failed to clear view history",{variant:"error"})}finally{ie(!1)}},ve=s=>{if(!s)return null;try{const i=JSON.parse(s);if((i==null?void 0:i.type)==="queue_invite"&&(i!=null&&i.queue_id))return i}catch{}return null},Ne=async(s,i)=>{if(!m.has(s.id)){v(r=>new Set(r).add(s.id));try{const r=de("csrf")||"",l=await fetch(`${le}/api/moddi/queues/${i}/accept`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r}});if(l.ok)n("Invitation accepted!",{variant:"success"}),h.mutate(s.id),Q(!1),a(`/md/queues/${i}`);else{const g=await l.json().catch(()=>({}));n(g.error||"Failed to accept invitation",{variant:"error"})}}catch{n("Failed to accept invitation",{variant:"error"})}finally{v(r=>{const l=new Set(r);return l.delete(s.id),l})}}},be=async(s,i)=>{if(!m.has(s.id)){v(r=>new Set(r).add(s.id));try{const r=de("csrf")||"",l=await fetch(`${le}/api/moddi/queues/${i}/deny`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r}});if(l.ok)n("Invitation declined",{variant:"success"}),h.mutate(s.id);else{const g=await l.json().catch(()=>({}));n(g.error||"Failed to decline invitation",{variant:"error"})}}catch{n("Failed to decline invitation",{variant:"error"})}finally{v(r=>{const l=new Set(r);return l.delete(s.id),l})}}},we=async()=>{const s=u.filter(i=>i.id.startsWith("n:")||i.kind==="system"&&!i.read).map(i=>i.id);s.length>0&&E.mutate(s)},ke=async s=>{if(Q(!1),E.mutate([s.id]),s.kind==="system"||s.id.startsWith("n:")){const i=X();try{await fetch("https://api.osumappi.ng/api/me/notifications/mark_read",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":i},body:JSON.stringify({ids:[s.id]})})}catch{}}},_e=async(s,i)=>{s.stopPropagation(),h.mutate(i)},Ce=()=>{const i=Object.entries(k).filter(([r,l])=>l).map(([r])=>r);i.length,i.length===0&&ee({standard:!0,taiko:!1,mania:!1,catch:!1});try{window.dispatchEvent(new Event("filterchange"))}catch{}R(!1)},Se=()=>{const i=Object.entries(I).filter(([r,l])=>l).map(([r])=>r);i.length,i.length===0&&te({untagged:!0,help:!0});try{window.dispatchEvent(new Event("moddifilterchange"))}catch{}R(!1)};return O.useEffect(()=>{o&&!localStorage.getItem("welcomed")&&(n(`Welcome, ${o.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[o,n]),e.jsxs("div",{className:"app-shell","data-section":S?"moddi":M?"mappi":N==="moddi"?"moddi":N==="mappi"?"mappi":void 0,children:[e.jsx(lt,{paused:t.pathname==="/editor"}),e.jsxs("header",{className:"top-nav",children:[t.pathname!=="/editor"&&e.jsxs("div",{className:"mobile-nav",children:[e.jsx("button",{className:"icon-link hamburger",onClick:()=>{T||U(),P(s=>!s)},"aria-label":"Menu","aria-expanded":T,children:e.jsx(Oe,{size:18})}),T&&e.jsxs("div",{className:"menu-panel",role:"menu",children:[$&&e.jsx(f,{to:t.pathname==="/"?"/about":"/",className:`menu-item ${t.pathname==="/about"?"active":""}`,onClick:()=>P(!1),children:t.pathname==="/"?"About":"Home"}),M&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>P(!1),children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>P(!1),children:"Discover"})]}),S&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/md/feed",className:`menu-item ${t.pathname==="/md/feed"?"active":""}`,onClick:()=>P(!1),children:"Feed"}),e.jsx(f,{to:"/md/queues",className:`menu-item ${t.pathname.startsWith("/md/queues")?"active":""}`,onClick:()=>P(!1),children:"Queues"})]}),!M&&!S&&!$&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:`menu-item ${t.pathname==="/mp/feed"?"active":""}`,onClick:()=>P(!1),children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:`menu-item ${t.pathname==="/mp/discover"?"active":""}`,onClick:()=>P(!1),children:"Discover"})]})]})]}),$?e.jsx(f,{to:"/",className:"title",children:S?"osu!moddi.ng":M?"osu!mappi.ng":"mappi!"}):xe?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(f,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(oe,{size:18})}),e.jsx(f,{to:S?"/md/feed":"/mp/feed",className:"title",children:S?"osu!moddi.ng":"osu!mappi.ng"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(f,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(oe,{size:18})}),e.jsxs(f,{to:S?"/mp/feed":"/md/feed",className:"title coin-flip-title",children:[e.jsx("span",{className:"coin-flip-front",children:S?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:S?"osu!mappi.ng":"osu!moddi.ng"})]})]}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),t.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(Ge,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[$&&e.jsx(f,{to:t.pathname==="/"?"/about":"/",className:t.pathname==="/about"?"active":"",children:t.pathname==="/"?"About":"Home"}),M&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(f,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]}),S&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/md/feed",className:t.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx(f,{to:"/md/queues",className:t.pathname.startsWith("/md/queues")?"active":"",children:"Queues"})]}),!M&&!S&&!$&&e.jsxs(e.Fragment,{children:[e.jsx(f,{to:"/mp/feed",className:t.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(f,{to:"/mp/discover",className:t.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(f,{to:"/editor",className:t.pathname==="/editor"?"active":"",children:"Editor"})]})]}),e.jsx("div",{style:{marginLeft:"auto"}}),o?e.jsxs("div",{className:"user-menu",children:[e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:6},children:[e.jsx("button",{className:"icon-link",onClick:()=>{w||U(),Q(s=>!s)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(Ie,{size:18})}),x>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),w&&e.jsxs("div",{className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(f,{to:"/md/notifications",onClick:()=>Q(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:s=>s.currentTarget.style.opacity="1",onMouseLeave:s=>s.currentTarget.style.opacity="0.7",children:"View all"}),u.filter(s=>!(s.kind==="system"&&s.id.startsWith("b:")&&(s.expiresAt||0)<=Date.now())).length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:we,children:e.jsx(re,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[u.filter(s=>!(s.kind==="system"&&s.id.startsWith("b:")&&(s.expiresAt||0)<=Date.now())).length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),u.filter(s=>!(s.kind==="system"&&s.id.startsWith("b:")&&(s.expiresAt||0)<=Date.now())).map(s=>{const i=ve(s.text),r=s.id.startsWith("b:"),l=i?"queue-invite":s.kind==="star"?"star":s.kind==="likes5"?"likes":s.kind==="inspiration"?"inspiration":r?"global":"system",g=s.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${l}`,role:"button",onClick:()=>!i&&ke(s),children:[e.jsxs("div",{className:`notif-icon ${g?"deletable":""}`,"aria-hidden":"true",onClick:g&&!i?F=>_e(F,s.id):void 0,title:g&&!i?"Remove":void 0,role:g&&!i?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:i?e.jsx(Pe,{}):l==="star"?e.jsx($e,{}):l==="likes"?e.jsx(ze,{}):l==="inspiration"?e.jsx(De,{}):l==="global"?e.jsx(Re,{}):null}),g&&!i?e.jsx("span",{className:"swap-trash",children:e.jsx(Me,{})}):null]}),e.jsx("div",{className:"notif-body",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Queue Invitation"}),e.jsxs("div",{className:"notif-desc",children:[i.inviter_username," invited you to join queue: ",i.queue_name]}),m.has(s.id)?e.jsx("div",{className:"muted",style:{fontSize:11,marginTop:6},children:"Processing..."}):e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:F=>{F.stopPropagation(),Ne(s,i.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(re,{size:12,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:F=>{F.stopPropagation(),be(s,i.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(qe,{size:12,style:{marginRight:4}}),"Decline"]})]})]}):s.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:r?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:s.text||""}),r&&s.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(s.expiresAt).toLocaleString()]}):null]}):s.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:s.text||"Someone is inspired by you!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:s.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:s.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},s.id)})]})]})]}),c!=null&&c.blocked?e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(Le,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:(()=>{const s=Math.max(0,Math.floor((((c==null?void 0:c.reset_at)??0)*1e3-Date.now())/1e3)),i=Math.floor(s/3600),r=Math.floor(s%3600/60),l=s%60,g=F=>String(F).padStart(2,"0");return i>0?`${i}:${g(r)}:${g(l)}`:`${r}:${g(l)}`})()})]}):null,e.jsxs("button",{className:"icon-link",onClick:()=>{y||U(),D(s=>!s)},title:o.username,"aria-label":"User menu","aria-expanded":y,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[o.avatar_url&&e.jsx("img",{src:o.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:o.username}),e.jsx(Be,{size:14,style:{opacity:.8}})]}),y&&e.jsxs("div",{className:"menu-panel",role:"menu",children:[e.jsx(f,{to:"/profile",className:"menu-item",onClick:()=>D(!1),children:"Profile"}),o!=null&&o.is_admin||o!=null&&o.is_mod?e.jsx(f,{to:"/moderation",className:"menu-item",onClick:()=>D(!1),children:"Moderation"}):null,e.jsx("button",{className:"menu-item",type:"button",onClick:()=>b.mutate(),children:"Log out"})]})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{const s="https://api.osumappi.ng";window.location.href=`${s}/api/auth/login`},disabled:d,children:d?"Checking…":"Login with osu!"})]})]}),e.jsx("main",{className:`page ${t.pathname==="/editor"?"fullscreen":""}`,children:t.pathname==="/editor"?e.jsx(V,{}):t.pathname==="/"?e.jsx(V,{}):t.pathname==="/mp/discover"||t.pathname==="/about"||t.pathname==="/profile"||t.pathname.startsWith("/profile/")||t.pathname==="/moderation"?e.jsx("div",{className:"card",children:e.jsx(V,{})}):e.jsx(V,{})}),t.pathname!=="/editor"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"site-badge","aria-hidden":!1,children:[e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("a",{className:"discord",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)",children:e.jsx(We,{size:18})}),e.jsx("span",{className:`cloudflare ${se?"active":""}`,title:se?"Cloudflare DNS active":"Cloudflare not detected",children:e.jsx(Qe,{size:18})})]}),o&&o.is_mod&&ae!==null&&e.jsxs("div",{className:"label",children:[ae," videos ready"]})]}),e.jsxs("div",{className:"site-controls","aria-hidden":!1,children:[e.jsx("button",{className:"settings-btn",onClick:()=>{C||U(),R(s=>!s)},"aria-expanded":C,"aria-label":"Filter settings",title:"Filter settings",children:e.jsx(Ue,{size:18})}),C&&e.jsx("div",{className:"settings-panel",role:"dialog","aria-modal":"false",children:ge?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Submission Status"}),e.jsx("div",{className:"col",style:{gap:6},children:[["unchecked","Unchecked"],["accepted","Accepted"],["denied","Denied"],["finished","Finished"],["archived","Archived"]].map(([s,i])=>{const r=B[s];return e.jsxs("label",{className:"row",style:{alignItems:"center",gap:8,cursor:"pointer",fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:r,onChange:l=>{fe(g=>({...g,[s]:l.target.checked}))},style:{cursor:"pointer"}}),e.jsx("span",{children:i})]},s)})}),e.jsx("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:e.jsx("button",{className:"btn secondary compact",onClick:()=>R(!1),children:"Close"})})]}):S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Tags"}),e.jsx("div",{className:"col",style:{gap:6},children:[["untagged","Untagged"],["help","Help"]].map(([s,i])=>{const r=I[s];return e.jsx("button",{className:`mode-cell ${r?"selected":""}`,"aria-pressed":r,onClick:()=>{te(l=>({...l,[s]:!r}))},children:e.jsx("span",{children:i})},s)})}),o&&(o.is_admin||o.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:H,onClick:ne,children:H?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>R(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:Se,children:"Apply"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:6},children:"Game modes"}),e.jsx("div",{className:"col",style:{gap:6},children:[["standard","Standard",Ze],["taiko","Taiko",Ye],["mania","Mania",et],["catch","Catch",tt]].map(([s,i,r])=>{const l=k[s];return e.jsxs("button",{className:`mode-cell ${l?"selected":""}`,"aria-pressed":l,onClick:()=>{ee(g=>({...g,[s]:!l}))},children:[e.jsx("img",{className:"mode-icon",src:r,width:24,height:24,alt:""}),e.jsx("span",{children:i})]},s)})}),o&&(o.is_admin||o.is_mod)&&e.jsxs("div",{className:"col",style:{gap:6,marginTop:10},children:[e.jsx("div",{className:"title",style:{fontSize:14,marginBottom:2},children:"Moderator Tools"}),e.jsx("button",{className:"btn secondary compact",disabled:H,onClick:ne,children:H?"Clearing…":"Clear view history"})]}),e.jsxs("div",{className:"row",style:{marginTop:8,justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn secondary compact",onClick:()=>R(!1),children:"Close"}),e.jsx("button",{className:"btn compact",onClick:Ce,children:"Apply"})]})]})})]})]})]})}const wt=p.lazy(()=>_(()=>import("./Home-Yi2VIAfX.js"),__vite__mapDeps([0,1,2]))),ue=p.lazy(()=>_(()=>import("./Discover-CaggoxQI.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9]))),W=p.lazy(()=>_(()=>import("./Feed-CtqMMTve.js"),__vite__mapDeps([10,1,2,11,12,4,6,5,7,13,8,9]))),kt=p.lazy(()=>_(()=>import("./PostDetail-kE23ta4K.js"),__vite__mapDeps([14,1,2,11,12,4,6,5,7,15,16,8,9]))),_t=p.lazy(()=>_(()=>import("./Feed-BJd14dXJ.js"),__vite__mapDeps([17,1,2,11,12,4,6,5,7,13,8,9]))),Ct=p.lazy(()=>_(()=>import("./PostDetail-D4Tu3G75.js"),__vite__mapDeps([18,1,2,11,12,4,6,5,7,15,8,9]))),St=p.lazy(()=>_(()=>import("./Queues-CPFEZJ0N.js"),__vite__mapDeps([19,1,2,8,9]))),Ft=p.lazy(()=>_(()=>import("./QueueDetail-C_uEX8eS.js"),__vite__mapDeps([20,1,2,8,9]))),Et=p.lazy(()=>_(()=>import("./Notifications-Bmw6YKik.js"),__vite__mapDeps([21,1,2,8,9]))),me=p.lazy(()=>_(()=>import("./Profile-2QOaCj6l.js"),__vite__mapDeps([22,1,2,16,4,5,6,7,12,8,9]))),Tt=p.lazy(()=>_(()=>import("./Moderation-tH1VnJo7.js"),__vite__mapDeps([23,1,2,8,9]))),At=p.lazy(()=>_(()=>import("./About-8L8QxYpy.js"),__vite__mapDeps([24,1,2]))),Ot=p.lazy(()=>_(()=>import("./editor-CKF6zFwf.js"),__vite__mapDeps([25,1,2,6,5,7])).then(t=>({default:t.Editor}))),It=()=>e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"50vh",color:"var(--muted)"},children:"Loading..."}),Pt=()=>e.jsx(p.Suspense,{fallback:e.jsx(It,{}),children:e.jsx(Ke,{children:e.jsxs(j,{element:e.jsx(bt,{}),children:[e.jsx(j,{path:"/",element:e.jsx(wt,{})}),e.jsx(j,{path:"/mp/discover",element:e.jsx(ue,{})}),e.jsx(j,{path:"/mp/feed",element:e.jsx(W,{})}),e.jsx(j,{path:"/mp/feed/:uid",element:e.jsx(kt,{})}),e.jsx(j,{path:"/md/feed",element:e.jsx(_t,{})}),e.jsx(j,{path:"/md/feed/:uid",element:e.jsx(Ct,{})}),e.jsx(j,{path:"/md/queues",element:e.jsx(St,{})}),e.jsx(j,{path:"/md/queues/:id",element:e.jsx(Ft,{})}),e.jsx(j,{path:"/md/notifications",element:e.jsx(Et,{})}),e.jsx(j,{path:"/profile",element:e.jsx(me,{})}),e.jsx(j,{path:"/profile/:id",element:e.jsx(me,{})}),e.jsx(j,{path:"/moderation",element:e.jsx(Tt,{})}),e.jsx(j,{path:"/about",element:e.jsx(At,{})}),e.jsx(j,{path:"/editor",element:e.jsx(Ot,{})}),e.jsx(j,{path:"/feed",element:e.jsx(ue,{})}),e.jsx(j,{path:"/upload",element:e.jsx(W,{})}),e.jsx(j,{path:"/posts",element:e.jsx(W,{})}),e.jsx(j,{path:"/recents",element:e.jsx(W,{})}),e.jsx(j,{path:"/recent",element:e.jsx(W,{})})]})})}),$t=()=>e.jsx(Xe,{children:e.jsx(Pt,{})});He(document.getElementById("root")).render(e.jsx(O.StrictMode,{children:e.jsx(rt,{children:e.jsx(Ve,{client:it,children:e.jsx(nt,{children:e.jsx($t,{})})})})}));export{L as A,xt as a,pt as b,z as c,Lt as d,vt as e,Nt as f,ot as u};
