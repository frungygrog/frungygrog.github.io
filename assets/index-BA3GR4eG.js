const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Discover-DgABVB1R.js","assets/vendor-react-CcFPULbg.js","assets/vendor-JPAzRx9E.js","assets/mappi-routes-DG7AcUwo.js","assets/vendor-hls-B_fsdCYC.js","assets/editor-BdlnYnWr.js","assets/vendor-zip-B-J1xrE3.js","assets/beatmap-preview-DIA57Ie2.js","assets/editor-CG1yLUbS.css","assets/moddi-routes-Dm4dtSgK.js","assets/editor-components-COwEyuAl.js","assets/editor-components-Bzmrvihl.css"])))=>i.map(i=>d[i]);
var Ze=Object.defineProperty;var et=(t,i,s)=>i in t?Ze(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s;var Ce=(t,i,s)=>et(t,typeof i!="symbol"?i+"":i,s);import{r as w,j as e,e as ae,u as ce,R as b,q as Ne,d as be,V as tt,W as Ee,X as st,L as B,Y as it,Z as at,P as Ie,_ as nt,$ as rt,Q as fe,M as ot,A as lt,h as ct,D as Ae,S as dt,T as ut,J as mt,c as Re,G as pt,l as Fe,a0 as ht,z as ft,a1 as _e,B as gt,v as xt,o as vt,k as bt,x as yt,i as jt,g as Nt,a2 as wt,a3 as kt,a4 as St,a5 as Tt,a6 as K}from"./vendor-react-CcFPULbg.js";import{y as Ct}from"./vendor-JPAzRx9E.js";import{u as de,a as M,A as P,c as ge,i as re,d as je,P as Et,b as le,e as At,T as _t,f as Lt}from"./mappi-routes-DG7AcUwo.js";import{u as se,a as De,b as oe,c as We,d as Pt,e as Mt,f as zt,g as Be,h as It,i as Rt,F as Ft,C as Dt,M as Wt,D as Bt,j as qt,P as $t,Q as Ht,k as Ut,N as Ot}from"./moddi-routes-Dm4dtSgK.js";import{b as Qt,a as Jt,i as Yt,c as Gt,H as Vt}from"./editor-components-COwEyuAl.js";import{s as Kt,E as Xt}from"./editor-BdlnYnWr.js";import"./vendor-hls-B_fsdCYC.js";import"./beatmap-preview-DIA57Ie2.js";import"./vendor-zip-B-J1xrE3.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=s(l);fetch(l.href,r)}})();const Zt="modulepreload",es=function(t){return"/"+t},Le={},ts=function(i,s,o){let l=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));l=Promise.allSettled(s.map(p=>{if(p=es(p),p in Le)return;Le[p]=!0;const N=p.endsWith(".css"),u=N?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${u}`))return;const g=document.createElement("link");if(g.rel=N?"stylesheet":Zt,N||(g.as="script"),g.crossOrigin="",g.href=p,f&&g.setAttribute("nonce",f),document.head.appendChild(g),N)return new Promise((C,T)=>{g.addEventListener("load",C),g.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${p}`)))})}))}function r(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return l.then(c=>{for(const f of c||[])f.status==="rejected"&&r(f.reason);return i().catch(r)})},ss=new Ct({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}});class is extends w.Component{constructor(s){super(s);Ce(this,"handleRetry",()=>{const s=this.isChunkLoadingError(this.state.error);this.setState({hasError:!1,error:null}),s&&window.location.reload()});this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,o){console.error("ErrorBoundary caught an error:",s,o)}isChunkLoadingError(s){if(!s)return!1;const o=s.message.toLowerCase();return o.includes("loading chunk")||o.includes("failed to load")||o.includes("chunk load failed")||o.includes("loading css chunk")||s.name==="ChunkLoadError"}render(){var s;if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const o=this.isChunkLoadingError(this.state.error),l=((s=this.state.error)==null?void 0:s.message)||"An unexpected error occurred";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"8px",color:"var(--muted)"},children:o?"Failed to load page. This might be a network issue.":l}),o&&e.jsx("p",{style:{marginBottom:"24px",fontSize:"14px",color:"var(--muted)",opacity:.8},children:"Try checking your internet connection or reloading the page."}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{className:"btn secondary",onClick:this.handleRetry,children:o?"Reload Page":"Try Again"}),!o&&e.jsx("button",{className:"btn secondary",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})}return this.props.children}}const ee=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function as({i:t}){const i=t*1337,s=(T,y)=>{const d=Math.sin(i+T+y)*1e4,x=d-Math.floor(d);return Math.floor(x*(y-T+1)+T)},o=s(0,100),l=s(24,50),r=.7+s(0,100)/100*.3,c=l*r,f=s(0,4e3),p=s(-10,10),N=s(-8,8),u=s(0,100),g=u<60?1:u<80?1.5:2,C=[{size:200*g,alpha:.06,dx:-22,dy:12,color:ee[s(0,ee.length-1)]},{size:150*g,alpha:.08,dx:-9,dy:7,color:ee[s(0,ee.length-1)]},{size:120*g,alpha:.1,dx:0,dy:0,color:ee[s(0,ee.length-1)]},{size:90*g,alpha:.12,dx:12,dy:-4,color:ee[s(0,ee.length-1)]},{size:64*g,alpha:.13,dx:20,dy:-7,color:ee[s(0,ee.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${o}vw`,animationDuration:`${c}s`,animationDelay:`${f}ms`,"--tx":`${p}vw`,transform:`rotate(${N}deg)`},children:C.map((T,y)=>e.jsx("svg",{width:T.size,height:T.size,viewBox:"0 0 100 100",style:{left:`${50+T.dx}%`,bottom:`${T.dy}px`,transform:"translateX(-50%)","--alpha":T.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:T.color})},y))})}function ns({paused:t=!1}){const i=w.useMemo(()=>new Array(20).fill(0).map((s,o)=>o),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:i.map(s=>e.jsx(as,{i:s},s))})}function rs(){const t=ae(),i=ce(),{lastSection:s,previousLocation:o,setPreviousLocation:l}=se(),r=b.useRef(null),c=b.useRef(!1),f=b.useRef(0),p=b.useRef(0),N=b.useRef(null),u=b.useRef(null),g=b.useRef(!1),C=300,T=2e3,y=b.useRef(null),d=b.useRef(null),x=b.useRef(null),[m,k]=b.useState(!1),[z,j]=b.useState(12),D=b.useRef(null),_=b.useRef(null),[n,S]=b.useState(!1),[I,q]=b.useState(12),[Q,R]=b.useState([]),[O,X]=b.useState(""),F=b.useRef(null),J=b.useRef(null),[Y,h]=b.useState(!1),[L,A]=b.useState(12),[U,ne]=b.useState(null),ue=b.useCallback(()=>{if(!d.current)return;const v=d.current.getBoundingClientRect(),$=window.innerWidth||document.documentElement.clientWidth||320,H=160;let W=v.left;W+H+8>$&&(W=Math.max(8,$-H-8)),W=Math.max(8,W),j(W)},[]),a=b.useCallback(()=>{if(!D.current)return;const v=D.current.getBoundingClientRect(),$=window.innerWidth||document.documentElement.clientWidth||320,H=220;let W=v.left;W+H+8>$&&(W=Math.max(8,$-H-8)),W=Math.max(8,W),q(W)},[]),E=b.useCallback(()=>{if(!F.current)return;const v=F.current.getBoundingClientRect(),$=window.innerWidth||document.documentElement.clientWidth||320,H=280;let W=v.left;W+H+8>$&&(W=Math.max(8,$-H-8)),W=Math.max(8,W),A(W)},[]);b.useEffect(()=>()=>{r.current&&clearTimeout(r.current),N.current&&clearTimeout(N.current),u.current&&clearTimeout(u.current)},[]),b.useEffect(()=>{if(!m)return;const v=$=>{const H=$.target;x.current&&!x.current.contains(H)&&d.current&&!d.current.contains(H)&&k(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[m]),b.useEffect(()=>{if(!n)return;const v=$=>{const H=$.target;_.current&&!_.current.contains(H)&&D.current&&!D.current.contains(H)&&S(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[n]),b.useEffect(()=>{if(!Y)return;const v=$=>{const H=$.target;J.current&&!J.current.contains(H)&&F.current&&!F.current.contains(H)&&h(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[Y]),b.useEffect(()=>{if(!m)return;ue();const v=()=>ue();return window.addEventListener("resize",v),window.addEventListener("orientationchange",v),()=>{window.removeEventListener("resize",v),window.removeEventListener("orientationchange",v)}},[m,ue]),b.useEffect(()=>{if(!n)return;a();const v=()=>a();return window.addEventListener("resize",v),window.addEventListener("orientationchange",v),()=>{window.removeEventListener("resize",v),window.removeEventListener("orientationchange",v)}},[n,a]),b.useEffect(()=>{if(!Y)return;E();const v=()=>E();return window.addEventListener("resize",v),window.addEventListener("orientationchange",v),()=>{window.removeEventListener("resize",v),window.removeEventListener("orientationchange",v)}},[Y,E]);const Z=t.pathname==="/"||t.pathname==="/about",G=t.pathname==="/editor";t.pathname.startsWith("/mp/")||!Z&&t.pathname.startsWith("/md/");const ie=t.pathname.startsWith("/md/")||!Z&&!t.pathname.startsWith("/mp/")&&s==="moddi";b.useEffect(()=>{if(!G)return;const v=H=>{const W=H.detail||{},Xe=Array.isArray(W.items)?W.items:[];R(Xe),X(String(W.selected||""))},$=H=>{const W=H.detail||{};ne({title:String(W.title||""),artist:String(W.artist||""),mapper:String(W.mapper||""),version:String(W.version||""),beatmapId:Number(W.beatmapId)||null})};return window.addEventListener("editor:difficulty:list",v),window.addEventListener("editor:info",$),()=>{window.removeEventListener("editor:difficulty:list",v),window.removeEventListener("editor:info",$)}},[G]);const $e=De(),{data:V}=oe(),me=b.useRef(null),pe=b.useRef(!1),we=()=>{pe.current=!1,(V!=null&&V.is_mod||V!=null&&V.is_admin)&&(me.current=setTimeout(()=>{pe.current=!0,i("/moderation")},500))},xe=()=>{me.current&&(clearTimeout(me.current),me.current=null),pe.current&&setTimeout(()=>{pe.current=!1},100)},He=v=>{if(pe.current){v.preventDefault(),v.stopPropagation();return}i("/settings")},Ue=v=>{if(xe(),pe.current){v.preventDefault();return}i("/settings")};if(b.useEffect(()=>()=>{me.current&&clearTimeout(me.current)},[]),Z)return null;const ke=()=>{i(o||(s==="moddi"?"/md/feed":"/mp/feed"))},Oe=()=>{k(v=>!v)},Qe=()=>{var v;k(!1),(v=y.current)==null||v.click()},Je=()=>{S(v=>!v)},Ye=v=>{S(!1),X(v),window.dispatchEvent(new CustomEvent("editor:difficulty:select",{detail:{path:v}}))},Ge=()=>{h(v=>!v)};if(G)return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:y,type:"file",accept:".osz,.zip",onChange:v=>{var H;const $=(H=v.target.files)==null?void 0:H[0];$&&window.dispatchEvent(new CustomEvent("editor:file",{detail:$}))},style:{display:"none"}}),e.jsxs("nav",{className:"mobile-bottom-nav mobile-bottom-nav-editor",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx("button",{className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:ke,"aria-label":"Back",title:"Go back",children:e.jsx(Ne,{size:20})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:d,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:Oe,"aria-label":"File",title:"File menu","aria-expanded":m,children:e.jsx(tt,{size:20})}),m&&be.createPortal(e.jsx("div",{ref:x,className:"menu-panel mobile-bottom-nav-menu",role:"menu",style:{"--mobile-menu-left":`${z}px`},children:e.jsx("button",{className:"menu-item",type:"button",onClick:Qe,style:{fontFamily:"Torus Pro, Torus, ui-sans-serif, system-ui, sans-serif"},children:"Open .osz"})}),document.body)]})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:ke,"aria-label":"Go back",title:"Go back to previous page",children:e.jsx("span",{className:"mobile-coin-flip-text",children:"ed!"})}),e.jsxs("div",{className:"mobile-bottom-nav-right",children:[Q.length>0&&e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:D,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:Je,"aria-label":"Select Difficulty",title:"Select Difficulty","aria-expanded":n,children:e.jsx(Ee,{size:20})}),n&&be.createPortal(e.jsx("div",{ref:_,className:"settings-panel mobile-bottom-nav-menu",role:"menu",style:{"--mobile-menu-left":`${I}px`,minWidth:220},children:Q.map(v=>{const $=v.mode==="taiko"?Qt:v.mode==="mania"?Jt:v.mode==="catch"?Yt:Gt;return e.jsxs("button",{className:`mode-option ${O===v.path?"selected":""}`,type:"button",onClick:()=>Ye(v.path),children:[e.jsx("img",{className:"mode-icon",src:$,width:24,height:24,alt:""}),e.jsx("span",{children:v.version||"(Untitled)"})]},v.path)})}),document.body)]}),U&&e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:F,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:Ge,"aria-label":"Map Info",title:"Map Info","aria-expanded":Y,children:e.jsx(st,{size:20})}),Y&&be.createPortal(e.jsx("div",{ref:J,className:"menu-panel mobile-bottom-nav-menu",role:"dialog",style:{"--mobile-menu-left":`${L}px`,minWidth:280,maxWidth:"min(380px, calc(100vw - 24px))"},children:e.jsxs("div",{style:{padding:"4px 0"},children:[e.jsxs("div",{style:{fontSize:14,fontWeight:700,color:"var(--text)",marginBottom:8},children:[U.artist||"Artist"," – ",U.title||"Title"]}),e.jsxs("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:["Mapped by: ",U.mapper||"Unknown"]}),U.version&&e.jsxs("div",{style:{fontSize:12,color:"var(--muted)",marginBottom:4},children:["Difficulty: ",U.version]}),U.beatmapId&&e.jsx("div",{style:{fontSize:12,color:"var(--muted)",marginTop:8},children:e.jsx("a",{href:`https://osu.ppy.sh/beatmaps/${U.beatmapId}`,target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary)",textDecoration:"none"},children:"View on osu.ppy.sh →"})})]})}),document.body)]})]})]})]});const Se=()=>{const v=Date.now();if(f.current>0){const $=v-f.current;if($<C&&$>0){N.current&&(clearTimeout(N.current),N.current=null),u.current&&(clearTimeout(u.current),u.current=null),r.current&&(clearTimeout(r.current),r.current=null),p.current=v+T,f.current=0,c.current=!1,l(t.pathname),i("/editor");return}}v<p.current&&f.current===0||(N.current&&(clearTimeout(N.current),N.current=null),u.current&&(clearTimeout(u.current),u.current=null),f.current=v,u.current=setTimeout(()=>{u.current!==null&&(i(ie?"/mp/feed":"/md/feed"),u.current=null)},C),N.current=setTimeout(()=>{f.current>0&&(f.current=0,p.current=Date.now()+T),N.current=null},C))},Te=()=>{c.current=!1,r.current=setTimeout(()=>{c.current=!0,i("/")},500)},ve=()=>{r.current&&(clearTimeout(r.current),r.current=null),c.current&&setTimeout(()=>{c.current=!1},100)},Ve=v=>{if(g.current){v.preventDefault(),v.stopPropagation(),g.current=!1;return}if(c.current){v.preventDefault(),v.stopPropagation();return}Se()},Ke=v=>{if(ve(),c.current){v.preventDefault(),g.current=!0;return}v.preventDefault(),Se(),g.current=!0,setTimeout(()=>{g.current=!1},C+100)};return e.jsxs("nav",{className:"mobile-bottom-nav",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx(B,{to:ie?"/md/feed":"/mp/feed",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/feed"||t.pathname==="/md/feed"?"active":""}`,"aria-label":"Feed",children:e.jsx(Ee,{size:20})}),ie?e.jsx(B,{to:"/md/queues",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/md/queues")?"active":""}`,"aria-label":"Queues",children:e.jsx(it,{size:20})}):e.jsx(B,{to:"/mp/discover",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/discover"?"active":""}`,"aria-label":"Discover",children:e.jsx(at,{size:20})})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:Ve,onTouchStart:Te,onTouchEnd:Ke,onMouseDown:Te,onMouseUp:ve,onMouseLeave:ve,"aria-label":ie?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",title:ie?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",children:e.jsx("span",{className:"mobile-coin-flip-text",children:ie?"md!":"mp!"})}),e.jsxs("div",{className:"mobile-bottom-nav-right",children:[e.jsxs(B,{to:"/notifications",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/notifications"?"active":""}`,"aria-label":"Notifications",style:{position:"relative",overflow:"visible"},children:[e.jsx(Ie,{size:20}),$e>0&&e.jsx("div",{style:{position:"absolute",top:4,right:4,width:10,height:10,background:"#f87171",borderRadius:9999,zIndex:10,pointerEvents:"none",border:"2px solid var(--panel)",boxSizing:"border-box"}})]}),e.jsx("button",{className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/settings"?"active":""}`,onClick:He,onTouchStart:we,onTouchEnd:Ue,onMouseDown:we,onMouseUp:xe,onMouseLeave:xe,"aria-label":V!=null&&V.is_mod||V!=null&&V.is_admin?"Settings (long press for moderation)":"Settings",title:V!=null&&V.is_mod||V!=null&&V.is_admin?"Settings (long press for moderation)":"Settings",children:e.jsx(nt,{size:20})})]})]})}function Pe({isModdi:t,onClick:i}){return e.jsxs("button",{onClick:i,className:"title coin-flip-title",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"inherit"},title:"Switch section (double-click for editor)","aria-label":"Switch section (double-click for editor)",children:[e.jsx("span",{className:"coin-flip-front",children:t?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:t?"osu!mappi.ng":"osu!moddi.ng"})]})}function os({isNeutralPage:t,isEditor:i,isModdi:s,isMappi:o,onCoinFlipClick:l}){const c=ae().pathname==="/";return t&&!c?e.jsx(B,{to:"/",className:"title",children:s?"osu!moddi.ng":o?"osu!mappi.ng":"mappi!"}):c?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:4},children:e.jsx(Pe,{isModdi:s,onClick:l})}):i?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(B,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(rt,{size:18})}),e.jsx(B,{to:s?"/md/feed":"/mp/feed",className:"title",children:"osu!editi.ng"})]}):e.jsx("div",{style:{display:"flex",alignItems:"center",gap:4},children:e.jsx(Pe,{isModdi:s,onClick:l})})}function ls({isNeutralPage:t,isMappi:i,isModdi:s}){const o=ae();return e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[t&&o.pathname!=="/"&&e.jsx(B,{to:o.pathname==="/about"?"/":"/about",className:o.pathname==="/about"?"active":"",children:o.pathname==="/about"?"Home":"About"}),i&&e.jsxs(e.Fragment,{children:[e.jsx(B,{to:"/mp/feed",className:o.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(B,{to:"/mp/discover",className:o.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(B,{to:"/editor",className:o.pathname==="/editor"?"active":"",children:"Editor"})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx(B,{to:"/md/feed",className:o.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx(B,{to:"/md/queues",className:o.pathname.startsWith("/md/queues")?"active":"",children:"Queues"})]}),!i&&!s&&!t&&e.jsxs(e.Fragment,{children:[e.jsx(B,{to:"/mp/feed",className:o.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(B,{to:"/mp/discover",className:o.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(B,{to:"/editor",className:o.pathname==="/editor"?"active":"",children:"Editor"})]})]})}function cs(t,i,s,o){const l=ce(),{notify:r}=de(),[c,f]=w.useState(new Set);return{parseQueueInvite:y=>{if(!y)return null;try{const d=JSON.parse(y);if((d==null?void 0:d.type)==="queue_invite"&&(d!=null&&d.queue_id))return d}catch{}return null},handleAcceptInvite:async(y,d)=>{if(!c.has(y.id)){f(x=>new Set(x).add(y.id));try{await M(P.moddi.queueAccept(String(d)),{method:"POST"}),r("Invitation accepted!",{variant:"success"}),s.mutate(y.id),o(!1),l(`/md/queues/${d}`)}catch(x){r((x==null?void 0:x.message)||"Failed to accept invitation",{variant:"error"})}finally{f(x=>{const m=new Set(x);return m.delete(y.id),m})}}},handleDenyInvite:async(y,d)=>{if(!c.has(y.id)){f(x=>new Set(x).add(y.id));try{await M(P.moddi.queueDeny(String(d)),{method:"POST"}),r("Invitation declined",{variant:"success"}),s.mutate(y.id)}catch(x){r((x==null?void 0:x.message)||"Failed to decline invitation",{variant:"error"})}finally{f(x=>{const m=new Set(x);return m.delete(y.id),m})}}},handleMarkAllRead:async()=>{const y=t.filter(d=>d.id.startsWith("n:")||d.kind==="system"&&!d.read).map(d=>d.id);y.length>0&&i.mutate(y)},handleNotificationClick:async y=>{o(!1),i.mutate([y.id]);const d=typeof y.targetPath=="string"&&y.targetPath.trim().length>0?y.targetPath:null;if(d&&l(d),y.kind==="system"||y.id.startsWith("n:"))try{await M(P.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:[y.id]})})}catch{}},handleDeleteNotification:async(y,d)=>{y.stopPropagation(),s.mutate(d)},processing:c}}function ds({notifications:t,unreadCount:i,notifOpen:s,setNotifOpen:o,markReadMutation:l,deleteNotificationMutation:r,closeAllPanels:c}){const f=w.useRef(null),p=w.useRef(null),{parseQueueInvite:N,handleAcceptInvite:u,handleDenyInvite:g,handleMarkAllRead:C,handleNotificationClick:T,handleDeleteNotification:y,processing:d}=cs(t,l,r,o);We(f,p,s,()=>o(!1));const x=t.filter(m=>!(m.kind==="system"&&m.id.startsWith("b:")&&(m.expiresAt||0)<=Date.now()));return e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:3},children:[e.jsx("button",{ref:f,className:"icon-link",onClick:()=>{s||c(),o(!s)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(Ie,{size:18})}),i>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),s&&e.jsxs("div",{ref:p,className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(B,{to:"/notifications",onClick:()=>o(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:m=>m.currentTarget.style.opacity="1",onMouseLeave:m=>m.currentTarget.style.opacity="0.7",children:"View all"}),x.length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:C,children:e.jsx(fe,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[x.length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),x.map(m=>{const k=N(m.text),z=m.id.startsWith("b:"),j=k?"queue-invite":m.kind==="star"?"star":m.kind==="likes5"?"likes":m.kind==="comment"?"comment":m.kind==="inspiration"?"inspiration":m.kind==="reaction"?"reaction":z?"global":"system",D=m.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${j}`,role:"button",onClick:()=>!k&&T(m),children:[e.jsxs("div",{className:`notif-icon ${D?"deletable":""}`,"aria-hidden":"true",onClick:D&&!k?_=>y(_,m.id):void 0,title:D&&!k?"Remove":void 0,role:D&&!k?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:k?e.jsx(ot,{}):j==="star"?e.jsx(lt,{}):j==="likes"?e.jsx(ct,{}):j==="comment"?e.jsx(Ae,{}):j==="inspiration"?e.jsx(Ae,{}):j==="reaction"?e.jsx(dt,{}):j==="global"?e.jsx(ut,{}):null}),D&&!k?e.jsx("span",{className:"swap-trash",children:e.jsx(mt,{})}):null]}),e.jsx("div",{className:"notif-body",children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Queue Invitation"}),e.jsxs("div",{className:"notif-desc",children:[k.inviter_username," invited you to join queue: ",k.queue_name]}),d.has(m.id)?e.jsx("div",{className:"muted",style:{fontSize:11,marginTop:6},children:"Processing..."}):e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:_=>{_.stopPropagation(),u(m,k.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(fe,{size:12,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:_=>{_.stopPropagation(),g(m,k.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(Re,{size:12,style:{marginRight:4}}),"Decline"]})]})]}):m.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:z?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:m.text||""}),z&&m.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(m.expiresAt).toLocaleString()]}):null]}):m.kind==="comment"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Comment"}),e.jsx("div",{className:"notif-desc",children:m.text||"Someone commented on your post"})]}):m.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:m.text||"Someone is inspired by you!"})]}):m.kind==="reaction"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Reaction"}),e.jsx("div",{className:"notif-desc",children:m.text||"Someone raised their hand on your post!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:m.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:m.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},m.id)})]})]})]})}function us({quota:t,nowTick:i}){if(!(t!=null&&t.blocked))return null;const s=Math.max(0,Math.floor((((t==null?void 0:t.reset_at)??0)*1e3-Date.now())/1e3)),o=Math.floor(s/3600),l=Math.floor(s%3600/60),r=s%60,c=p=>String(p).padStart(2,"0"),f=o>0?`${o}:${c(l)}:${c(r)}`:`${l}:${c(r)}`;return e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(pt,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:f})]})}function ms({me:t,menuOpen:i,setMenuOpen:s,onLogout:o,closeAllPanels:l}){const r=w.useRef(null),c=w.useRef(null);return We(r,c,i,()=>s(!1)),e.jsxs(e.Fragment,{children:[e.jsxs("button",{ref:r,className:"icon-link",onClick:()=>{i||l(),s(!i)},title:t.username,"aria-label":"User menu","aria-expanded":i,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[t.avatar_url&&e.jsx("img",{src:t.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:t.username}),e.jsx(Fe,{size:14,style:{opacity:.8}})]}),i&&e.jsxs("div",{ref:c,className:"menu-panel",role:"menu",children:[e.jsx(B,{to:"/profile",className:"menu-item",onClick:()=>s(!1),children:"Profile"}),e.jsx(B,{to:"/settings",className:"menu-item",onClick:()=>s(!1),children:"Settings"}),((t==null?void 0:t.is_admin)||(t==null?void 0:t.is_mod))&&e.jsx(B,{to:"/moderation",className:"menu-item",onClick:()=>s(!1),children:"Moderation"}),e.jsx("button",{className:"menu-item",type:"button",onClick:o,children:"Log out"})]})]})}function ps({isNeutralPage:t,isEditor:i,isMappi:s,isModdi:o,onCoinFlipClick:l}){const r=ae(),c=ce(),{data:f,isLoading:p}=oe(),{data:N}=Pt(!!f),{data:u=[]}=Mt(!!f),g=De(),C=zt(),T=Be(),y=It(),{menuOpen:d,notifOpen:x,setMenuOpen:m,setNotifOpen:k,closeAllPanels:z,previousLocation:j,lastSection:D}=se(),_=r.pathname==="/settings",n=r.pathname==="/moderation",S=r.pathname==="/profile"||r.pathname.startsWith("/profile/"),I=_||n||S,q=()=>{c(j||(D==="moddi"?"/md/feed":D==="mappi"?"/mp/feed":"/"))},[Q,R]=b.useState(0);return b.useEffect(()=>{const O=setInterval(()=>R(X=>X+1),1e3);return()=>clearInterval(O)},[]),e.jsxs("header",{className:"top-nav",children:[I&&e.jsx("button",{onClick:q,className:"icon-link",title:"Go back","aria-label":"Go back",style:{width:"auto",height:"auto",padding:"4px",marginRight:4},children:e.jsx(Ne,{size:18})}),e.jsx(os,{isNeutralPage:t,isEditor:i,isModdi:o,isMappi:s,onCoinFlipClick:l}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),r.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(Vt,{})}):e.jsxs(e.Fragment,{children:[e.jsx(ls,{isNeutralPage:t,isMappi:s,isModdi:o}),e.jsx("div",{style:{marginLeft:"auto"}}),e.jsx("a",{className:"icon-link",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)","aria-label":"Join Discord",style:{marginRight:3,transform:"translateY(2px)"},children:e.jsx(ht,{size:18})}),f?e.jsxs("div",{className:"user-menu",children:[e.jsx(ds,{notifications:u,unreadCount:g,notifOpen:x,setNotifOpen:k,markReadMutation:T,deleteNotificationMutation:y,closeAllPanels:z}),e.jsx(us,{quota:N,nowTick:Q}),e.jsx(ms,{me:f,menuOpen:d,setMenuOpen:m,onLogout:()=>C.mutate(),closeAllPanels:z})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{window.location.href=ge+P.auth.login},disabled:p,children:p?"Checking…":"Login with osu!"})]})]})}function hs({title:t,onRefresh:i}){const{data:s}=oe(),o=ae(),l=ce(),{lastSection:r}=se(),[c,f]=b.useState(!0),[p,N]=b.useState(0),[u,g]=b.useState(!1),C=b.useRef(!1),T=b.useRef(0),[y,d]=b.useState(!1),x=b.useRef(null),{data:m=[]}=Rt(),k=Be(),{notify:z}=de();b.useEffect(()=>{const n=document.querySelector(".page");if(!n)return;let S=n.scrollTop,I=!1;const q=()=>{I||(I=!0,requestAnimationFrame(()=>{const Q=n.scrollTop,R=Q-S;Q<=12||R<-12?f(!0):R>12&&f(!1),S=Q,I=!1}))};return n.addEventListener("scroll",q,{passive:!0}),()=>n.removeEventListener("scroll",q)},[]),b.useEffect(()=>{const n=document.querySelector(".page");if(!n)return;const S=120,I=70,q=X=>{var F;u||(n.scrollTop<=0?(C.current=!0,T.current=((F=X.touches[0])==null?void 0:F.clientY)??0):C.current=!1)},Q=X=>{var Y;if(!C.current||u)return;const F=((Y=X.touches[0])==null?void 0:Y.clientY)??0,J=Math.max(0,F-T.current);if(J>0){const h=Math.min(S,J*.5);N(h)}},R=async()=>{try{if(g(!0),i)await i();else{window.location.reload();return}}finally{setTimeout(()=>{g(!1),N(0)},400)}},O=()=>{!C.current||u||(p>=I?R():N(0),C.current=!1)};return n.addEventListener("touchstart",q,{passive:!0}),n.addEventListener("touchmove",Q,{passive:!0}),n.addEventListener("touchend",O),n.addEventListener("touchcancel",O),()=>{n.removeEventListener("touchstart",q),n.removeEventListener("touchmove",Q),n.removeEventListener("touchend",O),n.removeEventListener("touchcancel",O)}},[p,u,i]);const{showBack:j,onBack:D}=b.useMemo(()=>{const n=o.pathname;if(/^\/mp\/feed\/.+/.test(n))return{showBack:!0,onBack:()=>l("/mp/feed")};if(/^\/md\/feed\/.+/.test(n))return{showBack:!0,onBack:()=>l("/md/feed")};if(/^\/md\/queues\/.+/.test(n))return{showBack:!0,onBack:()=>l("/md/queues")};if(n==="/profile"||n.startsWith("/profile/")){const S=r==="moddi"?"/md/feed":"/mp/feed";return{showBack:!0,onBack:()=>{window.history.length>2?l(-1):l(S)}}}return{showBack:!1,onBack:()=>{}}},[o.pathname,l,r]),_=o.pathname==="/notifications";return e.jsxs("div",{className:`mobile-page-header ${c?"":"collapsed"}`,children:[e.jsxs("div",{className:`mobile-page-header-inner ${c?"show":"hide"}`,children:[e.jsx("div",{className:"mobile-page-header-left",children:j?e.jsx("button",{className:"icon-link",onClick:D,"aria-label":"Back",title:"Back",style:{padding:4},children:e.jsx(Ne,{size:18})}):e.jsx(B,{to:"/profile",className:"icon-link","aria-label":"Profile",children:s!=null&&s.avatar_url?e.jsx("img",{src:s.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}):e.jsx("span",{style:{display:"inline-block",width:22,height:22,borderRadius:"50%",background:"var(--hover-overlay-strong)"}})})}),t?e.jsx("div",{className:"mobile-page-header-title",children:t}):null,e.jsx("div",{className:"mobile-page-header-right",children:_?e.jsx("button",{className:"icon-link","aria-label":"Mark all read",title:"Mark all read",style:{padding:4},onClick:()=>{const n=m.filter(S=>!S.read&&(S.id.startsWith("n:")||S.kind==="system"&&!S.id.startsWith("b:"))).map(S=>S.id);n.length!==0&&k.mutate(n,{onSuccess:()=>{z("All notifications marked as read",{variant:"success"})}})},children:e.jsx(fe,{size:18})}):(()=>{const n=o.pathname;let S=null;return n==="/mp/feed"?S="mappi-feed":n==="/md/feed"?S="moddi-feed":n==="/md/queues"?S="moddi-queues":n.startsWith("/md/queues/")&&(S="moddi-queue-detail"),S?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:x,className:"icon-link","aria-haspopup":"dialog","aria-expanded":y,onClick:()=>d(I=>!I),"aria-label":"Filters",title:"Filters",style:{padding:4},children:e.jsx(ft,{size:18})}),y&&e.jsx("div",{style:{position:"absolute",right:0,top:32},children:e.jsx(Ft,{context:S,onClose:()=>d(!1)})})]}):null})()})]}),e.jsx("div",{className:"mobile-ptr-indicator","aria-hidden":"true",style:{opacity:u||p>4?1:0,transform:`translate(-50%, calc(-100% + ${Math.min(p,70)}px))`},children:e.jsx("div",{className:`mobile-ptr-spinner ${u?"spin":p>60?"ready":""}`})})]})}function fs({readyCount:t}){return t===null?null:e.jsx("div",{className:"site-badge","aria-hidden":!1,children:e.jsxs("div",{className:"label",children:[t," videos ready"]})})}function gs(){const t=ae(),{lastSection:i}=se(),s=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/notifications"||t.pathname==="/settings"||t.pathname==="/moderation"||t.pathname==="/profile"||t.pathname.startsWith("/profile/"),o=t.pathname==="/editor",l=t.pathname.startsWith("/mp/")||s&&(i==="mappi"||t.pathname==="/"&&!i)||!s&&!t.pathname.startsWith("/md/")&&i==="mappi",r=t.pathname.startsWith("/md/")||s&&i==="moddi"||!s&&!t.pathname.startsWith("/mp/")&&i==="moddi",c=t.pathname.startsWith("/md/queues/")&&t.pathname!=="/md/queues";return{isNeutralPage:s,isEditor:o,isMappi:l,isModdi:r,isQueueDetail:c}}function xs(t){const i=ce(),s=ae(),{setPreviousLocation:o}=se(),l=w.useRef(0),r=w.useRef(0),c=w.useRef(null),f=500,p=2e3;return w.useEffect(()=>()=>{c.current&&clearTimeout(c.current)},[]),u=>{u.preventDefault();const g=Date.now();if(!(g<r.current)){if(c.current&&l.current>0){const C=g-l.current;if(C<f&&C>0){clearTimeout(c.current),c.current=null,r.current=g+p,l.current=0,o(s.pathname),i("/editor");return}}c.current&&(clearTimeout(c.current),c.current=null),l.current=g,c.current=setTimeout(()=>{r.current=Date.now()+p,c.current=null,l.current=0,i(t?"/mp/feed":"/md/feed")},f)}}}function vs(){const t=ae(),{notify:i}=de(),{data:s}=oe(),{lastSection:o,setLastSection:l,setPreviousLocation:r}=se(),{isNeutralPage:c,isEditor:f,isMappi:p,isModdi:N}=gs(),u=xs(N);b.useEffect(()=>{t.pathname==="/settings"||t.pathname==="/moderation"||t.pathname==="/profile"||t.pathname.startsWith("/profile/")||r(t.pathname)},[t.pathname,r]),b.useEffect(()=>{t.pathname==="/notifications"||t.pathname==="/settings"||t.pathname==="/moderation"||t.pathname==="/profile"||t.pathname.startsWith("/profile/")||(t.pathname.startsWith("/mp/")?l("mappi"):t.pathname.startsWith("/md/")&&l("moddi"))},[t.pathname,l]);const[g,C]=b.useState(null);b.useEffect(()=>{!s||!s.is_mod||(async()=>{try{const d=await M(P.admin.debugState,{requireAuth:!1}),x=Array.isArray(d==null?void 0:d.counts)?d.counts.find(m=>String(m.status)==="ready"):null;x&&C(Number(x.c)||0)}catch{}})()},[s]),b.useEffect(()=>{s&&!localStorage.getItem("welcomed")&&(i(`Welcome, ${s.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[s,i]),b.useEffect(()=>{if(typeof window>"u"||!re()||t.pathname==="/editor")return;const x=document.querySelector(".page");x&&(x.scrollTop=0)},[t.pathname]);const{showMobileHeader:T,headerTitle:y}=b.useMemo(()=>{const d=t.pathname;if(d==="/"||d==="/about"||d==="/editor"||d==="/mp/discover"||d==="/mobile")return{showMobileHeader:!1,headerTitle:""};const x=d.split("/").filter(Boolean),m=x[0]||"",k=x[1]||"";if(m==="mp"){if(k==="discover")return{showMobileHeader:!0,headerTitle:"Discover"};if(k==="feed")return{showMobileHeader:!0,headerTitle:x.length>2?"Post":"Feed"}}if(m==="md"){if(k==="feed")return{showMobileHeader:!0,headerTitle:x.length>2?"Post":"Feed"};if(k==="queues")return{showMobileHeader:!0,headerTitle:x.length>2?"Queue":"Queues"}}return d==="/notifications"?{showMobileHeader:!0,headerTitle:"Notifications"}:m==="profile"?{showMobileHeader:!0,headerTitle:"Profile"}:d==="/settings"?{showMobileHeader:!0,headerTitle:"Settings"}:d==="/moderation"?{showMobileHeader:!0,headerTitle:"Moderation"}:{showMobileHeader:!0,headerTitle:""}},[t.pathname]);return e.jsxs("div",{className:"app-shell","data-section":N?"moddi":p?"mappi":o==="moddi"?"moddi":o==="mappi"?"mappi":void 0,children:[e.jsx(ns,{paused:t.pathname==="/editor"}),e.jsx(ps,{isNeutralPage:c,isEditor:f,isMappi:p,isModdi:N,onCoinFlipClick:u}),e.jsxs("main",{className:`page ${t.pathname==="/editor"||t.pathname==="/mp/discover"?"fullscreen":""}`,children:[T&&e.jsx(hs,{title:y}),t.pathname==="/about"?e.jsx("div",{className:"card",children:e.jsx(_e,{})}):e.jsx(_e,{})]}),t.pathname!=="/editor"&&e.jsx(e.Fragment,{children:e.jsx(fs,{readyCount:g})}),t.pathname!=="/mobile"&&e.jsx(rs,{})]})}const bs="theme";function ys(){try{const t=localStorage.getItem(bs);if(t==="light"||t==="dark")return t}catch{}return null}function qe(t){if(!(typeof document>"u")){document.documentElement.setAttribute("data-theme",t);try{const i=document.querySelector('meta[name="theme-color"]');i&&(i.content=t==="light"?"#ffffff":"#1a1a1a")}catch{}}}function js(t="dark"){const i=ys()||t;qe(i)}function Ns(){const{data:t,isLoading:i}=oe(),s=!!t,o=ce(),{lastSection:l}=se(),[r,c]=b.useState(!1);return b.useEffect(()=>{if(typeof window>"u")return;const f=localStorage.getItem("hide_mobile_install_prompt")==="1",p=re()&&!je()&&!f;c(p)},[]),b.useEffect(()=>{je()&&o(l==="moddi"?"/md/feed":"/mp/feed",{replace:!0})},[l,o]),e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes shimmer {
          0% { background-position: -1000px 0; }
          100% { background-position: 1000px 0; }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
        
        .landing-container {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 80px 24px 24px;
          overflow-y: auto;
          z-index: 1;
        }
        
        .landing-hero {
          text-align: center;
          max-width: 900px;
          width: 100%;
          animation: fadeInUp 0.8s ease-out;
        }
        
        .landing-title {
          font-size: clamp(48px, 8vw, 96px);
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 24px;
          background: linear-gradient(135deg, #7dd3fc 0%, #a78bfa 50%, #34d399 100%);
          background-size: 200% 200%;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          animation: shimmer 3s ease-in-out infinite, fadeInUp 0.8s ease-out 0.2s both;
          letter-spacing: -0.02em;
        }
        
        .landing-subtitle {
          font-size: clamp(18px, 2.5vw, 28px);
          color: var(--muted);
          margin: 0 0 64px;
          font-weight: 400;
          animation: fadeInUp 0.8s ease-out 0.4s both;
          opacity: 0.9;
        }
        
        .landing-actions {
          display: flex;
          gap: 24px;
          justify-content: center;
          flex-wrap: wrap;
          animation: fadeInUp 0.8s ease-out 0.6s both;
        }
        
        .landing-btn {
          padding: 20px 32px;
          font-size: 20px;
          font-weight: 700;
          text-decoration: none;
          border-radius: 10px;
          transition: background 0.2s ease, border-color 0.2s ease;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          min-width: 180px;
          border: 1px solid transparent;
          cursor: pointer;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          text-rendering: optimizeLegibility;
          font-smooth: always;
        }
        
        .landing-btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
        
        .landing-btn-primary {
          background: #ffffff;
          color: #0b0d10;
          border: 1px solid rgba(0, 0, 0, 0.15);
        }
        
        .landing-btn-primary:hover {
          background: linear-gradient(90deg, rgba(255,255,255,1), rgba(248,249,255,0.98));
          border-color: rgba(0, 0, 0, 0.18);
        }
        
        .landing-btn-secondary {
          background: var(--panel);
          color: var(--text);
          border: 1px solid var(--border);
        }
        
        .landing-btn-secondary:hover {
          background: linear-gradient(90deg, rgba(125,211,252,0.14), rgba(167,139,250,0.16));
          border-color: var(--border-strong);
        }
        
        .landing-glow {
          position: absolute;
          width: 600px;
          height: 600px;
          border-radius: 50%;
          background: radial-gradient(circle, rgba(125, 211, 252, 0.15) 0%, transparent 70%);
          pointer-events: none;
          animation: pulse 4s ease-in-out infinite;
          z-index: -1;
        }
        
        .landing-glow-1 {
          top: 10%;
          left: 10%;
          animation-delay: 0s;
        }
        
        .landing-glow-2 {
          bottom: 10%;
          right: 10%;
          background: radial-gradient(circle, rgba(167, 139, 250, 0.15) 0%, transparent 70%);
          animation-delay: 2s;
        }
        
        .landing-subtitle-desktop {
          display: block;
        }
        
        .landing-subtitle-mobile {
          display: none;
        }
        
        .landing-actions-desktop {
          display: flex;
        }
        
        .landing-actions-mobile {
          display: none;
        }
        
        @media (max-width: 768px) {
          .landing-container {
            padding: 60px 16px 16px;
          }
          
          .landing-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .landing-btn {
            width: 100%;
            min-width: unset;
            padding: 18px 24px;
            font-size: 18px;
          }
          
          .landing-subtitle-desktop {
            display: none;
          }
          
          .landing-subtitle-mobile {
            display: block;
          }
          
          .landing-actions-desktop {
            display: none;
          }
          
          .landing-actions-mobile {
            display: flex;
          }
        }
      `}),e.jsxs("div",{className:"landing-container",children:[e.jsx("div",{className:"landing-glow landing-glow-1"}),e.jsx("div",{className:"landing-glow landing-glow-2"}),e.jsxs("div",{className:"landing-hero",children:[e.jsx("h1",{className:"landing-title",children:"mappi!"}),e.jsx("p",{className:"landing-subtitle landing-subtitle-desktop",children:"Navigate to.."}),!s&&e.jsx("p",{className:"landing-subtitle landing-subtitle-mobile",children:"You have to be logged in to use the site."}),s&&e.jsx("p",{className:"landing-subtitle landing-subtitle-mobile",children:"Navigate to.."}),e.jsxs("div",{className:"landing-actions landing-actions-desktop",children:[e.jsx(B,{to:"/mp/feed",className:"landing-btn landing-btn-secondary",children:"mappi.ng"}),e.jsx(B,{to:"/md/feed",className:"landing-btn landing-btn-secondary",children:"moddi.ng"})]}),!s&&e.jsx("div",{className:"landing-actions landing-actions-mobile",children:e.jsx("button",{className:"landing-btn landing-btn-primary",onClick:()=>{window.location.href=ge+P.auth.login},disabled:i,children:i?"Checking…":"Login with osu!"})}),s&&e.jsxs("div",{className:"landing-actions landing-actions-mobile",children:[e.jsx(B,{to:"/mp/feed",className:"landing-btn landing-btn-secondary",children:"mappi.ng"}),e.jsx(B,{to:"/md/feed",className:"landing-btn landing-btn-secondary",children:"moddi.ng"})]})]})]}),r&&e.jsxs("div",{className:"mobile-install-prompt",role:"dialog","aria-live":"polite",style:{position:"fixed",left:12,right:12,bottom:12,zIndex:50,display:"flex",alignItems:"center",gap:12,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:10,padding:"10px 12px"},children:[e.jsx("div",{style:{fontSize:14,lineHeight:1.3},children:"Install osumapp.ing to your home screen"}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[e.jsx("button",{className:"btn secondary",onClick:()=>{c(!1);try{localStorage.setItem("hide_mobile_install_prompt","1")}catch{}},"aria-label":"Dismiss",title:"Dismiss",children:"Dismiss"}),e.jsx(B,{to:"/mobile",className:"btn","aria-label":"How to install",children:"Install"})]})]})]})}function ws(){const{data:t}=oe(),{modeFilters:i}=se(),s=Object.entries(i).filter(([l,r])=>r).map(([l])=>l),o=s.length?s.join(","):"standard";return gt({queryKey:["mappi","feed",o],queryFn:async({pageParam:l=0})=>{const r=new URLSearchParams({limit:"20",offset:String(l),modes:o}),c=`${P.feed.recent}?${r.toString()}`;return await M(c)},enabled:!!t,initialPageParam:0,getNextPageParam:(l,r)=>{var p;const c=r.reduce((N,u)=>{var g;return N+(((g=u.items)==null?void 0:g.length)||0)},0);return(((p=l.items)==null?void 0:p.length)||0)===20?c:void 0}})}function ks(){const t=ae(),i=xt(),{data:s}=oe(),{modeFilters:o}=se(),{data:l,fetchNextPage:r,hasNextPage:c,isFetching:f,isFetchingNextPage:p,refetch:N}=ws(),u=w.useMemo(()=>(l==null?void 0:l.pages.flatMap(m=>m.items||[]))||[],[l]),g=w.useMemo(()=>{const m=Object.entries(o).filter(([z,j])=>j).map(([z])=>z.toLowerCase()),k=new Set(m.length?m:["standard"]);return u.filter(z=>{const j=String(z.mode||"standard").toLowerCase();return k.has(j)})},[u,o]);w.useEffect(()=>{t.pathname==="/mp/feed"&&N()},[t.pathname,N]),w.useEffect(()=>{const m=()=>{N()};return window.addEventListener("filterchange",m),()=>window.removeEventListener("filterchange",m)},[N]);const C=m=>{i.setQueryData(["mappi","feed"],k=>k&&{...k,pages:k.pages.map(z=>({...z,items:z.items.map(j=>j.id===m.id?m:j)}))})},T=m=>{i.setQueryData(["mappi","feed"],k=>k&&{...k,pages:k.pages.map(z=>({...z,items:z.items.filter(j=>j.id!==m)}))})},y=()=>{N()},d=f&&!p,x=c??!1;return e.jsxs("div",{className:"feed-container mappi-feed",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"title",style:{marginBottom:8},children:"Feed"}),e.jsx("div",{className:"muted",style:{fontSize:12,marginBottom:12},children:"Clips auto-delete after 60 days. Starred posts are preserved."}),e.jsx(Dt,{section:"mappi",onUpload:y})]}),e.jsx(Wt,{section:"mappi",onUpload:y}),e.jsx(Bt,{context:"mappi-feed"}),e.jsx("div",{className:"feed-list-wrapper",style:{borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)",paddingBottom:"100px"},children:e.jsxs("div",{className:"col",style:{gap:0},children:[g.length===0&&!d&&e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No videos match the selected filter."}),g.map(m=>e.jsx(Et,{post:m,section:"mappi",onUpdate:C,onDelete:T,me:s},m.id)),g.length>0&&x&&e.jsx("div",{style:{padding:"16px",textAlign:"center",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsx("button",{className:"btn secondary",onClick:()=>r(),disabled:p,children:p?"Loading...":"Load more"})})]})})]})}function Me(t){if(!t)return"standard";const i=String(t).toLowerCase().trim();return i==="osu"||i==="0"||i==="standard"?"standard":i==="taiko"||i==="1"?"taiko":i==="catch"||i==="fruits"||i==="2"?"catch":i==="mania"||i==="3"?"mania":"standard"}const Ss=({open:t,onClose:i,videoId:s,initialDescription:o,initialBeatmapUrl:l,onSave:r})=>{const[c,f]=w.useState(o||""),[p,N]=w.useState(l||""),[u,g]=w.useState(null),[C,T]=w.useState(null),[y,d]=w.useState(""),[x,m]=w.useState(!1),k=w.useRef(0);w.useEffect(()=>{t&&(f(o||""),N(l||""),g(null),T(null),d(""))},[t,o,l]),w.useEffect(()=>{if(!t)return;k.current&&window.clearTimeout(k.current);const j=(p||"").trim();if(!j){d(""),g(null),T(null);return}if(!/^https?:\/\/osu\.ppy\.sh\/(beatmapsets|beatmaps)\//i.test(j)){d(""),g(null),T(null);return}return k.current=window.setTimeout(async()=>{var _;try{let n;try{n=new URL(j)}catch{d("Invalid URL format");return}const S=n.hash.match(/#osu\/(\d+)/),I=S?S[1]:null;n.hash="";const Q={url:n.toString()};I&&(Q.beatmap_id=I);const R=await M(P.osu.resolveBeatmap+le(Q),{requireAuth:!1}),O=Array.isArray(R==null?void 0:R.diffs)?R.diffs:[];if(!O.length&&!R.setId){d("No difficulties found"),g(null),T(null);return}if(g({setId:Number(R.setId)||0,beatmapId:R.beatmapId??null,title:String(R.title||""),artist:String(R.artist||""),mapper:String(R.mapper||""),diffs:O}),O.length>0){const X=Number.isFinite(Number(R.beatmapId))?Number(R.beatmapId):Number((_=O[0])==null?void 0:_.id),F=O.find(Y=>Number(Y.id)===X)||O[0],J=Me(F==null?void 0:F.mode);T({beatmapId:Number(F==null?void 0:F.id)||null,version:String((F==null?void 0:F.version)||""),mode:J})}d("")}catch(n){d(`Failed to resolve: ${(n==null?void 0:n.message)||"Unknown error"}`),g(null),T(null)}},400),()=>{k.current&&window.clearTimeout(k.current)}},[p,t]);const z=async()=>{if(!x){m(!0);try{await M(P.videos.update(s),{method:"PATCH",body:JSON.stringify({description:c.slice(0,100),beatmap_url:p.trim()||void 0})});const j=!!p.trim();if(u||!j)try{await M(P.videos.update(s)+"/beatmap",{method:"PATCH",body:JSON.stringify({beatmapset_id:j&&u&&u.setId>0?u.setId:null,beatmap_id:j&&(C!=null&&C.beatmapId)?C.beatmapId:null,beatmap_version:j&&(C!=null&&C.version)?C.version:null,beatmap_title:j&&(u!=null&&u.title)?u.title:null,beatmap_artist:j&&(u!=null&&u.artist)?u.artist:null,beatmap_mapper:j&&(u!=null&&u.mapper)?u.mapper:null,beatmap_url:j?p.trim():null})})}catch(_){console.warn("Failed to update beatmap metadata:",_)}r(c,p.trim()||null),i()}catch(j){alert((j==null?void 0:j.message)||"Failed to update post")}finally{m(!1)}}};return t?e.jsxs("div",{className:"overlay",role:"dialog","aria-modal":"true",onClick:j=>j.target===j.currentTarget&&i(),children:[e.jsx("div",{className:"overlay-backdrop",onClick:i}),e.jsxs("div",{className:"overlay-card",style:{maxWidth:"600px",width:"calc(100vw - 24px)"},children:[e.jsx("button",{className:"overlay-close",onClick:i,"aria-label":"Close",children:e.jsx(Re,{size:18})}),e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",children:"Edit Post"}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Description (max 100 chars)"}),e.jsx("textarea",{maxLength:100,placeholder:"Description (max 100 chars)",value:c,onChange:j=>f(j.target.value),style:{height:64,resize:"vertical",background:"var(--panel-dark)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:8,padding:"8px 10px"}})]}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Beatmap URL (optional)"}),u?e.jsx("div",{className:"col",style:{gap:8},children:e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{className:"chip-btn",style:{cursor:"default"},children:[e.jsxs("strong",{style:{marginRight:6},children:[u.artist," – ",u.title]}),e.jsxs("span",{className:"muted",children:["by ",u.mapper]})]}),e.jsx("select",{value:(C==null?void 0:C.beatmapId)??u.beatmapId??void 0,onChange:j=>{const D=Number(j.target.value),_=(u==null?void 0:u.diffs.find(n=>Number(n.id)===D))||null;if(_){const n=Me(_.mode);T({beatmapId:D,version:_.version,mode:n})}},style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:8,padding:"8px 10px"},children:u.diffs.map(j=>e.jsxs("option",{value:j.id,children:[j.version," (",j.mode,")"]},j.id))}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>{g(null),T(null),N("")},children:"Clear"})]})}):e.jsx("input",{type:"url",placeholder:"Beatmap URL (optional) e.g. https://osu.ppy.sh/beatmapsets/...",value:p,onChange:j=>N(j.target.value),style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:8,padding:"8px 10px"}}),y&&e.jsx("div",{className:"muted",style:{color:"var(--danger)",fontSize:12},children:y})]}),e.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn secondary",onClick:i,disabled:x,children:"Cancel"}),e.jsx("button",{className:"btn",onClick:z,disabled:x,children:x?"Saving...":"Save"})]})]})]})]}):null};function ze(){const t=vt(),i=ce(),{notify:s}=de(),[o,l]=w.useState(null),[r,c]=w.useState(null),[f,p]=w.useState(""),[N,u]=w.useState([]),[g,C]=w.useState([]),[T,y]=w.useState([]),[d,x]=w.useState(""),[m,k]=w.useState(null),[z,j]=w.useState([]),[D,_]=w.useState(null),[n,S]=w.useState(""),[I,q]=w.useState([]),[Q,R]=w.useState(null),[O,X]=w.useState(!1),F=w.useMemo(()=>{const h=t.id?Number(t.id):null;return h?o?o.id===h:!1:!0},[t.id,o]);function J(h){const L=h.stream_uid||String(h.id),A=t.id?`/profile/${t.id}`:"/profile";i(`/mp/feed/${L}`,{state:{returnTo:A}})}w.useEffect(()=>{(async()=>{try{const h=await M(P.auth.me,{requireAuth:!1});l(h),h&&Array.isArray(h.inspirations)&&j(h.inspirations)}catch(h){p((h==null?void 0:h.message)||"Not logged in")}})()},[]),w.useEffect(()=>{(async()=>{try{const h=t.id?Number(t.id):null;if(h){const L=await M(P.users.get(h),{requireAuth:!1});c(L),x(L.about||""),Array.isArray(L.inspirations)&&j(L.inspirations);const A=await M(P.users.videos(h)+le({limit:"60"}),{requireAuth:!1});y(A.items||[]);const U=await M(P.users.likes(h)+le({limit:"60"}),{requireAuth:!1});C(U.items||[])}else{if(!o)return;c(o),x(o.about||""),Array.isArray(o.inspirations)&&j(o.inspirations);const L=await M(P.users.myVideos+le({limit:"50"}),{requireAuth:!1});u(L.items||[]);const A=await M(P.users.likes(o.id)+le({limit:"60"}),{requireAuth:!1});C(A.items||[])}}catch{}})()},[t.id,o]),w.useEffect(()=>{X(!1)},[r==null?void 0:r.id]);async function Y(h){try{const A=(await M(P.auth.me,{method:"PATCH",body:JSON.stringify({inspirations:h})})).user||r;c(A),Array.isArray(A==null?void 0:A.inspirations)&&j(A.inspirations),t.id||l(A)}catch{}}return w.useEffect(()=>{let h;return D!==null&&n.trim().length>=2?h=setTimeout(async()=>{try{const L=await M(P.osu.usersSearch(n),{requireAuth:!1});q(Array.isArray(L.items)?L.items:[])}catch{}},250):q([]),()=>{h&&clearTimeout(h)}},[n,D]),e.jsxs("div",{className:"feed-container profile-page",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"row wrap",style:{alignItems:"center"},children:r?e.jsxs(e.Fragment,{children:[r.avatar_url&&e.jsx("img",{src:r.avatar_url,width:48,height:48,style:{borderRadius:"50%"}}),e.jsxs("div",{className:"col",children:[e.jsxs("div",{className:"title",style:{display:"flex",alignItems:"center",gap:8},children:[r.username,r.osu_user_id&&e.jsx("a",{href:`https://osu.ppy.sh/users/${r.osu_user_id}`,target:"_blank",rel:"noreferrer",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:"var(--text)",opacity:.7,cursor:"pointer",padding:0,textDecoration:"none",transition:"opacity 0.2s ease"},onMouseEnter:h=>h.currentTarget.style.opacity="1",onMouseLeave:h=>h.currentTarget.style.opacity="0.7",title:"View osu! profile","aria-label":"View osu! profile",children:e.jsx(bt,{size:16})})]}),e.jsxs("div",{className:"muted",children:["ID: ",r.id]})]}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[!F&&z.length>0&&e.jsx("span",{className:"muted",style:{fontSize:12},children:"inspired by:"}),z.map((h,L)=>F?e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>R(h.id),onMouseLeave:()=>R(null),children:[e.jsx("button",{className:"insp-avatar",onClick:()=>{if(!confirm("Remove this inspiration?"))return;const A=z.filter((U,ne)=>ne!==L);j(A),Y(A)},children:e.jsx("img",{src:h.avatar_url,alt:h.username})}),Q===h.id&&e.jsxs("div",{className:"insp-tooltip",children:[h.username," — click to remove"]})]},h.id):e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>R(h.id),onMouseLeave:()=>R(null),children:[e.jsx("a",{href:`https://osu.ppy.sh/users/${h.id}`,target:"_blank",rel:"noreferrer",className:"insp-avatar link",children:e.jsx("img",{src:h.avatar_url,alt:h.username})}),Q===h.id&&e.jsx("div",{className:"insp-tooltip",children:h.username})]},h.id)),F&&z.length<3&&new Array(3-z.length).fill(0).map((h,L)=>e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>R(-L-1),onMouseLeave:()=>R(null),children:[e.jsx("button",{className:"insp-add",onClick:()=>{_(L),S(""),q([])},children:"+"}),Q===-L-1&&e.jsx("div",{className:"insp-tooltip",children:"Add inspiration"}),D===L&&e.jsxs("div",{className:"insp-pop",role:"dialog","aria-label":"Search osu! users",children:[e.jsx("input",{autoFocus:!0,placeholder:"Search username",value:n,onChange:A=>S(A.target.value)}),e.jsxs("div",{className:"insp-results",children:[I.length===0&&n.trim().length>=2&&e.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:"No results"}),I.map(A=>e.jsxs("button",{className:"insp-result",onClick:()=>{if(o&&Number(o.osu_user_id)===Number(A.id)){s("Kinda based, but no.",{variant:"warn"}),_(null);return}if(z.some(ne=>ne.id===A.id)){_(null);return}const U=[...z,{id:A.id,username:A.username,avatar_url:A.avatar_url}].slice(0,3);j(U),_(null),Y(U)},children:[e.jsx("img",{src:A.avatar_url,alt:"avatar"}),e.jsx("span",{children:A.username})]},A.id))]}),e.jsx("button",{className:"insp-close",onClick:()=>_(null),children:"Close"})]})]},`slot-${L}`))]}),F&&e.jsx("div",{className:"muted",style:{fontSize:12},children:"Who inspires you?"})]})]}):e.jsx("div",{className:"muted",children:f||"Loading…"})}),e.jsxs("div",{className:"col",style:{marginTop:12,gap:4},children:[e.jsx("div",{className:"title",children:"About"}),F?e.jsx("div",{className:"col",style:{gap:6},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx("textarea",{value:d,onChange:h=>x(h.target.value),rows:3,maxLength:1e3,placeholder:"Write something about yourself (max 1000 chars)",style:{paddingRight:36}}),e.jsx("button",{className:"icon-link",onClick:async()=>{try{const h=await M(P.auth.me,{method:"PATCH",body:JSON.stringify({about:d})});c(h.user||r),l(h.user||o)}catch{}},"aria-label":"Save about",title:"Save",style:{position:"absolute",right:8,bottom:8,padding:4,color:"rgba(255,255,255,0.55)"},children:e.jsx(fe,{size:16})})]})}):(()=>{const h=((r==null?void 0:r.about)||"").trim()||"No bio.",L=h.length>200,A=L&&!O?h.slice(0,200)+"...":h;return e.jsxs("div",{className:"col",style:{gap:4},children:[e.jsx("div",{className:"muted",style:{whiteSpace:"pre-wrap"},children:A}),L&&e.jsx("button",{onClick:()=>X(!O),style:{display:"flex",alignItems:"center",gap:4,background:"transparent",border:"none",color:"var(--muted)",cursor:"pointer",padding:0,fontSize:14,fontFamily:"inherit",marginTop:4},children:O?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show less"}),e.jsx(yt,{size:14})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show more"}),e.jsx(Fe,{size:14})]})})]})})()]})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Profile sections",children:[e.jsx("button",{role:"tab","aria-selected":!0,className:"profile-tab active","data-tab":"uploads",onClick:h=>{const L=h.currentTarget.closest(".profile-tabs-unified");L.querySelectorAll(".profile-tab").forEach(U=>{U.classList.remove("active"),U.setAttribute("aria-selected","false")}),h.currentTarget.classList.add("active"),h.currentTarget.setAttribute("aria-selected","true"),L.querySelector(".profile-tabs-content").setAttribute("data-active","uploads")},children:"Uploads"}),e.jsx("button",{role:"tab","aria-selected":!1,className:"profile-tab","data-tab":"likes",onClick:h=>{const L=h.currentTarget.closest(".profile-tabs-unified");L.querySelectorAll(".profile-tab").forEach(U=>{U.classList.remove("active"),U.setAttribute("aria-selected","false")}),h.currentTarget.classList.add("active"),h.currentTarget.setAttribute("aria-selected","true"),L.querySelector(".profile-tabs-content").setAttribute("data-active","likes")},children:"Likes"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":"uploads",children:[e.jsx("div",{className:"panel uploads",hidden:!1,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[(F?N:T).length===0&&e.jsx("div",{className:"profile-empty-state",children:"No uploads yet."}),(F?N:T).map(h=>(F&&r?(r.id,r.username,r.avatar_url,r.is_admin,r.is_mod):h.uploader,e.jsxs("button",{className:"recent-cell",onClick:()=>J({...h}),children:[h.poster_url?e.jsx("img",{className:"recent-thumb",src:h.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsx("div",{className:"cell-footer",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(jt,{size:12}),e.jsx("span",{children:h.likes_count??0})]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(Nt,{size:12}),e.jsx("span",{children:h.comments_count??0})]})]})})]},h.id)))]})})}),e.jsx("div",{className:"panel likes",hidden:!0,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[g.length===0&&e.jsx("div",{className:"profile-empty-state",children:"No likes yet."}),g.map(h=>{var L,A;return e.jsxs("button",{className:"recent-cell",onClick:()=>J(h),children:[h.poster_url?e.jsx("img",{className:"recent-thumb",src:h.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsxs("div",{className:"cell-footer",children:[((L=h.uploader)==null?void 0:L.avatar_url)&&e.jsx("img",{className:"cell-avatar",src:h.uploader.avatar_url,alt:"avatar"}),e.jsx("span",{className:"cell-name",children:(A=h.uploader)==null?void 0:A.username})]})]},h.id)})]})})})]})]}),m&&e.jsx(Ss,{open:!!m,onClose:()=>k(null),videoId:m.id,initialDescription:m.description,initialBeatmapUrl:m.beatmap_url,onSave:(h,L)=>{u(N.map(A=>A.id===m.id?{...A,description:h||null,beatmap_url:L}:A)),k(null)}}),e.jsx("style",{children:`
        .insp-avatar { width: 32px; height: 32px; border-radius: 9999px; padding: 0; border: none; overflow: hidden; cursor: pointer; background: var(--hover-overlay); display: inline-flex; align-items: center; justify-content: center; }
        .insp-avatar.link { background: transparent; border: 1px solid var(--divider); }
        .insp-avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .insp-add { width: 32px; height: 32px; border-radius: 9999px; border: 1px dashed var(--divider); background: transparent; color: var(--text); font-weight: 700; cursor: pointer; }
        .insp-add:hover { border-color: var(--border-strong); }
        .insp-tooltip {
          position: absolute;
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
          background: rgba(18, 20, 24, 0.95);
          color: var(--text, #e5e7eb);
          border: 1px solid var(--divider);
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 14px;
          white-space: nowrap;
          z-index: 10000;
          pointer-events: none;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
        }
        .insp-tooltip::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          width: 0;
          height: 0;
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-bottom: 5px solid rgba(18, 20, 24, 0.95);
        }
        .insp-pop { position: absolute; right: 0; top: 40px; width: 260px; background: var(--panel); border: 1px solid var(--divider); border-radius: 10px; padding: 8px; z-index: 10; }
        .insp-pop input { width: 100%; padding: 8px 10px; border-radius: 8px; border: 1px solid var(--divider); background: var(--panel-dark); color: var(--text); outline: none; box-sizing: border-box; display: block; }
        .insp-results { margin-top: 6px; max-height: 220px; overflow: auto; display: grid; gap: 4px; }
        .insp-result { display: grid; grid-template-columns: 24px 1fr; gap: 8px; align-items: center; padding: 6px 8px; border-radius: 8px; border: 1px solid transparent; background: transparent; color: var(--text); cursor: pointer; text-align: left; }
        .insp-result:hover { background: var(--hover-overlay); border-color: var(--divider); }
        .insp-result img { width: 24px; height: 24px; border-radius: 9999px; object-fit: cover; }
        .insp-close { margin-top: 6px; width: 100%; padding: 6px 8px; border-radius: 8px; border: 1px solid var(--divider); background: var(--hover-overlay); color: var(--text); cursor: pointer; }
      `})]})}function Ts(){var L,A,U,ne,ue;const[t,i]=w.useState(null),[s,o]=w.useState([]),[l,r]=w.useState(""),[c,f]=w.useState([]),[p,N]=w.useState(null),[u,g]=w.useState([]),[C,T]=w.useState("all"),[y,d]=w.useState("approvals"),[x,m]=w.useState(null),[k,z]=w.useState(""),[j,D]=w.useState(!1),{notify:_}=de(),[n,S]=w.useState(null),[I,q]=w.useState(!1);w.useEffect(()=>{(async()=>{try{const a=await M(P.auth.me,{requireAuth:!1});if(i(a),a!=null&&a.is_admin)try{const E=await M(P.admin.settingsModeration,{requireAuth:!1});m(!!E.require_approval)}catch{}}catch{}try{const a=await M(P.admin.videosPending+le({limit:"50"}),{requireAuth:!1});o(a.items||[])}catch{}})()},[]);async function Q(){q(!0);try{const a=await M(P.admin.analytics,{requireAuth:!1});S(a)}finally{q(!1)}}async function R(){try{const a=await M(P.admin.usersSearch(l),{requireAuth:!1});f(a.items||[])}catch{}}async function O(a){N(a),g([]);try{const E=await M(P.admin.userVideos(a.id)+le({limit:"50"}),{requireAuth:!1});g(E.items||[])}catch{}}async function X(a,E){try{const Z=await M(P.admin.user(a.id),{method:"PATCH",body:JSON.stringify({is_mod:E})}),G=(Z==null?void 0:Z.user)||{...a,is_mod:E};_(E?"Granted moderation":"Revoked moderation",{variant:E?"success":"warn"}),N(G),f(c.map(ie=>ie.id===a.id?G:ie))}catch{alert("Failed to update")}}const F=!!(t!=null&&t.is_admin||t!=null&&t.is_mod),J=!!(t!=null&&t.is_admin);if(!F)return e.jsx("div",{className:"muted",children:"You do not have access."});const Y=s.filter(a=>!a.flagged_only),h=s.filter(a=>!!a.flagged_only);return e.jsx("div",{className:"feed-container moderation-container",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:e.jsxs("div",{className:"feed-header",style:{paddingTop:12,paddingBottom:0},children:[e.jsxs("div",{className:"moderation-header",children:[e.jsx("div",{className:"moderation-title",children:"Moderation"}),e.jsx("div",{className:"muted moderation-description",children:"Review approvals, manage users, and monitor moderation metrics from one place."})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Moderation tabs",style:{display:"flex",flexWrap:re()?"nowrap":"wrap",gap:re()?"2px":"4px",overflowX:re()?"auto":void 0},children:[e.jsx("button",{role:"tab","aria-selected":y==="approvals",className:`profile-tab ${y==="approvals"?"active":""}`,"data-tab":"approvals",onClick:a=>{const E=a.currentTarget.closest(".profile-tabs-unified");E.querySelectorAll(".profile-tab").forEach(G=>{G.classList.remove("active"),G.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),E.querySelector(".profile-tabs-content").setAttribute("data-active","approvals"),d("approvals")},children:"Approvals"}),(J||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="manage",className:`profile-tab ${y==="manage"?"active":""}`,"data-tab":"manage",onClick:a=>{const E=a.currentTarget.closest(".profile-tabs-unified");E.querySelectorAll(".profile-tab").forEach(G=>{G.classList.remove("active"),G.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),E.querySelector(".profile-tabs-content").setAttribute("data-active","manage"),d("manage")},children:"Manage"}),(J||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="analytics",className:`profile-tab ${y==="analytics"?"active":""}`,"data-tab":"analytics",onClick:a=>{const E=a.currentTarget.closest(".profile-tabs-unified");E.querySelectorAll(".profile-tab").forEach(G=>{G.classList.remove("active"),G.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),E.querySelector(".profile-tabs-content").setAttribute("data-active","analytics"),d("analytics"),n||Q()},children:"Analytics"}),(J||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="message",className:`profile-tab ${y==="message"?"active":""}`,"data-tab":"message",onClick:a=>{const E=a.currentTarget.closest(".profile-tabs-unified");E.querySelectorAll(".profile-tab").forEach(G=>{G.classList.remove("active"),G.setAttribute("aria-selected","false")}),a.currentTarget.classList.add("active"),a.currentTarget.setAttribute("aria-selected","true"),E.querySelector(".profile-tabs-content").setAttribute("data-active","message"),d("message")},children:"Message"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":y,children:[e.jsx("div",{className:"panel approvals",hidden:y!=="approvals",children:e.jsxs("div",{className:"col",style:{gap:24,paddingTop:8},children:[e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",flexWrap:"wrap",gap:8},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)"},children:"Pending approvals"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[Y.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",style:{maxHeight:"60vh"},children:[Y.length===0&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"Nothing pending."}),Y.map(a=>e.jsxs("div",{className:"col moderation-video-card",children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:12},children:[a.poster_url?e.jsx("img",{src:a.poster_url,width:80,height:45,style:{objectFit:"cover",borderRadius:8,flexShrink:0}}):e.jsx("div",{style:{width:80,height:45,borderRadius:8,background:"#0f1217",flexShrink:0}}),e.jsxs("div",{className:"col",style:{minWidth:0,flex:1,gap:6},children:[e.jsx("div",{style:{fontSize:14,lineHeight:1.4,wordBreak:"break-word"},title:a.description||"",children:a.description||"No description."}),e.jsxs("div",{className:"muted",style:{fontSize:12,lineHeight:1.4},children:[e.jsxs("div",{children:["uploader: ",a.username]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:2},children:[a.needs_review?e.jsx("span",{style:{color:"#f59e0b"},children:"(needs review)"}):e.jsx("span",{style:{color:"#60a5fa"},children:"(pending)"}),typeof a.flags_count=="number"&&a.flags_count>0?e.jsxs("span",{className:"muted",children:["• ",a.flags_count," reports"]}):null]})]})]})]}),e.jsxs("div",{className:"row wrap",style:{gap:8},children:[e.jsx("button",{className:"btn secondary",style:{flex:1,minWidth:"calc(33.333% - 6px)"},onClick:async()=>{try{await M(P.admin.videosReject(a.id),{method:"POST"}),o(s.filter(E=>E.id!==a.id)),_("Rejected",{variant:"warn"})}catch{}},children:"Reject"}),e.jsx("button",{className:"btn secondary",style:{flex:1,minWidth:"calc(33.333% - 6px)"},onClick:async()=>{try{await M(P.admin.videosApprove(a.id),{method:"POST"}),o(s.filter(E=>E.id!==a.id)),_("Approved",{variant:"success"})}catch{}},children:"Approve"}),e.jsx("button",{className:"btn secondary",style:{flex:1,minWidth:"calc(33.333% - 6px)"},onClick:async()=>{if(confirm("Permanently delete this video?"))try{await M(P.videos.delete(a.id),{method:"DELETE"}),o(s.filter(E=>E.id!==a.id)),_("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]},a.id))]})]}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",flexWrap:"wrap",gap:8},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)"},children:"Flagged (FYI)"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[h.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",style:{maxHeight:"60vh"},children:[h.length===0&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"No flagged items."}),h.map(a=>e.jsxs("div",{className:"col moderation-video-card flagged",children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:12},children:[a.poster_url?e.jsx("img",{src:a.poster_url,width:80,height:45,style:{objectFit:"cover",borderRadius:8,flexShrink:0}}):e.jsx("div",{style:{width:80,height:45,borderRadius:8,background:"#0f1217",flexShrink:0}}),e.jsxs("div",{className:"col",style:{minWidth:0,flex:1,gap:6},children:[e.jsx("div",{style:{fontSize:14,lineHeight:1.4,wordBreak:"break-word"},title:a.description||"",children:a.description||"No description."}),e.jsxs("div",{className:"muted",style:{fontSize:12,lineHeight:1.4},children:[e.jsxs("div",{children:["uploader: ",a.username]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:2},children:[e.jsx("span",{style:{color:"#9ca3af"},children:"(flagged)"}),typeof a.flags_count=="number"&&a.flags_count>0?e.jsxs("span",{className:"muted",children:["• ",a.flags_count," reports"]}):null]})]})]})]}),e.jsx("div",{className:"row",children:e.jsx("button",{className:"btn secondary",style:{width:"100%"},onClick:async()=>{if(confirm("Permanently delete this video?"))try{await M(P.videos.delete(a.id),{method:"DELETE"}),o(s.filter(E=>E.id!==a.id)),_("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})})]},a.id))]}),e.jsx("div",{className:"muted",style:{fontSize:12,marginTop:8,padding:"0 4px"},children:"Flagged items don't require approval; use Delete only if necessary."})]})]})}),e.jsx("div",{className:"panel manage",hidden:y!=="manage",children:e.jsxs("div",{className:"col",style:{gap:24,paddingTop:8},children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)",marginBottom:8},children:"User management"}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:l,onChange:a=>r(a.target.value),onKeyDown:a=>{a.key==="Enter"&&R()},className:"moderation-input",style:{width:"100%",fontSize:16,color:"inherit"}}),e.jsx("button",{className:"btn secondary",onClick:R,style:{width:"100%",minHeight:"44px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:12,maxHeight:"40vh"},children:e.jsx("div",{className:"col",style:{gap:12},children:c.map(a=>e.jsxs("button",{className:"btn secondary moderation-user-result",onClick:()=>O(a),style:{justifyContent:"flex-start",textAlign:"left",alignItems:"center"},children:[a.avatar_url&&e.jsx("img",{src:a.avatar_url,width:24,height:24,style:{borderRadius:"50%",flexShrink:0}}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0,gap:2,alignItems:"flex-start"},children:[e.jsx("span",{style:{fontWeight:500},children:a.username}),e.jsxs("span",{className:"muted",style:{fontSize:12},children:["id ",a.id," • osu ",a.osu_user_id]})]}),a.is_admin?e.jsx("span",{style:{color:"var(--accent)",fontSize:12,flexShrink:0},children:"admin"}):a.is_mod?e.jsx("span",{style:{color:"var(--accent)",fontSize:12,flexShrink:0},children:"mod"}):a.is_blacklisted?e.jsx("span",{style:{color:"#f87171",fontSize:12,flexShrink:0},children:"blacklisted"}):null]},a.id))})})]}),p?e.jsxs("div",{className:"col",style:{minWidth:0,borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:24,gap:16},children:[e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:12,flexWrap:"wrap"},children:[p.avatar_url&&e.jsx("img",{src:p.avatar_url,width:40,height:40,style:{borderRadius:"50%",flexShrink:0}}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0,gap:4},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)"},children:p.username}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["id ",p.id," • osu ",p.osu_user_id]})]})]}),e.jsxs("div",{className:"col",style:{gap:10},children:[J&&!p.is_admin&&(p.is_mod?e.jsx("button",{className:"btn secondary",style:{width:"100%",minHeight:"44px"},onClick:()=>X(p,!1),children:"Revoke moderation"}):e.jsx("button",{className:"btn secondary",style:{width:"100%",minHeight:"44px"},onClick:()=>X(p,!0),children:"Grant moderation"})),!p.is_admin&&(p.is_blacklisted?e.jsx("button",{className:"btn secondary",style:{width:"100%",minHeight:"44px"},onClick:async()=>{try{await M(P.admin.user(p.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!1})}),N({...p,is_blacklisted:!1}),_("User unblacklisted",{variant:"success"})}catch{alert("Failed")}},children:"Unblacklist"}):e.jsx("button",{className:"btn secondary",style:{width:"100%",minHeight:"44px"},onClick:async()=>{try{await M(P.admin.user(p.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!0})}),N({...p,is_blacklisted:!0}),_("User blacklisted",{variant:"warn"})}catch{alert("Failed")}},children:"Blacklist"}))]}),p.is_admin&&e.jsx("div",{className:"caption",style:{marginTop:4},children:"Admins always retain access"})]}),e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",flexWrap:"wrap",gap:8},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)"},children:"Uploads"}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("button",{className:"btn secondary compact",style:{minHeight:"36px",padding:"8px 16px"},onClick:()=>T("all"),children:"All"}),e.jsx("button",{className:"btn secondary compact",style:{minHeight:"36px",padding:"8px 16px"},onClick:()=>T("review"),children:"Review"})]})]}),e.jsxs("div",{className:"scroll-panel sm",style:{maxHeight:"50vh"},children:[u.length===0&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"No uploads."}),u.filter(a=>{if(C==="all")return!0;const E=(x?!a.approved_at:!1)&&a.status==="ready",Z=!!a.needs_review;return E||Z}).map(a=>e.jsxs("div",{className:"col moderation-video-card",children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:12},children:[a.poster_url?e.jsx("img",{src:a.poster_url,width:80,height:45,style:{objectFit:"cover",borderRadius:8,flexShrink:0}}):e.jsx("div",{style:{width:80,height:45,borderRadius:8,background:"#0f1217",flexShrink:0}}),e.jsxs("div",{className:"col",style:{minWidth:0,flex:1,gap:6},children:[e.jsx("div",{style:{fontSize:14,lineHeight:1.4,wordBreak:"break-word"},title:a.description||"",children:a.description||"No description."}),e.jsxs("div",{className:"muted",style:{fontSize:12,lineHeight:1.4},children:[e.jsxs("div",{children:[a.status.toUpperCase()," • ",new Date(a.created_at*1e3).toLocaleString()]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap",marginTop:2},children:[a.needs_review?e.jsx("span",{style:{color:"#f59e0b"},children:"(purgatory)"}):null,x&&!a.approved_at&&a.status==="ready"?e.jsx("span",{style:{color:"#60a5fa"},children:"(pending)"}):null]})]})]})]}),e.jsxs("div",{className:"row wrap",style:{gap:8,alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{className:"row",style:{gap:6,alignItems:"center"},children:[e.jsx("span",{className:"muted",style:{fontSize:14},children:a.likes_count??0}),e.jsx("span",{style:{color:"var(--accent)",fontSize:16},children:"★"})]}),e.jsxs("div",{className:"row",style:{gap:8},children:[(J||(t==null?void 0:t.is_mod))&&(!!a.needs_review||x&&!a.approved_at&&a.status==="ready")&&e.jsx("button",{className:"btn secondary compact",onClick:async()=>{try{await M(P.admin.videosApprove(a.id),{method:"POST"}),g(u.map(E=>E.id===a.id?{...E,approved_at:Math.floor(Date.now()/1e3),needs_review:0}:E)),_("Approved",{variant:"success"})}catch{alert("Approve failed")}},children:"Approve"}),(J||(t==null?void 0:t.is_mod))&&e.jsx("button",{className:"btn secondary compact",onClick:async()=>{if(confirm("Permanently delete this video?"))try{await M(P.videos.delete(a.id),{method:"DELETE"}),g(u.filter(E=>E.id!==a.id)),_("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]})]},a.id))]})]})]}):e.jsx("div",{className:"muted",style:{padding:"20px",textAlign:"center"},children:"Select a user to view details and uploads."})]})}),e.jsx("div",{className:"panel message",hidden:y!=="message",children:e.jsxs("div",{className:"col",style:{gap:24,paddingTop:8},children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)",marginBottom:8},children:"Send a system message"}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:l,onChange:a=>r(a.target.value),onKeyDown:a=>{a.key==="Enter"&&R()},className:"moderation-input",style:{width:"100%",fontSize:16,color:"inherit"}}),e.jsx("button",{className:"btn secondary",onClick:R,style:{width:"100%",minHeight:"44px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:12,maxHeight:"30vh"},children:e.jsx("div",{className:"col",style:{gap:12},children:c.map(a=>e.jsxs("button",{className:`btn secondary moderation-user-result ${(p==null?void 0:p.id)===a.id,""}`,onClick:()=>N(a),style:{justifyContent:"flex-start",textAlign:"left",alignItems:"center",border:(p==null?void 0:p.id)===a.id?"2px solid var(--accent)":void 0},children:[a.avatar_url&&e.jsx("img",{src:a.avatar_url,width:24,height:24,style:{borderRadius:"50%",flexShrink:0}}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0,gap:2,alignItems:"flex-start"},children:[e.jsx("span",{style:{fontWeight:500},children:a.username}),e.jsxs("span",{className:"muted",style:{fontSize:12},children:["id ",a.id," • osu ",a.osu_user_id]})]}),(p==null?void 0:p.id)===a.id&&e.jsx("span",{style:{color:"var(--accent)",fontSize:12,flexShrink:0},children:"selected"})]},a.id))})})]}),e.jsxs("div",{className:"col",style:{minWidth:0,borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:24,gap:16},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)"},children:"Compose"}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:12,padding:"8px 0"},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:a=>D(a.currentTarget.checked),style:{width:20,height:20,cursor:"pointer",minWidth:20,minHeight:20}}),e.jsx("span",{className:"muted",style:{fontSize:14},children:"Send to all users (global)"})]}),e.jsx("textarea",{placeholder:"Message (shown in notifications)",className:"moderation-input",style:{height:120,resize:"vertical",width:"100%",fontSize:16,color:"inherit",fontFamily:"inherit"},value:k,onChange:a=>z(a.target.value)}),e.jsx("button",{className:"btn secondary",style:{width:"100%",minHeight:"44px"},onClick:()=>{const a=(k||"").trim();if(!a){alert("Enter a message");return}(async()=>{try{const E={text:a,global:j};!j&&(p!=null&&p.id)&&(E.user_id=p.id),await M(P.admin.notificationsSystem,{method:"POST",body:JSON.stringify(E)}),z(""),_("Message sent",{variant:"success"})}catch{alert("Failed to send")}})()},children:"Send"}),e.jsx("div",{className:"caption",style:{marginTop:4,fontSize:12,lineHeight:1.4},children:'System messages persist for 24 hours and show an "Expires at" timestamp.'})]})]})}),e.jsx("div",{className:"panel analytics",hidden:y!=="analytics",children:e.jsxs("div",{className:"col",style:{gap:24,paddingTop:8},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)"},children:"Analytics"}),I&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"Loading…"}),!I&&!n&&e.jsx("div",{className:"muted",style:{padding:"12px"},children:"No data."}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"moderation-stats-grid",children:[e.jsx(te,{label:"Users",value:n.totals.users_total}),e.jsx(te,{label:"Admins",value:n.totals.users_admin}),e.jsx(te,{label:"Mods",value:n.totals.users_mod}),e.jsx(te,{label:"Blacklisted",value:n.totals.users_blacklisted}),e.jsx(te,{label:"Videos",value:n.totals.videos_total}),e.jsx(te,{label:"Ready",value:n.totals.videos_ready}),e.jsx(te,{label:"Pending",value:n.totals.pending_count}),e.jsx(te,{label:"Purgatory",value:n.totals.purgatory_count}),e.jsx(te,{label:"Likes",value:n.totals.likes_total}),e.jsx(te,{label:"Flags",value:n.totals.flags_total})]}),e.jsxs("div",{className:"col",style:{gap:20,marginTop:8},children:[e.jsx(ye,{title:"New users (30d)",series:n.series.users,color:"#60a5fa"}),e.jsx(ye,{title:"New videos (30d)",series:n.series.videos,color:"#34d399"}),((A=(L=n.stream)==null?void 0:L.graphql)==null?void 0:A.minutes_viewed)&&n.stream.graphql.minutes_viewed.length>0&&e.jsx(ye,{title:"Minutes viewed (30d)",series:n.stream.graphql.minutes_viewed,color:"#f59e0b"})]}),e.jsxs("div",{className:"col",style:{gap:8,marginTop:8},children:[e.jsx("div",{className:"title",style:{fontSize:"clamp(16px, 4vw, 18px)"},children:"Feed & Stream"}),e.jsxs("div",{className:"muted",style:{fontSize:14,lineHeight:1.5},children:["Feed: ",n.feed.count," items in rotation",n.feed.cursor?` • cursor ${n.feed.cursor}`:""]}),e.jsxs("div",{className:"muted",style:{fontSize:14,lineHeight:1.5},children:["Approx. ready seconds: ",n.stream.approximate.total_duration_sec," • ready videos: ",n.stream.approximate.videos_ready]}),n.stream.api&&e.jsxs("div",{className:"muted",style:{fontSize:12,lineHeight:1.5},children:["Stream API: ",n.stream.api.ok?"ok":"unavailable",(ne=(U=n.stream.api)==null?void 0:U.result_info)!=null&&ne.count?` • count ${n.stream.api.result_info.count}`:"",(ue=n.stream.api)!=null&&ue.sample_status?` • sample status ${String(n.stream.api.sample_status)}`:""]})]})]})]})})]})]})]})})}function te({label:t,value:i}){return e.jsxs("div",{className:"col moderation-stat-card",children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:t}),e.jsx("div",{className:"title",style:{fontSize:"clamp(18px, 4vw, 20px)"},children:i})]})}function ye({title:t,series:i,color:s}){const[o,l]=w.useState(()=>re());w.useEffect(()=>{const n=()=>l(re());return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const r=o?Math.min(400,window.innerWidth-48):400,c=160,f=8,p=8,N=28,u=o?36:42,g=i.map(n=>n.count),C=Math.max(1,...g),T=w.useMemo(()=>{const n=C,S=Math.pow(10,Math.floor(Math.log10(n))),I=n/S;return(I<=1?1:I<=2?2:I<=5?5:10)*S},[C]),y=r-u-p,d=c-f-N,x=w.useMemo(()=>i.map((n,S)=>{const I=u+S/Math.max(1,i.length-1)*y,q=f+(1-n.count/(T||1))*d;return[I,q]}),[i,T,y,d]),m=w.useMemo(()=>x.map((n,S)=>S===0?`M ${n[0]} ${n[1]}`:`L ${n[0]} ${n[1]}`).join(" "),[x]),k=[0,.25,.5,.75,1],z=w.useMemo(()=>{if(i.length===0)return[];const n=[0,.25,.5,.75,1].map(S=>Math.min(i.length-1,Math.round(S*(i.length-1))));return Array.from(new Set(n))},[i]),j=n=>{if(!n||n.length<10)return n||"";const S=n.slice(5,7).replace(/^0/,""),I=n.slice(8,10).replace(/^0/,"");return`${S}/${I}`};function D(n){const S=Number.isInteger(n);return n>=1e6?`${(n/1e6).toFixed(1).replace(/\.0$/,"")}M`:n>=1e3?`${(n/1e3).toFixed(1).replace(/\.0$/,"")}k`:S?String(n):n<10?n.toFixed(1):n.toFixed(1).replace(/\.0$/,"")}const _=i.length?i[i.length-1].count:0;return e.jsxs("div",{className:"col moderation-chart-card",children:[e.jsxs("div",{className:"row",style:{alignItems:"baseline",justifyContent:"space-between",marginBottom:12,flexWrap:"wrap",gap:4},children:[e.jsx("div",{className:"muted",style:{fontSize:o?13:14},children:t}),e.jsxs("div",{className:"muted",style:{fontSize:o?11:12},children:["latest: ",D(_)]})]}),e.jsx("div",{style:{width:"100%",overflowX:"auto"},children:e.jsxs("svg",{width:r,height:c,role:"img","aria-label":t,style:{display:"block"},children:[e.jsx("rect",{x:0,y:0,width:r,height:c,rx:12,style:{fill:"var(--panel-dark)"}}),k.map((n,S)=>{const I=f+(1-n)*d,q=n*T;return e.jsxs("g",{children:[e.jsx("line",{x1:u,y1:I,x2:r-p,y2:I,strokeWidth:1,style:{stroke:"var(--divider)"}}),e.jsx("text",{x:u-6,y:I+4,textAnchor:"end",fontSize:10,style:{fill:"var(--muted)"},children:D(q)})]},S)}),e.jsx("line",{x1:u,y1:f,x2:u,y2:f+d,strokeWidth:1,style:{stroke:"var(--border-strong)"}}),e.jsx("line",{x1:u,y1:f+d,x2:u+y,y2:f+d,strokeWidth:1,style:{stroke:"var(--border-strong)"}}),z.map((n,S)=>{var q;const I=u+n/Math.max(1,i.length-1)*y;return e.jsxs("g",{children:[e.jsx("line",{x1:I,y1:f,x2:I,y2:f+d,strokeWidth:1,style:{stroke:"var(--divider)"}}),e.jsx("text",{x:I,y:f+d+12,textAnchor:"middle",fontSize:10,style:{fill:"var(--muted)"},children:j((q=i[n])==null?void 0:q.day)})]},S)}),e.jsx("path",{d:m,fill:"none",stroke:s,strokeWidth:2}),x.length>0&&e.jsx("circle",{cx:x[x.length-1][0],cy:x[x.length-1][1],r:3,fill:s})]})})]})}function Cs(){return e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsxs("div",{className:"title",style:{fontSize:"2em"},children:["mappi! ",e.jsx("span",{style:{fontSize:"0.4em",fontWeight:"normal"},children:"by Catawba."})]}),e.jsx("div",{className:"muted",children:"Hi, I get writers block/lose motivation very very easily. I want this site to counterract that."}),e.jsx("div",{className:"muted",children:"Basically, when you are struggling to come up with ideas; you'd hop on this site, watch a few videos, see something that impresses you, then hopefully you can get back to mapping with a lil' bit of inspiration."}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"How it works:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Log in with your osu! account."}),e.jsx("li",{children:"Upload a clip (100MB max). Allow for it to upload/process."}),e.jsx("li",{children:"Uploaded clips enter the random feed. New uploads and liked videos surface more often."}),e.jsx("li",{children:"Moderators can review reports and pending items for safety."})]})]}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"Guidelines:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"You can post two clips every 24 hours before getting rate-limited."}),e.jsx("li",{children:"Keep clips 4:3 or 16:9 for best fit. Ultrawide will letterbox."}),e.jsx("li",{children:"Add a short description and (optional) beatmap link."}),e.jsx("li",{children:"Don't post unrelated content."}),e.jsx("li",{children:"Report posts accordingly and within reason."})]})]})]})}function Es(t){const i="=".repeat((4-t.length%4)%4),s=(t+i).replace(/-/g,"+").replace(/_/g,"/"),o=atob(s),l=new Uint8Array(o.length);for(let r=0;r<o.length;r++)l[r]=o.charCodeAt(r);return l}async function he(){return!("serviceWorker"in navigator)||!("PushManager"in window)?null:(await navigator.serviceWorker.ready).pushManager.getSubscription()}async function As(){try{const t=await fetch(`${ge}/api/push/public_key`,{credentials:"include"});if(!t.ok)return null;const i=await t.json().catch(()=>null);return i&&typeof i.publicKey=="string"?i.publicKey:null}catch{return null}}async function _s(t){if(!("Notification"in window)||!("serviceWorker"in navigator)||!("PushManager"in window)||await Notification.requestPermission()!=="granted")return!1;const s=await navigator.serviceWorker.ready;let o=await s.pushManager.getSubscription();o||(o=await s.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Es(t)}));try{await M(P.user.pushSubscribe,{method:"POST",body:JSON.stringify({...o.toJSON(),ua:navigator.userAgent})})}catch{}return!0}async function Ls(){const t=await he();if(!t)return!0;try{await M(P.user.pushUnsubscribe,{method:"POST",body:JSON.stringify({endpoint:t.endpoint})})}catch{}try{await t.unsubscribe()}catch{}return!0}function Ps(){const{theme:t,setTheme:i}=se(),{data:s}=oe(),{notify:o}=de(),[l,r]=b.useState("general"),[c,f]=b.useState(!1),[p,N]=b.useState(!1),[u,g]=b.useState(!1),[C,T]=b.useState(typeof Notification<"u"?Notification.permission:"default"),y=d=>{i(d),qe(d)};return b.useEffect(()=>{f(typeof window<"u"&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window),N(je()),he().then(d=>g(!!d)).catch(()=>g(!1)),typeof Notification<"u"&&T(Notification.permission)},[]),e.jsxs("div",{className:"feed-container moderation-container settings-page",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsx("div",{className:"feed-header",style:{paddingTop:12,paddingBottom:0},children:e.jsxs("div",{className:"moderation-header",children:[e.jsx("div",{className:"moderation-title",children:"Settings"}),e.jsx("div",{className:"muted moderation-description",children:"Personalize appearance and app behavior."})]})}),e.jsxs("div",{className:"profile-tabs-unified",role:"region","aria-label":"Settings",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Settings tabs",children:[e.jsx("button",{role:"tab","aria-selected":l==="general",className:`profile-tab ${l==="general"?"active":""}`,"data-tab":"general",onClick:d=>{const x=d.currentTarget.closest(".profile-tabs-unified"),m=x==null?void 0:x.querySelector(".profile-tabs-content");m==null||m.setAttribute("data-active","general"),r("general")},children:"General"}),e.jsx("button",{role:"tab","aria-selected":l==="notifications",className:`profile-tab ${l==="notifications"?"active":""}`,"data-tab":"notifications",onClick:d=>{const x=d.currentTarget.closest(".profile-tabs-unified"),m=x==null?void 0:x.querySelector(".profile-tabs-content");m==null||m.setAttribute("data-active","notifications"),r("notifications")},children:"Notifications"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":l,children:[e.jsx("div",{className:"panel general settings-panel",children:e.jsxs("div",{className:"settings-section",children:[e.jsx("h3",{className:"settings-section-title",children:"Appearance"}),e.jsx("div",{style:{height:"1px",background:"var(--divider)",margin:"12px 0",width:"100%",display:"block"}}),e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label",children:"Theme"}),e.jsxs("div",{className:"settings-toggle-group",role:"group","aria-label":"Theme selection",children:[e.jsx("button",{type:"button",className:`btn ${t==="dark"?"":"secondary"}`,"aria-pressed":t==="dark",onClick:()=>y("dark"),children:"Dark"}),e.jsx("button",{type:"button",className:`btn ${t==="light"?"":"secondary"}`,"aria-pressed":t==="light",onClick:()=>y("light"),children:"Light"})]})]}),e.jsx("div",{className:"settings-hint",children:"The selected theme is saved on this device."})]})}),e.jsxs("div",{className:"panel settings-panel",children:[e.jsxs("div",{className:"settings-section",children:[e.jsx("h3",{className:"settings-section-title",children:"Push Notifications"}),e.jsx("div",{style:{height:"1px",background:"var(--divider)",margin:"12px 0",width:"100%",display:"block"}}),!c&&e.jsx("div",{className:"settings-hint",children:"Push notifications are not supported on this device."}),c&&!p&&e.jsx("div",{className:"settings-hint",children:"On iOS, install the app to your Home Screen to enable push."}),c&&e.jsx("div",{className:"settings-row",children:C!=="granted"||!u?e.jsx("button",{className:"btn secondary",onClick:async()=>{const d=await As();if(!d)return;await _s(d),T(typeof Notification<"u"?Notification.permission:"default");const x=await he();g(!!x)},title:p?void 0:"On iOS, install as PWA to enable",children:"Enable push notifications"}):C==="granted"&&u?e.jsx("button",{className:"btn secondary",onClick:async()=>{await Ls();const d=await he();g(!!d),T(typeof Notification<"u"?Notification.permission:"default")},children:"Disable push notifications"}):null})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h3",{className:"settings-section-title",children:"Enable/Disable"}),e.jsx("div",{style:{height:"1px",background:"var(--divider)",margin:"12px 0",width:"100%",display:"block"}}),e.jsx(Ms,{})]})]})]})]})]})}function Ms(){const{notify:t}=de(),[i,s]=b.useState(!0),[o,l]=b.useState(!1),[r,c]=b.useState({star:!0,likes5:!0,comment:!0,inspiration:!0,reaction:!0,system:!0,invites:!0});b.useEffect(()=>{(async()=>{s(!0);try{const u=await M(P.user.notifPrefs,{requireAuth:!0});u&&u.prefs&&c(g=>({...g,...u.prefs}))}finally{s(!1)}})()},[]);async function f(u){l(!0);try{await M(P.user.notifPrefs,{method:"POST",body:JSON.stringify(u)}),t("Preferences saved",{variant:"success"})}catch(g){t((g==null?void 0:g.message)||"Failed to save",{variant:"error"})}finally{l(!1)}}function p(u){const g={...r,[u]:!r[u]};c(g),f(g)}const N=({k:u,label:g})=>e.jsxs("div",{className:"settings-row",children:[e.jsx("span",{className:"settings-label",children:g}),e.jsxs("label",{className:"settings-toggle-switch",children:[e.jsx("input",{type:"checkbox",checked:r[u],onChange:()=>p(u),"aria-label":`Toggle ${g}`}),e.jsx("span",{className:"settings-toggle-slider"})]})]});return i?e.jsx("div",{className:"settings-hint",children:"Loading preferences…"}):e.jsxs(e.Fragment,{children:[e.jsx(N,{k:"star",label:"Stars"}),e.jsx(N,{k:"likes5",label:"Likes milestone"}),e.jsx(N,{k:"comment",label:"Comments"}),e.jsx(N,{k:"inspiration",label:"Inspirations"}),e.jsx(N,{k:"reaction",label:"Reactions"}),e.jsx(N,{k:"invites",label:"Queue invitations"}),e.jsx(N,{k:"system",label:"System messages"}),o&&e.jsx("div",{className:"settings-hint",children:"Saving…"})]})}const zs=()=>(w.useEffect(()=>()=>{Kt.clearAll()},[]),e.jsx(Xt,{}));function Is(){const[t,i]=b.useState({mobile:!1,standalone:!1,platform:""}),[s,o]=b.useState("ios");return b.useEffect(()=>{const l=typeof navigator<"u"&&navigator.userAgent||"",r=/iPad|iPhone|iPod/i.test(l)||/(Macintosh).*Mobile/.test(l),c=/Android/i.test(l),f=r?"ios":c?"android":"other";i({mobile:re(),standalone:!1,platform:f}),o(f==="android"?"android":"ios")},[]),e.jsx("div",{className:"feed-container",style:{width:"100%",maxWidth:600,margin:"0 auto",padding:"0 16px"},children:e.jsxs("div",{className:"feed-header",style:{paddingTop:12,paddingBottom:0},children:[e.jsxs("div",{className:"moderation-header",children:[e.jsx("div",{className:"moderation-title",children:"Install osumapp.ing"}),e.jsx("div",{className:"muted moderation-description",children:"Add this app to your home screen for a faster, fullscreen experience."})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Install tabs",style:{display:"flex",gap:4},children:[e.jsx("button",{role:"tab","aria-selected":s==="ios",className:`profile-tab ${s==="ios"?"active":""}`,"data-tab":"ios",onClick:l=>{const r=l.currentTarget.closest(".profile-tabs-unified");r.querySelectorAll(".profile-tab").forEach(f=>{f.classList.remove("active"),f.setAttribute("aria-selected","false")}),l.currentTarget.classList.add("active"),l.currentTarget.setAttribute("aria-selected","true"),r.querySelector(".profile-tabs-content").setAttribute("data-active","ios"),o("ios")},children:"iOS"}),e.jsx("button",{role:"tab","aria-selected":s==="android",className:`profile-tab ${s==="android"?"active":""}`,"data-tab":"android",onClick:l=>{const r=l.currentTarget.closest(".profile-tabs-unified");r.querySelectorAll(".profile-tab").forEach(f=>{f.classList.remove("active"),f.setAttribute("aria-selected","false")}),l.currentTarget.classList.add("active"),l.currentTarget.setAttribute("aria-selected","true"),r.querySelector(".profile-tabs-content").setAttribute("data-active","android"),o("android")},children:"Android"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":s,children:[e.jsx("div",{className:"panel",hidden:s!=="ios",children:e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"iOS (Safari)"}),e.jsxs("ol",{style:{paddingLeft:18,margin:0,lineHeight:1.7},children:[e.jsx("li",{children:"Open this site in Safari."}),e.jsx("li",{children:"Tap the Share button."}),e.jsx("li",{children:"Select “Add to Home Screen”."}),e.jsx("li",{children:"Tap “Add” to confirm."})]})]})}),e.jsx("div",{className:"panel",hidden:s!=="android",children:e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Android (Chrome)"}),e.jsxs("ol",{style:{paddingLeft:18,margin:0,lineHeight:1.7},children:[e.jsx("li",{children:"Open the browser menu (⋮) in Chrome."}),e.jsx("li",{children:"Choose “Install app” or “Add to Home screen”."}),e.jsx("li",{children:"Confirm to add it."})]})]})})]})]})]})})}const Rs=b.lazy(()=>ts(()=>import("./Discover-DgABVB1R.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));js("dark");At();"serviceWorker"in navigator&&window.addEventListener("load",()=>{const t=encodeURIComponent(ge);navigator.serviceWorker.register(`/sw.js?api=${t}`).then(i=>{console.log("Service Worker registered successfully:",i.scope)}).catch(i=>{console.error("Service Worker registration failed:",i)})});const Fs=()=>e.jsx(Tt,{children:e.jsxs(K,{element:e.jsx(vs,{}),children:[e.jsx(K,{path:"/",element:e.jsx(Ns,{})}),e.jsx(K,{path:"/mp/discover",element:e.jsx(w.Suspense,{fallback:e.jsx("div",{style:{padding:"48px",textAlign:"center"},children:"Loading..."}),children:e.jsx(Rs,{})})}),e.jsx(K,{path:"/mp/feed",element:e.jsx(ks,{})}),e.jsx(K,{path:"/mp/feed/:uid",element:e.jsx(Lt,{})}),e.jsx(K,{path:"/md/feed",element:e.jsx(qt,{})}),e.jsx(K,{path:"/md/feed/:uid",element:e.jsx($t,{})}),e.jsx(K,{path:"/md/queues",element:e.jsx(Ht,{})}),e.jsx(K,{path:"/md/queues/:id",element:e.jsx(Ut,{})}),e.jsx(K,{path:"/notifications",element:e.jsx(Ot,{})}),e.jsx(K,{path:"/profile",element:e.jsx(ze,{})}),e.jsx(K,{path:"/profile/:id",element:e.jsx(ze,{})}),e.jsx(K,{path:"/moderation",element:e.jsx(Ts,{})}),e.jsx(K,{path:"/about",element:e.jsx(Cs,{})}),e.jsx(K,{path:"/settings",element:e.jsx(Ps,{})}),e.jsx(K,{path:"/mobile",element:e.jsx(Is,{})}),e.jsx(K,{path:"/editor",element:e.jsx(zs,{})})]})}),Ds=()=>e.jsx(St,{children:e.jsx(Fs,{})});wt(document.getElementById("root")).render(e.jsx(is,{children:e.jsx(kt,{client:ss,children:e.jsx(_t,{children:e.jsx(Ds,{})})})}));export{ns as B,ts as _};
