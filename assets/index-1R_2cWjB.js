var zt=Object.defineProperty;var Ft=(t,r,i)=>r in t?zt(t,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[r]=i;var pt=(t,r,i)=>Ft(t,typeof r!="symbol"?r+"":r,i);import{r as s,j as e,e as we,u as ze,R as Z,q as Dt,T as Pt,L as Q,U as Ye,V as Wt,W as $t,B as Ve,X as qt,Y as Ut,O as ht,K as Bt,A as jt,h as wt,P as Ot,Q as Ht,E as Qt,c as Ke,H as Yt,l as Nt,Z as Vt,_ as ft,y as Jt,v as Gt,b as Kt,a as Xt,i as kt,g as St,k as Je,$ as Zt,a0 as xt,o as es,x as ts,a1 as ss,a2 as as,a3 as ns,a4 as is,a5 as J}from"./vendor-react-DIP1I1qy.js";import{y as rs}from"./vendor-Csg-wJTD.js";import{u as _e,a as M,A as R,c as Ge,P as os,b as je,d as ls,C as cs,T as ds,e as us}from"./mappi-routes-D5G1srWb.js";import{u as Ne,a as Fe,b as ms,c as ps,d as hs,e as fs,f as xs,g as gs,C as bs,M as ys,P as vs,Q as js,h as ws,N as Ns}from"./moddi-routes-CM5iLVUD.js";import{H as ks}from"./editor-components-DlsJEc83.js";import{B as Ss,E as Cs}from"./editor-lib-ot5Irq4Z.js";import"./vendor-hls-B_fsdCYC.js";import"./beatmap-preview-OKqJdqLF.js";import"./vendor-zip-C_ySdRMX.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))o(p);new MutationObserver(p=>{for(const l of p)if(l.type==="childList")for(const f of l.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function i(p){const l={};return p.integrity&&(l.integrity=p.integrity),p.referrerPolicy&&(l.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?l.credentials="include":p.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(p){if(p.ep)return;p.ep=!0;const l=i(p);fetch(p.href,l)}})();const _s=new rs({defaultOptions:{queries:{staleTime:30*1e3,gcTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1},mutations:{retry:0}}});class Ts extends s.Component{constructor(i){super(i);pt(this,"handleRetry",()=>{const i=this.isChunkLoadingError(this.state.error);this.setState({hasError:!1,error:null}),i&&window.location.reload()});this.state={hasError:!1,error:null}}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,o){console.error("ErrorBoundary caught an error:",i,o)}isChunkLoadingError(i){if(!i)return!1;const o=i.message.toLowerCase();return o.includes("loading chunk")||o.includes("failed to load")||o.includes("chunk load failed")||o.includes("loading css chunk")||i.name==="ChunkLoadError"}render(){var i;if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const o=this.isChunkLoadingError(this.state.error),p=((i=this.state.error)==null?void 0:i.message)||"An unexpected error occurred";return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"400px",padding:"24px",textAlign:"center"},children:[e.jsx("h2",{style:{marginBottom:"16px",color:"var(--danger)"},children:"Something went wrong"}),e.jsx("p",{style:{marginBottom:"8px",color:"var(--muted)"},children:o?"Failed to load page. This might be a network issue.":p}),o&&e.jsx("p",{style:{marginBottom:"24px",fontSize:"14px",color:"var(--muted)",opacity:.8},children:"Try checking your internet connection or reloading the page."}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap",justifyContent:"center"},children:[e.jsx("button",{className:"btn secondary",onClick:this.handleRetry,children:o?"Reload Page":"Try Again"}),!o&&e.jsx("button",{className:"btn secondary",onClick:()=>window.location.reload(),children:"Reload Page"})]})]})}return this.props.children}}const me=["#7dd3fc","#a78bfa","#34d399","#f472b6","#f59e0b"];function Is({i:t}){const r=t*1337,i=(T,y)=>{const k=Math.sin(r+T+y)*1e4,I=k-Math.floor(k);return Math.floor(I*(y-T+1)+T)},o=i(0,100),p=i(24,50),l=.7+i(0,100)/100*.3,f=p*l,A=i(0,4e3),v=i(-10,10),E=i(-8,8),x=i(0,100),S=x<60?1:x<80?1.5:2,_=[{size:200*S,alpha:.06,dx:-22,dy:12,color:me[i(0,me.length-1)]},{size:150*S,alpha:.08,dx:-9,dy:7,color:me[i(0,me.length-1)]},{size:120*S,alpha:.1,dx:0,dy:0,color:me[i(0,me.length-1)]},{size:90*S,alpha:.12,dx:12,dy:-4,color:me[i(0,me.length-1)]},{size:64*S,alpha:.13,dx:20,dy:-7,color:me[i(0,me.length-1)]}];return e.jsx("div",{className:"cluster",style:{left:`${o}vw`,animationDuration:`${f}s`,animationDelay:`${A}ms`,"--tx":`${v}vw`,transform:`rotate(${E}deg)`},children:_.map((T,y)=>e.jsx("svg",{width:T.size,height:T.size,viewBox:"0 0 100 100",style:{left:`${50+T.dx}%`,bottom:`${T.dy}px`,transform:"translateX(-50%)","--alpha":T.alpha},children:e.jsx("polygon",{points:"50,0 100,100 0,100",fill:T.color})},y))})}function Ct({paused:t=!1}){const r=s.useMemo(()=>new Array(20).fill(0).map((i,o)=>o),[]);return e.jsx("div",{className:`triangles ${t?"paused":""}`,children:r.map(i=>e.jsx(Is,{i},i))})}function Rs(){const t=we(),r=ze(),{lastSection:i,previousLocation:o,setPreviousLocation:p}=Ne(),l=Z.useRef(null),f=Z.useRef(!1),A=Z.useRef(0),v=Z.useRef(0),E=Z.useRef(null),x=Z.useRef(null),S=Z.useRef(!1),_=300,T=2e3,y=Z.useRef(null),k=Z.useRef(null),I=Z.useRef(null),[c,C]=Z.useState(!1);Z.useEffect(()=>()=>{l.current&&clearTimeout(l.current),E.current&&clearTimeout(E.current),x.current&&clearTimeout(x.current)},[]),Z.useEffect(()=>{if(!c)return;const $=W=>{const O=W.target;I.current&&!I.current.contains(O)&&k.current&&!k.current.contains(O)&&C(!1)};return document.addEventListener("mousedown",$),()=>document.removeEventListener("mousedown",$)},[c]);const F=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",g=t.pathname==="/editor";t.pathname.startsWith("/mp/")||!F&&t.pathname.startsWith("/md/");const j=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!F&&!t.pathname.startsWith("/mp/")&&i==="moddi";if(F)return null;const N=()=>{r(o||(i==="moddi"?"/md/feed":"/mp/feed"))},b=()=>{C($=>!$)},V=()=>{var $;C(!1),($=y.current)==null||$.click()};if(g)return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:y,type:"file",accept:".osz,.zip",onChange:$=>{var O;const W=(O=$.target.files)==null?void 0:O[0];W&&window.dispatchEvent(new CustomEvent("editor:file",{detail:W}))},style:{display:"none"}}),e.jsxs("nav",{className:"mobile-bottom-nav mobile-bottom-nav-editor",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx("button",{className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:N,"aria-label":"Back",title:"Go back",children:e.jsx(Dt,{size:20})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:k,className:"mobile-bottom-nav-item mobile-bottom-nav-icon-only",onClick:b,"aria-label":"File",title:"File menu","aria-expanded":c,children:e.jsx(Pt,{size:20})}),c&&e.jsx("div",{ref:I,className:"menu-panel mobile-bottom-nav-menu",role:"menu",style:{position:"absolute",bottom:"calc(100% + 8px)",left:0,top:"auto",right:"auto",zIndex:1e3},children:e.jsx("button",{className:"menu-item",type:"button",onClick:V,style:{fontFamily:"Torus Pro, Torus, ui-sans-serif, system-ui, sans-serif"},children:"Open .osz"})})]})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:N,"aria-label":"Go back",title:"Go back to previous page",children:e.jsx("span",{className:"mobile-coin-flip-text",children:"ed!"})}),e.jsx("div",{className:"mobile-bottom-nav-right"})]})]});const se=()=>{const $=Date.now();if(A.current>0){const W=$-A.current;if(W<_&&W>0){E.current&&(clearTimeout(E.current),E.current=null),x.current&&(clearTimeout(x.current),x.current=null),l.current&&(clearTimeout(l.current),l.current=null),v.current=$+T,A.current=0,f.current=!1,p(t.pathname),r("/editor");return}}$<v.current&&A.current===0||(E.current&&(clearTimeout(E.current),E.current=null),x.current&&(clearTimeout(x.current),x.current=null),A.current=$,x.current=setTimeout(()=>{x.current!==null&&(r(j?"/mp/feed":"/md/feed"),x.current=null)},_),E.current=setTimeout(()=>{A.current>0&&(A.current=0,v.current=Date.now()+T),E.current=null},_))},ae=()=>{f.current=!1,l.current=setTimeout(()=>{f.current=!0,r("/")},500)},te=()=>{l.current&&(clearTimeout(l.current),l.current=null),f.current&&setTimeout(()=>{f.current=!1},100)},q=$=>{if(S.current){$.preventDefault(),$.stopPropagation(),S.current=!1;return}if(f.current){$.preventDefault(),$.stopPropagation();return}se()},ee=$=>{if(te(),f.current){$.preventDefault(),S.current=!0;return}$.preventDefault(),se(),S.current=!0,setTimeout(()=>{S.current=!1},_+100)};return e.jsxs("nav",{className:"mobile-bottom-nav",children:[e.jsxs("div",{className:"mobile-bottom-nav-left",children:[e.jsx(Q,{to:j?"/md/feed":"/mp/feed",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/feed"||t.pathname==="/md/feed"?"active":""}`,"aria-label":"Feed",children:e.jsx(Ye,{size:20})}),j?e.jsx(Q,{to:"/md/queues",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/md/queues")?"active":""}`,"aria-label":"Queues",children:e.jsx(Wt,{size:20})}):e.jsx(Q,{to:"/mp/discover",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/mp/discover"?"active":""}`,"aria-label":"Discover",children:e.jsx($t,{size:20})})]}),e.jsx("button",{className:"mobile-bottom-nav-coin-flip",onClick:q,onTouchStart:ae,onTouchEnd:ee,onMouseDown:ae,onMouseUp:te,onMouseLeave:te,"aria-label":j?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",title:j?"Switch to Mappi (long press for home)":"Switch to Moddi (long press for home)",children:e.jsx("span",{className:"mobile-coin-flip-text",children:j?"md!":"mp!"})}),e.jsxs("div",{className:"mobile-bottom-nav-right",children:[e.jsx(Q,{to:"/profile",className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname.startsWith("/profile")?"active":""}`,"aria-label":"Profile",children:e.jsx(Ve,{size:20})}),e.jsx("button",{className:`mobile-bottom-nav-item mobile-bottom-nav-icon-only ${t.pathname==="/settings"?"active":""}`,onClick:()=>r("/settings"),"aria-label":"Settings",children:e.jsx(qt,{size:20})})]})]})}function Es({isModdi:t,onClick:r}){return e.jsxs("button",{onClick:r,className:"title coin-flip-title",style:{background:"transparent",border:"none",padding:0,cursor:"pointer",color:"inherit",font:"inherit"},title:"Switch section (double-click for editor)","aria-label":"Switch section (double-click for editor)",children:[e.jsx("span",{className:"coin-flip-front",children:t?"osu!moddi.ng":"osu!mappi.ng"}),e.jsx("span",{className:"coin-flip-back",children:t?"osu!mappi.ng":"osu!moddi.ng"})]})}function Ls({isNeutralPage:t,isEditor:r,isModdi:i,isMappi:o,onCoinFlipClick:p}){return t?e.jsx(Q,{to:"/",className:"title",children:i?"osu!moddi.ng":o?"osu!mappi.ng":"mappi!"}):r?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(Q,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(Ye,{size:18})}),e.jsx(Q,{to:i?"/md/feed":"/mp/feed",className:"title",children:i?"osu!moddi.ng":"osu!mappi.ng"})]}):e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(Q,{to:"/",className:"icon-link",title:"Home","aria-label":"Home",style:{width:"auto",height:"auto",padding:"4px"},children:e.jsx(Ye,{size:18})}),e.jsx(Es,{isModdi:i,onClick:p})]})}function Ms({isNeutralPage:t,isMappi:r,isModdi:i}){const o=we();return e.jsxs("nav",{className:"nav-links","aria-label":"Primary",children:[t&&e.jsx(Q,{to:o.pathname==="/"?"/about":"/",className:o.pathname==="/about"?"active":"",children:o.pathname==="/"?"About":"Home"}),r&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{to:"/mp/feed",className:o.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(Q,{to:"/mp/discover",className:o.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(Q,{to:"/editor",className:o.pathname==="/editor"?"active":"",children:"Editor"})]}),i&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{to:"/md/feed",className:o.pathname==="/md/feed"?"active":"",children:"Feed"}),e.jsx(Q,{to:"/md/queues",className:o.pathname.startsWith("/md/queues")?"active":"",children:"Queues"})]}),!r&&!i&&!t&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{to:"/mp/feed",className:o.pathname==="/mp/feed"?"active":"",children:"Feed"}),e.jsx(Q,{to:"/mp/discover",className:o.pathname==="/mp/discover"?"active":"",children:"Discover"}),e.jsx(Q,{to:"/editor",className:o.pathname==="/editor"?"active":"",children:"Editor"})]})]})}function _t(t,r,i,o){s.useEffect(()=>{if(!i)return;const p=l=>{const f=l.target;r.current&&!r.current.contains(f)&&t.current&&!t.current.contains(f)&&o()};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[i,o,t,r])}function As(t,r,i,o){const p=ze(),{notify:l}=_e(),[f,A]=s.useState(new Set);return{parseQueueInvite:y=>{if(!y)return null;try{const k=JSON.parse(y);if((k==null?void 0:k.type)==="queue_invite"&&(k!=null&&k.queue_id))return k}catch{}return null},handleAcceptInvite:async(y,k)=>{if(!f.has(y.id)){A(I=>new Set(I).add(y.id));try{await M(R.moddi.queueAccept(String(k)),{method:"POST"}),l("Invitation accepted!",{variant:"success"}),i.mutate(y.id),o(!1),p(`/md/queues/${k}`)}catch(I){l((I==null?void 0:I.message)||"Failed to accept invitation",{variant:"error"})}finally{A(I=>{const c=new Set(I);return c.delete(y.id),c})}}},handleDenyInvite:async(y,k)=>{if(!f.has(y.id)){A(I=>new Set(I).add(y.id));try{await M(R.moddi.queueDeny(String(k)),{method:"POST"}),l("Invitation declined",{variant:"success"}),i.mutate(y.id)}catch(I){l((I==null?void 0:I.message)||"Failed to decline invitation",{variant:"error"})}finally{A(I=>{const c=new Set(I);return c.delete(y.id),c})}}},handleMarkAllRead:async()=>{const y=t.filter(k=>k.id.startsWith("n:")||k.kind==="system"&&!k.read).map(k=>k.id);y.length>0&&r.mutate(y)},handleNotificationClick:async y=>{if(o(!1),r.mutate([y.id]),y.kind==="system"||y.id.startsWith("n:"))try{await M(R.user.markNotificationsRead,{method:"POST",body:JSON.stringify({ids:[y.id]})})}catch{}},handleDeleteNotification:async(y,k)=>{y.stopPropagation(),i.mutate(k)},processing:f}}function zs({notifications:t,unreadCount:r,notifOpen:i,setNotifOpen:o,markReadMutation:p,deleteNotificationMutation:l,closeAllPanels:f}){const A=s.useRef(null),v=s.useRef(null),{parseQueueInvite:E,handleAcceptInvite:x,handleDenyInvite:S,handleMarkAllRead:_,handleNotificationClick:T,handleDeleteNotification:y,processing:k}=As(t,p,l,o);_t(A,v,i,()=>o(!1));const I=t.filter(c=>!(c.kind==="system"&&c.id.startsWith("b:")&&(c.expiresAt||0)<=Date.now()));return e.jsxs("div",{style:{position:"relative",display:"inline-block",marginRight:3},children:[e.jsx("button",{ref:A,className:"icon-link",onClick:()=>{i||f(),o(!i)},"aria-label":"Notifications",title:"Notifications",children:e.jsx(Ut,{size:18})}),r>0&&e.jsx("span",{style:{position:"absolute",top:2,right:2,width:8,height:8,background:"#f87171",borderRadius:9999}}),i&&e.jsxs("div",{ref:v,className:"menu-panel notif-panel",role:"menu",children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center",marginBottom:6},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:"Notifications"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(Q,{to:"/md/notifications",onClick:()=>o(!1),style:{fontSize:12,color:"var(--text)",textDecoration:"none",opacity:.7,transition:"opacity 0.15s ease"},onMouseEnter:c=>c.currentTarget.style.opacity="1",onMouseLeave:c=>c.currentTarget.style.opacity="0.7",children:"View all"}),I.length>0&&e.jsx("button",{className:"icon-link",title:"Mark all read","aria-label":"Mark all read",onClick:_,children:e.jsx(ht,{size:16})})]})]}),e.jsxs("div",{className:"notif-list",children:[I.length===0&&e.jsx("div",{className:"muted",style:{fontSize:12,padding:"6px 2px"},children:"No notifications.. :("}),I.map(c=>{const C=E(c.text),F=c.id.startsWith("b:"),g=C?"queue-invite":c.kind==="star"?"star":c.kind==="likes5"?"likes":c.kind==="comment"?"comment":c.kind==="inspiration"?"inspiration":c.kind==="reaction"?"reaction":F?"global":"system",j=c.id.startsWith("n:");return e.jsxs("div",{className:`notif-item ${g}`,role:"button",onClick:()=>!C&&T(c),children:[e.jsxs("div",{className:`notif-icon ${j?"deletable":""}`,"aria-hidden":"true",onClick:j&&!C?N=>y(N,c.id):void 0,title:j&&!C?"Remove":void 0,role:j&&!C?"button":void 0,children:[e.jsx("span",{className:"swap-main",children:C?e.jsx(Bt,{}):g==="star"?e.jsx(jt,{}):g==="likes"?e.jsx(wt,{}):g==="comment"?e.jsx(Ve,{}):g==="inspiration"?e.jsx(Ve,{}):g==="reaction"?e.jsx(Ot,{}):g==="global"?e.jsx(Ht,{}):null}),j&&!C?e.jsx("span",{className:"swap-trash",children:e.jsx(Qt,{})}):null]}),e.jsx("div",{className:"notif-body",children:C?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Queue Invitation"}),e.jsxs("div",{className:"notif-desc",children:[C.inviter_username," invited you to join queue: ",C.queue_name]}),k.has(c.id)?e.jsx("div",{className:"muted",style:{fontSize:11,marginTop:6},children:"Processing..."}):e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[e.jsxs("button",{className:"btn",onClick:N=>{N.stopPropagation(),x(c,C.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(ht,{size:12,style:{marginRight:4}}),"Accept"]}),e.jsxs("button",{className:"btn secondary",onClick:N=>{N.stopPropagation(),S(c,C.queue_id)},style:{fontSize:11,padding:"4px 8px",flex:1},children:[e.jsx(Ke,{size:12,style:{marginRight:4}}),"Decline"]})]})]}):c.kind==="system"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:F?"Global":"System"}),e.jsx("div",{className:"notif-desc",children:c.text||""}),F&&c.expiresAt?e.jsxs("div",{className:"notif-exp",children:["Expires at: ",new Date(c.expiresAt).toLocaleString()]}):null]}):c.kind==="comment"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Comment"}),e.jsx("div",{className:"notif-desc",children:c.text||"Someone commented on your post"})]}):c.kind==="inspiration"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Inspiration"}),e.jsx("div",{className:"notif-desc",children:c.text||"Someone is inspired by you!"})]}):c.kind==="reaction"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:"Reaction"}),e.jsx("div",{className:"notif-desc",children:c.text||"Someone raised their hand on your post!"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"notif-title",children:c.kind==="star"?"Star":"Likes"}),e.jsx("div",{className:"notif-desc",children:c.kind==="star"?"One of your posts was starred!":"One of your posts reached 5 likes!"})]})})]},c.id)})]})]})]})}function Fs({quota:t,nowTick:r}){if(!(t!=null&&t.blocked))return null;const i=Math.max(0,Math.floor((((t==null?void 0:t.reset_at)??0)*1e3-Date.now())/1e3)),o=Math.floor(i/3600),p=Math.floor(i%3600/60),l=i%60,f=v=>String(v).padStart(2,"0"),A=o>0?`${o}:${f(p)}:${f(l)}`:`${p}:${f(l)}`;return e.jsxs("div",{title:"Upload limit reached","aria-label":"Upload limit reached",style:{display:"inline-flex",alignItems:"center",gap:4,marginRight:8},children:[e.jsx(Yt,{}),e.jsx("span",{className:"muted",style:{fontSize:12},children:A})]})}function Ds({me:t,menuOpen:r,setMenuOpen:i,onLogout:o,closeAllPanels:p}){const l=s.useRef(null),f=s.useRef(null);return _t(l,f,r,()=>i(!1)),e.jsxs(e.Fragment,{children:[e.jsxs("button",{ref:l,className:"icon-link",onClick:()=>{r||p(),i(!r)},title:t.username,"aria-label":"User menu","aria-expanded":r,style:{width:"auto",height:40,padding:"0 8px",display:"inline-flex",alignItems:"center",gap:6},children:[t.avatar_url&&e.jsx("img",{src:t.avatar_url,width:22,height:22,style:{borderRadius:"50%"}}),e.jsx("span",{className:"muted",style:{display:"inline-block",verticalAlign:"middle"},children:t.username}),e.jsx(Nt,{size:14,style:{opacity:.8}})]}),r&&e.jsxs("div",{ref:f,className:"menu-panel",role:"menu",children:[e.jsx(Q,{to:"/profile",className:"menu-item",onClick:()=>i(!1),children:"Profile"}),((t==null?void 0:t.is_admin)||(t==null?void 0:t.is_mod))&&e.jsx(Q,{to:"/moderation",className:"menu-item",onClick:()=>i(!1),children:"Moderation"}),e.jsx("button",{className:"menu-item",type:"button",onClick:o,children:"Log out"})]})]})}function Ps({isNeutralPage:t,isEditor:r,isMappi:i,isModdi:o,onCoinFlipClick:p}){const l=we(),{data:f,isLoading:A}=Fe(),{data:v}=ms(!!f),{data:E=[]}=ps(!!f),x=hs(),S=fs(),_=xs(),T=gs(),{menuOpen:y,notifOpen:k,setMenuOpen:I,setNotifOpen:c,closeAllPanels:C}=Ne(),[F,g]=Z.useState(0);return Z.useEffect(()=>{const j=setInterval(()=>g(N=>N+1),1e3);return()=>clearInterval(j)},[]),e.jsxs("header",{className:"top-nav",children:[e.jsx(Ls,{isNeutralPage:t,isEditor:r,isModdi:o,isMappi:i,onCoinFlipClick:p}),e.jsx("span",{className:"nav-divider","aria-hidden":"true"}),l.pathname==="/editor"?e.jsx("div",{style:{display:"flex",alignItems:"center",gap:10,flex:1},children:e.jsx(ks,{})}):e.jsxs(e.Fragment,{children:[e.jsx(Ms,{isNeutralPage:t,isMappi:i,isModdi:o}),e.jsx("div",{style:{marginLeft:"auto"}}),e.jsx("a",{className:"icon-link",href:"https://discord.gg/3FZKUuumE2",target:"_blank",rel:"noreferrer",title:"Join Discord (opens in new tab)","aria-label":"Join Discord",style:{marginRight:3,transform:"translateY(2px)"},children:e.jsx(Vt,{size:18})}),f?e.jsxs("div",{className:"user-menu",children:[e.jsx(zs,{notifications:E,unreadCount:x,notifOpen:k,setNotifOpen:c,markReadMutation:_,deleteNotificationMutation:T,closeAllPanels:C}),e.jsx(Fs,{quota:v,nowTick:F}),e.jsx(Ds,{me:f,menuOpen:y,setMenuOpen:I,onLogout:()=>S.mutate(),closeAllPanels:C})]}):e.jsx("button",{className:"btn secondary",onClick:()=>{window.location.href=Ge+R.auth.login},disabled:A,children:A?"Checkingâ€¦":"Login with osu!"})]})]})}function Ws({readyCount:t}){return t===null?null:e.jsx("div",{className:"site-badge","aria-hidden":!1,children:e.jsxs("div",{className:"label",children:[t," videos ready"]})})}function $s(){const t=we(),{lastSection:r}=Ne(),i=t.pathname==="/"||t.pathname==="/about"||t.pathname==="/md/notifications",o=t.pathname==="/editor",p=t.pathname.startsWith("/mp/")||!i&&!t.pathname.startsWith("/md/")&&r==="mappi",l=t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"||!i&&!t.pathname.startsWith("/mp/")&&r==="moddi",f=t.pathname.startsWith("/md/queues/")&&t.pathname!=="/md/queues";return{isNeutralPage:i,isEditor:o,isMappi:p,isModdi:l,isQueueDetail:f}}function qs(t){const r=ze(),i=we(),{setPreviousLocation:o}=Ne(),p=s.useRef(0),l=s.useRef(0),f=s.useRef(null),A=500,v=2e3;return s.useEffect(()=>()=>{f.current&&clearTimeout(f.current)},[]),x=>{x.preventDefault();const S=Date.now();if(!(S<l.current)){if(f.current&&p.current>0){const _=S-p.current;if(_<A&&_>0){clearTimeout(f.current),f.current=null,l.current=S+v,p.current=0,o(i.pathname),r("/editor");return}}f.current&&(clearTimeout(f.current),f.current=null),p.current=S,f.current=setTimeout(()=>{l.current=Date.now()+v,f.current=null,p.current=0,r(t?"/mp/feed":"/md/feed")},A)}}}function Us(){const t=we(),{notify:r}=_e(),{data:i}=Fe(),{lastSection:o,setLastSection:p}=Ne(),{isNeutralPage:l,isEditor:f,isMappi:A,isModdi:v}=$s(),E=qs(v);Z.useEffect(()=>{t.pathname.startsWith("/mp/")?p("mappi"):t.pathname.startsWith("/md/")&&t.pathname!=="/md/notifications"&&p("moddi")},[t.pathname,p]);const[x,S]=Z.useState(null);return Z.useEffect(()=>{!i||!i.is_mod||(async()=>{try{const _=await M(R.admin.debugState,{requireAuth:!1}),T=Array.isArray(_==null?void 0:_.counts)?_.counts.find(y=>String(y.status)==="ready"):null;T&&S(Number(T.c)||0)}catch{}})()},[i]),Z.useEffect(()=>{i&&!localStorage.getItem("welcomed")&&(r(`Welcome, ${i.username}!`,{durationMs:1e4,variant:"success"}),localStorage.setItem("welcomed","1"))},[i,r]),e.jsxs("div",{className:"app-shell","data-section":v?"moddi":A?"mappi":o==="moddi"?"moddi":o==="mappi"?"mappi":void 0,children:[e.jsx(Ct,{paused:t.pathname==="/editor"}),e.jsx(Ps,{isNeutralPage:l,isEditor:f,isMappi:A,isModdi:v,onCoinFlipClick:E}),e.jsx("main",{className:`page ${t.pathname==="/editor"||t.pathname==="/mp/discover"?"fullscreen":""}`,children:t.pathname==="/about"||t.pathname==="/moderation"||t.pathname==="/settings"?e.jsx("div",{className:"card",children:e.jsx(ft,{})}):e.jsx(ft,{})}),t.pathname!=="/editor"&&e.jsx(e.Fragment,{children:e.jsx(Ws,{readyCount:x})}),e.jsx(Rs,{})]})}function Bs(){return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes shimmer {
          0% { background-position: -1000px 0; }
          100% { background-position: 1000px 0; }
        }
        
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
        
        .landing-container {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 80px 24px 24px;
          overflow-y: auto;
          z-index: 1;
        }
        
        .landing-hero {
          text-align: center;
          max-width: 900px;
          width: 100%;
          animation: fadeInUp 0.8s ease-out;
        }
        
        .landing-title {
          font-size: clamp(48px, 8vw, 96px);
          font-weight: 700;
          line-height: 1.1;
          margin: 0 0 24px;
          background: linear-gradient(135deg, #7dd3fc 0%, #a78bfa 50%, #34d399 100%);
          background-size: 200% 200%;
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          animation: shimmer 3s ease-in-out infinite, fadeInUp 0.8s ease-out 0.2s both;
          letter-spacing: -0.02em;
        }
        
        .landing-subtitle {
          font-size: clamp(18px, 2.5vw, 28px);
          color: var(--muted);
          margin: 0 0 64px;
          font-weight: 400;
          animation: fadeInUp 0.8s ease-out 0.4s both;
          opacity: 0.9;
        }
        
        .landing-actions {
          display: flex;
          gap: 24px;
          justify-content: center;
          flex-wrap: wrap;
          animation: fadeInUp 0.8s ease-out 0.6s both;
        }
        
        .landing-btn {
          padding: 20px 32px;
          font-size: 20px;
          font-weight: 700;
          text-decoration: none;
          border-radius: 10px;
          transition: background 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          min-width: 180px;
          border: 1px solid transparent;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
          text-rendering: optimizeLegibility;
          font-smooth: always;
        }
        
        .landing-btn-primary {
          background: #ffffff;
          color: #0b0d10;
          border: 1px solid rgba(0, 0, 0, 0.15);
        }
        
        .landing-btn-primary:hover {
          background: linear-gradient(90deg, rgba(255,255,255,1), rgba(248,249,255,0.98));
          border-color: rgba(0, 0, 0, 0.18);
          box-shadow: 0 1px 0 rgba(255,255,255,0.25) inset, 0 0 0 1px rgba(255,255,255,0.02) inset;
        }
        
        .landing-btn-secondary {
          background: #1f2430;
          color: var(--text);
          border: 1px solid rgba(255, 255, 255, 0.12);
        }
        
        .landing-btn-secondary:hover {
          background: linear-gradient(90deg, rgba(125,211,252,0.14), rgba(167,139,250,0.16));
          border-color: rgba(255, 255, 255, 0.18);
        }
        
        .landing-glow {
          position: absolute;
          width: 600px;
          height: 600px;
          border-radius: 50%;
          background: radial-gradient(circle, rgba(125, 211, 252, 0.15) 0%, transparent 70%);
          pointer-events: none;
          animation: pulse 4s ease-in-out infinite;
          z-index: -1;
        }
        
        .landing-glow-1 {
          top: 10%;
          left: 10%;
          animation-delay: 0s;
        }
        
        .landing-glow-2 {
          bottom: 10%;
          right: 10%;
          background: radial-gradient(circle, rgba(167, 139, 250, 0.15) 0%, transparent 70%);
          animation-delay: 2s;
        }
        
        @media (max-width: 768px) {
          .landing-container {
            padding: 60px 16px 16px;
          }
          
          .landing-actions {
            flex-direction: column;
            width: 100%;
          }
          
          .landing-btn {
            width: 100%;
            min-width: unset;
            padding: 18px 24px;
            font-size: 18px;
          }
        }
      `}),e.jsxs("div",{className:"landing-container",children:[e.jsx("div",{className:"landing-glow landing-glow-1"}),e.jsx("div",{className:"landing-glow landing-glow-2"}),e.jsxs("div",{className:"landing-hero",children:[e.jsx("h1",{className:"landing-title",children:"mappi!"}),e.jsx("p",{className:"landing-subtitle",children:"Navigate to.."}),e.jsxs("div",{className:"landing-actions",children:[e.jsx(Q,{to:"/mp/discover",className:"landing-btn landing-btn-secondary",children:"mappi.ng"}),e.jsx(Q,{to:"/md/feed",className:"landing-btn landing-btn-secondary",children:"moddi.ng"})]})]})]})]})}function Os(){const{data:t}=Fe(),{modeFilters:r}=Ne(),i=Object.entries(r).filter(([p,l])=>l).map(([p])=>p),o=i.length?i.join(","):"standard";return Jt({queryKey:["mappi","feed",o],queryFn:async({pageParam:p=0})=>{const l=new URLSearchParams({limit:"20",offset:String(p),modes:o}),f=`${R.feed.recent}?${l.toString()}`;return await M(f)},enabled:!!t,initialPageParam:0,getNextPageParam:(p,l)=>{var v;const f=l.reduce((E,x)=>{var S;return E+(((S=x.items)==null?void 0:S.length)||0)},0);return(((v=p.items)==null?void 0:v.length)||0)===20?f:void 0}})}function Ce(){const t=we(),r=Gt(),{data:i}=Fe(),{modeFilters:o}=Ne(),{data:p,fetchNextPage:l,hasNextPage:f,isFetching:A,isFetchingNextPage:v,refetch:E}=Os(),x=s.useMemo(()=>(p==null?void 0:p.pages.flatMap(c=>c.items||[]))||[],[p]),S=s.useMemo(()=>{const c=Object.entries(o).filter(([F,g])=>g).map(([F])=>F.toLowerCase()),C=new Set(c.length?c:["standard"]);return x.filter(F=>{const g=String(F.mode||"standard").toLowerCase();return C.has(g)})},[x,o]);s.useEffect(()=>{t.pathname==="/mp/feed"&&E()},[t.pathname,E]),s.useEffect(()=>{const c=()=>{E()};return window.addEventListener("filterchange",c),()=>window.removeEventListener("filterchange",c)},[E]);const _=c=>{r.setQueryData(["mappi","feed"],C=>C&&{...C,pages:C.pages.map(F=>({...F,items:F.items.map(g=>g.id===c.id?c:g)}))})},T=c=>{r.setQueryData(["mappi","feed"],C=>C&&{...C,pages:C.pages.map(F=>({...F,items:F.items.filter(g=>g.id!==c)}))})},y=()=>{E()},k=A&&!v,I=f??!1;return e.jsxs("div",{className:"feed-container",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"title",style:{marginBottom:8},children:"Feed"}),e.jsx("div",{className:"muted",style:{fontSize:12,marginBottom:12},children:"Clips auto-delete after 60 days. Starred posts are preserved."}),e.jsx(bs,{section:"mappi",onUpload:y})]}),e.jsx("div",{style:{marginTop:12,borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:e.jsxs("div",{className:"col",style:{gap:0},children:[S.length===0&&!k&&e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No videos match the selected filter."}),S.map(c=>e.jsx(os,{post:c,section:"mappi",onUpdate:_,onDelete:T,me:i},c.id)),S.length>0&&I&&e.jsx("div",{style:{padding:"16px",textAlign:"center",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsx("button",{className:"btn secondary",onClick:()=>l(),disabled:v,children:v?"Loading...":"Load more"})})]})})]})}const le={};function Hs(){try{const t=localStorage.getItem("feed_seen_ids");if(t){const r=JSON.parse(t);Array.isArray(r)&&(le.seenIds=r.filter(i=>typeof i=="number"))}}catch{}return le}function gt(t){Object.assign(le,t);try{const r=Array.from(new Set(le.seenIds||[])).slice(-200);localStorage.setItem("feed_seen_ids",JSON.stringify(r))}catch{}}function bt(){var dt,ut,mt;const{notify:t}=_e(),[r,i]=s.useState(le.history||[]),[o,p]=s.useState(le.index??-1),[l,f]=s.useState(le.queue||[]),[A,v]=s.useState(!1),[E,x]=s.useState(!1),[S,_]=s.useState(le.eligibleCount??null),[T,y]=s.useState(le.viewedCount??0),[k,I]=s.useState(!1),[c,C]=s.useState(!0),[F,g]=s.useState(!1),[j,N]=s.useState(!1),[b,V]=s.useState(!1),[se,ae]=s.useState(!1),[te,q]=s.useState(!1),[ee,$]=s.useState([]),[W,O]=s.useState(""),[ne,m]=s.useState(null),[P,D]=s.useState(!1),[Y,ge]=s.useState(null),[u,H]=s.useState(!1),z=s.useRef(new Set(le.seenIds||[])),ie=s.useRef(new Set),ke=s.useRef(!1),be=s.useRef(le.lastShownVideoId??null),Te=s.useRef(!1),Se=s.useRef(0),Xe=s.useRef(0),Ze=s.useRef(0),G=s.useRef(null),et=s.useRef(null),Ie=s.useRef(null),De=s.useRef(null),Pe=s.useRef(null),We=s.useRef(null),$e=s.useRef(null),qe=s.useRef(null),Re=s.useRef(0),tt=s.useRef(0),Ee=s.useRef(null),Le=s.useRef(null),[Me,Tt]=s.useState(0),n=s.useMemo(()=>o>=0?r[o]:null,[r,o]);s.useEffect(()=>{Hs()},[]),s.useEffect(()=>{gt({history:r,index:o,queue:l,seenIds:Array.from(z.current),eligibleCount:S??void 0,viewedCount:T,lastShownVideoId:be.current??void 0})},[r,o,l,S,T]);const he=s.useCallback(()=>{try{const a=localStorage.getItem("filter_modes"),d=(a?String(a):"standard").toLowerCase().split(",").map(L=>L.trim()).filter(Boolean),h=["standard","taiko","mania","catch"],w=Array.from(new Set(d.filter(L=>h.includes(L))));return w.length?w:["standard"]}catch{return["standard"]}},[]),st=s.useCallback(()=>{const a=new Set;return be.current!==null&&a.add(be.current),Array.from(z.current).slice(-200).forEach(h=>a.add(h)),l.forEach(h=>a.add(h.id)),Array.from(a)},[l]),Ue=s.useCallback(async(a=3)=>{var w,L,U,de;if(ke.current)return[];const d=Date.now();if(d<Se.current){const X=Math.ceil((Se.current-d)/1e3);return t(`Rate limited. Please wait ${X}s.`,{durationMs:3e3,variant:"warn"}),[]}const h=d-Ze.current;if(h<2e3){const X=2e3-h;await new Promise(ve=>setTimeout(ve,X))}ke.current=!0,Ze.current=Date.now();try{const X=st(),ve=he().join(","),ue=[],fe=new Set(l.map(re=>re.id));let xe=[...X];const He=Math.min(a,3);for(let re=0;re<He;re++){if(re>0){const B=Date.now()-Xe.current,K=1e3;B<K&&await new Promise(oe=>setTimeout(oe,K-B))}try{Xe.current=Date.now();const B=await M(R.feed.next+je({exclude:xe.join(","),modes:ve}),{requireAuth:!1}),K=B&&("id"in B?B:B.video)||null;if(!K)break;if(z.current.has(K.id)||fe.has(K.id)||K.id===be.current){xe.push(K.id);continue}ue.push(K),xe.push(K.id),fe.add(K.id)}catch(B){if((w=B==null?void 0:B.message)!=null&&w.includes("401")||(L=B==null?void 0:B.message)!=null&&L.includes("Unauthorized")){I(!0);break}else if((U=B==null?void 0:B.message)!=null&&U.includes("429")||(de=B==null?void 0:B.message)!=null&&de.includes("rate limit")){Se.current=Date.now()+5e3,t("Rate limited. Please wait a moment.",{durationMs:5e3,variant:"warn"});break}}}if(ue.length>0&&f(re=>{const B=new Set(re.map(oe=>oe.id)),K=ue.filter(oe=>!B.has(oe.id));return[...re,...K]}),ue.length===0&&l.length===0)try{const re=he().join(","),B=await M(R.feed.progress(re),{requireAuth:!1});_(Number(B.eligible||0)),y(Number(B.viewed||0)),x(Number(B.caught_up||0)===1)}catch{}return ue}catch{return[]}finally{ke.current=!1}},[st,he,l,t]),ce=s.useCallback(async()=>{if(!A){v(!0);try{l.length<=2&&Ue(3).catch(()=>{});let a;if(l.length>0)a=l[0],f(d=>d.filter(h=>h.id!==a.id));else{const d=await Ue(3);d.length>0&&(a=d[0],d.length>1&&f(h=>{const w=new Set(h.map(U=>U.id)),L=d.slice(1).filter(U=>!w.has(U.id));return[...h,...L]}))}if(a)be.current=a.id,z.current.add(a.id),gt({seenIds:Array.from(z.current)}),i(d=>{const h=[...d.slice(0,o+1),a];return p(h.length-1),h}),ie.current.has(a.id)||(ie.current.add(a.id),M(R.videos.view(a.id),{method:"POST"}).then(d=>{d&&i(h=>{const w=[...h],L=w.findIndex(U=>U.id===a.id);return L!==-1&&(w[L]={...w[L],views_count:d.views_count??w[L].views_count??0,viewed_by_me:!0}),w})}).catch(()=>{}));else try{const d=he().join(","),h=await M(R.feed.progress(d),{requireAuth:!1});_(Number(h.eligible||0)),y(Number(h.viewed||0)),x(Number(h.eligible||0)>0&&Number(h.viewed||0)>=Number(h.eligible||0))}catch{}}finally{v(!1)}}},[A,l,Ue,o,he]),It=s.useCallback(()=>{G.current&&!G.current.paused&&G.current.pause(),g(!0),q(!1)},[]),Be=s.useCallback(()=>{o>0&&(p(o-1),g(!1))},[o]),Oe=s.useCallback(()=>{const a=Date.now();if(!(a-tt.current<300)){if(tt.current=a,c||(Te.current=!0,C(!1)),o<r.length-1){const d=r[o+1];console.log("[Discover] Navigating to next video in history:",{currentIndex:o,nextIndex:o+1,currentVideoId:n==null?void 0:n.id,nextVideoId:d==null?void 0:d.id,nextVideoStreamUID:d==null?void 0:d.stream_uid}),d&&(be.current=d.id),p(o+1),g(!1);return}if(!E){if(Date.now()<Se.current){const d=Math.ceil((Se.current-Date.now())/1e3);t(`Rate limited. Please wait ${d}s.`,{durationMs:3e3,variant:"warn"});return}console.log("[Discover] Fetching next video (queue empty)"),ce()}}},[o,r,c,E,ce,t,n]);s.useEffect(()=>{const a=et.current;if(!a)return;const d=L=>{if(k||Math.abs(L.deltaY)<Math.abs(L.deltaX))return;L.preventDefault(),L.stopPropagation();const U=Date.now();if(!(U<Re.current)){if(Re.current=U+1e3,!n){L.deltaY>0&&!A&&ce();return}L.deltaY>0?Oe():Be()}},h=L=>{Ee.current=L.touches[0].clientY,Le.current=Date.now()},w=L=>{if(k||Ee.current===null||Le.current===null)return;const U=L.changedTouches[0].clientY,de=Date.now(),X=Ee.current-U,ve=de-Le.current;if(Ee.current=null,Le.current=null,Math.abs(X)<50||ve>300)return;const ue=Date.now();if(!(ue<Re.current)){if(Re.current=ue+1e3,!n){X>0&&!A&&ce();return}X>0?Oe():Be()}};return a.addEventListener("wheel",d,{passive:!1,capture:!0}),a.addEventListener("touchstart",h,{passive:!0}),a.addEventListener("touchend",w,{passive:!0}),window.addEventListener("wheel",d,{passive:!1,capture:!0}),()=>{a.removeEventListener("wheel",d,{capture:!0}),a.removeEventListener("touchstart",h),a.removeEventListener("touchend",w),window.removeEventListener("wheel",d,{capture:!0})}},[Oe,Be,n,A,ce,k]);const Rt=s.useCallback(async()=>{var a,d;if(!(!n||u)){H(!0);try{const h=n.liked_by_me?"DELETE":"POST",w=await M(R.videos.like(n.id),{method:h});i(L=>{const U=[...L],de=U.findIndex(X=>X.id===n.id);return de!==-1&&(U[de]={...U[de],liked_by_me:!n.liked_by_me,likes_count:w.likes_count}),U})}catch(h){((a=h==null?void 0:h.message)!=null&&a.includes("429")||(d=h==null?void 0:h.message)!=null&&d.includes("rate limit"))&&t("Please slow down a bit.",{durationMs:5e3,variant:"warn"})}finally{H(!1)}}},[n,u,t]),at=s.useCallback(async a=>{if(n)try{await M(R.videos.flag(n.id),{method:"POST",body:JSON.stringify({reason:a})}),t("Thanks for your report.",{variant:"info"})}catch{t("Report failed",{variant:"error"})}finally{V(!1)}},[n,t]),Et=s.useCallback(async()=>{if(!n)return;const a=!n.is_starred,d=a?"star":"unstar";try{await M(R.admin.videosAction(n.id,d),{method:"POST"}),i(h=>{const w=[...h],L=w.findIndex(U=>U.id===n.id);return L!==-1&&(w[L]={...w[L],is_starred:a}),w}),ae(!1),t(a?"Post starred":"Star removed",{variant:"success"})}catch{t("Action failed",{variant:"error"})}},[n,t]),nt=s.useCallback(async()=>{if(!(!n||!confirm("Permanently delete this video?")))try{await M(R.videos.delete(n.id),{method:"DELETE"}),t("Deleted",{variant:"warn"}),V(!1),i(a=>{const d=a.filter((h,w)=>w!==o);return d.length===0?(p(-1),setTimeout(ce,0)):p(h=>Math.max(0,Math.min(h,d.length-1))),d})}catch{alert("Delete failed")}},[n,o,ce,t]),Ae=s.useCallback(async()=>{if(n!=null&&n.id)try{const a=await M(R.videos.comments(n.id),{requireAuth:!1});$(a.items||[])}catch{}},[n==null?void 0:n.id]);s.useEffect(()=>{j&&(n!=null&&n.id)&&Ae()},[j,n==null?void 0:n.id,Ae]);const it=s.useCallback(async a=>{if(a.preventDefault(),!(!W.trim()||!(n!=null&&n.id))){D(!0);try{await M(R.videos.comments(n.id),{method:"POST",body:JSON.stringify({text:W.trim(),parent_id:ne||void 0})}),O(""),m(null),Ae(),i(d=>{const h=[...d],w=h.findIndex(L=>L.id===n.id);return w!==-1&&(h[w]={...h[w],comments_count:(h[w].comments_count||0)+1}),h}),t("Comment posted!",{variant:"success"})}catch(d){t((d==null?void 0:d.message)||"Failed to post comment",{variant:"error"})}finally{D(!1)}}},[W,n,ne,Ae,t]),Lt=s.useCallback(a=>{$(d=>d.filter(h=>h.id!==a)),i(d=>{const h=[...d],w=h.findIndex(L=>L.id===(n==null?void 0:n.id));return w!==-1&&(h[w]={...h[w],comments_count:Math.max(0,(h[w].comments_count||0)-1)}),h})},[n==null?void 0:n.id]),{topLevelComments:rt,repliesMap:ot}=s.useMemo(()=>{const a=ee.filter(h=>!h.parent_id),d=new Map;return ee.filter(h=>h.parent_id).forEach(h=>{const w=h.parent_id;d.has(w)||d.set(w,[]),d.get(w).push(h)}),{topLevelComments:a,repliesMap:d}},[ee]),Mt=s.useCallback(()=>{if(!G.current)return;const a=!c;C(a),G.current.muted=a,a||(Te.current=!0),!a&&G.current.paused&&G.current.play().catch(()=>{})},[c]),At=s.useCallback(a=>{G.current=a,a&&(a.muted=c)},[c]);s.useEffect(()=>{g(!1),N(!1),Te.current?C(!1):C(!0)},[n==null?void 0:n.id,n==null?void 0:n.stream_uid,o,r.length]),s.useEffect(()=>{G.current&&(G.current.muted=c)},[c]),s.useEffect(()=>{if(!n)return;const a=!Te.current;C(a);const d=setTimeout(()=>{G.current&&(G.current.muted=a)},100);return()=>clearTimeout(d)},[n==null?void 0:n.id]),s.useEffect(()=>{n&&(be.current=n.id)},[n==null?void 0:n.id]),s.useEffect(()=>{F&&G.current&&!G.current.paused&&G.current.pause()},[F]),s.useEffect(()=>{r.length===0&&ce()},[]),s.useEffect(()=>{(async()=>{try{const a=he().join(","),d=await M(R.feed.progress(a),{requireAuth:!1}),h=Number(d.eligible||0),w=Number(d.viewed||0);_(h),y(w),x(h>0&&w>=h)}catch{}})()},[he]),s.useEffect(()=>{const a=()=>{i([]),f([]),z.current.clear(),be.current=null,p(-1),x(!1),(async()=>{try{const d=he().join(","),h=await M(R.feed.progress(d),{requireAuth:!1}),w=Number(h.eligible||0),L=Number(h.viewed||0);_(w),y(L),x(!1)}catch{}ce()})()};return window.addEventListener("filterchange",a),()=>window.removeEventListener("filterchange",a)},[he,ce]),s.useEffect(()=>{(async()=>{try{const a=await M(R.auth.me,{requireAuth:!1});ge(a)}catch{}})()},[]);const[ye,lt]=s.useState(()=>typeof window<"u"?window.matchMedia("(max-width: 480px)").matches:!1);s.useEffect(()=>{const a=()=>{const w=document.querySelector(".top-nav");w&&Tt(w.offsetHeight),lt(window.matchMedia("(max-width: 480px)").matches)};a();const d=window.matchMedia("(max-width: 480px)"),h=()=>lt(d.matches);return d.addEventListener("change",h),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a),d.removeEventListener("change",h)}},[]),s.useEffect(()=>{var h;if(!Ie.current||!De.current||!n||!G.current)return;const a=()=>{var ve;const w=(ve=De.current)==null?void 0:ve.querySelector("div"),L=G.current;if(!w||!L||!Ie.current)return;const U=Ie.current,de=window.matchMedia("(max-width: 480px)").matches;let X;if(n.width&&n.height?X=n.width/n.height:L.videoWidth>0&&L.videoHeight>0?X=L.videoWidth/L.videoHeight:X=16/9,de){const fe=U.offsetWidth,xe=fe/X;w.style.width=`${fe}px`,w.style.height=`${xe}px`,w.style.maxWidth="100%",w.style.maxHeight="100%"}else{const fe=U.offsetWidth-32,xe=U.offsetHeight-32,He=16/9,re=fe/He;let K=Math.min(xe,re),oe=K*X;oe>fe&&(oe=fe,K=oe/X),K>xe&&(K=xe,oe=K*X),w.style.width=`${oe}px`,w.style.height=`${K}px`,w.style.maxWidth="100%",w.style.maxHeight="100%"}},d=()=>{requestAnimationFrame(a)};if(G.current.readyState>=1)a();else{const w=()=>{var L;a(),(L=G.current)==null||L.removeEventListener("loadedmetadata",w)};(h=G.current)==null||h.addEventListener("loadedmetadata",w)}return window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[n==null?void 0:n.id,n==null?void 0:n.width,n==null?void 0:n.height]),s.useEffect(()=>{if(!b)return;const a=d=>{Pe.current&&!Pe.current.contains(d.target)&&V(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[b]),s.useEffect(()=>{if(!se)return;const a=d=>{We.current&&!We.current.contains(d.target)&&ae(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[se]),s.useEffect(()=>{if(!te)return;const a=d=>{$e.current&&!$e.current.contains(d.target)&&qe.current&&!qe.current.contains(d.target)&&q(!1)};return document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[te]);const ct=!!(Y!=null&&Y.is_admin||Y!=null&&Y.is_mod);return e.jsxs(e.Fragment,{children:[e.jsx(Ct,{paused:ye}),e.jsx("style",{children:`
        .video-area .discover-player-wrapper {
          position: relative !important;
          width: 100% !important;
          height: 100% !important;
          max-width: 100% !important;
          max-height: 100% !important;
          min-height: 100% !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          box-sizing: border-box !important;
        }
        .video-area .discover-player-wrapper > div {
          position: relative !important;
          /* Dimensions will be set by JavaScript to ensure proper fit */
          box-sizing: border-box !important;
          /* Center the video within container */
          flex-shrink: 1 !important;
          min-width: 0 !important;
          min-height: 0 !important;
          align-self: center !important;
        }
        .video-area .discover-player-wrapper > div[style] {
          /* JavaScript will set width and height, but ensure max constraints */
          max-width: 100% !important;
          max-height: 100% !important;
          box-sizing: border-box !important;
          flex-shrink: 1 !important;
          min-width: 0 !important;
          min-height: 0 !important;
        }
        /* Ensure wrapper constrains width to prevent overflow */
        .video-area .discover-player-wrapper {
          max-width: 100% !important;
          width: 100% !important;
          overflow: hidden !important;
          /* Use flexbox to center and constrain */
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }
        .video-area .discover-player-wrapper video {
          /* Ensure video content is fully visible - no cropping */
          width: 100% !important;
          height: 100% !important;
          object-fit: contain !important;
          max-width: 100% !important;
          max-height: 100% !important;
        }
        /* Mobile-specific: ensure videos take full width */
        @media (max-width: 480px) {
          .video-area .discover-player-wrapper > div {
            min-width: 100% !important;
            max-width: 100% !important;
          }
          .video-area .discover-player-wrapper > div[style] {
            min-width: 100% !important;
            max-width: 100% !important;
          }
        }
      `}),e.jsxs("div",{ref:et,className:"player-wrap",style:{height:"100dvh",width:"100vw",position:"fixed",top:ye?"calc(0px - env(safe-area-inset-top, 0px))":0,left:0,right:0,bottom:0,overflow:"hidden",background:"transparent",zIndex:1,margin:0,padding:0,boxSizing:"border-box"},children:[E&&e.jsx("div",{className:"chip info",style:{position:"absolute",top:Me+20,left:"50%",transform:"translateX(-50%)",zIndex:10,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(10px)"},children:"You're all caught up. Check 'Feed' to watch videos you've seen already."}),e.jsx("div",{ref:Ie,className:"video-area discover-video-container",style:{position:"absolute",top:ye?0:Me,left:0,right:0,bottom:ye?"-10px":0,maxHeight:ye?"calc(100dvh + env(safe-area-inset-top, 0px) + 2px)":`calc(100dvh - ${Me}px)`,height:ye?"calc(100dvh + env(safe-area-inset-top, 0px) + 2px)":`calc(100dvh - ${Me}px)`,display:"flex",alignItems:"center",justifyContent:"center",background:"#000",transition:ye?"none":"bottom 0.3s ease-out, max-height 0.3s ease-out, height 0.3s ease-out",overflow:"hidden",boxSizing:"border-box",padding:ye?"0":"16px",maxWidth:"100vw",width:"100%"},children:k?e.jsxs("div",{className:"col",style:{alignItems:"center",zIndex:10},children:[e.jsx("div",{className:"muted",style:{marginBottom:8},children:"Please log in to view videos."}),e.jsx("button",{className:"btn",onClick:()=>window.location.href=Ge+R.auth.login,children:"Login with osu!"})]}):n?e.jsx("div",{style:{width:"100%",height:"100%",maxWidth:"100%",maxHeight:"100%",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",overflow:"hidden"},children:e.jsxs("div",{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:10,pointerEvents:"none"}}),e.jsxs("div",{onClick:Mt,style:{position:"relative",width:"100%",height:"100%",cursor:"pointer",zIndex:1,display:"flex",alignItems:"center",justifyContent:"center",maxWidth:"100%",maxHeight:"100%"},children:[e.jsx("div",{ref:De,className:"discover-player-wrapper",children:e.jsx(ls,{streamUID:n.stream_uid,playbackUrl:n.playback_url,aspectRatio:n.width&&n.height?n.width/n.height:null,preferNative:!0,autoplay:!0,loop:!0,muted:c,controls:!1,onVideoRef:At})}),e.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(0,0,0,0.6)",backdropFilter:"blur(10px)",borderRadius:"50%",width:56,height:56,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",transition:"opacity 0.3s ease",opacity:c?1:0,zIndex:2},children:c?e.jsx(Kt,{size:28,color:"#fff"}):e.jsx(Xt,{size:28,color:"#fff"})})]})]})}):E?null:e.jsxs("div",{className:"muted",style:{zIndex:10,textAlign:"center",padding:"20px",maxWidth:"400px",pointerEvents:"none"},children:[e.jsx("div",{style:{marginBottom:12,fontSize:14,fontWeight:500},children:"How to navigate"}),e.jsxs("div",{style:{fontSize:12,lineHeight:1.6},children:[e.jsx("div",{children:"â€¢ Scroll up/down or swipe to change videos"}),e.jsx("div",{children:"â€¢ Click video to toggle mute/unmute"}),e.jsx("div",{children:"â€¢ Hold to pause temporarily"})]})]})}),n&&!F&&e.jsxs("div",{style:{position:"absolute",right:16,top:"50%",display:"flex",flexDirection:"column",gap:20,alignItems:"center",zIndex:15,pointerEvents:"auto",transform:"translateY(-50%) scale(1)",transformOrigin:"center right"},onClick:a=>a.stopPropagation(),children:[e.jsx(Q,{to:`/profile/${(dt=n.uploader)==null?void 0:dt.id}`,style:{width:48,height:48,borderRadius:"50%",border:"2px solid rgba(255,255,255,0.3)",overflow:"hidden",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none"},children:(ut=n.uploader)!=null&&ut.avatar_url?e.jsx("img",{src:n.uploader.avatar_url,width:48,height:48,style:{borderRadius:"50%",objectFit:"cover",display:"block"},alt:n.uploader.username}):e.jsx("div",{style:{width:48,height:48,background:"rgba(255,255,255,0.1)"}})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("button",{onClick:Rt,disabled:u,"aria-label":n.liked_by_me?"Unlike":"Like",title:n.liked_by_me?"Unlike":"Like",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:n.liked_by_me?"#f87171":"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:n.liked_by_me?e.jsx(wt,{size:28}):e.jsx(kt,{size:28})}),e.jsx("span",{style:{color:"#fff",fontSize:12,fontWeight:600,textShadow:"0 1px 3px rgba(0,0,0,0.8)"},children:n.likes_count??0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("button",{onClick:()=>N(!0),"aria-label":"Comments",title:"Comments",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(St,{size:28})}),e.jsx("span",{style:{color:"#fff",fontSize:12,fontWeight:600,textShadow:"0 1px 3px rgba(0,0,0,0.8)"},children:n.comments_count??0})]}),n.beatmap_url&&e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{ref:qe,onClick:()=>q(a=>!a),title:"Beatmap options","aria-label":"Beatmap options",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(Je,{size:24})}),te&&e.jsxs("div",{ref:$e,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:160,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsxs("a",{className:"menu-item",href:n.beatmap_url,target:"_blank",rel:"noreferrer",onClick:()=>q(!1),children:[e.jsx(Je,{size:16,style:{marginRight:8}}),"osu.ppy.sh"]}),n.beatmapset_id&&e.jsx("button",{className:"menu-item",onClick:It,children:"Preview"})]})]}),ct?e.jsxs("div",{style:{position:"relative"},children:[e.jsx("button",{onClick:()=>ae(a=>!a),title:"Manage","aria-label":"Manage",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(xt,{size:24})}),se&&e.jsxs("div",{ref:We,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:180,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsx("button",{className:"menu-item",onClick:Et,children:n.is_starred?"Unstar post":"Star post"}),e.jsx("button",{className:"menu-item",onClick:nt,children:"Delete video"})]})]}):e.jsx("button",{onClick:()=>V(a=>!a),title:"Report","aria-label":"Report",style:{width:48,height:48,borderRadius:"50%",border:"none",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#fff",transition:"transform 0.2s ease",pointerEvents:"auto"},onMouseEnter:a=>a.currentTarget.style.transform="scale(1.1)",onMouseLeave:a=>a.currentTarget.style.transform="scale(1)",children:e.jsx(Zt,{size:24})}),b&&e.jsxs("div",{ref:Pe,style:{position:"absolute",bottom:60,right:0,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:6,zIndex:100,minWidth:160,boxShadow:"0 12px 30px rgba(0,0,0,0.4)"},children:[e.jsx("div",{className:"muted",style:{fontSize:12,padding:"4px 8px"},children:"Report asâ€¦"}),e.jsx("button",{className:"menu-item",onClick:()=>at("unrelated"),children:"Unrelated"}),e.jsx("button",{className:"menu-item",onClick:()=>at("explicit"),children:"Explicit"}),ct&&e.jsx("button",{className:"menu-item",onClick:nt,children:"Delete video"})]})]}),n&&!F&&e.jsxs("div",{style:{position:"absolute",left:16,bottom:80,right:80,zIndex:15,pointerEvents:"none",display:"flex",flexDirection:"column",gap:12,transformOrigin:"bottom left"},onClick:a=>a.stopPropagation(),children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,pointerEvents:"auto"},children:e.jsx(Q,{to:`/profile/${(mt=n.uploader)==null?void 0:mt.id}`,style:{textDecoration:"none",color:"#fff",fontWeight:600,fontSize:"clamp(14px, 16px, 18px)",display:"flex",alignItems:"center",gap:8,textShadow:"0 1px 3px rgba(0,0,0,0.8)",transition:"font-size 0.3s ease-out"},children:(()=>{var w,L,U;const a=(w=n.uploader)==null?void 0:w.is_admin,d=(L=n.uploader)==null?void 0:L.is_mod,h=a?"#fff3bf":d?"#d7fbe8":"#fff";return e.jsxs(e.Fragment,{children:[e.jsxs("span",{style:{color:h},children:["@",(U=n.uploader)==null?void 0:U.username]}),n.is_starred&&e.jsx(jt,{size:16,color:"#f59e0b",title:"Starred"}),(a||d)&&e.jsx(xt,{size:14,color:h,title:a?"admin":"mod"})]})})()})}),(n.description??"").trim()&&e.jsx("div",{style:{color:"#fff",fontSize:"clamp(12px, 14px, 16px)",lineHeight:1.5,textShadow:"0 1px 3px rgba(0,0,0,0.8)",maxWidth:"85%",wordBreak:"break-word",pointerEvents:"auto",transition:"font-size 0.3s ease-out"},children:n.description}),n.beatmap_title&&e.jsxs("div",{style:{color:"rgba(255,255,255,0.9)",fontSize:"clamp(11px, 13px, 15px)",textShadow:"0 1px 3px rgba(0,0,0,0.8)",pointerEvents:"auto",transition:"font-size 0.3s ease-out"},children:[n.beatmap_artist," â€“ ",n.beatmap_title," ",n.beatmap_mapper?`(by ${n.beatmap_mapper})`:""," ",n.beatmap_version?`[${n.beatmap_version}]`:""]})]}),j&&n&&e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
              @keyframes slideUp {
                from { transform: translateY(100%); }
                to { transform: translateY(0); }
              }
            `}),e.jsxs("div",{style:{position:"fixed",bottom:0,left:0,right:0,height:"50%",background:"var(--panel)",borderTop:"1px solid rgba(255,255,255,0.08)",borderTopLeftRadius:20,borderTopRightRadius:20,display:"flex",flexDirection:"column",zIndex:20,boxShadow:"0 -4px 20px rgba(0,0,0,0.3)",animation:"slideUp 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 20px",borderBottom:"1px solid rgba(255,255,255,0.06)"},children:[e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:["Comments (",n.comments_count??0,")"]}),e.jsx("button",{onClick:()=>N(!1),style:{background:"transparent",border:"none",color:"var(--text)",cursor:"pointer",padding:"4px",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"Close comments",children:e.jsx(Ke,{size:24})})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"8px 0"},children:rt.length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No comments yet. Be the first to comment!"}):e.jsx("div",{className:"col",style:{gap:0},children:rt.map(a=>e.jsx(cs,{comment:a,replies:ot.get(a.id)||[],me:Y,section:"mappi",onReply:d=>m(d),onDelete:Lt,replyingTo:ne,replyText:W,onReplyTextChange:O,onReplySubmit:it,posting:P,onCancelReply:()=>{m(null),O("")},repliesMap:ot},a.id))})}),Y&&!ne&&e.jsx("div",{style:{padding:"12px 20px",borderTop:"1px solid rgba(255,255,255,0.06)",background:"var(--panel-dark)"},children:e.jsxs("form",{onSubmit:it,style:{display:"flex",alignItems:"flex-end",gap:8},children:[e.jsx("textarea",{placeholder:"Write a comment...",value:W,onChange:a=>O(a.target.value),rows:1,style:{flex:1,background:"#0b0d10",border:"1px solid rgba(255,255,255,0.12)",borderRadius:6,padding:"8px 12px",color:"var(--text)",fontFamily:"inherit",fontSize:13,resize:"none",minHeight:"36px",maxHeight:"120px",overflowY:"auto"},onInput:a=>{const d=a.target;d.style.height="auto",d.style.height=`${Math.min(d.scrollHeight,120)}px`}}),e.jsx("button",{type:"submit",className:"btn compact",disabled:P||!W.trim(),style:{padding:"8px 16px",fontSize:13,flexShrink:0},children:P?"...":"Post"})]})})]})]}),F&&(n==null?void 0:n.beatmapset_id)&&e.jsx(Ss,{open:F,onClose:()=>g(!1),downloadUrl:`${Ge}${R.osu.downloadBeatmapset(n.beatmapset_id)}`,beatmapId:n.beatmap_id??void 0,beatmapVersion:n.beatmap_version??void 0})]})]})}function yt(t){if(!t)return"standard";const r=String(t).toLowerCase().trim();return r==="osu"||r==="0"||r==="standard"?"standard":r==="taiko"||r==="1"?"taiko":r==="catch"||r==="fruits"||r==="2"?"catch":r==="mania"||r==="3"?"mania":"standard"}const Qs=({open:t,onClose:r,videoId:i,initialDescription:o,initialBeatmapUrl:p,onSave:l})=>{const[f,A]=s.useState(o||""),[v,E]=s.useState(p||""),[x,S]=s.useState(null),[_,T]=s.useState(null),[y,k]=s.useState(""),[I,c]=s.useState(!1),C=s.useRef(0);s.useEffect(()=>{t&&(A(o||""),E(p||""),S(null),T(null),k(""))},[t,o,p]),s.useEffect(()=>{if(!t)return;C.current&&window.clearTimeout(C.current);const g=(v||"").trim();if(!g){k(""),S(null),T(null);return}if(!/^https?:\/\/osu\.ppy\.sh\/(beatmapsets|beatmaps)\//i.test(g)){k(""),S(null),T(null);return}return C.current=window.setTimeout(async()=>{var N;try{let b;try{b=new URL(g)}catch{k("Invalid URL format");return}const V=b.hash.match(/#osu\/(\d+)/),se=V?V[1]:null;b.hash="";const te={url:b.toString()};se&&(te.beatmap_id=se);const q=await M(R.osu.resolveBeatmap+je(te),{requireAuth:!1}),ee=Array.isArray(q==null?void 0:q.diffs)?q.diffs:[];if(!ee.length&&!q.setId){k("No difficulties found"),S(null),T(null);return}if(S({setId:Number(q.setId)||0,beatmapId:q.beatmapId??null,title:String(q.title||""),artist:String(q.artist||""),mapper:String(q.mapper||""),diffs:ee}),ee.length>0){const $=Number.isFinite(Number(q.beatmapId))?Number(q.beatmapId):Number((N=ee[0])==null?void 0:N.id),W=ee.find(ne=>Number(ne.id)===$)||ee[0],O=yt(W==null?void 0:W.mode);T({beatmapId:Number(W==null?void 0:W.id)||null,version:String((W==null?void 0:W.version)||""),mode:O})}k("")}catch(b){k(`Failed to resolve: ${(b==null?void 0:b.message)||"Unknown error"}`),S(null),T(null)}},400),()=>{C.current&&window.clearTimeout(C.current)}},[v,t]);const F=async()=>{if(!I){c(!0);try{await M(R.videos.update(i),{method:"PATCH",body:JSON.stringify({description:f.slice(0,100),beatmap_url:v.trim()||void 0})});const g=!!v.trim();if(x||!g)try{await M(R.videos.update(i)+"/beatmap",{method:"PATCH",body:JSON.stringify({beatmapset_id:g&&x&&x.setId>0?x.setId:null,beatmap_id:g&&(_!=null&&_.beatmapId)?_.beatmapId:null,beatmap_version:g&&(_!=null&&_.version)?_.version:null,beatmap_title:g&&(x!=null&&x.title)?x.title:null,beatmap_artist:g&&(x!=null&&x.artist)?x.artist:null,beatmap_mapper:g&&(x!=null&&x.mapper)?x.mapper:null,beatmap_url:g?v.trim():null})})}catch(N){console.warn("Failed to update beatmap metadata:",N)}l(f,v.trim()||null),r()}catch(g){alert((g==null?void 0:g.message)||"Failed to update post")}finally{c(!1)}}};return t?e.jsxs("div",{className:"overlay",role:"dialog","aria-modal":"true",onClick:g=>g.target===g.currentTarget&&r(),children:[e.jsx("div",{className:"overlay-backdrop",onClick:r}),e.jsxs("div",{className:"overlay-card",style:{maxWidth:"600px",width:"calc(100vw - 24px)"},children:[e.jsx("button",{className:"overlay-close",onClick:r,"aria-label":"Close",children:e.jsx(Ke,{size:18})}),e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",children:"Edit Post"}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Description (max 100 chars)"}),e.jsx("textarea",{maxLength:100,placeholder:"Description (max 100 chars)",value:f,onChange:g=>A(g.target.value),style:{height:64,resize:"vertical",background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"}})]}),e.jsxs("div",{className:"col",style:{gap:8},children:[e.jsx("label",{className:"muted",style:{fontSize:12},children:"Beatmap URL (optional)"}),x?e.jsx("div",{className:"col",style:{gap:8},children:e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flexWrap:"wrap"},children:[e.jsxs("div",{className:"chip-btn",style:{cursor:"default"},children:[e.jsxs("strong",{style:{marginRight:6},children:[x.artist," â€“ ",x.title]}),e.jsxs("span",{className:"muted",children:["by ",x.mapper]})]}),e.jsx("select",{value:(_==null?void 0:_.beatmapId)??x.beatmapId??void 0,onChange:g=>{const j=Number(g.target.value),N=(x==null?void 0:x.diffs.find(b=>Number(b.id)===j))||null;if(N){const b=yt(N.mode);T({beatmapId:j,version:N.version,mode:b})}},style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"},children:x.diffs.map(g=>e.jsxs("option",{value:g.id,children:[g.version," (",g.mode,")"]},g.id))}),e.jsx("button",{className:"btn secondary",type:"button",onClick:()=>{S(null),T(null),E("")},children:"Clear"})]})}):e.jsx("input",{type:"url",placeholder:"Beatmap URL (optional) e.g. https://osu.ppy.sh/beatmapsets/...",value:v,onChange:g=>E(g.target.value),style:{background:"var(--panel-dark)",color:"var(--text)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:"8px 10px"}}),y&&e.jsx("div",{className:"muted",style:{color:"var(--danger)",fontSize:12},children:y})]}),e.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn secondary",onClick:r,disabled:I,children:"Cancel"}),e.jsx("button",{className:"btn",onClick:F,disabled:I,children:I?"Saving...":"Save"})]})]})]})]}):null};function vt(){const t=es(),r=ze(),{notify:i}=_e(),[o,p]=s.useState(null),[l,f]=s.useState(null),[A,v]=s.useState(""),[E,x]=s.useState([]),[S,_]=s.useState([]),[T,y]=s.useState([]),[k,I]=s.useState(""),[c,C]=s.useState(null),[F,g]=s.useState([]),[j,N]=s.useState(null),[b,V]=s.useState(""),[se,ae]=s.useState([]),[te,q]=s.useState(null),[ee,$]=s.useState(!1),W=s.useMemo(()=>{const m=t.id?Number(t.id):null;return m?o?o.id===m:!1:!0},[t.id,o]);function O(m){const P=m.stream_uid||String(m.id),D=t.id?`/profile/${t.id}`:"/profile";r(`/mp/feed/${P}`,{state:{returnTo:D}})}s.useEffect(()=>{(async()=>{try{const m=await M(R.auth.me,{requireAuth:!1});p(m),m&&Array.isArray(m.inspirations)&&g(m.inspirations)}catch(m){v((m==null?void 0:m.message)||"Not logged in")}})()},[]),s.useEffect(()=>{(async()=>{try{const m=t.id?Number(t.id):null;if(m){const P=await M(R.users.get(m),{requireAuth:!1});f(P),I(P.about||""),Array.isArray(P.inspirations)&&g(P.inspirations);const D=await M(R.users.videos(m)+je({limit:"60"}),{requireAuth:!1});y(D.items||[]);const Y=await M(R.users.likes(m)+je({limit:"60"}),{requireAuth:!1});_(Y.items||[])}else{if(!o)return;f(o),I(o.about||""),Array.isArray(o.inspirations)&&g(o.inspirations);const P=await M(R.users.myVideos+je({limit:"50"}),{requireAuth:!1});x(P.items||[]);const D=await M(R.users.likes(o.id)+je({limit:"60"}),{requireAuth:!1});_(D.items||[])}}catch{}})()},[t.id,o]),s.useEffect(()=>{$(!1)},[l==null?void 0:l.id]);async function ne(m){try{const D=(await M(R.auth.me,{method:"PATCH",body:JSON.stringify({inspirations:m})})).user||l;f(D),Array.isArray(D==null?void 0:D.inspirations)&&g(D.inspirations),t.id||p(D)}catch{}}return s.useEffect(()=>{let m;return j!==null&&b.trim().length>=2?m=setTimeout(async()=>{try{const P=await M(R.osu.usersSearch(b),{requireAuth:!1});ae(Array.isArray(P.items)?P.items:[])}catch{}},250):ae([]),()=>{m&&clearTimeout(m)}},[b,j]),e.jsxs("div",{className:"feed-container",style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"feed-header",children:[e.jsx("div",{className:"row wrap",style:{alignItems:"center"},children:l?e.jsxs(e.Fragment,{children:[l.avatar_url&&e.jsx("img",{src:l.avatar_url,width:48,height:48,style:{borderRadius:"50%"}}),e.jsxs("div",{className:"col",children:[e.jsxs("div",{className:"title",style:{display:"flex",alignItems:"center",gap:8},children:[l.username,l.osu_user_id&&e.jsx("a",{href:`https://osu.ppy.sh/users/${l.osu_user_id}`,target:"_blank",rel:"noreferrer",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:"var(--text)",opacity:.7,cursor:"pointer",padding:0,textDecoration:"none",transition:"opacity 0.2s ease"},onMouseEnter:m=>m.currentTarget.style.opacity="1",onMouseLeave:m=>m.currentTarget.style.opacity="0.7",title:"View osu! profile","aria-label":"View osu! profile",children:e.jsx(Je,{size:16})})]}),e.jsxs("div",{className:"muted",children:["ID: ",l.id]})]}),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[!W&&F.length>0&&e.jsx("span",{className:"muted",style:{fontSize:12},children:"inspired by:"}),F.map((m,P)=>W?e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>q(m.id),onMouseLeave:()=>q(null),children:[e.jsx("button",{className:"insp-avatar",onClick:()=>{if(!confirm("Remove this inspiration?"))return;const D=F.filter((Y,ge)=>ge!==P);g(D),ne(D)},children:e.jsx("img",{src:m.avatar_url,alt:m.username})}),te===m.id&&e.jsxs("div",{className:"insp-tooltip",children:[m.username," â€” click to remove"]})]},m.id):e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>q(m.id),onMouseLeave:()=>q(null),children:[e.jsx("a",{href:`https://osu.ppy.sh/users/${m.id}`,target:"_blank",rel:"noreferrer",className:"insp-avatar link",children:e.jsx("img",{src:m.avatar_url,alt:m.username})}),te===m.id&&e.jsx("div",{className:"insp-tooltip",children:m.username})]},m.id)),W&&F.length<3&&new Array(3-F.length).fill(0).map((m,P)=>e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>q(-P-1),onMouseLeave:()=>q(null),children:[e.jsx("button",{className:"insp-add",onClick:()=>{N(P),V(""),ae([])},children:"+"}),te===-P-1&&e.jsx("div",{className:"insp-tooltip",children:"Add inspiration"}),j===P&&e.jsxs("div",{className:"insp-pop",role:"dialog","aria-label":"Search osu! users",children:[e.jsx("input",{autoFocus:!0,placeholder:"Search username",value:b,onChange:D=>V(D.target.value)}),e.jsxs("div",{className:"insp-results",children:[se.length===0&&b.trim().length>=2&&e.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:"No results"}),se.map(D=>e.jsxs("button",{className:"insp-result",onClick:()=>{if(o&&Number(o.osu_user_id)===Number(D.id)){i("Kinda based, but no.",{variant:"warn"}),N(null);return}if(F.some(ge=>ge.id===D.id)){N(null);return}const Y=[...F,{id:D.id,username:D.username,avatar_url:D.avatar_url}].slice(0,3);g(Y),N(null),ne(Y)},children:[e.jsx("img",{src:D.avatar_url,alt:"avatar"}),e.jsx("span",{children:D.username})]},D.id))]}),e.jsx("button",{className:"insp-close",onClick:()=>N(null),children:"Close"})]})]},`slot-${P}`))]}),W&&e.jsx("div",{className:"muted",style:{fontSize:12},children:"Who inspires you?"})]})]}):e.jsx("div",{className:"muted",children:A||"Loadingâ€¦"})}),e.jsxs("div",{className:"col",style:{marginTop:12,gap:4},children:[e.jsx("div",{className:"title",children:"About"}),W?e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("textarea",{value:k,onChange:m=>I(m.target.value),rows:3,maxLength:1e3,placeholder:"Write something about yourself (max 1000 chars)"}),e.jsx("div",{className:"row",style:{justifyContent:"flex-end"},children:e.jsx("button",{className:"btn compact",onClick:async()=>{try{const m=await M(R.auth.me,{method:"PATCH",body:JSON.stringify({about:k})});f(m.user||l),p(m.user||o)}catch{}},children:"Save"})})]}):(()=>{const m=((l==null?void 0:l.about)||"").trim()||"No bio.",P=m.length>200,D=P&&!ee?m.slice(0,200)+"...":m;return e.jsxs("div",{className:"col",style:{gap:4},children:[e.jsx("div",{className:"muted",style:{whiteSpace:"pre-wrap"},children:D}),P&&e.jsx("button",{onClick:()=>$(!ee),style:{display:"flex",alignItems:"center",gap:4,background:"transparent",border:"none",color:"var(--muted)",cursor:"pointer",padding:0,fontSize:14,fontFamily:"inherit",marginTop:4},children:ee?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show less"}),e.jsx(ts,{size:14})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Show more"}),e.jsx(Nt,{size:14})]})})]})})()]})]}),e.jsxs("div",{className:"profile-tabs-unified",children:[e.jsxs("div",{className:"profile-tabs-header",role:"tablist","aria-label":"Profile sections",children:[e.jsx("button",{role:"tab","aria-selected":!0,className:"profile-tab active","data-tab":"uploads",onClick:m=>{const P=m.currentTarget.closest(".profile-tabs-unified");P.querySelectorAll(".profile-tab").forEach(Y=>{Y.classList.remove("active"),Y.setAttribute("aria-selected","false")}),m.currentTarget.classList.add("active"),m.currentTarget.setAttribute("aria-selected","true"),P.querySelector(".profile-tabs-content").setAttribute("data-active","uploads")},children:"Uploads"}),e.jsx("button",{role:"tab","aria-selected":!1,className:"profile-tab","data-tab":"likes",onClick:m=>{const P=m.currentTarget.closest(".profile-tabs-unified");P.querySelectorAll(".profile-tab").forEach(Y=>{Y.classList.remove("active"),Y.setAttribute("aria-selected","false")}),m.currentTarget.classList.add("active"),m.currentTarget.setAttribute("aria-selected","true"),P.querySelector(".profile-tabs-content").setAttribute("data-active","likes")},children:"Likes"})]}),e.jsxs("div",{className:"profile-tabs-content","data-active":"uploads",children:[e.jsx("div",{className:"panel uploads",hidden:!1,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[(W?E:T).length===0&&e.jsx("div",{className:"profile-empty-state",children:"No uploads yet."}),(W?E:T).map(m=>(W&&l?(l.id,l.username,l.avatar_url,l.is_admin,l.is_mod):m.uploader,e.jsxs("button",{className:"recent-cell",onClick:()=>O({...m}),children:[m.poster_url?e.jsx("img",{className:"recent-thumb",src:m.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsx("div",{className:"cell-footer",children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(kt,{size:12}),e.jsx("span",{children:m.likes_count??0})]}),e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(St,{size:12}),e.jsx("span",{children:m.comments_count??0})]})]})})]},m.id)))]})})}),e.jsx("div",{className:"panel likes",hidden:!0,children:e.jsx("div",{className:"profile-grid-container",children:e.jsxs("div",{className:"recent-grid cols3",children:[S.length===0&&e.jsx("div",{className:"profile-empty-state",children:"No likes yet."}),S.map(m=>{var P,D;return e.jsxs("button",{className:"recent-cell",onClick:()=>O(m),children:[m.poster_url?e.jsx("img",{className:"recent-thumb",src:m.poster_url,alt:"thumb"}):e.jsx("div",{className:"thumb-fallback"}),e.jsxs("div",{className:"cell-footer",children:[((P=m.uploader)==null?void 0:P.avatar_url)&&e.jsx("img",{className:"cell-avatar",src:m.uploader.avatar_url,alt:"avatar"}),e.jsx("span",{className:"cell-name",children:(D=m.uploader)==null?void 0:D.username})]})]},m.id)})]})})})]})]}),c&&e.jsx(Qs,{open:!!c,onClose:()=>C(null),videoId:c.id,initialDescription:c.description,initialBeatmapUrl:c.beatmap_url,onSave:(m,P)=>{x(E.map(D=>D.id===c.id?{...D,description:m||null,beatmap_url:P}:D)),C(null)}}),e.jsx("style",{children:`
        .insp-avatar { width: 32px; height: 32px; border-radius: 9999px; padding: 0; border: none; overflow: hidden; cursor: pointer; background: rgba(255,255,255,0.06); display: inline-flex; align-items: center; justify-content: center; }
        .insp-avatar.link { background: transparent; border: 1px solid rgba(255,255,255,0.08); }
        .insp-avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }
        .insp-add { width: 32px; height: 32px; border-radius: 9999px; border: 1px dashed rgba(255,255,255,0.25); background: transparent; color: #e5e7eb; font-weight: 700; cursor: pointer; }
        .insp-add:hover { border-color: rgba(255,255,255,0.5); }
        .insp-tooltip {
          position: absolute;
          top: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
          background: rgba(18, 20, 24, 0.95);
          color: var(--text, #e5e7eb);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 14px;
          white-space: nowrap;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
          z-index: 10000;
          pointer-events: none;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
        }
        .insp-tooltip::after {
          content: '';
          position: absolute;
          bottom: 100%;
          left: 50%;
          transform: translateX(-50%);
          width: 0;
          height: 0;
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-bottom: 5px solid rgba(18, 20, 24, 0.95);
        }
        .insp-pop { position: absolute; right: 0; top: 40px; width: 260px; background: var(--panel); border: 1px solid rgba(255,255,255,0.08); border-radius: 10px; box-shadow: 0 12px 30px rgba(0,0,0,0.4); padding: 8px; z-index: 10; }
        .insp-pop input { width: 100%; padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.08); background: var(--panel-dark); color: #fff; outline: none; box-sizing: border-box; display: block; }
        .insp-results { margin-top: 6px; max-height: 220px; overflow: auto; display: grid; gap: 4px; }
        .insp-result { display: grid; grid-template-columns: 24px 1fr; gap: 8px; align-items: center; padding: 6px 8px; border-radius: 8px; border: 1px solid transparent; background: transparent; color: #e5e7eb; cursor: pointer; text-align: left; }
        .insp-result:hover { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.08); }
        .insp-result img { width: 24px; height: 24px; border-radius: 9999px; object-fit: cover; }
        .insp-close { margin-top: 6px; width: 100%; padding: 6px 8px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.04); color: #e5e7eb; cursor: pointer; }
      `})]})}function Ys(){var m,P,D,Y,ge;const[t,r]=s.useState(null),[i,o]=s.useState([]),[p,l]=s.useState(""),[f,A]=s.useState([]),[v,E]=s.useState(null),[x,S]=s.useState([]),[_,T]=s.useState("all"),[y,k]=s.useState("approvals"),[I,c]=s.useState(null),[C,F]=s.useState(""),[g,j]=s.useState(!1),{notify:N}=_e(),[b,V]=s.useState(null),[se,ae]=s.useState(!1);s.useEffect(()=>{(async()=>{try{const u=await M(R.auth.me,{requireAuth:!1});if(r(u),u!=null&&u.is_admin)try{const H=await M(R.admin.settingsModeration,{requireAuth:!1});c(!!H.require_approval)}catch{}}catch{}try{const u=await M(R.admin.videosPending+je({limit:"50"}),{requireAuth:!1});o(u.items||[])}catch{}})()},[]);async function te(){ae(!0);try{const u=await M(R.admin.analytics,{requireAuth:!1});V(u)}finally{ae(!1)}}async function q(){try{const u=await M(R.admin.usersSearch(p),{requireAuth:!1});A(u.items||[])}catch{}}async function ee(u){E(u),S([]);try{const H=await M(R.admin.userVideos(u.id)+je({limit:"50"}),{requireAuth:!1});S(H.items||[])}catch{}}async function $(u,H){try{const z=await M(R.admin.user(u.id),{method:"PATCH",body:JSON.stringify({is_mod:H})}),ie=(z==null?void 0:z.user)||{...u,is_mod:H};N(H?"Granted moderation":"Revoked moderation",{variant:H?"success":"warn"}),E(ie),A(f.map(ke=>ke.id===u.id?ie:ke))}catch{alert("Failed to update")}}const W=!!(t!=null&&t.is_admin||t!=null&&t.is_mod),O=!!(t!=null&&t.is_admin),ne=I===null?null:!I;return e.jsxs("div",{className:"col",style:{width:"100%"},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:10},children:[e.jsx("div",{className:"title",children:"Moderation"}),O&&ne!==null&&e.jsxs("div",{className:"row",style:{alignItems:"center",gap:6},children:[e.jsx("span",{className:"muted",style:{fontSize:12},children:"Auto-approve"}),e.jsx("button",{className:`btn ${ne?"":"secondary"}`,style:{padding:"6px 10px"},onClick:async()=>{if(I===null)return;const u=!I;try{await M(R.admin.settingsModeration,{method:"POST",body:JSON.stringify({require_approval:u})}),c(u),N(u?"Auto-approve disabled":"Auto-approve enabled",{variant:u?"warn":"success"})}catch{alert("Failed to update setting")}},children:ne?"On":"Off"})]})]}),W&&e.jsxs("div",{className:"tabs",role:"tablist","aria-label":"Moderation tabs",children:[e.jsx("button",{role:"tab","aria-selected":y==="approvals",className:`tab ${y==="approvals"?"active":""}`,onClick:()=>k("approvals"),children:"Approvals"}),(O||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="manage",className:`tab ${y==="manage"?"active":""}`,onClick:()=>k("manage"),children:"Manage"}),(O||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="analytics",className:`tab ${y==="analytics"?"active":""}`,onClick:()=>{k("analytics"),b||te()},children:"Analytics"}),(O||(t==null?void 0:t.is_mod))&&e.jsx("button",{role:"tab","aria-selected":y==="message",className:`tab ${y==="message"?"active":""}`,onClick:()=>k("message"),children:"Message"})]})]}),e.jsx("hr",{className:"subtle-divider"}),!W&&e.jsx("div",{className:"muted",children:"You do not have access."}),y==="approvals"&&W&&(()=>{const u=i.filter(z=>!z.flagged_only),H=i.filter(z=>!!z.flagged_only);return e.jsxs("div",{className:"row wrap",style:{marginTop:12,gap:16,alignItems:"flex-start"},children:[e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Pending approvals"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[u.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",children:[u.length===0&&e.jsx("div",{className:"muted",children:"Nothing pending."}),u.map(z=>e.jsxs("div",{className:"row wrap",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[z.poster_url?e.jsx("img",{src:z.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:z.description||"",children:z.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:["uploader: ",z.username,z.needs_review?e.jsx("span",{style:{marginLeft:6,color:"#f59e0b"},children:"(needs review)"}):e.jsx("span",{style:{marginLeft:6,color:"#60a5fa"},children:"(pending)"}),typeof z.flags_count=="number"&&z.flags_count>0?e.jsxs("span",{className:"muted",style:{marginLeft:6},children:["â€¢ ",z.flags_count," reports"]}):null]})]})]}),e.jsxs("div",{className:"row wrap",children:[e.jsx("button",{className:"btn secondary",onClick:async()=>{try{await M(R.admin.videosReject(z.id),{method:"POST"}),o(i.filter(ie=>ie.id!==z.id)),N("Rejected",{variant:"warn"})}catch{}},children:"Reject"}),e.jsx("button",{className:"btn",style:{marginLeft:8},onClick:async()=>{try{await M(R.admin.videosApprove(z.id),{method:"POST"}),o(i.filter(ie=>ie.id!==z.id)),N("Approved",{variant:"success"})}catch{}},children:"Approve"}),e.jsx("button",{className:"btn secondary",style:{marginLeft:8},onClick:async()=>{if(confirm("Permanently delete this video?"))try{await M(R.videos.delete(z.id),{method:"DELETE"}),o(i.filter(ie=>ie.id!==z.id)),N("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]},z.id))]})]}),e.jsxs("div",{className:"col",style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Flagged (FYI)"}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:[H.length," item(s)"]})]}),e.jsxs("div",{className:"scroll-panel sm",children:[H.length===0&&e.jsx("div",{className:"muted",children:"No flagged items."}),H.map(z=>e.jsxs("div",{className:"row wrap",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[z.poster_url?e.jsx("img",{src:z.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:z.description||"",children:z.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:["uploader: ",z.username,e.jsx("span",{style:{marginLeft:6,color:"#9ca3af"},children:"(flagged)"}),typeof z.flags_count=="number"&&z.flags_count>0?e.jsxs("span",{className:"muted",style:{marginLeft:6},children:["â€¢ ",z.flags_count," reports"]}):null]})]})]}),e.jsx("div",{className:"row wrap",children:e.jsx("button",{className:"btn secondary",onClick:async()=>{if(confirm("Permanently delete this video?"))try{await M(R.videos.delete(z.id),{method:"DELETE"}),o(i.filter(ie=>ie.id!==z.id)),N("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})})]},z.id))]}),e.jsx("div",{className:"muted",style:{fontSize:12,marginTop:6},children:"Flagged items donâ€™t require approval; use Delete only if necessary."})]})]})})(),y==="manage"&&(O||(t==null?void 0:t.is_mod))&&e.jsx("div",{className:"col",style:{marginTop:16},children:e.jsxs("div",{className:"mod-manage-grid",children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"User management"}),e.jsxs("div",{className:"row wrap",style:{gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:p,onChange:u=>l(u.target.value),onKeyDown:u=>{u.key==="Enter"&&q()}}),e.jsx("button",{className:"btn",onClick:q,style:{padding:"6px 10px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:8},children:e.jsx("div",{className:"col",style:{gap:6},children:f.map(u=>e.jsxs("button",{className:"btn secondary",onClick:()=>ee(u),style:{justifyContent:"flex-start"},children:[u.avatar_url&&e.jsx("img",{src:u.avatar_url,width:18,height:18,style:{borderRadius:"50%",marginRight:8}}),e.jsx("span",{className:"one-line",style:{marginRight:8},children:u.username}),e.jsxs("span",{className:"muted",children:["(id ",u.id,", osu ",u.osu_user_id,")"]}),u.is_admin?e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"admin"}):u.is_mod?e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"mod"}):u.is_blacklisted?e.jsx("span",{style:{marginLeft:"auto",color:"#f87171"},children:"blacklisted"}):null]},u.id))})})]}),e.jsx("div",{className:"v-divider","aria-hidden":"true"}),e.jsx("div",{className:"col",style:{minWidth:0},children:v?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row wrap",style:{alignItems:"center"},children:[v.avatar_url&&e.jsx("img",{src:v.avatar_url,width:28,height:28,style:{borderRadius:"50%",marginRight:8}}),e.jsx("div",{className:"title",style:{marginRight:8,fontSize:18},children:v.username}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["id ",v.id," â€¢ osu ",v.osu_user_id]}),e.jsx("div",{style:{marginLeft:"auto"}}),O?v.is_admin?e.jsx("span",{}):v.is_mod?e.jsx("button",{className:"btn secondary",style:{padding:"6px 10px"},onClick:()=>$(v,!1),children:"Revoke moderation"}):e.jsx("button",{className:"btn",style:{padding:"6px 10px"},onClick:()=>$(v,!0),children:"Grant moderation"}):null,!v.is_admin&&(v.is_blacklisted?e.jsx("button",{className:"btn",style:{marginLeft:8,padding:"6px 10px"},onClick:async()=>{try{await M(R.admin.user(v.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!1})}),E({...v,is_blacklisted:!1}),N("User unblacklisted",{variant:"success"})}catch{alert("Failed")}},children:"Unblacklist"}):e.jsx("button",{className:"btn secondary",style:{marginLeft:8,padding:"6px 10px"},onClick:async()=>{try{await M(R.admin.user(v.id),{method:"PATCH",body:JSON.stringify({is_blacklisted:!0})}),E({...v,is_blacklisted:!0}),N("User blacklisted",{variant:"warn"})}catch{alert("Failed")}},children:"Blacklist"}))]}),v.is_admin?e.jsx("div",{className:"caption",style:{marginTop:4},children:"Admins always retain access"}):null,e.jsxs("div",{className:"col",style:{marginTop:12},children:[e.jsxs("div",{className:"row-between",style:{alignItems:"center"},children:[e.jsx("div",{className:"title",children:"Uploads"}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("span",{className:"muted",style:{fontSize:12},children:"Show"}),e.jsx("button",{className:`btn ${_==="all"?"":"secondary"}`,onClick:()=>T("all"),children:"All"}),e.jsx("button",{className:`btn ${_==="review"?"":"secondary"}`,onClick:()=>T("review"),children:"Needs review"})]})]}),e.jsxs("div",{className:"scroll-panel sm",style:{marginTop:8},children:[x.length===0&&e.jsx("div",{className:"muted",children:"No uploads."}),x.filter(u=>{if(_==="all")return!0;const H=(I?!u.approved_at:!1)&&u.status==="ready",z=!!u.needs_review;return H||z}).map(u=>e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:"8px 10px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",minWidth:0,gap:10},children:[u.poster_url?e.jsx("img",{src:u.poster_url,width:64,height:36,style:{objectFit:"cover",borderRadius:6}}):e.jsx("div",{style:{width:64,height:36,borderRadius:6,background:"#0f1217"}}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"one-line",title:u.description||"",children:u.description||"No description."}),e.jsxs("div",{className:"muted one-line",children:[u.status.toUpperCase()," â€¢ ",new Date(u.created_at*1e3).toLocaleString(),u.needs_review?e.jsx("span",{style:{marginLeft:6,color:"#f59e0b"},children:"(purgatory)"}):null,I&&!u.approved_at&&u.status==="ready"?e.jsx("span",{style:{marginLeft:6,color:"#60a5fa"},children:"(pending)"}):null]})]})]}),e.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[e.jsx("span",{className:"muted",children:u.likes_count??0}),e.jsx("span",{style:{color:"var(--accent)"},children:"â˜…"}),(O||(t==null?void 0:t.is_mod))&&(!!u.needs_review||I&&!u.approved_at&&u.status==="ready")&&e.jsx("button",{className:"btn",onClick:async()=>{try{await M(R.admin.videosApprove(u.id),{method:"POST"}),S(x.map(H=>H.id===u.id?{...H,approved_at:Math.floor(Date.now()/1e3),needs_review:0}:H)),N("Approved",{variant:"success"})}catch{alert("Approve failed")}},children:"Approve"}),(O||(t==null?void 0:t.is_mod))&&e.jsx("button",{className:"btn secondary",style:{marginLeft:8},onClick:async()=>{if(confirm("Permanently delete this video?"))try{await M(R.videos.delete(u.id),{method:"DELETE"}),S(x.filter(H=>H.id!==u.id)),N("Deleted",{variant:"warn"})}catch{alert("Delete failed")}},children:"Delete"})]})]},u.id))]})]})]}):e.jsx("div",{className:"muted",children:"Select a user to view details and uploads."})})]})}),!1,y==="message"&&(O||(t==null?void 0:t.is_mod))&&e.jsx("div",{className:"col",style:{marginTop:16},children:e.jsxs("div",{className:"mod-manage-grid",children:[e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"Send a system message"}),e.jsxs("div",{className:"row wrap",style:{gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",placeholder:"Search username or ID",value:p,onChange:u=>l(u.target.value),onKeyDown:u=>{u.key==="Enter"&&q()}}),e.jsx("button",{className:"btn",onClick:q,style:{padding:"6px 10px"},children:"Search"})]}),e.jsx("div",{className:"scroll-panel sm",style:{marginTop:8},children:e.jsx("div",{className:"col",style:{gap:6},children:f.map(u=>e.jsxs("button",{className:"btn secondary",onClick:()=>E(u),style:{justifyContent:"flex-start"},children:[u.avatar_url&&e.jsx("img",{src:u.avatar_url,width:18,height:18,style:{borderRadius:"50%",marginRight:8}}),e.jsx("span",{className:"one-line",style:{marginRight:8},children:u.username}),e.jsxs("span",{className:"muted",children:["(id ",u.id,", osu ",u.osu_user_id,")"]}),(v==null?void 0:v.id)===u.id&&e.jsx("span",{style:{marginLeft:"auto",color:"var(--accent)"},children:"selected"})]},u.id))})})]}),e.jsx("div",{className:"v-divider","aria-hidden":"true"}),e.jsxs("div",{className:"col",style:{minWidth:0},children:[e.jsx("div",{className:"title",style:{marginBottom:6},children:"Compose"}),e.jsxs("label",{className:"row",style:{alignItems:"center",gap:8},children:[e.jsx("input",{type:"checkbox",checked:g,onChange:u=>j(u.currentTarget.checked)}),e.jsx("span",{className:"muted",style:{fontSize:12},children:"Send to all users (global)"})]}),e.jsx("textarea",{placeholder:"Message (shown in notifications)",style:{height:120,resize:"vertical"},value:C,onChange:u=>F(u.target.value)}),e.jsx("div",{className:"row wrap",style:{justifyContent:"flex-end",gap:8},children:e.jsx("button",{className:"btn",onClick:()=>{const u=(C||"").trim();if(!u){alert("Enter a message");return}(async()=>{try{const H={text:u,global:g};!g&&(v!=null&&v.id)&&(H.user_id=v.id),await M(R.admin.notificationsSystem,{method:"POST",body:JSON.stringify(H)}),F(""),N("Message sent",{variant:"success"})}catch{alert("Failed to send")}})()},children:"Send"})}),e.jsx("div",{className:"caption",style:{marginTop:6},children:'System messages persist for 24 hours and show an "Expires at" timestamp.'})]})]})}),y==="analytics"&&(O||(t==null?void 0:t.is_mod))&&e.jsxs("div",{className:"col",style:{marginTop:16,gap:12},children:[e.jsx("div",{className:"title",children:"Analytics"}),se&&e.jsx("div",{className:"muted",children:"Loadingâ€¦"}),!se&&!b&&e.jsx("div",{className:"muted",children:"No data."}),b&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row",style:{flexWrap:"wrap",gap:10},children:[e.jsx(pe,{label:"Users",value:b.totals.users_total}),e.jsx(pe,{label:"Admins",value:b.totals.users_admin}),e.jsx(pe,{label:"Mods",value:b.totals.users_mod}),e.jsx(pe,{label:"Blacklisted",value:b.totals.users_blacklisted}),e.jsx(pe,{label:"Videos",value:b.totals.videos_total}),e.jsx(pe,{label:"Ready",value:b.totals.videos_ready}),e.jsx(pe,{label:"Pending",value:b.totals.pending_count}),e.jsx(pe,{label:"Purgatory",value:b.totals.purgatory_count}),e.jsx(pe,{label:"Likes",value:b.totals.likes_total}),e.jsx(pe,{label:"Flags",value:b.totals.flags_total})]}),e.jsxs("div",{className:"row",style:{flexWrap:"wrap",gap:20,marginTop:8},children:[e.jsx(Qe,{title:"New users (30d)",series:b.series.users,color:"#60a5fa"}),e.jsx(Qe,{title:"New videos (30d)",series:b.series.videos,color:"#34d399"}),((P=(m=b.stream)==null?void 0:m.graphql)==null?void 0:P.minutes_viewed)&&b.stream.graphql.minutes_viewed.length>0&&e.jsx(Qe,{title:"Minutes viewed (30d)",series:b.stream.graphql.minutes_viewed,color:"#f59e0b"})]}),e.jsxs("div",{className:"col",style:{gap:6,marginTop:8},children:[e.jsx("div",{className:"title",children:"Feed & Stream"}),e.jsxs("div",{className:"muted",children:["Feed: ",b.feed.count," items in rotation",b.feed.cursor?` â€¢ cursor ${b.feed.cursor}`:""]}),e.jsxs("div",{className:"muted",children:["Approx. ready seconds: ",b.stream.approximate.total_duration_sec," â€¢ ready videos: ",b.stream.approximate.videos_ready]}),b.stream.api&&e.jsxs("div",{className:"muted",style:{fontSize:12},children:["Stream API: ",b.stream.api.ok?"ok":"unavailable",(Y=(D=b.stream.api)==null?void 0:D.result_info)!=null&&Y.count?` â€¢ count ${b.stream.api.result_info.count}`:"",(ge=b.stream.api)!=null&&ge.sample_status?` â€¢ sample status ${String(b.stream.api.sample_status)}`:""]})]})]})]})]})}function pe({label:t,value:r}){return e.jsxs("div",{className:"col",style:{padding:"8px 10px",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,minWidth:120},children:[e.jsx("div",{className:"muted",style:{fontSize:12},children:t}),e.jsx("div",{className:"title",children:r})]})}function Qe({title:t,series:r,color:i}){const E=r.map(j=>j.count),x=Math.max(1,...E),S=s.useMemo(()=>{const j=x,N=Math.pow(10,Math.floor(Math.log10(j))),b=j/N;return(b<=1?1:b<=2?2:b<=5?5:10)*N},[x]),_=350,T=124,y=s.useMemo(()=>r.map((j,N)=>{const b=42+N/Math.max(1,r.length-1)*_,V=8+(1-j.count/(S||1))*T;return[b,V]}),[r,S,_,T]),k=s.useMemo(()=>y.map((j,N)=>N===0?`M ${j[0]} ${j[1]}`:`L ${j[0]} ${j[1]}`).join(" "),[y]),I=[0,.25,.5,.75,1],c=s.useMemo(()=>{if(r.length===0)return[];const j=[0,.25,.5,.75,1].map(N=>Math.min(r.length-1,Math.round(N*(r.length-1))));return Array.from(new Set(j))},[r]),C=j=>{if(!j||j.length<10)return j||"";const N=j.slice(5,7).replace(/^0/,""),b=j.slice(8,10).replace(/^0/,"");return`${N}/${b}`};function F(j){const N=Number.isInteger(j);return j>=1e6?`${(j/1e6).toFixed(1).replace(/\.0$/,"")}M`:j>=1e3?`${(j/1e3).toFixed(1).replace(/\.0$/,"")}k`:N?String(j):j<10?j.toFixed(1):j.toFixed(1).replace(/\.0$/,"")}const g=r.length?r[r.length-1].count:0;return e.jsxs("div",{className:"col",style:{border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,padding:10},children:[e.jsxs("div",{className:"row",style:{alignItems:"baseline",justifyContent:"space-between",marginBottom:6},children:[e.jsx("div",{className:"muted",children:t}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["latest: ",F(g)]})]}),e.jsxs("svg",{width:400,height:160,role:"img","aria-label":t,children:[e.jsx("rect",{x:0,y:0,width:400,height:160,fill:"#0f1217",rx:8}),I.map((j,N)=>{const b=8+(1-j)*T,V=j*S;return e.jsxs("g",{children:[e.jsx("line",{x1:42,y1:b,x2:392,y2:b,stroke:"rgba(255,255,255,0.08)",strokeWidth:1}),e.jsx("text",{x:36,y:b+4,textAnchor:"end",fontSize:10,fill:"rgba(255,255,255,0.6)",children:F(V)})]},N)}),e.jsx("line",{x1:42,y1:8,x2:42,y2:8+T,stroke:"rgba(255,255,255,0.25)",strokeWidth:1}),e.jsx("line",{x1:42,y1:8+T,x2:42+_,y2:8+T,stroke:"rgba(255,255,255,0.25)",strokeWidth:1}),c.map((j,N)=>{var V;const b=42+j/Math.max(1,r.length-1)*_;return e.jsxs("g",{children:[e.jsx("line",{x1:b,y1:8,x2:b,y2:8+T,stroke:"rgba(255,255,255,0.08)",strokeWidth:1}),e.jsx("text",{x:b,y:8+T+12,textAnchor:"middle",fontSize:10,fill:"rgba(255,255,255,0.6)",children:C((V=r[j])==null?void 0:V.day)})]},N)}),e.jsx("path",{d:k,fill:"none",stroke:i,strokeWidth:2}),y.length>0&&e.jsx("circle",{cx:y[y.length-1][0],cy:y[y.length-1][1],r:3,fill:i})]})]})}function Vs(){return e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsxs("div",{className:"title",style:{fontSize:"2em"},children:["mappi! ",e.jsx("span",{style:{fontSize:"0.4em",fontWeight:"normal"},children:"by Catawba."})]}),e.jsx("div",{className:"muted",children:"Hi, I get writers block/lose motivation very very easily. I want this site to counterract that."}),e.jsx("div",{className:"muted",children:"Basically, when you are struggling to come up with ideas; you'd hop on this site, watch a few videos, see something that impresses you, then hopefully you can get back to mapping with a lil' bit of inspiration."}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"How it works:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Log in with your osu! account."}),e.jsx("li",{children:"Upload a clip (100MB max). Allow for it to upload/process."}),e.jsx("li",{children:"Uploaded clips enter the random feed. New uploads and liked videos surface more often."}),e.jsx("li",{children:"Moderators can review reports and pending items for safety."})]})]}),e.jsxs("div",{className:"section-panel",children:[e.jsx("div",{className:"title",style:{fontSize:18},children:"Guidelines:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"You can post two clips every 24 hours before getting rate-limited."}),e.jsx("li",{children:"Keep clips 4:3 or 16:9 for best fit. Ultrawide will letterbox."}),e.jsx("li",{children:"Add a short description and (optional) beatmap link."}),e.jsx("li",{children:"Don't post unrelated content."}),e.jsx("li",{children:"Report posts accordingly and within reason."})]})]})]})}function Js(){return e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("div",{className:"title",style:{fontSize:"2em"},children:"Settings"}),e.jsx("div",{className:"section-panel",children:e.jsx("div",{className:"muted",children:"Settings page coming soon..."})})]})}const Gs=()=>e.jsx(Cs,{}),Ks=()=>e.jsx(is,{children:e.jsxs(J,{element:e.jsx(Us,{}),children:[e.jsx(J,{path:"/",element:e.jsx(Bs,{})}),e.jsx(J,{path:"/mp/discover",element:e.jsx(bt,{})}),e.jsx(J,{path:"/mp/feed",element:e.jsx(Ce,{})}),e.jsx(J,{path:"/mp/feed/:uid",element:e.jsx(us,{})}),e.jsx(J,{path:"/md/feed",element:e.jsx(ys,{})}),e.jsx(J,{path:"/md/feed/:uid",element:e.jsx(vs,{})}),e.jsx(J,{path:"/md/queues",element:e.jsx(js,{})}),e.jsx(J,{path:"/md/queues/:id",element:e.jsx(ws,{})}),e.jsx(J,{path:"/md/notifications",element:e.jsx(Ns,{})}),e.jsx(J,{path:"/profile",element:e.jsx(vt,{})}),e.jsx(J,{path:"/profile/:id",element:e.jsx(vt,{})}),e.jsx(J,{path:"/moderation",element:e.jsx(Ys,{})}),e.jsx(J,{path:"/about",element:e.jsx(Vs,{})}),e.jsx(J,{path:"/settings",element:e.jsx(Js,{})}),e.jsx(J,{path:"/editor",element:e.jsx(Gs,{})}),e.jsx(J,{path:"/feed",element:e.jsx(bt,{})}),e.jsx(J,{path:"/upload",element:e.jsx(Ce,{})}),e.jsx(J,{path:"/posts",element:e.jsx(Ce,{})}),e.jsx(J,{path:"/recents",element:e.jsx(Ce,{})}),e.jsx(J,{path:"/recent",element:e.jsx(Ce,{})})]})}),Xs=()=>e.jsx(ns,{children:e.jsx(Ks,{})});ss(document.getElementById("root")).render(e.jsx(Ts,{children:e.jsx(as,{client:_s,children:e.jsx(ds,{children:e.jsx(Xs,{})})})}));
