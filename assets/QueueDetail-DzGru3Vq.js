import{r as n,j as e,M as Me,Z as $e,_ as Pe,w as Ie,P as Ee,i as We,$ as Ae,U as De,a0 as Le,v as Be,a1 as Ue,L as Oe,c as ne,a2 as Qe,y as Xe,t as xe,a3 as He}from"./vendor-react-DRMPtHf0.js";import{u as ve}from"./index-DRTA66xC.js";import"./vendor-Dm_EoMJn.js";import"./editor-components-B-NcqUmU.js";const oe="https://api.osumappi.ng";function ye(a){var o;return(o=document.cookie.split("; ").map(i=>i.split("=")).find(([i])=>i===a))==null?void 0:o[1]}function Je({submission:a,canManage:o,onUpdate:i}){const[F,c]=n.useState(!1),[W,M]=n.useState(!1),[x,O]=n.useState(null),{notify:y}=ve();n.useEffect(()=>{if(!a.beatmap_url||!a.beatmapset_id&&!a.beatmap_id||x)return;let d=!1;return(async()=>{try{let p;try{p=new URL(a.beatmap_url)}catch{return}const b=p.hash.match(/#osu\/(\d+)/),v=b?b[1]:null;p.hash="";const X=p.toString(),P=new URLSearchParams({url:X});v&&P.set("beatmap_id",v);const R=await fetch(`${oe}/api/osu/beatmap/resolve?${P.toString()}`,{credentials:"include"});if(R.ok&&!d){const S=await R.json();(S.title||S.artist)&&O({title:S.title||null,artist:S.artist||null,mapper:S.mapper||null})}}catch{}})(),()=>{d=!0}},[a.beatmap_url,a.beatmapset_id,a.beatmap_id]);const m=async d=>{if(!F){c(!0);try{const p=ye("csrf")||"";if((await fetch(`${oe}/api/moddi/queues/${a.queue_id}/submissions/${a.id}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":p},body:JSON.stringify({status:d})})).ok){const v={...a,status:d,updated_at:Math.floor(Date.now()/1e3)};i&&i(v),y("Status updated",{variant:"success"})}else y("Failed to update status",{variant:"error"})}catch{y("Failed to update status",{variant:"error"})}finally{c(!1),M(!1)}}},Q=async()=>{if(!F){c(!0);try{const d=ye("csrf")||"",p=!!a.is_archived;if((await fetch(`${oe}/api/moddi/queues/${a.queue_id}/submissions/${a.id}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":d},body:JSON.stringify({is_archived:!p})})).ok){const v={...a,is_archived:p?0:1,updated_at:Math.floor(Date.now()/1e3)};i&&i(v),y(p?"Unarchived":"Archived",{variant:"success"})}else y("Failed to update archive status",{variant:"error"})}catch{y("Failed to update archive status",{variant:"error"})}finally{c(!1)}}},h={unchecked:"#f59e0b",accepted:"#10b981",denied:"#ef4444",finished:"#6366f1"},w={unchecked:"Unchecked",accepted:"Accepted",denied:"Denied",finished:"Finished"},$=a.beatmapset_id?`https://assets.ppy.sh/beatmaps/${a.beatmapset_id}/covers/card.jpg`:null,T=!!a.is_archived;return e.jsxs("div",{style:{position:"relative",borderRadius:12,overflow:"hidden",borderBottom:"1px solid rgba(255,255,255,0.06)",background:"rgba(255,255,255,0.01)",transition:"background-color 0.15s ease",opacity:T?.6:1},onMouseEnter:d=>d.currentTarget.style.backgroundColor="rgba(255,255,255,0.025)",onMouseLeave:d=>d.currentTarget.style.backgroundColor="rgba(255,255,255,0.01)",children:[$&&e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,height:"200px",backgroundImage:`url(${$})`,backgroundSize:"cover",backgroundPosition:"center",opacity:.3,zIndex:0}}),e.jsx("div",{style:{position:"relative",zIndex:1,padding:"16px"},children:e.jsxs("div",{className:"row",style:{alignItems:"flex-start",justifyContent:"space-between",gap:12,marginBottom:12},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[x?e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("div",{style:{fontSize:18,fontWeight:600,marginBottom:4},children:x.title||"Unknown Title"}),e.jsx("div",{className:"muted",style:{fontSize:14,marginBottom:2},children:x.artist||"Unknown Artist"}),x.mapper&&e.jsxs("div",{className:"muted",style:{fontSize:12},children:["Mapped by ",x.mapper]}),a.beatmap_version&&e.jsx("div",{className:"muted",style:{fontSize:12,marginTop:4},children:a.beatmap_version})]}):e.jsx("div",{style:{marginBottom:8},children:e.jsxs("a",{href:a.beatmap_url,target:"_blank",rel:"noreferrer",style:{display:"inline-flex",alignItems:"center",gap:6,color:"#7dd3fc",textDecoration:"none",fontSize:14},children:[e.jsx(Me,{size:14}),"View beatmap"]})}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,marginTop:8},children:[a.avatar_url&&e.jsx("img",{src:a.avatar_url,width:24,height:24,style:{borderRadius:"50%"},alt:a.username}),e.jsx("span",{style:{fontSize:13},children:a.username}),e.jsx("span",{className:"muted",style:{fontSize:12},children:new Date(a.created_at*1e3).toLocaleDateString()})]}),a.message&&e.jsxs("div",{style:{marginTop:12,padding:10,background:"rgba(255,255,255,0.03)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:8,fontSize:13,lineHeight:1.5},children:[e.jsx("div",{className:"muted",style:{fontSize:11,marginBottom:4,fontWeight:600},children:"Message:"}),a.message]})]}),o?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("button",{className:"icon-link",onClick:Q,disabled:F,title:T?"Unarchive":"Archive",style:{color:T?"#6366f1":"var(--muted)",width:"auto",height:"auto",padding:"4px"},children:T?e.jsx($e,{size:16}):e.jsx(Pe,{size:16})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("button",{className:"chip-btn",onClick:()=>M(!W),disabled:F,style:{background:h[a.status]+"20",border:`1px solid ${h[a.status]}40`,color:h[a.status],whiteSpace:"nowrap"},children:[e.jsx("span",{style:{textTransform:"capitalize",fontSize:12},children:w[a.status]}),e.jsx(Ie,{size:12,style:{marginLeft:4}})]}),W&&e.jsx("div",{style:{position:"absolute",right:0,top:"100%",marginTop:4,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:8,padding:4,zIndex:10,minWidth:120,boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:["unchecked","accepted","denied","finished"].map(d=>e.jsx("button",{className:"menu-item",onClick:()=>m(d),style:{color:d===a.status?h[d]:void 0},children:w[d]},d))})]})]}):e.jsx("span",{style:{padding:"6px 12px",borderRadius:6,fontSize:12,fontWeight:500,background:h[a.status]+"20",color:h[a.status],whiteSpace:"nowrap"},children:w[a.status]})]})})]})}const g="https://api.osumappi.ng";function z(a){var o;return(o=document.cookie.split("; ").map(i=>i.split("=")).find(([i])=>i===a))==null?void 0:o[1]}const be=({content:a})=>e.jsx("div",{style:{fontSize:13,lineHeight:1.6,color:"var(--text)"},children:e.jsx(He,{components:{p:({children:o})=>e.jsx("p",{style:{margin:"0 0 8px 0"},children:o}),ul:({children:o})=>e.jsx("ul",{style:{margin:"0 0 8px 0",paddingLeft:20},children:o}),ol:({children:o})=>e.jsx("ol",{style:{margin:"0 0 8px 0",paddingLeft:20},children:o}),li:({children:o})=>e.jsx("li",{style:{margin:"0 0 4px 0"},children:o}),strong:({children:o})=>e.jsx("strong",{style:{fontWeight:600},children:o}),em:({children:o})=>e.jsx("em",{children:o}),code:({children:o})=>e.jsx("code",{style:{background:"rgba(255,255,255,0.1)",padding:"2px 4px",borderRadius:4,fontSize:12},children:o}),h1:({children:o})=>e.jsx("h1",{style:{fontSize:18,fontWeight:700,margin:"0 0 8px 0"},children:o}),h2:({children:o})=>e.jsx("h2",{style:{fontSize:16,fontWeight:700,margin:"0 0 8px 0"},children:o}),h3:({children:o})=>e.jsx("h3",{style:{fontSize:14,fontWeight:600,margin:"0 0 8px 0"},children:o})},children:a})});function Ze(){const{id:a}=Ee(),o=We(),[i,F]=n.useState(null),[c,W]=n.useState([]),[M,x]=n.useState([]),[O,y]=n.useState(!0),[m,Q]=n.useState(null),[h,w]=n.useState(!1),[$,T]=n.useState(!1),[d,p]=n.useState(""),[b,v]=n.useState(""),[X,P]=n.useState(null),[R,S]=n.useState(!1),[H,J]=n.useState(""),[le,G]=n.useState(""),[A,V]=n.useState(""),[k,de]=n.useState(!1),[je,ce]=n.useState(!1),[j,D]=n.useState("general"),[f,ue]=n.useState(!1),[Y,pe]=n.useState(!1),[ge,L]=n.useState(null),[B,me]=n.useState(""),[K,I]=n.useState([]),[Z,N]=n.useState(!1),ee=n.useRef(null),te=n.useRef(null),[U,he]=n.useState(!1),[se,Se]=n.useState({unchecked:!0,accepted:!0,denied:!0,finished:!0,archived:!1}),ae=n.useRef(null),ie=n.useRef(null),{notify:l}=ve(),C=async()=>{if(a){y(!0);try{const t=await fetch(`${g}/api/moddi/queues/${a}`,{credentials:"include"});if(t.ok){const r=await t.json();F(r.queue),W(r.members||[]),x(r.submissions||[])}else t.status===403?(l("You do not have access to this queue",{variant:"error"}),o("/md/queues")):l("Failed to load queue",{variant:"error"})}catch{l("Failed to load queue",{variant:"error"})}finally{y(!1)}}};n.useEffect(()=>{C(),fetch(`${g}/api/me`,{credentials:"include"}).then(t=>t.ok?t.json():null).then(t=>Q(t)).catch(()=>{})},[a]);const re=m&&i&&(i.owner_id===m.id||c.some(t=>t.user_id===m.id&&t.role==="owner")),ke=m&&c.some(t=>t.user_id===m.id&&t.joined_at),fe=m&&i&&(i.owner_id===m.id||c.some(t=>t.user_id===m.id&&t.joined_at)),we=async t=>{if(t.preventDefault(),!i||i.is_open===0){l("Queue is closed for submissions",{variant:"error"});return}if(!d.trim()){l("Beatmap URL is required",{variant:"error"});return}T(!0);try{const r=z("csrf")||"",s=await fetch(`${g}/api/moddi/queues/${a}/submit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r},body:JSON.stringify({beatmap_url:d.trim(),message:b.trim()||null})});if(s.ok)l("Submission created!",{variant:"success"}),w(!1),p(""),v(""),C();else{const u=await s.json().catch(()=>({}));l(u.error||"Failed to submit",{variant:"error"})}}catch{l("Failed to submit",{variant:"error"})}finally{T(!1)}},Te=t=>{x(r=>r.map(s=>s.id===t.id?t:s))},Ne=()=>{i&&(J(i.name),G(i.description||""),V(i.rules||""),S(!0),D("general"))},_=()=>{S(!1),J(""),G(""),V("")},Ce=async()=>{if(!(!i||!fe)){ce(!0);try{const t=z("csrf")||"",r=i.is_open!==1,s=await fetch(`${g}/api/moddi/queues/${a}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":t},body:JSON.stringify({is_open:r})});if(s.ok)l(`Queue ${r?"opened":"closed"}`,{variant:"success"}),C();else{const u=await s.json().catch(()=>({}));l(u.error||"Failed to update status",{variant:"error"})}}catch{l("Failed to update status",{variant:"error"})}finally{ce(!1)}}},_e=async t=>{if(t.preventDefault(),!i||!H.trim()){l("Queue name is required",{variant:"error"});return}ue(!0);try{const r=z("csrf")||"",s=c.filter(q=>q.user_id!==i.owner_id&&q.role!=="owner").length>0,u=await fetch(`${g}/api/moddi/queues/${a}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r},body:JSON.stringify({name:H.trim(),description:le.trim()||null,rules:A.trim()||null,is_group:s})});if(u.ok)l("Queue updated!",{variant:"success"}),_(),C();else{const q=await u.json().catch(()=>({}));l(q.error||"Failed to update queue",{variant:"error"})}}catch{l("Failed to update queue",{variant:"error"})}finally{ue(!1)}};n.useEffect(()=>{if(!B.trim()){I([]),N(!1);return}const t=setTimeout(async()=>{try{const r=await fetch(`${g}/api/admin/users/search?q=${encodeURIComponent(B)}`,{credentials:"include"});if(r.ok){const s=await r.json();I(s.items||[]),N(!0)}else I([]),N(!1)}catch{I([]),N(!1)}},300);return()=>clearTimeout(t)},[B]);const ze=async t=>{if(!Y){pe(!0);try{const r=z("csrf")||"",s=await fetch(`${g}/api/moddi/queues/${a}/invite`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r},body:JSON.stringify({user_id:t})});if(s.ok)l("Invite sent!",{variant:"success"}),me(""),I([]),N(!1),C();else{const u=await s.json().catch(()=>({}));l(u.error||"Failed to invite member",{variant:"error"})}}catch{l("Failed to invite member",{variant:"error"})}finally{pe(!1)}}},Fe=async()=>{if(i&&confirm(`Are you sure you want to delete "${i.name}"? This action cannot be undone.`)){de(!0);try{const t=z("csrf")||"",r=await fetch(`${g}/api/moddi/queues/${a}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":t}});if(r.ok)l("Queue deleted",{variant:"success"}),o("/md/queues");else{const s=await r.json().catch(()=>({}));l(s.error||"Failed to delete queue",{variant:"error"})}}catch{l("Failed to delete queue",{variant:"error"})}finally{de(!1)}}},Re=async t=>{if(confirm("Remove this member from the queue?")){L(t);try{const r=z("csrf")||"",s=await fetch(`${g}/api/moddi/queues/${a}/members/${t}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":r}});if(s.ok){l("Member removed",{variant:"success"});const q=c.filter(E=>E.user_id!==t).some(E=>E.user_id!==(i==null?void 0:i.owner_id)&&E.role!=="owner");i&&i.is_group===1&&!q&&((await fetch(`${g}/api/moddi/queues/${a}`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json","X-CSRF-Token":r},body:JSON.stringify({is_group:!1})})).ok||console.warn("Failed to convert queue back to individual after removing last member")),C()}else{const u=await s.json().catch(()=>({}));l(u.error||"Failed to remove member",{variant:"error"})}}catch{l("Failed to remove member",{variant:"error"})}finally{L(null)}}},qe=async t=>{if(confirm("Cancel this invitation?")){L(t);try{const r=z("csrf")||"",s=await fetch(`${g}/api/moddi/queues/${a}/members/${t}`,{method:"DELETE",credentials:"include",headers:{"X-CSRF-Token":r}});if(s.ok)l("Invitation canceled",{variant:"success"}),C();else{const u=await s.json().catch(()=>({}));l(u.error||"Failed to cancel invitation",{variant:"error"})}}catch{l("Failed to cancel invitation",{variant:"error"})}finally{L(null)}}};return n.useEffect(()=>{if(!R)return;const t=r=>{const s=r.target;s.closest(".manage-overlay")||s.closest(".manage-overlay-backdrop")||!s.closest(".manage-popup")&&ae.current&&!ae.current.contains(s)&&_()};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[R]),n.useEffect(()=>{if(!U)return;const t=r=>{const s=r.target;ie.current&&!ie.current.contains(s)&&!s.closest(".filter-popup")&&he(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[U]),n.useEffect(()=>{if(!Z)return;const t=r=>{const s=r.target;ee.current&&!ee.current.contains(s)&&te.current&&!te.current.contains(s)&&N(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[Z]),O?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"Loading..."}):i?e.jsxs("div",{style:{width:"100%",maxWidth:"600px",margin:"0 auto",padding:"0 16px"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:16,paddingTop:16},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:12,flex:1,minWidth:0},children:[e.jsx("button",{className:"icon-link",onClick:()=>o("/md/queues"),style:{width:"auto",height:"auto",padding:"4px",background:"transparent"},title:"Back","aria-label":"Back",children:e.jsx(De,{size:20})}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:10,flex:1,minWidth:0},children:[e.jsx("div",{className:"title",style:{flex:1,minWidth:0},children:i.name}),fe&&e.jsxs("button",{onClick:Ce,disabled:je,className:`queue-status-badge ${i.is_open===1?"status-open":"status-closed"}`,title:i.is_open===1?"Close queue":"Open queue","aria-label":i.is_open===1?"Close queue":"Open queue",children:[i.is_open===1?e.jsx(Le,{size:14}):e.jsx(Be,{size:14}),e.jsx("span",{children:i.is_open===1?"Open":"Closed"})]})]})]}),e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8},children:[re&&e.jsx("button",{ref:ae,className:"icon-link",onClick:Ne,style:{width:"auto",height:"auto",padding:"4px"},title:"Manage Queue","aria-label":"Manage Queue",children:e.jsx(Ue,{size:18})}),c.length>0&&e.jsx("div",{style:{display:"flex",alignItems:"center",gap:6},children:c.map(t=>e.jsxs("div",{style:{position:"relative"},onMouseEnter:()=>P(t.user_id),onMouseLeave:()=>P(null),children:[e.jsx(Oe,{to:`/profile/${t.user_id}`,className:"queue-member-avatar",title:t.username,children:t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:t.username}):e.jsx("div",{style:{width:"100%",height:"100%",background:"rgba(255,255,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,color:"var(--muted)"},children:t.username.charAt(0).toUpperCase()})}),X===t.user_id&&e.jsxs("div",{className:"queue-member-tooltip",children:[t.username," ",t.role!=="member"?`(${t.role})`:""]})]},t.user_id))})]})]}),i.description&&e.jsx("div",{className:"muted",style:{marginBottom:16,fontSize:14,padding:"0 4px"},children:i.description}),i.rules&&e.jsxs("div",{style:{marginBottom:16,padding:12,background:"var(--panel-dark)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Rules"}),e.jsx(be,{content:i.rules})]}),i.is_open===0&&e.jsx("div",{style:{marginBottom:12,padding:10,background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:10,textAlign:"center",fontSize:14,color:"#f59e0b"},children:"This queue is currently closed for submissions"}),e.jsxs("div",{style:{background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:10,marginBottom:12,opacity:i.is_open===0?.6:1},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",cursor:i.is_open===1?"pointer":"not-allowed",padding:"8px 12px",minHeight:36},onClick:()=>i.is_open===1&&w(!h),children:[e.jsxs("span",{style:{fontWeight:600,fontSize:16,lineHeight:1},children:["Submit a beatmap ",i.is_open===0&&"(Closed)"]}),i.is_open===1&&(h?e.jsx(ne,{size:16}):e.jsx(Qe,{size:16}))]}),h&&e.jsx("form",{onSubmit:we,style:{padding:"12px",borderTop:"1px solid rgba(255,255,255,0.06)"},children:e.jsxs("div",{className:"col",style:{gap:12},children:[e.jsx("input",{type:"url",placeholder:"Beatmap URL e.g. https://osu.ppy.sh/beatmapsets/...",value:d,onChange:t=>p(t.target.value),required:!0,style:{background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),e.jsx("input",{type:"text",placeholder:"Message (optional, max 100 chars)",value:b,onChange:t=>v(t.target.value.slice(0,100)),maxLength:100,style:{background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:12,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),b.length>0&&e.jsxs("div",{className:"muted",style:{fontSize:12,textAlign:"right",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:[b.length,"/100"]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:t=>{t.stopPropagation(),w(!1)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:$,onClick:t=>t.stopPropagation(),children:$?"Submitting...":"Submit"})]})]})})]}),e.jsxs("div",{style:{borderTop:"1px solid rgba(255,255,255,0.06)",borderBottom:"1px solid rgba(255,255,255,0.06)",position:"relative"},children:[(re||ke)&&e.jsxs("div",{style:{position:"absolute",top:12,right:12,zIndex:5},children:[e.jsx("button",{ref:ie,className:"icon-link",onClick:()=>he(!U),style:{width:"auto",height:"auto",padding:"4px"},title:"Filter submissions","aria-label":"Filter submissions",children:e.jsx(Xe,{size:18})}),U&&e.jsxs("div",{className:"filter-popup",style:{position:"absolute",right:0,top:"100%",marginTop:8,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:8,padding:12,zIndex:10,minWidth:180,boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:8,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Filter by status"}),e.jsx("div",{className:"col",style:{gap:6},children:[{key:"unchecked",label:"Unchecked"},{key:"accepted",label:"Accepted"},{key:"denied",label:"Denied"},{key:"finished",label:"Finished"},{key:"archived",label:"Archived"}].map(({key:t,label:r})=>e.jsxs("label",{className:"row",style:{alignItems:"center",gap:8,cursor:"pointer",fontSize:13},children:[e.jsx("input",{type:"checkbox",checked:se[t],onChange:s=>Se(u=>({...u,[t]:s.target.checked})),style:{cursor:"pointer"}}),e.jsx("span",{children:r})]},t))})]})]}),e.jsx("div",{className:"col",style:{gap:0},children:M.length===0?e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"No submissions yet."}):M.filter(t=>{const r=!!t.is_archived;return se[t.status]&&(se.archived||!r)}).map(t=>e.jsx(Je,{submission:t,canManage:!!re,onUpdate:Te},t.id))})]}),R&&Ae.createPortal(e.jsxs("div",{className:"overlay manage-overlay",children:[e.jsx("div",{className:"overlay-backdrop manage-overlay-backdrop",onClick:_}),e.jsxs("div",{className:"overlay-card",style:{maxWidth:500},children:[e.jsx("button",{className:"overlay-close",onClick:_,"aria-label":"Close",children:e.jsx(ne,{size:18})}),e.jsxs("div",{className:"col",style:{gap:0,padding:"0"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:16,padding:"20px 16px 12px",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:[e.jsx("div",{className:"title",style:{fontSize:20,margin:0,padding:0,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Manage Queue"}),e.jsxs("div",{className:"tabs",role:"tablist",style:{margin:0},children:[e.jsx("button",{role:"tab","aria-selected":j==="general",className:`tab ${j==="general"?"active":""}`,onClick:()=>D("general"),children:"General"}),e.jsx("button",{role:"tab","aria-selected":j==="rules",className:`tab ${j==="rules"?"active":""}`,onClick:()=>D("rules"),children:"Rules"}),e.jsx("button",{role:"tab","aria-selected":j==="members",className:`tab ${j==="members"?"active":""}`,onClick:()=>D("members"),children:"Members"})]})]}),e.jsx("hr",{className:"subtle-divider",style:{margin:"0 16px"}}),e.jsxs("form",{onSubmit:_e,className:"col",style:{gap:0,padding:"16px"},children:[j==="general"&&e.jsxs("div",{className:"col",style:{gap:10},children:[e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Queue Name"}),e.jsx("input",{type:"text",value:H,onChange:t=>J(t.target.value),required:!0,style:{background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}})]}),e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Description (optional)"}),e.jsx("textarea",{placeholder:"Description",value:le,onChange:t=>G(t.target.value),rows:3,style:{background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14,resize:"vertical"}})]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"space-between",alignItems:"center",marginTop:8},children:[e.jsxs("button",{type:"button",className:"btn secondary",onClick:Fe,disabled:k||f,style:{background:"rgba(248, 113, 113, 0.1)",borderColor:"rgba(248, 113, 113, 0.3)",color:"var(--danger)",fontSize:13,padding:"8px 12px"},children:[e.jsx(xe,{size:14,style:{marginRight:6}}),k?"Deleting...":"Delete Queue"]}),e.jsxs("div",{className:"row",style:{gap:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:_,disabled:f||k,style:{fontSize:13,padding:"8px 16px"},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:f||k,style:{fontSize:13,padding:"8px 16px"},children:f?"Updating...":"Save Changes"})]})]})]}),j==="rules"&&e.jsxs("div",{className:"col",style:{gap:10},children:[e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Rules (optional, markdown supported)"}),e.jsx("textarea",{placeholder:"Rules in markdown format...",value:A,onChange:t=>V(t.target.value),rows:8,style:{background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:13,resize:"vertical"}}),A&&e.jsxs("div",{style:{padding:10,background:"var(--panel-dark)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:8,fontSize:12},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:6,opacity:.8,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Preview:"}),e.jsx(be,{content:A})]})]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end",marginTop:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:_,disabled:f||k,style:{fontSize:13,padding:"8px 16px"},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:f||k,style:{fontSize:13,padding:"8px 16px"},children:f?"Updating...":"Save Changes"})]})]}),j==="members"&&e.jsxs("div",{className:"col",style:{gap:10},children:[e.jsxs("div",{className:"col",style:{gap:6,position:"relative"},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Invite Members"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{ref:ee,type:"text",placeholder:"Search username or ID",value:B,onChange:t=>me(t.target.value),onKeyDown:t=>{t.key==="Enter"&&t.preventDefault()},onFocus:()=>{K.length>0&&N(!0)},style:{width:"100%",background:"var(--bg)",border:"1px solid rgba(255,255,255,0.12)",borderRadius:8,padding:10,color:"var(--text)",fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif",fontSize:14}}),Z&&K.length>0&&e.jsx("div",{ref:te,style:{position:"absolute",top:"100%",left:0,right:0,marginTop:4,background:"var(--panel)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:8,maxHeight:300,overflowY:"auto",zIndex:1e3,boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:e.jsx("div",{className:"col",style:{gap:0},children:K.map(t=>{const r=c.some(s=>s.user_id===t.id);return e.jsxs("button",{className:"menu-item",onClick:()=>{!r&&!Y&&ze(t.id)},disabled:r||Y,style:{justifyContent:"flex-start",opacity:r?.5:1,cursor:r?"not-allowed":"pointer"},children:[t.avatar_url&&e.jsx("img",{src:t.avatar_url,width:20,height:20,style:{borderRadius:"50%",marginRight:8}}),e.jsxs("div",{style:{flex:1,textAlign:"left",minWidth:0},children:[e.jsx("div",{style:{fontSize:13,fontWeight:500},children:t.username}),e.jsxs("div",{className:"muted",style:{fontSize:11},children:["id ",t.id," â€¢ osu ",t.osu_user_id]})]}),r&&e.jsx("span",{style:{color:"var(--muted)",fontSize:11},children:"Already a member"})]},t.id)})})})]})]}),c.length>0&&e.jsxs("div",{className:"col",style:{gap:6},children:[e.jsx("label",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Members"}),e.jsx("div",{className:"col",style:{gap:4},children:(()=>{const t=c.filter(s=>s.joined_at!==null),r=c.filter(s=>s.invited_at!==null&&s.joined_at===null);return e.jsxs(e.Fragment,{children:[t.map(s=>e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 0"},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flex:1,minWidth:0},children:[s.avatar_url&&e.jsx("img",{src:s.avatar_url,width:32,height:32,style:{borderRadius:"50%"},alt:s.username}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:s.username}),e.jsx("div",{className:"muted",style:{fontSize:12,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:s.role})]})]}),s.user_id!==i.owner_id&&s.role!=="owner"&&e.jsx("button",{className:"icon-link",onClick:()=>Re(s.user_id),disabled:ge===s.user_id,title:"Remove member",style:{width:"auto",height:"auto",padding:"4px",color:"var(--danger)"},children:e.jsx(xe,{size:16})})]},s.user_id)),r.length>0&&e.jsx(e.Fragment,{children:r.map(s=>e.jsxs("div",{className:"row",style:{alignItems:"center",justifyContent:"space-between",gap:8,padding:"6px 0",opacity:.7},children:[e.jsxs("div",{className:"row",style:{alignItems:"center",gap:8,flex:1,minWidth:0},children:[s.avatar_url&&e.jsx("img",{src:s.avatar_url,width:32,height:32,style:{borderRadius:"50%"},alt:s.username}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:14,fontWeight:500,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:s.username}),e.jsx("div",{className:"muted",style:{fontSize:12,fontFamily:"'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif"},children:"Invited"})]})]}),e.jsx("button",{className:"icon-link",onClick:()=>qe(s.user_id),disabled:ge===s.user_id,title:"Cancel invitation",style:{width:"auto",height:"auto",padding:"4px",color:"var(--danger)"},children:e.jsx(ne,{size:16})})]},s.user_id))})]})})()})]}),e.jsxs("div",{className:"row",style:{gap:8,justifyContent:"flex-end",marginTop:8},children:[e.jsx("button",{type:"button",className:"btn secondary",onClick:_,disabled:f||k,style:{fontSize:13,padding:"8px 16px"},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn",disabled:f||k,style:{fontSize:13,padding:"8px 16px"},children:f?"Updating...":"Save Changes"})]})]})]})]})]})]}),document.body),e.jsx("style",{children:`
        .queue-member-avatar {
          width: 32px;
          height: 32px;
          border-radius: 9999px;
          padding: 0;
          border: 1px solid rgba(255,255,255,0.08);
          overflow: hidden;
          cursor: pointer;
          background: transparent;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          text-decoration: none;
          transition: border-color 0.2s;
        }
        .queue-member-avatar:hover {
          border-color: rgba(167, 139, 250, 0.4);
        }
        .queue-member-avatar img {
          width: 100%;
          height: 100%;
          object-fit: cover;
          display: block;
        }
        .queue-member-tooltip {
          position: absolute;
          bottom: calc(100% + 8px);
          left: 50%;
          transform: translateX(-50%);
          background: rgba(18, 20, 24, 0.95);
          color: var(--text, #e5e7eb);
          border: 1px solid rgba(255, 255, 255, 0.08);
          border-radius: 6px;
          padding: 6px 10px;
          font-size: 14px;
          white-space: nowrap;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
          z-index: 10000;
          pointer-events: none;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
        }
        .queue-member-tooltip::after {
          content: '';
          position: absolute;
          top: 100%;
          left: 50%;
          transform: translateX(-50%);
          width: 0;
          height: 0;
          border-left: 5px solid transparent;
          border-right: 5px solid transparent;
          border-top: 5px solid rgba(18, 20, 24, 0.95);
        }
        .queue-status-badge {
          display: inline-flex;
          align-items: center;
          gap: 6px;
          padding: 6px 12px;
          border-radius: 12px;
          font-size: 12px;
          font-weight: 600;
          font-family: 'Torus Pro', Torus, ui-sans-serif, system-ui, sans-serif;
          border: 1px solid;
          cursor: pointer;
          transition: all 0.2s;
          white-space: nowrap;
        }
        .queue-status-badge:disabled {
          cursor: not-allowed;
          opacity: 0.6;
        }
        .queue-status-badge.status-open {
          background: rgba(52, 211, 153, 0.15);
          border-color: rgba(52, 211, 153, 0.4);
          color: #34d399;
        }
        .queue-status-badge.status-open:hover:not(:disabled) {
          background: rgba(52, 211, 153, 0.25);
          border-color: rgba(52, 211, 153, 0.5);
        }
        .queue-status-badge.status-closed {
          background: rgba(245, 158, 11, 0.15);
          border-color: rgba(245, 158, 11, 0.4);
          color: #f59e0b;
        }
        .queue-status-badge.status-closed:hover:not(:disabled) {
          background: rgba(245, 158, 11, 0.25);
          border-color: rgba(245, 158, 11, 0.5);
        }
      `})]}):e.jsx("div",{className:"muted",style:{textAlign:"center",padding:48},children:"Queue not found"})}export{Ze as default};
